---
source: tests/class.rs
expression: class
---
header:
  version:
    major: 1
    minor: 0
  properties:
    multi_use: MultiUse
    persistable: NotPersistable
    data_binding_behavior: None
    data_source_behavior: None
    mts_transaction_mode: NotAnMTSObject
  attributes:
    name: cSystemColorDialog
    global_name_space: Local
    creatable: "True"
    predeclared_id: "False"
    exposed: "False"
    description: ~
    ext_key: {}
cst:
  root:
    kind: Root
    children:
      - kind: EndOfLineComment
        text: "'Display a system color selection dialog"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Adopted from a reference implementation at http://www.devx.com/vb2themax/Tip/19257, originally by Marco Bellinaso"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' See also the MSDN documentation for ChooseColor at https://msdn.microsoft.com/en-us/library/windows/desktop/ms646912%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396"
      - kind: Newline
        text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: OptionStatement
        children:
          - kind: OptionKeyword
            text: Option
          - kind: Whitespace
            text: " "
          - kind: ExplicitKeyword
            text: Explicit
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: ChooseColorStruct
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lStructSize
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: hwndOwner
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: hInstance
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: rgbResult
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpCustColors
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: flags
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lCustData
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpfnHook
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpTemplateName
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: ChooseColor
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"comdlg32.dll\""
          - kind: Whitespace
            text: " "
          - kind: AliasKeyword
            text: Alias
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"ChooseColorA\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: Identifier
                text: lpChooseColor
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: ChooseColorStruct
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: OleTranslateColor
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"oleaut32.dll\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lOleColor
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lHPalette
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lColorRef
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: Whitespace
        text: "    "
      - kind: Newline
        text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_RGBINIT
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H1
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_FULLOPEN
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H2
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_PREVENTFULLOPEN
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H4
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_SHOWHELP
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H8
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_ENABLEHOOK
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H10
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_ENABLETEMPLATE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H20
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_ENABLETEMPLATEHANDLE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H40
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_SOLIDCOLOR
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H80
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CC_ANYCOLOR
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H100
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CLR_INVALID
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: HFFFF
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Show the common dialog for choosing a color."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Returns TRUE if OK was selected; FALSE otherwise"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' dstColor holds the return value; this value is nonsense if the function returns FALSE"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' hParent is the handle (hWnd) of the parent form"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' showFullDialog specifies whether the dialog will show both selection panels by default"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' initColor is the color initially selected when the dialog is open"
      - kind: Newline
        text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Example:"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'    Dim oleNewColor As OLE_COLOR"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'    If ShowColorsDialog(oleNewColor, Me.hwnd, True, vbRed) Then Me.BackColor = oleNewColor"
      - kind: Newline
        text: "\r\n"
      - kind: FunctionStatement
        children:
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: ShowColorDialog
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstColor
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hParent
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: NumericLiteralExpression
                children:
                  - kind: LongLiteral
                    text: 0&
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: showFullDialog
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: initColor
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: OLE_COLOR
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: BooleanKeyword
            text: Boolean
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: cc
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: ChooseColorStruct
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: aColorRef
                  - kind: LeftParenthesis
                    text: (
                  - kind: NumericLiteralExpression
                    children:
                      - kind: IntegerLiteral
                        text: "15"
                  - kind: RightParenthesis
                    text: )
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: lInitColor
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "  "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' Translate the initial OLE color to a long value"
              - kind: Newline
                text: "\r\n"
              - kind: IfStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: IfKeyword
                    text: If
                  - kind: Whitespace
                    text: " "
                  - kind: ParenthesizedExpression
                    children:
                      - kind: LeftParenthesis
                        text: (
                      - kind: BinaryExpression
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: initColor
                          - kind: Whitespace
                            text: " "
                          - kind: InequalityOperator
                            text: "<>"
                          - kind: Whitespace
                            text: " "
                          - kind: NumericLiteralExpression
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                      - kind: RightParenthesis
                        text: )
                  - kind: Whitespace
                    text: " "
                  - kind: ThenKeyword
                    text: Then
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: CallExpression
                            children:
                              - kind: Identifier
                                text: OleTranslateColor
                              - kind: LeftParenthesis
                                text: (
                              - kind: ArgumentList
                                children:
                                  - kind: Argument
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: initColor
                                  - kind: Comma
                                    text: ","
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Argument
                                    children:
                                      - kind: NumericLiteralExpression
                                        children:
                                          - kind: IntegerLiteral
                                            text: "0"
                                  - kind: Comma
                                    text: ","
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Argument
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: lInitColor
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lInitColor
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: CLR_INVALID
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "    "
                          - kind: EndKeyword
                            text: End
                          - kind: IfStatement
                            children:
                              - kind: Whitespace
                                text: " "
                              - kind: IfKeyword
                                text: If
                              - kind: IdentifierExpression
                                children:
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: Whitespace
                                text: "    "
                              - kind: Newline
                                text: "\r\n"
                              - kind: StatementList
                                children:
                                  - kind: Whitespace
                                    text: "    "
                                  - kind: EndOfLineComment
                                    text: "' Fill the ChooseColorStruct struct"
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: WithStatement
                                    children:
                                      - kind: Whitespace
                                        text: "    "
                                      - kind: WithKeyword
                                        text: With
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Identifier
                                        text: cc
                                      - kind: Newline
                                        text: "\r\n"
                                      - kind: StatementList
                                        children:
                                          - kind: Whitespace
                                            text: "        "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: PeriodOperator
                                                    text: "."
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: lStructSize
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: EqualityOperator
                                                    text: "="
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: CallExpression
                                                    children:
                                                      - kind: LenKeyword
                                                        text: Len
                                                      - kind: LeftParenthesis
                                                        text: (
                                                      - kind: ArgumentList
                                                        children:
                                                          - kind: Argument
                                                            children:
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: cc
                                                      - kind: RightParenthesis
                                                        text: )
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "        "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: PeriodOperator
                                                    text: "."
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: hwndOwner
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: EqualityOperator
                                                    text: "="
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: hParent
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "        "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: PeriodOperator
                                                    text: "."
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: lpCustColors
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: EqualityOperator
                                                    text: "="
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: CallExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: VarPtr
                                                      - kind: LeftParenthesis
                                                        text: (
                                                      - kind: ArgumentList
                                                        children:
                                                          - kind: Argument
                                                            children:
                                                              - kind: CallExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: aColorRef
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                  - kind: ArgumentList
                                                                    children:
                                                                      - kind: Argument
                                                                        children:
                                                                          - kind: NumericLiteralExpression
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "0"
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                      - kind: RightParenthesis
                                                        text: )
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "        "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: PeriodOperator
                                                    text: "."
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: rgbResult
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: EqualityOperator
                                                    text: "="
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: initColor
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "        "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: PeriodOperator
                                                    text: "."
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: BinaryExpression
                                                    children:
                                                      - kind: BinaryExpression
                                                        children:
                                                          - kind: BinaryExpression
                                                            children:
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: flags
                                                              - kind: Whitespace
                                                                text: " "
                                                              - kind: EqualityOperator
                                                                text: "="
                                                              - kind: Whitespace
                                                                text: " "
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: CC_SOLIDCOLOR
                                                          - kind: Whitespace
                                                            text: " "
                                                          - kind: OrKeyword
                                                            text: Or
                                                          - kind: Whitespace
                                                            text: " "
                                                          - kind: IdentifierExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: CC_ANYCOLOR
                                                      - kind: Whitespace
                                                        text: " "
                                                      - kind: OrKeyword
                                                        text: Or
                                                      - kind: Whitespace
                                                        text: " "
                                                      - kind: IdentifierExpression
                                                        children:
                                                          - kind: Identifier
                                                            text: CC_RGBINIT
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: OrKeyword
                                                    text: Or
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: CallExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: IIf
                                                      - kind: LeftParenthesis
                                                        text: (
                                                      - kind: ArgumentList
                                                        children:
                                                          - kind: Argument
                                                            children:
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: showFullDialog
                                                          - kind: Comma
                                                            text: ","
                                                          - kind: Whitespace
                                                            text: " "
                                                          - kind: Argument
                                                            children:
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: CC_FULLOPEN
                                                          - kind: Comma
                                                            text: ","
                                                          - kind: Whitespace
                                                            text: " "
                                                          - kind: Argument
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                      - kind: RightParenthesis
                                                        text: )
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "    "
                                      - kind: EndKeyword
                                        text: End
                                      - kind: Whitespace
                                        text: " "
                                      - kind: WithKeyword
                                        text: With
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Whitespace
                                    text: "    "
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: Whitespace
                                    text: "    "
                                  - kind: EndOfLineComment
                                    text: "' Show the dialog and return the result (if any)"
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: Whitespace
                                    text: "    "
                                  - kind: AssignmentStatement
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: ShowColorDialog
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: CBool
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: CallExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: ChooseColor
                                                      - kind: LeftParenthesis
                                                        text: (
                                                      - kind: ArgumentList
                                                        children:
                                                          - kind: Argument
                                                            children:
                                                              - kind: IdentifierExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: cc
                                                      - kind: RightParenthesis
                                                        text: )
                                          - kind: RightParenthesis
                                            text: )
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: IfStatement
                                    children:
                                      - kind: Whitespace
                                        text: "    "
                                      - kind: IfKeyword
                                        text: If
                                      - kind: Whitespace
                                        text: " "
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: ShowColorDialog
                                      - kind: Whitespace
                                        text: " "
                                      - kind: ThenKeyword
                                        text: Then
                                      - kind: Whitespace
                                        text: " "
                                      - kind: AssignmentStatement
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: dstColor
                                          - kind: Whitespace
                                            text: " "
                                          - kind: EqualityOperator
                                            text: "="
                                          - kind: Whitespace
                                            text: " "
                                          - kind: MemberAccessExpression
                                            children:
                                              - kind: Identifier
                                                text: cc
                                              - kind: PeriodOperator
                                                text: "."
                                              - kind: Identifier
                                                text: rgbResult
                                          - kind: Newline
                                            text: "\r\n"
                                      - kind: Whitespace
                                        text: "    "
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Unknown
                                    text: End
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Unknown
                                    text: Function
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: Newline
                                    text: "\r\n"
