---
source: tests/class.rs
expression: class1
---
header:
  version:
    major: 1
    minor: 0
  properties:
    multi_use: MultiUse
    persistable: NotPersistable
    data_binding_behavior: None
    data_source_behavior: None
    mts_transaction_mode: NotAnMTSObject
  attributes:
    name: FastDrawing
    global_name_space: Local
    creatable: "True"
    predeclared_id: "False"
    exposed: "False"
    description: ~
    ext_key: {}
cst:
  root:
    kind: Root
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Real-time drawing class for VB6"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Published in 2011 by Tanner Helland"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'This class was built to simplify per-pixel access in VB6.  The attached project demonstrates how to use it."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Note that its simplified design is primarily based around modifying 24-bpp RGB data.  Alpha channels are"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' not currently supported (although the code could be easily modified for this)."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'***************************************************************************"
      - kind: Newline
        text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: OptionStatement
        children:
          - kind: OptionKeyword
            text: Option
          - kind: Whitespace
            text: " "
          - kind: ExplicitKeyword
            text: Explicit
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Stripped down bitmap information"
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_Bitmap
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmType
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmWidth
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmHeight
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmWidthBytes
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmPlanes
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmBitsPixel
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmBits
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Retrieve object properties directly from Windows; this lets us bypass some VB-specific annoyances"
      - kind: Newline
        text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetObject
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"gdi32\""
          - kind: Whitespace
            text: " "
          - kind: AliasKeyword
            text: Alias
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"GetObjectA\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hObject
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: nCount
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpObject
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Any
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Standard pixel data (Windows BGRA order)"
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_RGBQuad
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: rgbBlue
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: ByteKeyword
            text: Byte
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: rgbGreen
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: ByteKeyword
            text: Byte
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: rgbRed
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: ByteKeyword
            text: Byte
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: rgbAlpha
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: ByteKeyword
            text: Byte
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Full-size bitmap header"
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_BitmapInfoHeader
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmSize
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmWidth
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmHeight
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmPlanes
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmBitCount
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmCompression
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmSizeImage
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmXPelsPerMeter
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmYPelsPerMeter
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmClrUsed
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmClrImportant
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Extended header for 8-bit images"
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_BitmapInfo
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmHeader
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_BitmapInfoHeader
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: bmColors
          - kind: LeftParenthesis
            text: (
          - kind: IntegerLiteral
            text: "0"
          - kind: Whitespace
            text: " "
          - kind: ToKeyword
            text: To
          - kind: Whitespace
            text: " "
          - kind: IntegerLiteral
            text: "255"
          - kind: RightParenthesis
            text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GDI_RGBQuad
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Higher-quality image stretching must be activated manually"
      - kind: Newline
        text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: SetStretchBltMode
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"gdi32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hDC
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: nStretchMode
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'DIB section interfaces"
      - kind: Newline
        text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetDIBits
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"gdi32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hDC
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hBitmap
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: nStartScan
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: nNumScans
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpBits
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Any
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpBI
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: GDI_BitmapInfo
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: wUsage
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: StretchDIBits
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"gdi32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: hDC
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstX
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstY
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstWidth
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstHeight
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcX
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcY
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcWidth
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcHeight
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpBits
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Any
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpBitsInfo
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: GDI_BitmapInfo
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: wUsage
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dwRop
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Return an image's width, in pixels"
      - kind: Newline
        text: "\r\n"
      - kind: FunctionStatement
        children:
          - kind: PublicKeyword
            text: Public
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetImageWidth
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcPictureBox
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: PictureBox
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_Bitmap
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: GetObject
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: Image
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: LenKeyword
                    text: Len
                  - kind: LeftParenthesis
                    text: (
                  - kind: Identifier
                    text: bm
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: AssignmentStatement
                children:
                  - kind: IdentifierExpression
                    children:
                      - kind: Identifier
                        text: GetImageWidth
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: MemberAccessExpression
                    children:
                      - kind: Identifier
                        text: bm
                      - kind: PeriodOperator
                        text: "."
                      - kind: Identifier
                        text: bmWidth
                  - kind: Newline
                    text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Return an image's height, in pixels"
      - kind: Newline
        text: "\r\n"
      - kind: FunctionStatement
        children:
          - kind: PublicKeyword
            text: Public
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetImageHeight
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcPictureBox
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: PictureBox
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_Bitmap
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: GetObject
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: Image
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: LenKeyword
                    text: Len
                  - kind: LeftParenthesis
                    text: (
                  - kind: Identifier
                    text: bm
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: AssignmentStatement
                children:
                  - kind: IdentifierExpression
                    children:
                      - kind: Identifier
                        text: GetImageHeight
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: CallExpression
                    children:
                      - kind: Identifier
                        text: Abs
                      - kind: LeftParenthesis
                        text: (
                      - kind: ArgumentList
                        children:
                          - kind: Argument
                            children:
                              - kind: MemberAccessExpression
                                children:
                                  - kind: Identifier
                                    text: bm
                                  - kind: PeriodOperator
                                    text: "."
                                  - kind: Identifier
                                    text: bmHeight
                      - kind: RightParenthesis
                        text: )
                  - kind: Newline
                    text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Copy an 24-bpp image's pixel information into an array dimensioned (x * 3 , y).  Each row of the array represents"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Blue, Green, Red pixel values - e.g. BGRBGRBGR..."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Also, because Windows DIBs are stored upside-down (last line first), you can ask this function to reverse"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' line-order for you.  This can make position-specific calculations more intuitive."
      - kind: Newline
        text: "\r\n"
      - kind: SubStatement
        children:
          - kind: PublicKeyword
            text: Public
          - kind: Whitespace
            text: " "
          - kind: SubKeyword
            text: Sub
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetImageData2D
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcPictureBox
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: PictureBox
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstPixelData
              - kind: LeftParenthesis
                text: (
              - kind: RightParenthesis
                text: )
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: ByteKeyword
                text: Byte
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: fixOrientation
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: BooleanLiteralExpression
                children:
                  - kind: FalseKeyword
                    text: "False"
              - kind: RightParenthesis
                text: )
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_Bitmap
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: GetObject
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: Image
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: LenKeyword
                    text: Len
                  - kind: LeftParenthesis
                    text: (
                  - kind: Identifier
                    text: bm
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Calculate a size for the destination array.  For performance reasons, Windows requires"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' 24-bpp DIB scanlines to be aligned on 4-byte boundaries - this means that the destination"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' array's width may not be a multiple of (imageWidth * 3), by design."
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: imgStride
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: AssignmentStatement
                children:
                  - kind: IdentifierExpression
                    children:
                      - kind: Identifier
                        text: imgStride
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: BinaryExpression
                    children:
                      - kind: BinaryExpression
                        children:
                          - kind: ParenthesizedExpression
                            children:
                              - kind: LeftParenthesis
                                text: (
                              - kind: BinaryExpression
                                children:
                                  - kind: MemberAccessExpression
                                    children:
                                      - kind: Identifier
                                        text: bm
                                      - kind: PeriodOperator
                                        text: "."
                                      - kind: Identifier
                                        text: bmWidth
                                  - kind: Whitespace
                                    text: " "
                                  - kind: MultiplicationOperator
                                    text: "*"
                                  - kind: Whitespace
                                    text: " "
                                  - kind: NumericLiteralExpression
                                    children:
                                      - kind: IntegerLiteral
                                        text: "3"
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: SubtractionOperator
                            text: "-"
                          - kind: Whitespace
                            text: " "
                          - kind: NumericLiteralExpression
                            children:
                              - kind: IntegerLiteral
                                text: "1"
                      - kind: Whitespace
                        text: " "
                      - kind: AdditionOperator
                        text: +
                      - kind: Whitespace
                        text: " "
                      - kind: ParenthesizedExpression
                        children:
                          - kind: LeftParenthesis
                            text: (
                          - kind: BinaryExpression
                            children:
                              - kind: MemberAccessExpression
                                children:
                                  - kind: Identifier
                                    text: bm
                                  - kind: PeriodOperator
                                    text: "."
                                  - kind: Identifier
                                    text: bmWidth
                              - kind: Whitespace
                                text: " "
                              - kind: ModKeyword
                                text: Mod
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "4"
                          - kind: RightParenthesis
                            text: )
                  - kind: Newline
                    text: "\r\n"
              - kind: ReDimStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: ReDimKeyword
                    text: ReDim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: dstPixelData
                  - kind: LeftParenthesis
                    text: (
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Whitespace
                    text: " "
                  - kind: ToKeyword
                    text: To
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: imgStride
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Whitespace
                    text: " "
                  - kind: ToKeyword
                    text: To
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmHeight
                  - kind: Whitespace
                    text: " "
                  - kind: SubtractionOperator
                    text: "-"
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "1"
                  - kind: RightParenthesis
                    text: )
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: ByteKeyword
                    text: Byte
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Create a temporary header to pass to the GetDIBits call"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_BitmapInfo
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: WithStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: WithKeyword
                    text: With
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmHeader
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmWidth
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: MemberAccessExpression
                                children:
                                  - kind: Identifier
                                    text: bm
                                  - kind: PeriodOperator
                                    text: "."
                                  - kind: Identifier
                                    text: bmWidth
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmHeight
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: MemberAccessExpression
                                children:
                                  - kind: Identifier
                                    text: bm
                                  - kind: PeriodOperator
                                    text: "."
                                  - kind: Identifier
                                    text: bmHeight
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: fixOrientation
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: bmHeight
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: BinaryExpression
                                    children:
                                      - kind: UnaryExpression
                                        children:
                                          - kind: SubtractionOperator
                                            text: "-"
                                          - kind: NumericLiteralExpression
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                      - kind: Whitespace
                                        text: " "
                                      - kind: MultiplicationOperator
                                        text: "*"
                                      - kind: Whitespace
                                        text: " "
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: PeriodOperator
                                            text: "."
                          - kind: Identifier
                            text: bmHeight
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmSize
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "40"
                      - kind: Whitespace
                        text: "                "
                      - kind: EndOfLineComment
                        text: "'Size, in bytes, of the header"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmPlanes
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                      - kind: Whitespace
                        text: "               "
                      - kind: EndOfLineComment
                        text: "'Number of planes (always one for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmBitCount
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "24"
                      - kind: Whitespace
                        text: "            "
                      - kind: EndOfLineComment
                        text: "'Bits per pixel (always 24 for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmCompression
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                      - kind: Whitespace
                        text: "          "
                      - kind: EndOfLineComment
                        text: "'Compression (always none for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: WithKeyword
                    text: With
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Copy the pixel data into our array"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: GetDIBits
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: hDC
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: Image
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmHeight
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: dstPixelData
                  - kind: LeftParenthesis
                    text: (
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: SubKeyword
            text: Sub
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Set an image's pixel information from a raw byte array.  The byte array *must* have been created"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' according to the rules defined in GetImageData2D(), above.  Similarly, if you reversed scanline"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' order at retrieval time, you should also pass TRUE for fixOrientation when calling this function."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'The image will be stretched to fit the destination picture box (without regard to aspect ratio)."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' You can manually modify this by changing the destination parameters of the StretchDIBits call."
      - kind: Newline
        text: "\r\n"
      - kind: SubStatement
        children:
          - kind: PublicKeyword
            text: Public
          - kind: Whitespace
            text: " "
          - kind: SubKeyword
            text: Sub
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: SetImageData2D
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: dstPictureBox
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: PictureBox
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: imgWidth
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: imgHeight
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: srcPixelData
              - kind: LeftParenthesis
                text: (
              - kind: RightParenthesis
                text: )
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: ByteKeyword
                text: Byte
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: fixOrientation
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: BooleanLiteralExpression
                children:
                  - kind: FalseKeyword
                    text: "False"
              - kind: RightParenthesis
                text: )
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_Bitmap
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: GetObject
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: dstPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: Image
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: LenKeyword
                    text: Len
                  - kind: LeftParenthesis
                    text: (
                  - kind: Identifier
                    text: bm
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Create a temporary header to pass to the StretchDIBits call"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: GDI_BitmapInfo
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: WithStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: WithKeyword
                    text: With
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmHeader
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmWidth
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: imgWidth
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmHeight
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: imgHeight
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: fixOrientation
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: bmHeight
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: BinaryExpression
                                    children:
                                      - kind: UnaryExpression
                                        children:
                                          - kind: SubtractionOperator
                                            text: "-"
                                          - kind: NumericLiteralExpression
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                      - kind: Whitespace
                                        text: " "
                                      - kind: MultiplicationOperator
                                        text: "*"
                                      - kind: Whitespace
                                        text: " "
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: PeriodOperator
                                            text: "."
                          - kind: Identifier
                            text: bmHeight
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmSize
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "40"
                      - kind: Whitespace
                        text: "                "
                      - kind: EndOfLineComment
                        text: "'Size, in bytes, of the header"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmPlanes
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                      - kind: Whitespace
                        text: "               "
                      - kind: EndOfLineComment
                        text: "'Number of planes (always one for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmBitCount
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "24"
                      - kind: Whitespace
                        text: "            "
                      - kind: EndOfLineComment
                        text: "'Bits per pixel (always 24 for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: bmCompression
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                      - kind: Whitespace
                        text: "          "
                      - kind: EndOfLineComment
                        text: "'Compression (always none for this instance)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: WithKeyword
                    text: With
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'If stretching will be involved, request high-quality stretching from GDI"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: SetStretchBltMode
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: dstPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: hDC
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: LongLiteral
                    text: 3&
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Paint the pixel data into the destination picture box.  By using bm.bmWidth and bm.bmHeight as"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' the destination width/height, the pixel data will be automatically resized to fit the picture box."
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: CallStatement
                children:
                  - kind: Identifier
                    text: StretchDIBits
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: dstPictureBox
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: hDC
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmWidth
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bm
                  - kind: PeriodOperator
                    text: "."
                  - kind: Identifier
                    text: bmHeight
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: imgWidth
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: imgHeight
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: srcPixelData
                  - kind: LeftParenthesis
                    text: (
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: RightParenthesis
                    text: )
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: bmi
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: IntegerLiteral
                    text: "0"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: vbSrcCopy
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'VB's built-in backbuffer system (\"AutoRedraw\") won't detect changes made by WAPI functions,"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' so we need to manually notify it of the need to redraw."
              - kind: Newline
                text: "\r\n"
              - kind: IfStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: IfKeyword
                    text: If
                  - kind: Whitespace
                    text: " "
                  - kind: MemberAccessExpression
                    children:
                      - kind: Identifier
                        text: dstPictureBox
                      - kind: PeriodOperator
                        text: "."
                      - kind: Identifier
                        text: AutoRedraw
                  - kind: Whitespace
                    text: " "
                  - kind: ThenKeyword
                    text: Then
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: MemberAccessExpression
                            children:
                              - kind: Identifier
                                text: dstPictureBox
                              - kind: PeriodOperator
                                text: "."
                              - kind: Identifier
                                text: Picture
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: MemberAccessExpression
                            children:
                              - kind: Identifier
                                text: dstPictureBox
                              - kind: PeriodOperator
                                text: "."
                              - kind: Identifier
                                text: Image
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: dstPictureBox
                          - kind: PeriodOperator
                            text: "."
                          - kind: Identifier
                            text: Refresh
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: IfKeyword
                    text: If
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: SubKeyword
            text: Sub
          - kind: Newline
            text: "\r\n"
