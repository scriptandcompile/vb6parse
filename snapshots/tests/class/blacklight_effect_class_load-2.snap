---
source: tests/class.rs
expression: class2
---
header:
  version:
    major: 1
    minor: 0
  properties:
    multi_use: MultiUse
    persistable: NotPersistable
    data_binding_behavior: None
    data_source_behavior: None
    mts_transaction_mode: NotAnMTSObject
  attributes:
    name: pdOpenSaveDialog
    global_name_space: Local
    creatable: "True"
    predeclared_id: "False"
    exposed: "False"
    description: ~
    ext_key: {}
cst:
  root:
    kind: Root
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'PhotoDemon Unicode-Aware System Open/Save Dialog"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Copyright 2015-2018 by Tanner Helland"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Created: 05/August/15"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Last updated: 15/August/15"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Last update: finish work on GetSaveFileName()"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Common dialogs appear in multiple places throughout PD.  In the beginning, PD relied on a convenient common dialog wrapper"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' from vbAccelerator (http://www.vbaccelerator.com/home/VB/Code/Libraries/Common_Dialogs/Code_Only_Common_Dialogs/article.asp),"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' but besides being unwieldy and somewhat error-prone, Steve's implementation was ANSI-only.  Due to some major differences in"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' string handling (including multifile delimiters), it was non-trivial to overhaul his control, so in 2015, I wrote a new"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' common dialog interface, specific to PD."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'The eventual goal is to add parallel support for Vista's IFileOpen/SaveDialogs, which would actually allow me to customize"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' the program's main dialogs, but that's a ways off.  For now, everything simply wraps the traditional common dialog controls."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'For convenience against existing code, the function calls are roughly identical to Steve's old control."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'All source code in this file is licensed under a modified BSD license.  This means you may use the code in your own"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' projects IF you provide attribution.  For more information, please visit https://photodemon.org/license/"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'***************************************************************************"
      - kind: Newline
        text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: OptionStatement
        children:
          - kind: OptionKeyword
            text: Option
          - kind: Whitespace
            text: " "
          - kind: ExplicitKeyword
            text: Explicit
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Unicode interface.  Note that the only thing we pass it is a pointer to the master OPENFILENAME struct; it does the rest."
      - kind: Newline
        text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetOpenFileNameW
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"comdlg32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: ptrToOFN
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetSaveFileNameW
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"comdlg32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: ptrToOFN
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CommDlgExtendedError
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"comdlg32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: DeclareStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: DeclareKeyword
            text: Declare
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: lstrlenW
          - kind: Whitespace
            text: " "
          - kind: LibKeyword
            text: Lib
          - kind: Whitespace
            text: " "
          - kind: StringLiteral
            text: "\"kernel32\""
          - kind: Whitespace
            text: " "
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: lpString
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'MSDN struct breakdown: https://msdn.microsoft.com/en-us/library/ms646839%28v=vs.85%29.aspx"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' Note that some parameter behavior (e.g. lpstrInitialDir) varies under Win 7 and later."
      - kind: Newline
        text: "\r\n"
      - kind: TypeStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: OPENFILENAME
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lStructSize
          - kind: Whitespace
            text: "          "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: hWndOwner
          - kind: Whitespace
            text: "            "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: hInstance
          - kind: Whitespace
            text: "            "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrFilter
          - kind: Whitespace
            text: "          "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrCustomFilter
          - kind: Whitespace
            text: "    "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nMaxCustFilter
          - kind: Whitespace
            text: "       "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nFilterIndex
          - kind: Whitespace
            text: "         "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrFile
          - kind: Whitespace
            text: "            "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nMaxFile
          - kind: Whitespace
            text: "             "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrFileTitle
          - kind: Whitespace
            text: "       "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nMaxFileTitle
          - kind: Whitespace
            text: "        "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrInitialDir
          - kind: Whitespace
            text: "      "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrTitle
          - kind: Whitespace
            text: "           "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: Flags
          - kind: Whitespace
            text: "                "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nFileOffset
          - kind: Whitespace
            text: "          "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: nFileExtension
          - kind: Whitespace
            text: "       "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: IntegerKeyword
            text: Integer
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpstrDefExt
          - kind: Whitespace
            text: "          "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: StringKeyword
            text: String
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lCustData
          - kind: Whitespace
            text: "            "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpfnHook
          - kind: Whitespace
            text: "             "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: lpTemplateName
          - kind: Whitespace
            text: "       "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: pvReserved
          - kind: Whitespace
            text: "           "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: dwReserved
          - kind: Whitespace
            text: "           "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: FlagsEx
          - kind: Whitespace
            text: "              "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: TypeKeyword
            text: Type
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EnumStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: EnumKeyword
            text: Enum
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: EOpenFile
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_READONLY
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H1
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_OVERWRITEPROMPT
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H2
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_HIDEREADONLY
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H4
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NOCHANGEDIR
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H8
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_SHOWHELP
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H10
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_ENABLEHOOK
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H20
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_ENABLETEMPLATE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H40
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_ENABLETEMPLATEHANDLE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H80
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NOVALIDATE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H100
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_ALLOWMULTISELECT
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H200
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_EXTENSIONDIFFERENT
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H400
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_PATHMUSTEXIST
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H800
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_FILEMUSTEXIST
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H1000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_CREATEPROMPT
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H2000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_SHAREAWARE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H4000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NOREADONLYRETURN
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H8000
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NOTESTFILECREATE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H10000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NONETWORKBUTTON
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H20000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NOLONGNAMES
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H40000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_EXPLORER
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H80000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_NODEREFERENCELINKS
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H100000
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: OFN_LONGNAMES
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H200000
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: EnumKeyword
            text: Enum
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: Unknown
        text: "#"
      - kind: IfStatement
        children:
          - kind: IfKeyword
            text: If
          - kind: Whitespace
            text: " "
          - kind: BooleanLiteralExpression
            children:
              - kind: FalseKeyword
                text: "False"
          - kind: Whitespace
            text: " "
          - kind: ThenKeyword
            text: Then
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_READONLY
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H1
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_OVERWRITEPROMPT
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: IdentifierExpression
                    children:
                      - kind: Ampersand
                        text: "&"
                  - kind: Identifier
                    text: H2
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_HIDEREADONLY
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H4
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NOCHANGEDIR
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H8
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_SHOWHELP
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H10
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_ENABLEHOOK
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H20
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_ENABLETEMPLATE
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: IdentifierExpression
                    children:
                      - kind: Ampersand
                        text: "&"
                  - kind: Identifier
                    text: H40
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_ENABLETEMPLATEHANDLE
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H80
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NOVALIDATE
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H100
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_ALLOWMULTISELECT
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H200
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_EXTENSIONDIFFERENT
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: IdentifierExpression
                    children:
                      - kind: Ampersand
                        text: "&"
                  - kind: Identifier
                    text: H400
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_PATHMUSTEXIST
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H800
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_FILEMUSTEXIST
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H1000
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_CREATEPROMPT
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H2000
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_SHAREAWARE
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: IdentifierExpression
                    children:
                      - kind: Ampersand
                        text: "&"
                  - kind: Identifier
                    text: H4000
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NOREADONLYRETURN
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H8000
                  - kind: Ampersand
                    text: "&"
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NOTESTFILECREATE
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H10000
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NONETWORKBUTTON
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H20000
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NOLONGNAMES
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: IdentifierExpression
                    children:
                      - kind: Ampersand
                        text: "&"
                  - kind: Identifier
                    text: H40000
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_EXPLORER
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H80000
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_NODEREFERENCELINKS
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H100000
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: PrivateKeyword
                    text: Private
                  - kind: Whitespace
                    text: " "
                  - kind: ConstKeyword
                    text: Const
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OFN_LONGNAMES
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: Ampersand
                    text: "&"
                  - kind: Identifier
                    text: H200000
                  - kind: Newline
                    text: "\r\n"
              - kind: Unknown
                text: "#"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: IfKeyword
            text: If
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'MSDN explanation of potential CD errors: https://msdn.microsoft.com/en-us/library/ms646916%28v=vs.85%29.aspx"
      - kind: Newline
        text: "\r\n"
      - kind: EnumStatement
        children:
          - kind: PublicKeyword
            text: Public
          - kind: Whitespace
            text: " "
          - kind: EnumKeyword
            text: Enum
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: CommonDialogErrorsEnum
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_DIALOGFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: HFFFF
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_FINDRESFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H6
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_LOADRESFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H7
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_INITIALIZATION
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H2
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_LOADSTRFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H5
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_LOCKRESFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H8
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_MEMALLOCFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H9
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_MEMLOCKFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: HA
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_NOHINSTANCE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H4
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_NOHOOK
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H8
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_NOTEMPLATE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H3
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_REGISTERMSGFAIL
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: HC
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_STRUCTSIZE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H1
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: FNERR_BUFFERTOOSMALL
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H3003
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: FNERR_INVALIDFILENAME
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H3002
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: FNERR_SUBCLASSFAILURE
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Ampersand
            text: "&"
          - kind: Identifier
            text: H3001
          - kind: Ampersand
            text: "&"
          - kind: Newline
            text: "\r\n"
          - kind: Whitespace
            text: "    "
          - kind: Identifier
            text: CDERR_CANCELED
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: vbObjectError
          - kind: Newline
            text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: EnumKeyword
            text: Enum
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Arbitrary-length return strings are possible, but because we have to re-raise the dialog upon failure (ugh), it's not"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' really practical to implement a \"try again with larger buffer\" feature.  Fortunately, post-XP operatings systems have"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' no upper limit, so we can start with an arbitrarily large string."
      - kind: Newline
        text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: MAX_PATH_LOAD_XP
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: IntegerLiteral
            text: "16384"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: MAX_PATH_LOAD
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: IntegerLiteral
            text: "262144"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: MAX_PATH_SAVE
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: IntegerLiteral
            text: "1024"
          - kind: Newline
            text: "\r\n"
      - kind: DimStatement
        children:
          - kind: PrivateKeyword
            text: Private
          - kind: Whitespace
            text: " "
          - kind: ConstKeyword
            text: Const
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: MAX_FILE
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: LongKeyword
            text: Long
          - kind: Whitespace
            text: " "
          - kind: EqualityOperator
            text: "="
          - kind: Whitespace
            text: " "
          - kind: IntegerLiteral
            text: "260"
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Display a system-specific Open File dialog."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' RETURNS: TRUE if one or more files was selected; FALSE if canceled."
      - kind: Newline
        text: "\r\n"
      - kind: FunctionStatement
        children:
          - kind: FriendKeyword
            text: Friend
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetOpenFileName
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FileName
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FileTitle
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FileMustExist
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: BooleanLiteralExpression
                children:
                  - kind: TrueKeyword
                    text: "True"
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: MultiSelect
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: BooleanLiteralExpression
                children:
                  - kind: FalseKeyword
                    text: "False"
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Filter
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: StringLiteralExpression
                children:
                  - kind: StringLiteral
                    text: "\"All (*.*)|*.*\""
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FilterIndex
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: NumericLiteralExpression
                children:
                  - kind: IntegerLiteral
                    text: "1"
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: InitDir
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: DlgTitle
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: DefaultExt
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Owner
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: NumericLiteralExpression
                children:
                  - kind: LongLiteral
                    text: 0&
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: BooleanKeyword
            text: Boolean
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: lReturn
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: lInitPathSize
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Prep a relevant OFN struct"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: tmpOFN
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OPENFILENAME
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: WithStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: WithKeyword
                    text: With
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: tmpOFN
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lStructSize
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: LenKeyword
                                    text: Len
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                  - kind: RightParenthesis
                                    text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "' is used to prevent the user from entering invalid filenames."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: BinaryExpression
                                children:
                                  - kind: BinaryExpression
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: Flags
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: OFN_PATHMUSTEXIST
                                  - kind: Whitespace
                                    text: " "
                                  - kind: OrKeyword
                                    text: Or
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: OFN_LONGNAMES
                              - kind: Whitespace
                                text: " "
                              - kind: OrKeyword
                                text: Or
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: OFN_HIDEREADONLY
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: FileMustExist
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                          - kind: Identifier
                            text: Flags
                          - kind: Whitespace
                            text: " "
                          - kind: OrKeyword
                            text: Or
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: OFN_FILEMUSTEXIST
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: MultiSelect
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                          - kind: Identifier
                            text: Flags
                          - kind: Whitespace
                            text: " "
                          - kind: OrKeyword
                            text: Or
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: OFN_ALLOWMULTISELECT
                          - kind: Whitespace
                            text: " "
                          - kind: OrKeyword
                            text: Or
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: OFN_EXPLORER
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Various other obvious flags"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: hWndOwner
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: Owner
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrInitialDir
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: InitDir
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrDefExt
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: DefaultExt
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: DlgTitle
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "' pipe and colon separators, which are forcibly converted now."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: DimStatement
                        children:
                          - kind: DimKeyword
                            text: Dim
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: Ch
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: StringKeyword
                            text: String
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: i
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: IntegerKeyword
                            text: Integer
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: s
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: StringKeyword
                            text: String
                          - kind: Newline
                            text: "\r\n"
                      - kind: ForStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: ForKeyword
                            text: For
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: i
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: NumericLiteralExpression
                            children:
                              - kind: IntegerLiteral
                                text: "1"
                          - kind: Whitespace
                            text: " "
                          - kind: ToKeyword
                            text: To
                          - kind: Whitespace
                            text: " "
                          - kind: CallExpression
                            children:
                              - kind: LenKeyword
                                text: Len
                              - kind: LeftParenthesis
                                text: (
                              - kind: ArgumentList
                                children:
                                  - kind: Argument
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: Filter
                              - kind: RightParenthesis
                                text: )
                          - kind: Newline
                            text: "\r\n"
                          - kind: StatementList
                            children:
                              - kind: Whitespace
                                text: "            "
                              - kind: AssignmentStatement
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Ch
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: CallExpression
                                    children:
                                      - kind: Identifier
                                        text: Mid$
                                      - kind: LeftParenthesis
                                        text: (
                                      - kind: ArgumentList
                                        children:
                                          - kind: Argument
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: Filter
                                          - kind: Comma
                                            text: ","
                                          - kind: Whitespace
                                            text: " "
                                          - kind: Argument
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: i
                                          - kind: Comma
                                            text: ","
                                          - kind: Whitespace
                                            text: " "
                                          - kind: Argument
                                            children:
                                              - kind: NumericLiteralExpression
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                      - kind: RightParenthesis
                                        text: )
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: IfStatement
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Whitespace
                                    text: " "
                                  - kind: BinaryExpression
                                    children:
                                      - kind: BinaryExpression
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: Ch
                                          - kind: Whitespace
                                            text: " "
                                          - kind: EqualityOperator
                                            text: "="
                                          - kind: Whitespace
                                            text: " "
                                          - kind: StringLiteralExpression
                                            children:
                                              - kind: StringLiteral
                                                text: "\"|\""
                                      - kind: Whitespace
                                        text: " "
                                      - kind: OrKeyword
                                        text: Or
                                      - kind: Whitespace
                                        text: " "
                                      - kind: BinaryExpression
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: Ch
                                          - kind: Whitespace
                                            text: " "
                                          - kind: EqualityOperator
                                            text: "="
                                          - kind: Whitespace
                                            text: " "
                                          - kind: StringLiteralExpression
                                            children:
                                              - kind: StringLiteral
                                                text: "\":\""
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ThenKeyword
                                    text: Then
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: StatementList
                                    children:
                                      - kind: Whitespace
                                        text: "                "
                                      - kind: AssignmentStatement
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: s
                                          - kind: Whitespace
                                            text: " "
                                          - kind: EqualityOperator
                                            text: "="
                                          - kind: Whitespace
                                            text: " "
                                          - kind: BinaryExpression
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                              - kind: Whitespace
                                                text: " "
                                              - kind: Ampersand
                                                text: "&"
                                              - kind: Whitespace
                                                text: " "
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: vbNullChar
                                          - kind: Newline
                                            text: "\r\n"
                                      - kind: Whitespace
                                        text: "            "
                                  - kind: ElseClause
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                      - kind: Newline
                                        text: "\r\n"
                                      - kind: StatementList
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                              - kind: Whitespace
                                                text: " "
                                              - kind: EqualityOperator
                                                text: "="
                                              - kind: Whitespace
                                                text: " "
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: s
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: Ampersand
                                                    text: "&"
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: Ch
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "            "
                                  - kind: EndKeyword
                                    text: End
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: Whitespace
                                text: "        "
                          - kind: NextKeyword
                            text: Next
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Double-nulls mark final termination"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: s
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Ampersand
                                    text: "&"
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: vbNullChar
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: vbNullChar
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFilter
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nFilterIndex
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FilterIndex
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lInitPathSize
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: MAX_PATH_LOAD_XP
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileName
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: StringKeyword
                                    text: String
                      - kind: Unknown
                        text: $
                      - kind: Unknown
                        text: (
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: lInitPathSize
                          - kind: Whitespace
                            text: " "
                          - kind: SubtractionOperator
                            text: "-"
                          - kind: Whitespace
                            text: " "
                          - kind: LenKeyword
                            text: Len
                          - kind: LeftParenthesis
                            text: (
                          - kind: Identifier
                            text: FileName
                          - kind: RightParenthesis
                            text: )
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: IntegerLiteral
                            text: "0"
                          - kind: RightParenthesis
                            text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFile
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nMaxFile
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lInitPathSize
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: StringKeyword
                                    text: String
                      - kind: Unknown
                        text: $
                      - kind: Unknown
                        text: (
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: MAX_FILE
                          - kind: Whitespace
                            text: " "
                          - kind: SubtractionOperator
                            text: "-"
                          - kind: Whitespace
                            text: " "
                          - kind: LenKeyword
                            text: Len
                          - kind: LeftParenthesis
                            text: (
                          - kind: Identifier
                            text: FileTitle
                          - kind: RightParenthesis
                            text: )
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: IntegerLiteral
                            text: "0"
                          - kind: RightParenthesis
                            text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nMaxFileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: MAX_FILE
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'All other fields are fine as-is"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: WithKeyword
                    text: With
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Turn control over to the common dialog function"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: AssignmentStatement
                children:
                  - kind: IdentifierExpression
                    children:
                      - kind: Identifier
                        text: lReturn
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: CallExpression
                    children:
                      - kind: Identifier
                        text: GetOpenFileNameW
                      - kind: LeftParenthesis
                        text: (
                      - kind: ArgumentList
                        children:
                          - kind: Argument
                            children:
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: VarPtr
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                  - kind: RightParenthesis
                                    text: )
                      - kind: RightParenthesis
                        text: )
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Before proceeding, add debug info in the special case of a buffer underrun.  This case is problematic, as we can't simply"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' \"try again\" without re-raising a modal dialog, so I'm hoping my current default buffer size is always sufficient."
              - kind: Newline
                text: "\r\n"
              - kind: IfStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: IfKeyword
                    text: If
                  - kind: Whitespace
                    text: " "
                  - kind: BinaryExpression
                    children:
                      - kind: ParenthesizedExpression
                        children:
                          - kind: LeftParenthesis
                            text: (
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lReturn
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: NumericLiteralExpression
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                          - kind: RightParenthesis
                            text: )
                      - kind: Whitespace
                        text: " "
                      - kind: AndKeyword
                        text: And
                      - kind: Whitespace
                        text: " "
                      - kind: ParenthesizedExpression
                        children:
                          - kind: LeftParenthesis
                            text: (
                          - kind: BinaryExpression
                            children:
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: CommDlgExtendedError
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FNERR_BUFFERTOOSMALL
                          - kind: RightParenthesis
                            text: )
                  - kind: Whitespace
                    text: " "
                  - kind: ThenKeyword
                    text: Then
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: MsgBox
                          - kind: Whitespace
                            text: " "
                          - kind: StringLiteral
                            text: "\"Unfortunately, the number of images you selected exceeds what Windows allows for a single load operation.  Please try again with a smaller set of selected images.\""
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: vbExclamation
                          - kind: Whitespace
                            text: " "
                          - kind: OrKeyword
                            text: Or
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: vbOKOnly
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: StringLiteral
                            text: "\"Error: too many images\""
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: IfKeyword
                    text: If
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer."
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 16K buffer as a limit,"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'  since PD won't do well with that many loaded images anyway.)"
              - kind: Newline
                text: "\r\n"
              - kind: IfStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: IfKeyword
                    text: If
                  - kind: Whitespace
                    text: " "
                  - kind: ParenthesizedExpression
                    children:
                      - kind: LeftParenthesis
                        text: (
                      - kind: BinaryExpression
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lReturn
                          - kind: Whitespace
                            text: " "
                          - kind: InequalityOperator
                            text: "<>"
                          - kind: Whitespace
                            text: " "
                          - kind: NumericLiteralExpression
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                      - kind: RightParenthesis
                        text: )
                  - kind: Whitespace
                    text: " "
                  - kind: ThenKeyword
                    text: Then
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Success!  Parse out the relevant strings."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: DimStatement
                        children:
                          - kind: DimKeyword
                            text: Dim
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: LongKeyword
                            text: Long
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: ParenthesizedExpression
                            children:
                              - kind: LeftParenthesis
                                text: (
                              - kind: UnaryExpression
                                children:
                                  - kind: NotKeyword
                                    text: Not
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: MultiSelect
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Newline
                            text: "\r\n"
                          - kind: StatementList
                            children:
                              - kind: Whitespace
                                text: "        "
                              - kind: Newline
                                text: "\r\n"
                              - kind: IfStatement
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ParenthesizedExpression
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                      - kind: BinaryExpression
                                        children:
                                          - kind: MemberAccessExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                              - kind: PeriodOperator
                                                text: "."
                                              - kind: Identifier
                                                text: nFileOffset
                                          - kind: Whitespace
                                            text: " "
                                          - kind: InequalityOperator
                                            text: "<>"
                                          - kind: Whitespace
                                            text: " "
                                          - kind: NumericLiteralExpression
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                      - kind: RightParenthesis
                                        text: )
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ThenKeyword
                                    text: Then
                                  - kind: Newline
                                    text: "\r\n"
                                  - kind: StatementList
                                    children:
                                      - kind: Whitespace
                                        text: "                "
                                      - kind: AssignmentStatement
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                          - kind: Whitespace
                                            text: " "
                                          - kind: EqualityOperator
                                            text: "="
                                          - kind: Whitespace
                                            text: " "
                                          - kind: BinaryExpression
                                            children:
                                              - kind: CallExpression
                                                children:
                                                  - kind: Identifier
                                                    text: InStr
                                                  - kind: LeftParenthesis
                                                    text: (
                                                  - kind: ArgumentList
                                                    children:
                                                      - kind: Argument
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                              - kind: PeriodOperator
                                                                text: "."
                                                              - kind: Identifier
                                                                text: nFileOffset
                                                      - kind: Comma
                                                        text: ","
                                                      - kind: Whitespace
                                                        text: " "
                                                      - kind: Argument
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                              - kind: PeriodOperator
                                                                text: "."
                                                              - kind: Identifier
                                                                text: lpstrFile
                                                      - kind: Comma
                                                        text: ","
                                                      - kind: Whitespace
                                                        text: " "
                                                      - kind: Argument
                                                        children:
                                                          - kind: IdentifierExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: vbNullChar
                                                  - kind: RightParenthesis
                                                    text: )
                                              - kind: Whitespace
                                                text: " "
                                              - kind: SubtractionOperator
                                                text: "-"
                                              - kind: Whitespace
                                                text: " "
                                              - kind: NumericLiteralExpression
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                          - kind: Newline
                                            text: "\r\n"
                                      - kind: IfStatement
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                          - kind: IfKeyword
                                            text: If
                                          - kind: Whitespace
                                            text: " "
                                          - kind: ParenthesizedExpression
                                            children:
                                              - kind: LeftParenthesis
                                                text: (
                                              - kind: BinaryExpression
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: lLen
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: LessThanOperator
                                                    text: "<"
                                                  - kind: Whitespace
                                                    text: " "
                                                  - kind: NumericLiteralExpression
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                              - kind: RightParenthesis
                                                text: )
                                          - kind: Whitespace
                                            text: " "
                                          - kind: ThenKeyword
                                            text: Then
                                          - kind: Whitespace
                                            text: " "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: lLen
                                              - kind: Whitespace
                                                text: " "
                                              - kind: EqualityOperator
                                                text: "="
                                              - kind: Whitespace
                                                text: " "
                                              - kind: CallExpression
                                                children:
                                                  - kind: LenKeyword
                                                    text: Len
                                                  - kind: LeftParenthesis
                                                    text: (
                                                  - kind: ArgumentList
                                                    children:
                                                      - kind: Argument
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                              - kind: PeriodOperator
                                                                text: "."
                                                              - kind: Identifier
                                                                text: lpstrFile
                                                  - kind: RightParenthesis
                                                    text: )
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "            "
                                  - kind: ElseClause
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                      - kind: Newline
                                        text: "\r\n"
                                      - kind: StatementList
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                          - kind: AssignmentStatement
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: lLen
                                              - kind: Whitespace
                                                text: " "
                                              - kind: EqualityOperator
                                                text: "="
                                              - kind: Whitespace
                                                text: " "
                                              - kind: CallExpression
                                                children:
                                                  - kind: Identifier
                                                    text: lstrlenW
                                                  - kind: LeftParenthesis
                                                    text: (
                                                  - kind: ArgumentList
                                                    children:
                                                      - kind: Argument
                                                        children:
                                                          - kind: CallExpression
                                                            children:
                                                              - kind: Identifier
                                                                text: StrPtr
                                                              - kind: LeftParenthesis
                                                                text: (
                                                              - kind: ArgumentList
                                                                children:
                                                                  - kind: Argument
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: tmpOFN
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                          - kind: Identifier
                                                                            text: lpstrFile
                                                              - kind: RightParenthesis
                                                                text: )
                                                  - kind: RightParenthesis
                                                    text: )
                                              - kind: Newline
                                                text: "\r\n"
                                          - kind: Whitespace
                                            text: "            "
                                  - kind: EndKeyword
                                    text: End
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: Whitespace
                                text: "            "
                              - kind: Newline
                                text: "\r\n"
                              - kind: IfStatement
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: lLen
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ThenKeyword
                                    text: Then
                                  - kind: Whitespace
                                    text: " "
                                  - kind: AssignmentStatement
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: FileName
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: Left$
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: lpstrFile
                                              - kind: Comma
                                                text: ","
                                              - kind: Whitespace
                                                text: " "
                                              - kind: Argument
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: lLen
                                          - kind: RightParenthesis
                                            text: )
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: Whitespace
                                text: "        "
                          - kind: ElseClause
                            children:
                              - kind: ElseKeyword
                                text: Else
                              - kind: Newline
                                text: "\r\n"
                              - kind: StatementList
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: AssignmentStatement
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: FileName
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: MemberAccessExpression
                                        children:
                                          - kind: Identifier
                                            text: tmpOFN
                                          - kind: PeriodOperator
                                            text: "."
                                          - kind: Identifier
                                            text: lpstrFile
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Whitespace
                                    text: "        "
                          - kind: EndKeyword
                            text: End
                          - kind: Whitespace
                            text: " "
                          - kind: IfKeyword
                            text: If
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: CallExpression
                            children:
                              - kind: Identifier
                                text: lstrlenW
                              - kind: LeftParenthesis
                                text: (
                              - kind: ArgumentList
                                children:
                                  - kind: Argument
                                    children:
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: StrPtr
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: lpstrFileTitle
                                          - kind: RightParenthesis
                                            text: )
                              - kind: RightParenthesis
                                text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: Left$
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: MemberAccessExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                              - kind: PeriodOperator
                                                text: "."
                                              - kind: Identifier
                                                text: lpstrFileTitle
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Return the filter index, so the caller can store it to preferences as desired"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: FilterIndex
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: MemberAccessExpression
                            children:
                              - kind: Identifier
                                text: tmpOFN
                              - kind: PeriodOperator
                                text: "."
                              - kind: Identifier
                                text: nFilterIndex
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: GetOpenFileName
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BooleanLiteralExpression
                            children:
                              - kind: TrueKeyword
                                text: "True"
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: ElseClause
                    children:
                      - kind: ElseKeyword
                        text: Else
                      - kind: Newline
                        text: "\r\n"
                      - kind: StatementList
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: GetOpenFileName
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: BooleanLiteralExpression
                                children:
                                  - kind: FalseKeyword
                                    text: "False"
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileName
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                          - kind: Whitespace
                            text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: IfKeyword
                    text: If
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "                    "
              - kind: Newline
                text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Newline
            text: "\r\n"
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "'Display a system-specific Save File dialog."
      - kind: Newline
        text: "\r\n"
      - kind: EndOfLineComment
        text: "' RETURNS: TRUE if a valid save target was selected/created; FALSE if canceled."
      - kind: Newline
        text: "\r\n"
      - kind: FunctionStatement
        children:
          - kind: FriendKeyword
            text: Friend
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Whitespace
            text: " "
          - kind: Identifier
            text: GetSaveFileName
          - kind: ParameterList
            children:
              - kind: LeftParenthesis
                text: (
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FileName
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FileTitle
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: OverWritePrompt
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: BooleanKeyword
                text: Boolean
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: BooleanLiteralExpression
                children:
                  - kind: TrueKeyword
                    text: "True"
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Filter
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: StringLiteralExpression
                children:
                  - kind: StringLiteral
                    text: "\"All (*.*)|*.*\""
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: FilterIndex
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: NumericLiteralExpression
                children:
                  - kind: IntegerLiteral
                    text: "1"
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: InitDir
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: DlgTitle
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByRefKeyword
                text: ByRef
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: DefaultExt
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: StringKeyword
                text: String
              - kind: Comma
                text: ","
              - kind: Whitespace
                text: " "
              - kind: Underscore
                text: _
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "                           "
              - kind: OptionalKeyword
                text: Optional
              - kind: Whitespace
                text: " "
              - kind: ByValKeyword
                text: ByVal
              - kind: Whitespace
                text: " "
              - kind: Identifier
                text: Owner
              - kind: Whitespace
                text: " "
              - kind: AsKeyword
                text: As
              - kind: Whitespace
                text: " "
              - kind: LongKeyword
                text: Long
              - kind: Whitespace
                text: " "
              - kind: EqualityOperator
                text: "="
              - kind: Whitespace
                text: " "
              - kind: UnaryExpression
                children:
                  - kind: SubtractionOperator
                    text: "-"
                  - kind: NumericLiteralExpression
                    children:
                      - kind: IntegerLiteral
                        text: "1"
              - kind: RightParenthesis
                text: )
          - kind: Whitespace
            text: " "
          - kind: AsKeyword
            text: As
          - kind: Whitespace
            text: " "
          - kind: BooleanKeyword
            text: Boolean
          - kind: Newline
            text: "\r\n"
          - kind: StatementList
            children:
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: lReturn
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Comma
                    text: ","
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: lInitPathSize
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: LongKeyword
                    text: Long
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Prep a relevant OFN struct"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: DimStatement
                children:
                  - kind: DimKeyword
                    text: Dim
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: tmpOFN
                  - kind: Whitespace
                    text: " "
                  - kind: AsKeyword
                    text: As
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: OPENFILENAME
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: WithStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: WithKeyword
                    text: With
                  - kind: Whitespace
                    text: " "
                  - kind: Identifier
                    text: tmpOFN
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lStructSize
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: LenKeyword
                                    text: Len
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                  - kind: RightParenthesis
                                    text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: Flags
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: OFN_HIDEREADONLY
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: OverWritePrompt
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                          - kind: Identifier
                            text: Flags
                          - kind: Whitespace
                            text: " "
                          - kind: OrKeyword
                            text: Or
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: OFN_OVERWRITEPROMPT
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Various other obvious flags"
                      - kind: Newline
                        text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: ParenthesizedExpression
                            children:
                              - kind: LeftParenthesis
                                text: (
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Owner
                                  - kind: Whitespace
                                    text: " "
                                  - kind: InequalityOperator
                                    text: "<>"
                                  - kind: Whitespace
                                    text: " "
                                  - kind: UnaryExpression
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                      - kind: NumericLiteralExpression
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: hWndOwner
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: Owner
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: lpstrInitialDir
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: InitDir
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: lpstrDefExt
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: DefaultExt
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: lpstrTitle
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: DlgTitle
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "' pipe and colon separators, which are forcibly converted now."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: DimStatement
                        children:
                          - kind: DimKeyword
                            text: Dim
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: s
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: StringKeyword
                            text: String
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: Filter
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: CallExpression
                            children:
                              - kind: Identifier
                                text: InStr
                              - kind: LeftParenthesis
                                text: (
                              - kind: ArgumentList
                                children:
                                  - kind: Argument
                                    children:
                                      - kind: NumericLiteralExpression
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                  - kind: Comma
                                    text: ","
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Argument
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: s
                                  - kind: Comma
                                    text: ","
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Argument
                                    children:
                                      - kind: StringLiteralExpression
                                        children:
                                          - kind: StringLiteral
                                            text: "\"|\""
                                  - kind: Comma
                                    text: ","
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Argument
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: vbBinaryCompare
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: Replace
                                  - kind: DollarSign
                                    text: $
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: s
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: StringLiteralExpression
                                            children:
                                              - kind: StringLiteral
                                                text: "\"|\""
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: vbNullChar
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Newline
                                text: "\r\n"
                          - kind: IfStatement
                            children:
                              - kind: Whitespace
                                text: "        "
                              - kind: IfKeyword
                                text: If
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: InStr
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: NumericLiteralExpression
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: s
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: StringLiteralExpression
                                            children:
                                              - kind: StringLiteral
                                                text: "\":\""
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: vbBinaryCompare
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Whitespace
                                text: " "
                              - kind: ThenKeyword
                                text: Then
                              - kind: Whitespace
                                text: " "
                              - kind: AssignmentStatement
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: s
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: CallExpression
                                    children:
                                      - kind: Identifier
                                        text: Replace
                                      - kind: DollarSign
                                        text: $
                                      - kind: LeftParenthesis
                                        text: (
                                      - kind: ArgumentList
                                        children:
                                          - kind: Argument
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                          - kind: Comma
                                            text: ","
                                          - kind: Whitespace
                                            text: " "
                                          - kind: Argument
                                            children:
                                              - kind: StringLiteralExpression
                                                children:
                                                  - kind: StringLiteral
                                                    text: "\":\""
                                          - kind: Comma
                                            text: ","
                                          - kind: Whitespace
                                            text: " "
                                          - kind: Argument
                                            children:
                                              - kind: IdentifierExpression
                                                children:
                                                  - kind: Identifier
                                                    text: vbNullChar
                                      - kind: RightParenthesis
                                        text: )
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: Whitespace
                                text: "        "
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: EndOfLineComment
                            text: "'Double-nulls mark final termination"
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: BinaryExpression
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: s
                                  - kind: Whitespace
                                    text: " "
                                  - kind: Ampersand
                                    text: "&"
                                  - kind: Whitespace
                                    text: " "
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: vbNullChar
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: vbNullChar
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFilter
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nFilterIndex
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FilterIndex
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer)."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lInitPathSize
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: MAX_PATH_SAVE
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileName
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: StringKeyword
                                    text: String
                      - kind: Unknown
                        text: $
                      - kind: Unknown
                        text: (
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: lInitPathSize
                          - kind: Whitespace
                            text: " "
                          - kind: SubtractionOperator
                            text: "-"
                          - kind: Whitespace
                            text: " "
                          - kind: LenKeyword
                            text: Len
                          - kind: LeftParenthesis
                            text: (
                          - kind: Identifier
                            text: FileName
                          - kind: RightParenthesis
                            text: )
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: IntegerLiteral
                            text: "0"
                          - kind: RightParenthesis
                            text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFile
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nMaxFile
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lInitPathSize
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: s
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: Ampersand
                                text: "&"
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: StringKeyword
                                    text: String
                      - kind: Unknown
                        text: $
                      - kind: Unknown
                        text: (
                      - kind: CallStatement
                        children:
                          - kind: Identifier
                            text: MAX_FILE
                          - kind: Whitespace
                            text: " "
                          - kind: SubtractionOperator
                            text: "-"
                          - kind: Whitespace
                            text: " "
                          - kind: LenKeyword
                            text: Len
                          - kind: LeftParenthesis
                            text: (
                          - kind: Identifier
                            text: FileTitle
                          - kind: RightParenthesis
                            text: )
                          - kind: Comma
                            text: ","
                          - kind: Whitespace
                            text: " "
                          - kind: IntegerLiteral
                            text: "0"
                          - kind: RightParenthesis
                            text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: lpstrFileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: s
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: PeriodOperator
                                text: "."
                          - kind: BinaryExpression
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: nMaxFileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: MAX_FILE
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'All other fields are fine as-is"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: WithKeyword
                    text: With
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Turn control over to the common dialog function"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: AssignmentStatement
                children:
                  - kind: IdentifierExpression
                    children:
                      - kind: Identifier
                        text: lReturn
                  - kind: Whitespace
                    text: " "
                  - kind: EqualityOperator
                    text: "="
                  - kind: Whitespace
                    text: " "
                  - kind: CallExpression
                    children:
                      - kind: Identifier
                        text: GetSaveFileNameW
                      - kind: LeftParenthesis
                        text: (
                      - kind: ArgumentList
                        children:
                          - kind: Argument
                            children:
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: VarPtr
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                  - kind: RightParenthesis
                                    text: )
                      - kind: RightParenthesis
                        text: )
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer."
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 1K buffer as a limit,"
              - kind: Newline
                text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: EndOfLineComment
                text: "'  which should allow for saving to just about anywhere!)"
              - kind: Newline
                text: "\r\n"
              - kind: IfStatement
                children:
                  - kind: Whitespace
                    text: "    "
                  - kind: IfKeyword
                    text: If
                  - kind: Whitespace
                    text: " "
                  - kind: ParenthesizedExpression
                    children:
                      - kind: LeftParenthesis
                        text: (
                      - kind: BinaryExpression
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lReturn
                          - kind: Whitespace
                            text: " "
                          - kind: InequalityOperator
                            text: "<>"
                          - kind: Whitespace
                            text: " "
                          - kind: NumericLiteralExpression
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                      - kind: RightParenthesis
                        text: )
                  - kind: Whitespace
                    text: " "
                  - kind: ThenKeyword
                    text: Then
                  - kind: Newline
                    text: "\r\n"
                  - kind: StatementList
                    children:
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Success!  Parse out the relevant filename string."
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: DimStatement
                        children:
                          - kind: DimKeyword
                            text: Dim
                          - kind: Whitespace
                            text: " "
                          - kind: Identifier
                            text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: AsKeyword
                            text: As
                          - kind: Whitespace
                            text: " "
                          - kind: LongKeyword
                            text: Long
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: ParenthesizedExpression
                            children:
                              - kind: LeftParenthesis
                                text: (
                              - kind: BinaryExpression
                                children:
                                  - kind: MemberAccessExpression
                                    children:
                                      - kind: Identifier
                                        text: tmpOFN
                                      - kind: PeriodOperator
                                        text: "."
                                      - kind: Identifier
                                        text: nFileOffset
                                  - kind: Whitespace
                                    text: " "
                                  - kind: InequalityOperator
                                    text: "<>"
                                  - kind: Whitespace
                                    text: " "
                                  - kind: NumericLiteralExpression
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                              - kind: RightParenthesis
                                text: )
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Newline
                            text: "\r\n"
                          - kind: StatementList
                            children:
                              - kind: Whitespace
                                text: "            "
                              - kind: AssignmentStatement
                                children:
                                  - kind: IdentifierExpression
                                    children:
                                      - kind: Identifier
                                        text: lLen
                                  - kind: Whitespace
                                    text: " "
                                  - kind: EqualityOperator
                                    text: "="
                                  - kind: Whitespace
                                    text: " "
                                  - kind: BinaryExpression
                                    children:
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: InStr
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: nFileOffset
                                              - kind: Comma
                                                text: ","
                                              - kind: Whitespace
                                                text: " "
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: lpstrFile
                                              - kind: Comma
                                                text: ","
                                              - kind: Whitespace
                                                text: " "
                                              - kind: Argument
                                                children:
                                                  - kind: IdentifierExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: vbNullChar
                                          - kind: RightParenthesis
                                            text: )
                                      - kind: Whitespace
                                        text: " "
                                      - kind: SubtractionOperator
                                        text: "-"
                                      - kind: Whitespace
                                        text: " "
                                      - kind: NumericLiteralExpression
                                        children:
                                          - kind: LongLiteral
                                            text: 1&
                                  - kind: Newline
                                    text: "\r\n"
                              - kind: IfStatement
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: IfKeyword
                                    text: If
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ParenthesizedExpression
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                      - kind: BinaryExpression
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                          - kind: Whitespace
                                            text: " "
                                          - kind: LessThanOperator
                                            text: "<"
                                          - kind: Whitespace
                                            text: " "
                                          - kind: NumericLiteralExpression
                                            children:
                                              - kind: LongLiteral
                                                text: 1&
                                      - kind: RightParenthesis
                                        text: )
                                  - kind: Whitespace
                                    text: " "
                                  - kind: ThenKeyword
                                    text: Then
                                  - kind: Whitespace
                                    text: " "
                                  - kind: AssignmentStatement
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: lLen
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: CallExpression
                                        children:
                                          - kind: LenKeyword
                                            text: Len
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: lpstrFile
                                          - kind: RightParenthesis
                                            text: )
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Whitespace
                                    text: "        "
                          - kind: ElseClause
                            children:
                              - kind: ElseKeyword
                                text: Else
                              - kind: Newline
                                text: "\r\n"
                              - kind: StatementList
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                  - kind: AssignmentStatement
                                    children:
                                      - kind: IdentifierExpression
                                        children:
                                          - kind: Identifier
                                            text: lLen
                                      - kind: Whitespace
                                        text: " "
                                      - kind: EqualityOperator
                                        text: "="
                                      - kind: Whitespace
                                        text: " "
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: lstrlenW
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: CallExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: StrPtr
                                                      - kind: LeftParenthesis
                                                        text: (
                                                      - kind: ArgumentList
                                                        children:
                                                          - kind: Argument
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                children:
                                                                  - kind: Identifier
                                                                    text: tmpOFN
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                  - kind: Identifier
                                                                    text: lpstrFile
                                                      - kind: RightParenthesis
                                                        text: )
                                          - kind: RightParenthesis
                                            text: )
                                      - kind: Newline
                                        text: "\r\n"
                                  - kind: Whitespace
                                    text: "        "
                          - kind: EndKeyword
                            text: End
                          - kind: Whitespace
                            text: " "
                          - kind: IfKeyword
                            text: If
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileName
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: Left$
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: MemberAccessExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                              - kind: PeriodOperator
                                                text: "."
                                              - kind: Identifier
                                                text: lpstrFile
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'As a convenience, return the file title too (which is just the filename + extension, with no path data)"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: CallExpression
                            children:
                              - kind: Identifier
                                text: lstrlenW
                              - kind: LeftParenthesis
                                text: (
                              - kind: ArgumentList
                                children:
                                  - kind: Argument
                                    children:
                                      - kind: CallExpression
                                        children:
                                          - kind: Identifier
                                            text: StrPtr
                                          - kind: LeftParenthesis
                                            text: (
                                          - kind: ArgumentList
                                            children:
                                              - kind: Argument
                                                children:
                                                  - kind: MemberAccessExpression
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                      - kind: PeriodOperator
                                                        text: "."
                                                      - kind: Identifier
                                                        text: lpstrFileTitle
                                          - kind: RightParenthesis
                                            text: )
                              - kind: RightParenthesis
                                text: )
                          - kind: Newline
                            text: "\r\n"
                      - kind: IfStatement
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: IfKeyword
                            text: If
                          - kind: Whitespace
                            text: " "
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: lLen
                          - kind: Whitespace
                            text: " "
                          - kind: ThenKeyword
                            text: Then
                          - kind: Whitespace
                            text: " "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: CallExpression
                                children:
                                  - kind: Identifier
                                    text: Left$
                                  - kind: LeftParenthesis
                                    text: (
                                  - kind: ArgumentList
                                    children:
                                      - kind: Argument
                                        children:
                                          - kind: MemberAccessExpression
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                              - kind: PeriodOperator
                                                text: "."
                                              - kind: Identifier
                                                text: lpstrFileTitle
                                      - kind: Comma
                                        text: ","
                                      - kind: Whitespace
                                        text: " "
                                      - kind: Argument
                                        children:
                                          - kind: IdentifierExpression
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                  - kind: RightParenthesis
                                    text: )
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "        "
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: EndOfLineComment
                        text: "'Return the filter index, so the caller can store it to preferences as desired"
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: FilterIndex
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: MemberAccessExpression
                            children:
                              - kind: Identifier
                                text: tmpOFN
                              - kind: PeriodOperator
                                text: "."
                              - kind: Identifier
                                text: nFilterIndex
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: AssignmentStatement
                        children:
                          - kind: IdentifierExpression
                            children:
                              - kind: Identifier
                                text: GetSaveFileName
                          - kind: Whitespace
                            text: " "
                          - kind: EqualityOperator
                            text: "="
                          - kind: Whitespace
                            text: " "
                          - kind: BooleanLiteralExpression
                            children:
                              - kind: TrueKeyword
                                text: "True"
                          - kind: Newline
                            text: "\r\n"
                      - kind: Whitespace
                        text: "        "
                      - kind: Newline
                        text: "\r\n"
                      - kind: Whitespace
                        text: "    "
                  - kind: ElseClause
                    children:
                      - kind: ElseKeyword
                        text: Else
                      - kind: Newline
                        text: "\r\n"
                      - kind: StatementList
                        children:
                          - kind: Whitespace
                            text: "        "
                          - kind: AssignmentStatement
                            children:
                              - kind: IdentifierExpression
                                children:
                                  - kind: Identifier
                                    text: GetSaveFileName
                              - kind: Whitespace
                                text: " "
                              - kind: EqualityOperator
                                text: "="
                              - kind: Whitespace
                                text: " "
                              - kind: BooleanLiteralExpression
                                children:
                                  - kind: FalseKeyword
                                    text: "False"
                              - kind: Newline
                                text: "\r\n"
                          - kind: Whitespace
                            text: "    "
                  - kind: EndKeyword
                    text: End
                  - kind: Whitespace
                    text: " "
                  - kind: IfKeyword
                    text: If
                  - kind: Newline
                    text: "\r\n"
              - kind: Whitespace
                text: "    "
              - kind: Newline
                text: "\r\n"
          - kind: EndKeyword
            text: End
          - kind: Whitespace
            text: " "
          - kind: FunctionKeyword
            text: Function
          - kind: Newline
            text: "\r\n"
