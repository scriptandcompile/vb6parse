---
source: tests/form.rs
expression: form_file
---
form:
  name: frmFire
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          System:
            index: 5
        border_style: Sizable
        caption: Even Faster Real-Time Fire Effect - www.tannerhelland.com
        client_height: 4380
        client_left: 60
        client_top: 345
        client_width: 7965
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: HasContext
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 292
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 531
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: hsBlue
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 840
                max: 300
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 16
                tab_stop: Included
                top: 1800
                value: 50
                visible: Visible
                whats_this_help_id: 0
                width: 6975
        - name: hsGreen
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 840
                max: 300
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 15
                tab_stop: Included
                top: 1440
                value: 100
                visible: Visible
                whats_this_help_id: 0
                width: 6975
        - name: hsRed
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 840
                max: 300
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 14
                tab_stop: Included
                top: 1080
                value: 200
                visible: Visible
                whats_this_help_id: 0
                width: 6975
        - name: scrUniformity
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 3840
                max: 3
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 10
                tab_stop: Included
                top: 120
                value: 2
                visible: Visible
                whats_this_help_id: 0
                width: 1695
        - name: txtHeight
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 285
                help_context_id: 0
                hide_selection: true
                left: 2160
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 4
                tab_stop: Included
                text: "128"
                tool_tip_text: ""
                top: 120
                visible: Visible
                whats_this_help_id: 0
                width: 495
        - name: txtWidth
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 285
                help_context_id: 0
                hide_selection: true
                left: 720
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 3
                tab_stop: Included
                text: "512"
                tool_tip_text: ""
                top: 120
                visible: Visible
                whats_this_help_id: 0
                width: 495
        - name: cmdStop
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: Stop Fire
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 375
                help_context_id: 0
                left: 6240
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 2
                tab_stop: Included
                tool_tip_text: ""
                top: 600
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 1575
        - name: cmdStart
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: Start Fire
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 375
                help_context_id: 0
                left: 4440
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 1
                tab_stop: Included
                tool_tip_text: ""
                top: 600
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 1575
        - name: picDest
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  RGB:
                    red: 0
                    green: 0
                    blue: 0
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 1950
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 128
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 512
                tab_index: 0
                tab_stop: Included
                tool_tip_text: "Here's your flame!"
                top: 2280
                visible: Visible
                whats_this_help_id: 0
                width: 7710
              controls: []
        - name: Label6
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Blue:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 225
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 13
                tool_tip_text: ""
                top: 1800
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 420
                word_wrap: NonWrapping
        - name: Label4
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Green:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 225
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 12
                tool_tip_text: ""
                top: 1440
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 555
                word_wrap: NonWrapping
        - name: Label2
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Red:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 225
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 11
                tool_tip_text: ""
                top: 1080
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 390
                word_wrap: NonWrapping
        - name: Label7
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Note: changes will not take place until the fire is restarted."
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  RGB:
                    red: 255
                    green: 0
                    blue: 0
                height: 255
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 9
                tool_tip_text: ""
                top: 720
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 4215
                word_wrap: NonWrapping
        - name: lblFrameRate
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: Frame Rate...
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 255
                left: 5760
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 8
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1335
                word_wrap: NonWrapping
        - name: Label1
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Width:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 7
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 615
                word_wrap: NonWrapping
        - name: Label3
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Height:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 1440
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 6
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 615
                word_wrap: NonWrapping
        - name: Label5
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Uniformity:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 225
                left: 2880
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 5
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 870
                word_wrap: NonWrapping
      menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmFire
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\n'API:\r\n'BitBlt for blitting the fire from the buffer to the screen\r\nPrivate Declare Function BitBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long) As Long\r\n\r\n'Pixel routines; faster then PSet and Point but not as fast as GetDIBits, StretchDIBits\r\nPrivate Declare Function SetPixelV Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long) As Byte\r\nPrivate Declare Function GetPixel Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long) As Long\r\n\r\n'High performance timer functions\r\nPrivate Declare Function QueryPerformanceFrequency Lib \"kernel32\" (ByRef lpFrequency As Currency) As Long\r\nPrivate Declare Function QueryPerformanceCounter Lib \"kernel32\" (ByRef lpPerformanceCount As Currency) As Long\r\n\r\n'Values for tracking function times\r\nPrivate curFreq As Currency, curStart As Currency, curEnd As Currency\r\n\r\n'Whether or not to run the flames\r\nPrivate Engage As Boolean\r\n\r\n'How many frames have elapsed since the program began\r\nPrivate frameCount As Long\r\n\r\n'Pressing the START button initializes the screen and calls the DrawFastFlames() routine\r\nPrivate Sub cmdStart_Click()\r\n    \r\n    'First, clear the picture boxes\r\n    picDest.Picture = LoadPicture(vbNullString)\r\n    picDest.Refresh\r\n    \r\n    'Collect the width and height values of the flame effect\r\n    Dim tempX As Long, tempY As Long\r\n    tempX = Val(txtWidth)\r\n    tempY = Val(txtHeight)\r\n    \r\n    'Resize the picture boxes to match (and add two pixels for the borders of the picture box (1 pixel each))\r\n    picDest.Width = tempX + 2\r\n    picDest.Height = tempY + 2\r\n    \r\n    'Determine the resolution of this system's high performance timer\r\n    QueryPerformanceFrequency curFreq\r\n    \r\n    'Set the \"engage\" parameter to true and call the fire function\r\n    frameCount = 0\r\n    Engage = True\r\n    DrawFastFlames picDest, tempX, tempY, CSng(hsRed) / 100!, CSng(hsGreen) / 100!, CSng(hsBlue) / 100!, scrUniformity.Value\r\n\r\nEnd Sub\r\n\r\n'When STOP is pressed, disengage the fire routine\r\nPrivate Sub cmdStop_Click()\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This routine draws a cool fire effect using the specified parameters\r\nPrivate Sub DrawFastFlames(dstPic As PictureBox, ByVal flameWidth As Long, ByVal flameHeight As Long, ByVal redModifier As Single, ByVal greenModifier As Single, ByVal blueModifier As Single, Optional ByVal Uniformity As Byte = 2)\r\n    \r\n    'This array holds all the individual flame pixels\r\n    Dim FlameArray() As Long\r\n    ReDim FlameArray(0 To flameWidth, 0 To flameHeight) As Long\r\n    \r\n    'How much of the flames to reheat after each drawing (typically the bottom 10% of the array)\r\n    Dim FillVal As Long\r\n    FillVal = flameHeight * 0.9\r\n    \r\n    'This will temporarily hold the value of each flame pixel\r\n    Dim curPixel As Long\r\n    \r\n    'As much as I hate an arbitrary name like \"temp\", that's what we'll use this for\r\n    Dim tmpValue As Long\r\n    \r\n    'Loop variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'This is used to generate an RGB() value for the flame's color\r\n    Static Color As Long\r\n    \r\n    'Look-up tables for each color (faster than generating them on the fly)\r\n    Dim Red(0 To 255) As Byte\r\n    Dim Green(0 To 255) As Byte\r\n    Dim Blue(0 To 255) As Byte\r\n    For x = 0 To 255\r\n        Red(x) = ByteMe(x * redModifier)\r\n        Green(x) = ByteMe(x * greenModifier)\r\n        Blue(x) = ByteMe(x * blueModifier)\r\n    Next x\r\n\r\n    'Used to calculate FPS\r\n    Dim curTime As Single\r\n\r\n    'NEW! DIB Section code\r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Depending on VB quirks, the DIB array may or may not be the same size\r\n    ' as the scalewidth/scaleheight properties\r\n    Dim iWidth As Long, iHeight As Long\r\n    Dim tmpX As Long, tmpY As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(picDest)\r\n    iHeight = fDraw.GetImageHeight(picDest)\r\n    fDraw.GetImageData2D picDest, imageData()\r\n\r\n    'Uniformity is a somewhat arbitrary measurement; basically, I use it to control how\r\n    ' random the flames vertical growth is.  The initial number passed into this function\r\n    ' should lie between 0 and 3\r\n    Uniformity = 5 - Uniformity\r\n    \r\n    'Before starting, randomize the seed for VB's built-in Randomize function\r\n    Randomize Timer\r\n\r\n    'If engaged, draw the flames!\r\n    Do While Engage\r\n        \r\n        'Remember the current time (for calculating FPS at the end of the loop)\r\n        QueryPerformanceCounter curStart\r\n        \r\n        'Run a loop through the flames from the bottom up...\r\n        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'API:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'BitBlt for blitting the fire from the buffer to the screen"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function BitBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: BitBlt
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDestDC As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDestDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hSrcDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: xSrc
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ySrc
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dwRop
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Pixel routines; faster then PSet and Point but not as fast as GetDIBits, StretchDIBits"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function SetPixelV Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long) As Byte\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: SetPixelV
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: crColor
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function GetPixel Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetPixel
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal x As Long, ByVal y As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'High performance timer functions"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function QueryPerformanceFrequency Lib \"kernel32\" (ByRef lpFrequency As Currency) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: QueryPerformanceFrequency
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"kernel32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByRef lpFrequency As Currency)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpFrequency
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: CurrencyKeyword
                text: Currency
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function QueryPerformanceCounter Lib \"kernel32\" (ByRef lpPerformanceCount As Currency) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: QueryPerformanceCounter
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"kernel32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByRef lpPerformanceCount As Currency)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpPerformanceCount
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: CurrencyKeyword
                text: Currency
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Values for tracking function times"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private curFreq As Currency, curStart As Currency, curEnd As Currency\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: curFreq
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: CurrencyKeyword
            text: Currency
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: curStart
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: CurrencyKeyword
            text: Currency
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: curEnd
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: CurrencyKeyword
            text: Currency
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Whether or not to run the flames"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private Engage As Boolean\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: Engage
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'How many frames have elapsed since the program began"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private frameCount As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: frameCount
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Pressing the START button initializes the screen and calls the DrawFastFlames() routine"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmdStart_Click()\r\n    \r\n    'First, clear the picture boxes\r\n    picDest.Picture = LoadPicture(vbNullString)\r\n    picDest.Refresh\r\n    \r\n    'Collect the width and height values of the flame effect\r\n    Dim tempX As Long, tempY As Long\r\n    tempX = Val(txtWidth)\r\n    tempY = Val(txtHeight)\r\n    \r\n    'Resize the picture boxes to match (and add two pixels for the borders of the picture box (1 pixel each))\r\n    picDest.Width = tempX + 2\r\n    picDest.Height = tempY + 2\r\n    \r\n    'Determine the resolution of this system's high performance timer\r\n    QueryPerformanceFrequency curFreq\r\n    \r\n    'Set the \"engage\" parameter to true and call the fire function\r\n    frameCount = 0\r\n    Engage = True\r\n    DrawFastFlames picDest, tempX, tempY, CSng(hsRed) / 100!, CSng(hsGreen) / 100!, CSng(hsBlue) / 100!, scrUniformity.Value\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmdStart_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'First, clear the picture boxes\r\n    picDest.Picture = LoadPicture(vbNullString)\r\n    picDest.Refresh\r\n    \r\n    'Collect the width and height values of the flame effect\r\n    Dim tempX As Long, tempY As Long\r\n    tempX = Val(txtWidth)\r\n    tempY = Val(txtHeight)\r\n    \r\n    'Resize the picture boxes to match (and add two pixels for the borders of the picture box (1 pixel each))\r\n    picDest.Width = tempX + 2\r\n    picDest.Height = tempY + 2\r\n    \r\n    'Determine the resolution of this system's high performance timer\r\n    QueryPerformanceFrequency curFreq\r\n    \r\n    'Set the \"engage\" parameter to true and call the fire function\r\n    frameCount = 0\r\n    Engage = True\r\n    DrawFastFlames picDest, tempX, tempY, CSng(hsRed) / 100!, CSng(hsGreen) / 100!, CSng(hsBlue) / 100!, scrUniformity.Value\r\n\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'First, clear the picture boxes"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picDest.Picture = LoadPicture(vbNullString)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picDest.Picture
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picDest
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Picture
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: LoadPicture(vbNullString)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: LoadPicture
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: vbNullString
                        is_token: false
                        children:
                          - kind: Argument
                            text: vbNullString
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: vbNullString
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "picDest.Refresh\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: picDest
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Refresh
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Collect the width and height values of the flame effect"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tempX As Long, tempY As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tempX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tempY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "tempX = Val(txtWidth)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: tempX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: tempX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(txtWidth)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: txtWidth
                        is_token: false
                        children:
                          - kind: Argument
                            text: txtWidth
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: txtWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: txtWidth
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "tempY = Val(txtHeight)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: tempY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: tempY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(txtHeight)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: txtHeight
                        is_token: false
                        children:
                          - kind: Argument
                            text: txtHeight
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: txtHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: txtHeight
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Resize the picture boxes to match (and add two pixels for the borders of the picture box (1 pixel each))"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picDest.Width = tempX + 2\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picDest.Width
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picDest
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: WidthKeyword
                        text: Width
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: tempX + 2
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: tempX
                        is_token: false
                        children:
                          - kind: Identifier
                            text: tempX
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "2"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picDest.Height = tempY + 2\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picDest.Height
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picDest
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Height
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: tempY + 2
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: tempY
                        is_token: false
                        children:
                          - kind: Identifier
                            text: tempY
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "2"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Determine the resolution of this system's high performance timer"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "QueryPerformanceFrequency curFreq\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: QueryPerformanceFrequency
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: curFreq
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set the \"engage\" parameter to true and call the fire function"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "frameCount = 0\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: frameCount
                    is_token: false
                    children:
                      - kind: Identifier
                        text: frameCount
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Engage = True\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Engage
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Engage
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BooleanLiteralExpression
                    text: "True"
                    is_token: false
                    children:
                      - kind: TrueKeyword
                        text: "True"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawFastFlames picDest, tempX, tempY, CSng(hsRed) / 100!, CSng(hsGreen) / 100!, CSng(hsBlue) / 100!, scrUniformity.Value\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawFastFlames
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: picDest
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tempX
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tempY
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: CSng
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hsRed
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DivisionOperator
                    text: /
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SingleLiteral
                    text: 100!
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: CSng
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hsGreen
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DivisionOperator
                    text: /
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SingleLiteral
                    text: 100!
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: CSng
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hsBlue
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DivisionOperator
                    text: /
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SingleLiteral
                    text: 100!
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: scrUniformity
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Value
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When STOP is pressed, disengage the fire routine"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmdStop_Click()\r\n    Engage = False\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmdStop_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    Engage = False\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Engage = False\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Engage
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Engage
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BooleanLiteralExpression
                    text: "False"
                    is_token: false
                    children:
                      - kind: FalseKeyword
                        text: "False"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This routine draws a cool fire effect using the specified parameters"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub DrawFastFlames(dstPic As PictureBox, ByVal flameWidth As Long, ByVal flameHeight As Long, ByVal redModifier As Single, ByVal greenModifier As Single, ByVal blueModifier As Single, Optional ByVal Uniformity As Byte = 2)\r\n    \r\n    'This array holds all the individual flame pixels\r\n    Dim FlameArray() As Long\r\n    ReDim FlameArray(0 To flameWidth, 0 To flameHeight) As Long\r\n    \r\n    'How much of the flames to reheat after each drawing (typically the bottom 10% of the array)\r\n    Dim FillVal As Long\r\n    FillVal = flameHeight * 0.9\r\n    \r\n    'This will temporarily hold the value of each flame pixel\r\n    Dim curPixel As Long\r\n    \r\n    'As much as I hate an arbitrary name like \"temp\", that's what we'll use this for\r\n    Dim tmpValue As Long\r\n    \r\n    'Loop variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'This is used to generate an RGB() value for the flame's color\r\n    Static Color As Long\r\n    \r\n    'Look-up tables for each color (faster than generating them on the fly)\r\n    Dim Red(0 To 255) As Byte\r\n    Dim Green(0 To 255) As Byte\r\n    Dim Blue(0 To 255) As Byte\r\n    For x = 0 To 255\r\n        Red(x) = ByteMe(x * redModifier)\r\n        Green(x) = ByteMe(x * greenModifier)\r\n        Blue(x) = ByteMe(x * blueModifier)\r\n    Next x\r\n\r\n    'Used to calculate FPS\r\n    Dim curTime As Single\r\n\r\n    'NEW! DIB Section code\r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Depending on VB quirks, the DIB array may or may not be the same size\r\n    ' as the scalewidth/scaleheight properties\r\n    Dim iWidth As Long, iHeight As Long\r\n    Dim tmpX As Long, tmpY As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(picDest)\r\n    iHeight = fDraw.GetImageHeight(picDest)\r\n    fDraw.GetImageData2D picDest, imageData()\r\n\r\n    'Uniformity is a somewhat arbitrary measurement; basically, I use it to control how\r\n    ' random the flames vertical growth is.  The initial number passed into this function\r\n    ' should lie between 0 and 3\r\n    Uniformity = 5 - Uniformity\r\n    \r\n    'Before starting, randomize the seed for VB's built-in Randomize function\r\n    Randomize Timer\r\n\r\n    'If engaged, draw the flames!\r\n    Do While Engage\r\n        \r\n        'Remember the current time (for calculating FPS at the end of the loop)\r\n        QueryPerformanceCounter curStart\r\n        \r\n        'Run a loop through the flames from the bottom up...\r\n        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawFastFlames
            is_token: true
            children: []
          - kind: ParameterList
            text: "(dstPic As PictureBox, ByVal flameWidth As Long, ByVal flameHeight As Long, ByVal redModifier As Single, ByVal greenModifier As Single, ByVal blueModifier As Single, Optional ByVal Uniformity As Byte = 2)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: Identifier
                text: dstPic
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: flameWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: flameHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: redModifier
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: greenModifier
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: blueModifier
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Uniformity
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByteKeyword
                text: Byte
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: NumericLiteralExpression
                text: "2"
                is_token: false
                children:
                  - kind: IntegerLiteral
                    text: "2"
                    is_token: true
                    children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'This array holds all the individual flame pixels\r\n    Dim FlameArray() As Long\r\n    ReDim FlameArray(0 To flameWidth, 0 To flameHeight) As Long\r\n    \r\n    'How much of the flames to reheat after each drawing (typically the bottom 10% of the array)\r\n    Dim FillVal As Long\r\n    FillVal = flameHeight * 0.9\r\n    \r\n    'This will temporarily hold the value of each flame pixel\r\n    Dim curPixel As Long\r\n    \r\n    'As much as I hate an arbitrary name like \"temp\", that's what we'll use this for\r\n    Dim tmpValue As Long\r\n    \r\n    'Loop variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'This is used to generate an RGB() value for the flame's color\r\n    Static Color As Long\r\n    \r\n    'Look-up tables for each color (faster than generating them on the fly)\r\n    Dim Red(0 To 255) As Byte\r\n    Dim Green(0 To 255) As Byte\r\n    Dim Blue(0 To 255) As Byte\r\n    For x = 0 To 255\r\n        Red(x) = ByteMe(x * redModifier)\r\n        Green(x) = ByteMe(x * greenModifier)\r\n        Blue(x) = ByteMe(x * blueModifier)\r\n    Next x\r\n\r\n    'Used to calculate FPS\r\n    Dim curTime As Single\r\n\r\n    'NEW! DIB Section code\r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Depending on VB quirks, the DIB array may or may not be the same size\r\n    ' as the scalewidth/scaleheight properties\r\n    Dim iWidth As Long, iHeight As Long\r\n    Dim tmpX As Long, tmpY As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(picDest)\r\n    iHeight = fDraw.GetImageHeight(picDest)\r\n    fDraw.GetImageData2D picDest, imageData()\r\n\r\n    'Uniformity is a somewhat arbitrary measurement; basically, I use it to control how\r\n    ' random the flames vertical growth is.  The initial number passed into this function\r\n    ' should lie between 0 and 3\r\n    Uniformity = 5 - Uniformity\r\n    \r\n    'Before starting, randomize the seed for VB's built-in Randomize function\r\n    Randomize Timer\r\n\r\n    'If engaged, draw the flames!\r\n    Do While Engage\r\n        \r\n        'Remember the current time (for calculating FPS at the end of the loop)\r\n        QueryPerformanceCounter curStart\r\n        \r\n        'Run a loop through the flames from the bottom up...\r\n        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This array holds all the individual flame pixels"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim FlameArray() As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FlameArray
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: ReDimStatement
                text: "    ReDim FlameArray(0 To flameWidth, 0 To flameHeight) As Long\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ReDimKeyword
                    text: ReDim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FlameArray
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: flameWidth
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: flameHeight
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'How much of the flames to reheat after each drawing (typically the bottom 10% of the array)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim FillVal As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FillVal
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "FillVal = flameHeight * 0.9\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: FillVal
                    is_token: false
                    children:
                      - kind: Identifier
                        text: FillVal
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: flameHeight * 0.9
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: flameHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: flameHeight
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: MultiplicationOperator
                        text: "*"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "0.9"
                        is_token: false
                        children:
                          - kind: SingleLiteral
                            text: "0.9"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This will temporarily hold the value of each flame pixel"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim curPixel As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: curPixel
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'As much as I hate an arbitrary name like \"temp\", that's what we'll use this for"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tmpValue As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpValue
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Loop variables"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim x As Long, y As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: y
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This is used to generate an RGB() value for the flame's color"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Static Color As Long\r\n"
                is_token: false
                children:
                  - kind: StaticKeyword
                    text: Static
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Color
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Look-up tables for each color (faster than generating them on the fly)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim Red(0 To 255) As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Red
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim Green(0 To 255) As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Green
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim Blue(0 To 255) As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Blue
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: ForStatement
                text: "    For x = 0 To 255\r\n        Red(x) = ByteMe(x * redModifier)\r\n        Green(x) = ByteMe(x * greenModifier)\r\n        Blue(x) = ByteMe(x * blueModifier)\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        Red(x) = ByteMe(x * redModifier)\r\n        Green(x) = ByteMe(x * greenModifier)\r\n        Blue(x) = ByteMe(x * blueModifier)\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Red(x) = ByteMe(x * redModifier)\r\n"
                        is_token: false
                        children:
                          - kind: CallExpression
                            text: Red(x)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Red
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: ByteMe(x * redModifier)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: ByteMe
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x * redModifier
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x * redModifier
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: x * redModifier
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: redModifier
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: redModifier
                                                is_token: true
                                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Green(x) = ByteMe(x * greenModifier)\r\n"
                        is_token: false
                        children:
                          - kind: CallExpression
                            text: Green(x)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Green
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: ByteMe(x * greenModifier)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: ByteMe
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x * greenModifier
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x * greenModifier
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: x * greenModifier
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: greenModifier
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: greenModifier
                                                is_token: true
                                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Blue(x) = ByteMe(x * blueModifier)\r\n"
                        is_token: false
                        children:
                          - kind: CallExpression
                            text: Blue(x)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Blue
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: ByteMe(x * blueModifier)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: ByteMe
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x * blueModifier
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x * blueModifier
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: x * blueModifier
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: blueModifier
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: blueModifier
                                                is_token: true
                                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Used to calculate FPS"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim curTime As Single\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: curTime
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SingleKeyword
                    text: Single
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'NEW! DIB Section code"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This array will hold the image's pixel data"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim imageData() As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Depending on VB quirks, the DIB array may or may not be the same size"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' as the scalewidth/scaleheight properties"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim iWidth As Long, iHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iWidth
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tmpX As Long, tmpY As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim fDraw As New FastDrawing\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NewKeyword
                    text: New
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FastDrawing
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iWidth = fDraw.GetImageWidth(picDest)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageWidth(picDest)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageWidth
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: picDest
                        is_token: false
                        children:
                          - kind: Argument
                            text: picDest
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: picDest
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picDest
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iHeight = fDraw.GetImageHeight(picDest)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageHeight(picDest)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageHeight
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: picDest
                        is_token: false
                        children:
                          - kind: Argument
                            text: picDest
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: picDest
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picDest
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "fDraw.GetImageData2D picDest, imageData()\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GetImageData2D
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: picDest
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Uniformity is a somewhat arbitrary measurement; basically, I use it to control how"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' random the flames vertical growth is.  The initial number passed into this function"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' should lie between 0 and 3"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Uniformity = 5 - Uniformity\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Uniformity
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Uniformity
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: 5 - Uniformity
                    is_token: false
                    children:
                      - kind: NumericLiteralExpression
                        text: "5"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "5"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IdentifierExpression
                        text: Uniformity
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Uniformity
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Before starting, randomize the seed for VB's built-in Randomize function"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: RandomizeStatement
                text: "    Randomize Timer\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: RandomizeKeyword
                    text: Randomize
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Timer
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If engaged, draw the flames!"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: DoStatement
                text: "    Do While Engage\r\n        \r\n        'Remember the current time (for calculating FPS at the end of the loop)\r\n        QueryPerformanceCounter curStart\r\n        \r\n        'Run a loop through the flames from the bottom up...\r\n        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: DoKeyword
                    text: Do
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: WhileKeyword
                    text: While
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: Engage
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Engage
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        \r\n        'Remember the current time (for calculating FPS at the end of the loop)\r\n        QueryPerformanceCounter curStart\r\n        \r\n        'Run a loop through the flames from the bottom up...\r\n        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Remember the current time (for calculating FPS at the end of the loop)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "QueryPerformanceCounter curStart\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: QueryPerformanceCounter
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: curStart
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Run a loop through the flames from the bottom up..."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "        For y = 2 To flameHeight\r\n        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "2"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "2"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: flameHeight
                            is_token: false
                            children:
                              - kind: Identifier
                                text: flameHeight
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "        \r\n        '...and from right-to-left\r\n        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'...and from right-to-left"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "        For x = 0 To flameWidth\r\n        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: x
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: flameWidth
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: flameWidth
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        \r\n            'Grab the current flame pixel\r\n            curPixel = FlameArray(x, y)\r\n            \r\n            'If this pixel is dim enough, ignore it for sake of uniformity\r\n            If curPixel < Uniformity Then GoTo 1\r\n            \r\n            'Give this pixel a random degree of cooldown\r\n            tmpValue = Int(Rnd * Uniformity)\r\n            FlameArray(x, y) = curPixel - tmpValue\r\n            \r\n            'In addition, move this pixel upward\r\n            tmpY = y - tmpValue\r\n            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n            'Generate a color based on the \"heat\" value\r\n            Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n            \r\n            'To improve speed, randomize the x movement of every 5th pixel\r\n            ' (as opposed to doing it for every pixel)\r\n            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n            \r\n            'Draw this flame pixel using a cool flame-colored formula (based upon\r\n            ' the values passed into this function)\r\n            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Grab the current flame pixel"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "curPixel = FlameArray(x, y)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: curPixel
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: curPixel
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: "FlameArray(x, y)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: FlameArray
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "x, y"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'If this pixel is dim enough, ignore it for sake of uniformity"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "            If curPixel < Uniformity Then GoTo 1\r\n            \r\n"
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: curPixel < Uniformity
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: curPixel
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: curPixel
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOperator
                                                text: "<"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: Uniformity
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: Uniformity
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: GotoStatement
                                            text: "GoTo 1\r\n"
                                            is_token: false
                                            children:
                                              - kind: GotoKeyword
                                                text: GoTo
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Give this pixel a random degree of cooldown"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "tmpValue = Int(Rnd * Uniformity)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpValue
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpValue
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: Int(Rnd * Uniformity)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Int
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: Rnd * Uniformity
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: Rnd * Uniformity
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: Rnd * Uniformity
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: Rnd
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Rnd
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: Uniformity
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Uniformity
                                                                is_token: true
                                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "FlameArray(x, y) = curPixel - tmpValue\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: "FlameArray(x, y)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: FlameArray
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "x, y"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: curPixel - tmpValue
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: curPixel
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: curPixel
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: tmpValue
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: tmpValue
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'In addition, move this pixel upward"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "tmpY = y - tmpValue\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpY
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpY
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: y - tmpValue
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: tmpValue
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: tmpValue
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: IfStatement
                                        text: "            If tmpY < 0 Then tmpY = 0\r\n            FlameArray(x, tmpY) = FlameArray(x, y)\r\n            \r\n"
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: tmpY < 0
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: tmpY
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: tmpY
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOperator
                                                text: "<"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "tmpY = 0\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: tmpY
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: tmpY
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "FlameArray(x, tmpY) = FlameArray(x, y)\r\n"
                                            is_token: false
                                            children:
                                              - kind: CallExpression
                                                text: "FlameArray(x, tmpY)"
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: FlameArray
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: "x, tmpY"
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: x
                                                                is_token: true
                                                                children: []
                                                      - kind: Comma
                                                        text: ","
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Argument
                                                        text: tmpY
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: tmpY
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpY
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: "FlameArray(x, y)"
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: FlameArray
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: "x, y"
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: x
                                                                is_token: true
                                                                children: []
                                                      - kind: Comma
                                                        text: ","
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Argument
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: y
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Generate a color based on the \"heat\" value"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "Color = (FlameArray(x, y) * 255) \\ flameHeight\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Color
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Color
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: "(FlameArray(x, y) * 255) \\ flameHeight"
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: "(FlameArray(x, y) * 255)"
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: "FlameArray(x, y) * 255"
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: "FlameArray(x, y)"
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: FlameArray
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: "x, y"
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Argument
                                                                text: y
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: y
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "255"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "255"
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BackwardSlashOperator
                                                text: "\\"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: flameHeight
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: flameHeight
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'To improve speed, randomize the x movement of every 5th pixel"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "' (as opposed to doing it for every pixel)"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "            If ((x + y) And 3) = 0 Then\r\n                tmpX = (x + Int(Rnd * 2)) * 3\r\n            Else\r\n                tmpX = x * 3\r\n            End If\r\n"
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: ((x + y) And 3) = 0
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: ((x + y) And 3)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: (x + y) And 3
                                                    is_token: false
                                                    children:
                                                      - kind: ParenthesizedExpression
                                                        text: (x + y)
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: x + y
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: y
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: y
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AndKeyword
                                                        text: And
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "3"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "3"
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "                tmpX = (x + Int(Rnd * 2)) * 3\r\n            "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "                "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "tmpX = (x + Int(Rnd * 2)) * 3\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: tmpX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpX
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: (x + Int(Rnd * 2)) * 3
                                                    is_token: false
                                                    children:
                                                      - kind: ParenthesizedExpression
                                                        text: (x + Int(Rnd * 2))
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: x + Int(Rnd * 2)
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallExpression
                                                                text: Int(Rnd * 2)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Int
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: Rnd * 2
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: Rnd * 2
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: Rnd * 2
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: Rnd
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: Rnd
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "2"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "2"
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "3"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "3"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "            "
                                                is_token: true
                                                children: []
                                          - kind: ElseClause
                                            text: "Else\r\n                tmpX = x * 3\r\n            "
                                            is_token: false
                                            children:
                                              - kind: ElseKeyword
                                                text: Else
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: CodeBlock
                                                text: "                tmpX = x * 3\r\n            "
                                                is_token: false
                                                children:
                                                  - kind: Whitespace
                                                    text: "                "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "tmpX = x * 3\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: tmpX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: tmpX
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: x * 3
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: x
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "3"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "3"
                                                                is_token: true
                                                                children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "            "
                                                    is_token: true
                                                    children: []
                                          - kind: EndKeyword
                                            text: End
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Draw this flame pixel using a cool flame-colored formula (based upon"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "' the values passed into this function)"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "            If tmpX <= (iWidth * 3) - 3 Then\r\n                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: tmpX <= (iWidth * 3) - 3
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: tmpX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: tmpX
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOrEqualOperator
                                                text: "<="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: (iWidth * 3) - 3
                                                is_token: false
                                                children:
                                                  - kind: ParenthesizedExpression
                                                    text: (iWidth * 3)
                                                    is_token: false
                                                    children:
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: iWidth * 3
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: iWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: iWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "3"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "3"
                                                                is_token: true
                                                                children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SubtractionOperator
                                                    text: "-"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "3"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "3"
                                                        is_token: true
                                                        children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "                tmpY = flameHeight - y\r\n                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "                "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "tmpY = flameHeight - y\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: tmpY
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpY
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: flameHeight - y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: flameHeight
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: flameHeight
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: IfStatement
                                                text: "                If tmpY < 0 Then tmpY = 0\r\n                imageData(tmpX, tmpY) = Blue(Color)\r\n                imageData(tmpX + 1, tmpY) = Green(Color)\r\n                imageData(tmpX + 2, tmpY) = Red(Color)\r\n            End If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                                is_token: false
                                                children:
                                                  - kind: Whitespace
                                                    text: "                "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: tmpY < 0
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: tmpY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: tmpY
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: LessThanOperator
                                                        text: "<"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "0"
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "tmpY = 0\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: tmpY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: tmpY
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "0"
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "                "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "imageData(tmpX, tmpY) = Blue(Color)\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: "imageData(tmpX, tmpY)"
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: imageData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: "tmpX, tmpY"
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: tmpX
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: tmpX
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: tmpX
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Argument
                                                                text: tmpY
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: tmpY
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: tmpY
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallExpression
                                                        text: Blue(Color)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: Blue
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: Color
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: Color
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: Color
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: Color
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "                "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: imageData
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: tmpX
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "1,"
                                                    is_token: false
                                                    children:
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                      - kind: IdentifierExpression
                                                        text: ","
                                                        is_token: false
                                                        children:
                                                          - kind: Comma
                                                            text: ","
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "tmpY) = Green(Color)\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: tmpY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: tmpY
                                                            is_token: true
                                                            children: []
                                                      - kind: BinaryExpression
                                                        text: ) = Green(Color)
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: )
                                                            is_token: false
                                                            children:
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: Green(Color)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Green
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: Color
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: Color
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: Color
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: Color
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "                "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: imageData
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: tmpX
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "2,"
                                                    is_token: false
                                                    children:
                                                      - kind: NumericLiteralExpression
                                                        text: "2"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "2"
                                                            is_token: true
                                                            children: []
                                                      - kind: IdentifierExpression
                                                        text: ","
                                                        is_token: false
                                                        children:
                                                          - kind: Comma
                                                            text: ","
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "tmpY) = Red(Color)\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: tmpY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: tmpY
                                                            is_token: true
                                                            children: []
                                                      - kind: BinaryExpression
                                                        text: ) = Red(Color)
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: )
                                                            is_token: false
                                                            children:
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: Red(Color)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Red
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: Color
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: Color
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: Color
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: Color
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "            "
                                                    is_token: true
                                                    children: []
                                                  - kind: EndKeyword
                                                    text: End
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: " If\r\n            \r\n1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: "\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: CodeBlock
                                                        text: "1       Next x\r\n        Next y\r\n\r\n        'Once all flames are processed, make the bottom 4 rows hot again\r\n        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n        \r\n        'Copy the whole flame image from the buffer to the viewable picture box\r\n        fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n        \r\n        'Calculate an exact framerate and display it\r\n        QueryPerformanceCounter curEnd\r\n        lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n    \r\n        'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)\r\n        frameCount = frameCount + 1\r\n        If (frameCount And 31) Then DoEvents\r\n    \r\n    'Do it all over again!\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n'When the form is closed, make sure the flame function is disengaged\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Engage = False\r\nEnd Sub\r\n\r\n'This simple little function ensure that the variable it receives falls within the\r\n' proper byte range (0-255)\r\nPrivate Function ByteMe(ByVal toByte As Long) As Byte\r\n    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\nEnd Function\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Unknown
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "       "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Next
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallStatement
                                                            text: "x\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: x
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Next
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallStatement
                                                            text: "y\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'Once all flames are processed, make the bottom 4 rows hot again"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: ForStatement
                                                            text: "        For y = FillVal To flameHeight\r\n        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        Next y\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "        "
                                                                is_token: true
                                                                children: []
                                                              - kind: ForKeyword
                                                                text: For
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: y
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: y
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: FillVal
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: FillVal
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ToKeyword
                                                                text: To
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: flameHeight
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: flameHeight
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: CodeBlock
                                                                text: "        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n        "
                                                                is_token: false
                                                                children:
                                                                  - kind: ForStatement
                                                                    text: "        For x = 0 To flameWidth\r\n            FlameArray(x, y) = flameHeight\r\n        Next x\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ForKeyword
                                                                        text: For
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "0"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "0"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ToKeyword
                                                                        text: To
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: flameWidth
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: flameWidth
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CodeBlock
                                                                        text: "            FlameArray(x, y) = flameHeight\r\n        "
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Whitespace
                                                                            text: "            "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "FlameArray(x, y) = flameHeight\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: "FlameArray(x, y)"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: FlameArray
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: "x, y"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Comma
                                                                                        text: ","
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Argument
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: y
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: flameHeight
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: flameHeight
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "        "
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: NextKeyword
                                                                        text: Next
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                              - kind: NextKeyword
                                                                text: Next
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'Copy the whole flame image from the buffer to the viewable picture box"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallStatement
                                                            text: "fDraw.SetImageData2D dstPic, iWidth, iHeight, imageData()\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: fDraw
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: SetImageData2D
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: dstPic
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: iWidth
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: iHeight
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'Calculate an exact framerate and display it"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallStatement
                                                            text: "QueryPerformanceCounter curEnd\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: QueryPerformanceCounter
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: curEnd
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "lblFrameRate.Caption = Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\"\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: lblFrameRate.Caption
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: lblFrameRate
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Caption
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: "Int(1 / ((curEnd - curStart) / curFreq)) & \" FPS\""
                                                                is_token: false
                                                                children:
                                                                  - kind: CallExpression
                                                                    text: Int(1 / ((curEnd - curStart) / curFreq))
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: Int
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: 1 / ((curEnd - curStart) / curFreq)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: 1 / ((curEnd - curStart) / curFreq)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: BinaryExpression
                                                                                text: 1 / ((curEnd - curStart) / curFreq)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "1"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: DivisionOperator
                                                                                    text: /
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ParenthesizedExpression
                                                                                    text: ((curEnd - curStart) / curFreq)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: (curEnd - curStart) / curFreq
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ParenthesizedExpression
                                                                                            text: (curEnd - curStart)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: curEnd - curStart
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: curEnd
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: curEnd
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: curStart
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: curStart
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: DivisionOperator
                                                                                            text: /
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: curFreq
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: curFreq
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Ampersand
                                                                    text: "&"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: StringLiteralExpression
                                                                    text: "\" FPS\""
                                                                    is_token: false
                                                                    children:
                                                                      - kind: StringLiteral
                                                                        text: "\" FPS\""
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'Every 32 frames, halt for external events (keypresses, mouse movement, etc.)"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "frameCount = frameCount + 1\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: frameCount
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: frameCount
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: frameCount + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: frameCount
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: frameCount
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: IfStatement
                                                            text: "        If (frameCount And 31) Then DoEvents\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "        "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: (frameCount And 31)
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: frameCount And 31
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: frameCount
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: frameCount
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AndKeyword
                                                                        text: And
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "31"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "31"
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ThenKeyword
                                                                text: Then
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: DoEvents
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'Do it all over again!"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Loop
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: End
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Sub
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'When the form is closed, make sure the flame function is disengaged"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: DimStatement
                                                            text: "Private Sub Form_Unload(Cancel As Integer)\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: PrivateKeyword
                                                                text: Private
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubKeyword
                                                                text: Sub
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Form_Unload
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Cancel
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AsKeyword
                                                                text: As
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IntegerKeyword
                                                                text: Integer
                                                                is_token: true
                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "Engage = False\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: Engage
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Engage
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BooleanLiteralExpression
                                                                text: "False"
                                                                is_token: false
                                                                children:
                                                                  - kind: FalseKeyword
                                                                    text: "False"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Unknown
                                                            text: End
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Sub
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'This simple little function ensure that the variable it receives falls within the"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "' proper byte range (0-255)"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: DimStatement
                                                            text: "Private Function ByteMe(ByVal toByte As Long) As Byte\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: PrivateKeyword
                                                                text: Private
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: FunctionKeyword
                                                                text: Function
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: ByteMe
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ByValKeyword
                                                                text: ByVal
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: toByte
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AsKeyword
                                                                text: As
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: LongKeyword
                                                                text: Long
                                                                is_token: true
                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AsKeyword
                                                                text: As
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ByteKeyword
                                                                text: Byte
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: IfStatement
                                                            text: "    If (toByte > 255) Then\r\n        ByteMe = 255\r\n    ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    Else\r\n        ByteMe = toByte\r\n    End If\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: (toByte > 255)
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: toByte > 255
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: toByte
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: toByte
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: GreaterThanOperator
                                                                        text: ">"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "255"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "255"
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ThenKeyword
                                                                text: Then
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: CodeBlock
                                                                text: "        ByteMe = 255\r\n    "
                                                                is_token: false
                                                                children:
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "ByteMe = 255\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: ByteMe
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: ByteMe
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "255"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "255"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                              - kind: ElseIfClause
                                                                text: "ElseIf (toByte < 0) Then\r\n        ByteMe = 0\r\n    "
                                                                is_token: false
                                                                children:
                                                                  - kind: ElseIfKeyword
                                                                    text: ElseIf
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ParenthesizedExpression
                                                                    text: (toByte < 0)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: toByte < 0
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: toByte
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: toByte
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LessThanOperator
                                                                            text: "<"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "0"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ThenKeyword
                                                                    text: Then
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "        ByteMe = 0\r\n    "
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "ByteMe = 0\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: ByteMe
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: ByteMe
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "0"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                              - kind: ElseClause
                                                                text: "Else\r\n        ByteMe = toByte\r\n    "
                                                                is_token: false
                                                                children:
                                                                  - kind: ElseKeyword
                                                                    text: Else
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "        ByteMe = toByte\r\n    "
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "ByteMe = toByte\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: ByteMe
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: ByteMe
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: toByte
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: toByte
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                              - kind: EndKeyword
                                                                text: End
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Unknown
                                                            text: End
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Unknown
                                                            text: Function
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
