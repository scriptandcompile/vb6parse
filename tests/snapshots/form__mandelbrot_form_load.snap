---
source: tests/form.rs
expression: form_file
---
form:
  name: frmFractal
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          System:
            index: 5
        border_style: Sizable
        caption: Mandelbrot Fractal Demo - www.tannerhelland.com
        client_height: 10575
        client_left: 60
        client_top: 345
        client_width: 9255
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: "Yes"
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 705
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 617
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: CmdReset
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: Reset
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 615
                help_context_id: 0
                left: 8280
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 14
                tab_stop: Included
                tool_tip_text: ""
                top: 480
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 855
        - name: scrAccuracy
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 1200
                max: 20
                min: 1
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 10
                tab_stop: Included
                top: 90
                value: 1
                visible: Visible
                whats_this_help_id: 0
                width: 6255
        - name: CmdRedraw
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: Draw the Fractal
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 615
                help_context_id: 0
                left: 6120
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 5
                tab_stop: Included
                tool_tip_text: ""
                top: 480
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 2055
        - name: TxtYMax
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                hide_selection: true
                left: 4560
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 4
                tab_stop: Included
                text: "1.5"
                tool_tip_text: ""
                top: 720
                visible: Visible
                whats_this_help_id: 0
                width: 1365
        - name: TxtYMin
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                hide_selection: true
                left: 3120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 3
                tab_stop: Included
                text: "-1.5"
                tool_tip_text: ""
                top: 720
                visible: Visible
                whats_this_help_id: 0
                width: 1365
        - name: TxtXMax
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                hide_selection: true
                left: 1560
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 2
                tab_stop: Included
                text: ".75"
                tool_tip_text: ""
                top: 720
                visible: Visible
                whats_this_help_id: 0
                width: 1365
        - name: TxtXMin
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                hide_selection: true
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 1
                tab_stop: Included
                text: "-1.75"
                tool_tip_text: ""
                top: 720
                visible: Visible
                whats_this_help_id: 0
                width: 1365
        - name: PicDraw
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: "Yes"
                height: 9015
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 599
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 599
                tab_index: 0
                tab_stop: Included
                tool_tip_text: ""
                top: 1440
                visible: Visible
                whats_this_help_id: 0
                width: 9015
        - name: Label7
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Use the mouse to click-drag new bound values. (Press the \"\"draw\"\" button above after selecting a new frame of reference.)"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 255
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 13
                tool_tip_text: ""
                top: 1200
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 9015
                word_wrap: NonWrapping
        - name: Label6
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: Accurate shading
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 210
                left: 7560
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 12
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1290
                word_wrap: NonWrapping
        - name: Label5
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: Fast shading
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 255
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 11
                tool_tip_text: ""
                top: 120
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1095
                word_wrap: NonWrapping
        - name: Label4
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Y Max:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 4560
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 9
                tool_tip_text: ""
                top: 480
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 735
                word_wrap: NonWrapping
        - name: Label3
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Y Min:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 3120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 8
                tool_tip_text: ""
                top: 480
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 735
                word_wrap: NonWrapping
        - name: Label2
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "X Max:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 1560
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 7
                tool_tip_text: ""
                top: 480
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 735
                word_wrap: NonWrapping
        - name: Label1
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "X Min:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 255
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 6
                tool_tip_text: ""
                top: 480
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 735
                word_wrap: NonWrapping
      menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmFractal
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\n'These dimensions relate to using the mouse to select new bounding areas\r\nDim iX As Double, iY As Double\r\nDim tX As Double, tY As Double\r\nDim iWidth As Double, iHeight As Double\r\nDim toDraw As Boolean\r\n\r\n'This array stores the values of the fractal as they're calculated\r\nDim mFractal() As Double\r\n\r\n'This number (set by the corresponding scrollbar) takes on values between 100 and 2000\r\n'Higher numbers = more accurate/slow; lower mumbers = less accurate/fast\r\nDim IterationLimit As Long\r\n\r\n'Simple API declaration for drawing pixels\r\nPrivate Declare Function SetPixelV Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long) As Byte\r\n\r\n\r\n'DRAW THE FRACTAL\r\nPrivate Sub CmdRedraw_Click()\r\n\r\n    'Lots of variables are required for fractal-drawing\r\n    Dim drawWidth As Long, drawHeight As Long\r\n    Dim count As Double\r\n    Dim red As Long, green As Long, blue As Long\r\n    Dim minX As Double, maxX As Double, minY As Double, maxY As Double\r\n    Dim calcX As Double, calcY As Double, stepX As Double, stepY As Double\r\n    Dim color As Long\r\n    Dim loValue As Double, hiValue As Double\r\n    loValue = 2000000000#\r\n    hiValue = -2000000000#\r\n    \r\n    'Reset the mouse values after each draw (since no box is present after drawing)\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    \r\n    'Prepare the picture box using hard-coded size values.  (Feel free to change these.)\r\n    drawWidth = 600\r\n    drawHeight = 600\r\n    PicDraw.Width = drawWidth + 2\r\n    PicDraw.Height = drawHeight + 2\r\n    PicDraw.Refresh\r\n    DoEvents\r\n    \r\n    'Set minimum and maximum view windows based on corresponding text box values\r\n    minX = Val(TxtXMin)\r\n    maxX = Val(TxtXMax)\r\n    minY = Val(TxtYMin)\r\n    maxY = Val(TxtYMax)\r\n    \r\n    'Create a conversion between the Mandlebrot set window and the actual pixels where the fractal will appear\r\n    stepX = Abs(maxX - minX) / drawWidth\r\n    stepY = Abs(maxY - minY) / drawHeight\r\n    \r\n    'Resize the fractal array\r\n    ReDim mFractal(0 To drawWidth, 0 To drawHeight) As Double\r\n    \r\n    'Run a loop through each pixel, calculating Mandelbrot values as we go\r\n    calcX = minX\r\n    calcY = minY\r\n    \r\n    Dim x As Long, y As Long\r\n    Dim rootCount As Double\r\n    \r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'These dimensions relate to using the mouse to select new bounding areas"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim iX As Double, iY As Double\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iX
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iY
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Dim tX As Double, tY As Double\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: tX
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: tY
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Dim iWidth As Double, iHeight As Double\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iWidth
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iHeight
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Dim toDraw As Boolean\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: toDraw
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This array stores the values of the fractal as they're calculated"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim mFractal() As Double\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: mFractal
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DoubleKeyword
            text: Double
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This number (set by the corresponding scrollbar) takes on values between 100 and 2000"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Higher numbers = more accurate/slow; lower mumbers = less accurate/fast"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim IterationLimit As Long\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: IterationLimit
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Simple API declaration for drawing pixels"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function SetPixelV Lib \"gdi32\" (ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long) As Byte\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: SetPixelV
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: crColor
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'DRAW THE FRACTAL"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub CmdRedraw_Click()\r\n\r\n    'Lots of variables are required for fractal-drawing\r\n    Dim drawWidth As Long, drawHeight As Long\r\n    Dim count As Double\r\n    Dim red As Long, green As Long, blue As Long\r\n    Dim minX As Double, maxX As Double, minY As Double, maxY As Double\r\n    Dim calcX As Double, calcY As Double, stepX As Double, stepY As Double\r\n    Dim color As Long\r\n    Dim loValue As Double, hiValue As Double\r\n    loValue = 2000000000#\r\n    hiValue = -2000000000#\r\n    \r\n    'Reset the mouse values after each draw (since no box is present after drawing)\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    \r\n    'Prepare the picture box using hard-coded size values.  (Feel free to change these.)\r\n    drawWidth = 600\r\n    drawHeight = 600\r\n    PicDraw.Width = drawWidth + 2\r\n    PicDraw.Height = drawHeight + 2\r\n    PicDraw.Refresh\r\n    DoEvents\r\n    \r\n    'Set minimum and maximum view windows based on corresponding text box values\r\n    minX = Val(TxtXMin)\r\n    maxX = Val(TxtXMax)\r\n    minY = Val(TxtYMin)\r\n    maxY = Val(TxtYMax)\r\n    \r\n    'Create a conversion between the Mandlebrot set window and the actual pixels where the fractal will appear\r\n    stepX = Abs(maxX - minX) / drawWidth\r\n    stepY = Abs(maxY - minY) / drawHeight\r\n    \r\n    'Resize the fractal array\r\n    ReDim mFractal(0 To drawWidth, 0 To drawHeight) As Double\r\n    \r\n    'Run a loop through each pixel, calculating Mandelbrot values as we go\r\n    calcX = minX\r\n    calcY = minY\r\n    \r\n    Dim x As Long, y As Long\r\n    Dim rootCount As Double\r\n    \r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: CmdRedraw_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "\r\n    'Lots of variables are required for fractal-drawing\r\n    Dim drawWidth As Long, drawHeight As Long\r\n    Dim count As Double\r\n    Dim red As Long, green As Long, blue As Long\r\n    Dim minX As Double, maxX As Double, minY As Double, maxY As Double\r\n    Dim calcX As Double, calcY As Double, stepX As Double, stepY As Double\r\n    Dim color As Long\r\n    Dim loValue As Double, hiValue As Double\r\n    loValue = 2000000000#\r\n    hiValue = -2000000000#\r\n    \r\n    'Reset the mouse values after each draw (since no box is present after drawing)\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    \r\n    'Prepare the picture box using hard-coded size values.  (Feel free to change these.)\r\n    drawWidth = 600\r\n    drawHeight = 600\r\n    PicDraw.Width = drawWidth + 2\r\n    PicDraw.Height = drawHeight + 2\r\n    PicDraw.Refresh\r\n    DoEvents\r\n    \r\n    'Set minimum and maximum view windows based on corresponding text box values\r\n    minX = Val(TxtXMin)\r\n    maxX = Val(TxtXMax)\r\n    minY = Val(TxtYMin)\r\n    maxY = Val(TxtYMax)\r\n    \r\n    'Create a conversion between the Mandlebrot set window and the actual pixels where the fractal will appear\r\n    stepX = Abs(maxX - minX) / drawWidth\r\n    stepY = Abs(maxY - minY) / drawHeight\r\n    \r\n    'Resize the fractal array\r\n    ReDim mFractal(0 To drawWidth, 0 To drawHeight) As Double\r\n    \r\n    'Run a loop through each pixel, calculating Mandelbrot values as we go\r\n    calcX = minX\r\n    calcY = minY\r\n    \r\n    Dim x As Long, y As Long\r\n    Dim rootCount As Double\r\n    \r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Lots of variables are required for fractal-drawing"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim drawWidth As Long, drawHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: drawWidth
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: drawHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim count As Double\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: count
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim red As Long, green As Long, blue As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: red
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: green
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: blue
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim minX As Double, maxX As Double, minY As Double, maxY As Double\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: minX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: maxX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: minY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: maxY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim calcX As Double, calcY As Double, stepX As Double, stepY As Double\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: calcX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: calcY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: stepX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: stepY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim color As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: color
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim loValue As Double, hiValue As Double\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: loValue
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hiValue
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "loValue = 2000000000#\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: loValue
                    is_token: false
                    children:
                      - kind: Identifier
                        text: loValue
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "2000000000#"
                    is_token: false
                    children:
                      - kind: DoubleLiteral
                        text: "2000000000#"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "hiValue = -2000000000#\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: hiValue
                    is_token: false
                    children:
                      - kind: Identifier
                        text: hiValue
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-2000000000#"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2000000000#"
                        is_token: false
                        children:
                          - kind: DoubleLiteral
                            text: "2000000000#"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Reset the mouse values after each draw (since no box is present after drawing)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iX = -1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iY = -1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "tX = -1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: tX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: tX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "tY = -1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: tY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: tY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Prepare the picture box using hard-coded size values.  (Feel free to change these.)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "drawWidth = 600\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: drawWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: drawWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "600"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "600"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "drawHeight = 600\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: drawHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: drawHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "600"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "600"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "PicDraw.Width = drawWidth + 2\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: PicDraw.Width
                    is_token: false
                    children:
                      - kind: Identifier
                        text: PicDraw
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: WidthKeyword
                        text: Width
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: drawWidth + 2
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: drawWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: drawWidth
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "2"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "PicDraw.Height = drawHeight + 2\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: PicDraw.Height
                    is_token: false
                    children:
                      - kind: Identifier
                        text: PicDraw
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Height
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: drawHeight + 2
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: drawHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: drawHeight
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "2"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "PicDraw.Refresh\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: PicDraw
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Refresh
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DoEvents\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DoEvents
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set minimum and maximum view windows based on corresponding text box values"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "minX = Val(TxtXMin)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: minX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: minX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(TxtXMin)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: TxtXMin
                        is_token: false
                        children:
                          - kind: Argument
                            text: TxtXMin
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: TxtXMin
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: TxtXMin
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "maxX = Val(TxtXMax)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: maxX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: maxX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(TxtXMax)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: TxtXMax
                        is_token: false
                        children:
                          - kind: Argument
                            text: TxtXMax
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: TxtXMax
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: TxtXMax
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "minY = Val(TxtYMin)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: minY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: minY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(TxtYMin)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: TxtYMin
                        is_token: false
                        children:
                          - kind: Argument
                            text: TxtYMin
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: TxtYMin
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: TxtYMin
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "maxY = Val(TxtYMax)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: maxY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: maxY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Val(TxtYMax)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Val
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: TxtYMax
                        is_token: false
                        children:
                          - kind: Argument
                            text: TxtYMax
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: TxtYMax
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: TxtYMax
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Create a conversion between the Mandlebrot set window and the actual pixels where the fractal will appear"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "stepX = Abs(maxX - minX) / drawWidth\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: stepX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: stepX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: Abs(maxX - minX) / drawWidth
                    is_token: false
                    children:
                      - kind: CallExpression
                        text: Abs(maxX - minX)
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Abs
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: ArgumentList
                            text: maxX - minX
                            is_token: false
                            children:
                              - kind: Argument
                                text: maxX - minX
                                is_token: false
                                children:
                                  - kind: BinaryExpression
                                    text: maxX - minX
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: maxX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: maxX
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: minX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: minX
                                            is_token: true
                                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: DivisionOperator
                        text: /
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IdentifierExpression
                        text: drawWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: drawWidth
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "stepY = Abs(maxY - minY) / drawHeight\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: stepY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: stepY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: Abs(maxY - minY) / drawHeight
                    is_token: false
                    children:
                      - kind: CallExpression
                        text: Abs(maxY - minY)
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Abs
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: ArgumentList
                            text: maxY - minY
                            is_token: false
                            children:
                              - kind: Argument
                                text: maxY - minY
                                is_token: false
                                children:
                                  - kind: BinaryExpression
                                    text: maxY - minY
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: maxY
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: maxY
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: minY
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: minY
                                            is_token: true
                                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: DivisionOperator
                        text: /
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IdentifierExpression
                        text: drawHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: drawHeight
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Resize the fractal array"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ReDimStatement
                text: "ReDim mFractal(0 To drawWidth, 0 To drawHeight) As Double\r\n"
                is_token: false
                children:
                  - kind: ReDimKeyword
                    text: ReDim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: mFractal
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: drawWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: drawWidth
                        is_token: true
                        children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: drawHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: drawHeight
                        is_token: true
                        children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Run a loop through each pixel, calculating Mandelbrot values as we go"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "calcX = minX\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: calcX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: calcX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: minX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: minX
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "calcY = minY\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: calcY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: calcY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: minY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: minY
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim x As Long, y As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: y
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim rootCount As Double\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: rootCount
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: DoubleKeyword
                    text: Double
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: y
                    is_token: false
                    children:
                      - kind: Identifier
                        text: y
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: drawHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: drawHeight
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "    For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "For x = 0 To drawWidth\r\n    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                        is_token: false
                        children:
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: x
                            is_token: false
                            children:
                              - kind: Identifier
                                text: x
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: drawWidth
                            is_token: false
                            children:
                              - kind: Identifier
                                text: drawWidth
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "    \r\n        'This main recursive function is what actually calculates the fractal values\r\n        count = Calculate(calcX, calcY, 0, 0, 0)\r\n        rootCount = Sqr(count)\r\n        \r\n        'Keep track of the highest and lowest values encountered so far (to help with rendering)\r\n        If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'This main recursive function is what actually calculates the fractal values"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "count = Calculate(calcX, calcY, 0, 0, 0)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: count
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: count
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "Calculate(calcX, calcY, 0, 0, 0)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Calculate
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "calcX, calcY, 0, 0, 0"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: calcX
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: calcX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: calcX
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: calcY
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: calcY
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: calcY
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "rootCount = Sqr(count)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: rootCount
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: rootCount
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: Sqr(count)
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Sqr
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: count
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: count
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: count
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: count
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Keep track of the highest and lowest values encountered so far (to help with rendering)"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "If rootCount < loValue Then\r\n            loValue = rootCount\r\n        Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                is_token: false
                                children:
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: rootCount < loValue
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: rootCount
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: rootCount
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: LessThanOperator
                                        text: "<"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: loValue
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: loValue
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "            loValue = rootCount\r\n        "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "loValue = rootCount\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: loValue
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: loValue
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: rootCount
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: rootCount
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                  - kind: ElseClause
                                    text: "Else\r\n            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                    is_token: false
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: CodeBlock
                                        text: "            If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfStatement
                                            text: "If rootCount > hiValue Then hiValue = rootCount\r\n        End If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                            is_token: false
                                            children:
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: rootCount > hiValue
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: rootCount
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rootCount
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: GreaterThanOperator
                                                    text: ">"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: hiValue
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: hiValue
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "hiValue = rootCount\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: hiValue
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: hiValue
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: rootCount
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rootCount
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: EndKeyword
                                                text: End
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If\r\n        \r\n        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: "\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        'Store the fractal value in the array\r\n        mFractal(x, y) = rootCount\r\n        \r\n        calcX = calcX + stepX\r\n        \r\n    Next x\r\n        calcX = minX\r\n        calcY = calcY + stepY\r\n        'Give the user some indication of how close we are to finishing\r\n        CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n    Next y\r\n    \r\n    'Once the fractal values have been saved, calculate the difference between the lowest and highest values\r\n    Dim lohiDif As Double\r\n    lohiDif = hiValue - loValue\r\n    If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n    'Draw the fractal\r\n    For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'Store the fractal value in the array"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "mFractal(x, y) = rootCount\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: "mFractal(x, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: mFractal
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "x, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: rootCount
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: rootCount
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "calcX = calcX + stepX\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: calcX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: calcX
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: calcX + stepX
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: calcX
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: calcX
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: stepX
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: stepX
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: Next
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallStatement
                                                        text: "x\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "calcX = minX\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: calcX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: calcX
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: minX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: minX
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "calcY = calcY + stepY\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: calcY
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: calcY
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: calcY + stepY
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: calcY
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: calcY
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: stepY
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: stepY
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'Give the user some indication of how close we are to finishing"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "CmdRedraw.Caption = Int((y / drawHeight) * 100) & \"% Complete\"\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: CmdRedraw.Caption
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: CmdRedraw
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Caption
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: "Int((y / drawHeight) * 100) & \"% Complete\""
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: Int((y / drawHeight) * 100)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Int
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: (y / drawHeight) * 100
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: (y / drawHeight) * 100
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: (y / drawHeight) * 100
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ParenthesizedExpression
                                                                                text: (y / drawHeight)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: y / drawHeight
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: y
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: DivisionOperator
                                                                                        text: /
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: drawHeight
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: drawHeight
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "100"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "100"
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Ampersand
                                                                text: "&"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: StringLiteralExpression
                                                                text: "\"% Complete\""
                                                                is_token: false
                                                                children:
                                                                  - kind: StringLiteral
                                                                    text: "\"% Complete\""
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: Next
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallStatement
                                                        text: "y\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'Once the fractal values have been saved, calculate the difference between the lowest and highest values"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: DimStatement
                                                        text: "Dim lohiDif As Double\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: DimKeyword
                                                            text: Dim
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: lohiDif
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AsKeyword
                                                            text: As
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: DoubleKeyword
                                                            text: Double
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "lohiDif = hiValue - loValue\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: lohiDif
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: lohiDif
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: hiValue - loValue
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: hiValue
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: hiValue
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: loValue
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: loValue
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: "If lohiDif = 0# Then lohiDif = 0.0000000001\r\n    \r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: "lohiDif = 0#"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: lohiDif
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: lohiDif
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "0#"
                                                                is_token: false
                                                                children:
                                                                  - kind: DoubleLiteral
                                                                    text: "0#"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "lohiDif = 0.0000000001\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: lohiDif
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: lohiDif
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "0.0000000001"
                                                                is_token: false
                                                                children:
                                                                  - kind: SingleLiteral
                                                                    text: "0.0000000001"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'Draw the fractal"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: ForStatement
                                                        text: "For y = 0 To drawHeight\r\n    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: ForKeyword
                                                            text: For
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: y
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "0"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ToKeyword
                                                            text: To
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: drawHeight
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: drawHeight
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: CodeBlock
                                                            text: "    For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: ForStatement
                                                                text: "For x = 0 To drawWidth\r\n    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: ForKeyword
                                                                    text: For
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ToKeyword
                                                                    text: To
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: drawWidth
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: drawWidth
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "    \r\n        'Convert the fractal value to a 0-255 RGB value\r\n        count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n        \r\n        'Make the highest values pure white (looks better, IMO)\r\n        If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'Convert the fractal value to a 0-255 RGB value"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "count = Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: count
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: count
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "Int(((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Int
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: "((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: BinaryExpression
                                                                                        text: "((mFractal(x, y) - loValue) / lohiDif) * 255# + 0.5"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: "((mFractal(x, y) - loValue) / lohiDif) * 255#"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: ParenthesizedExpression
                                                                                                text: "((mFractal(x, y) - loValue) / lohiDif)"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: "(mFractal(x, y) - loValue) / lohiDif"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: "(mFractal(x, y) - loValue)"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: "mFractal(x, y) - loValue"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: CallExpression
                                                                                                                text: "mFractal(x, y)"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: mFractal
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: LeftParenthesis
                                                                                                                    text: (
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: ArgumentList
                                                                                                                    text: "x, y"
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Argument
                                                                                                                        text: x
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: x
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: x
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: Comma
                                                                                                                        text: ","
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Argument
                                                                                                                        text: y
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: y
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: y
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                  - kind: RightParenthesis
                                                                                                                    text: )
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: loValue
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: loValue
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: DivisionOperator
                                                                                                        text: /
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: lohiDif
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: lohiDif
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: MultiplicationOperator
                                                                                                text: "*"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "255#"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: DoubleLiteral
                                                                                                    text: "255#"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AdditionOperator
                                                                                            text: +
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "0.5"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: SingleLiteral
                                                                                                text: "0.5"
                                                                                                is_token: true
                                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'Make the highest values pure white (looks better, IMO)"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If mFractal(x, y) = hiValue Then\r\n            red = 255\r\n            green = 255\r\n            blue = 255\r\n        Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: "mFractal(x, y) = hiValue"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: "mFractal(x, y)"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: mFractal
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: "x, y"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Comma
                                                                                        text: ","
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Argument
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: y
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: hiValue
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: hiValue
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "            red = 255\r\n            green = 255\r\n            blue = 255\r\n        "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "red = 255\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: red
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: red
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "255"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "255"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "green = 255\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: green
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: green
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "255"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "255"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "blue = 255\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: blue
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: blue
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "255"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "255"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: ElseClause
                                                                            text: "Else\r\n            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ElseKeyword
                                                                                text: Else
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "            'I use this simple color formula to make the fractal shades of violet instead of just gray\r\n            red = count\r\n            green = count \\ 2\r\n            blue = count * 2\r\n            If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "'I use this simple color formula to make the fractal shades of violet instead of just gray"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "red = count\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: red
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: red
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: count
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: count
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "green = count \\ 2\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: green
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: green
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: "count \\ 2"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: count
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: count
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BackwardSlashOperator
                                                                                            text: "\\"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "2"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "2"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "blue = count * 2\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: blue
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: blue
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: count * 2
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: count
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: count
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: MultiplicationOperator
                                                                                            text: "*"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "2"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "2"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If blue > 255 Then blue = 255\r\n        End If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: blue > 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: blue
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: blue
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: GreaterThanOperator
                                                                                            text: ">"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "blue = 255\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: blue
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: blue
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfStatement
                                                                                        text: "If\r\n        \r\n        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IfKeyword
                                                                                            text: If
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: "\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "        'Draw this pixel\r\n        SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n        \r\n    Next x\r\n        'Refresh the image every 16 lines\r\n        If y And 15 = 0 Then PicDraw.Refresh\r\n    Next y\r\n    \r\n    'Final image refresh\r\n    PicDraw.Refresh\r\n\r\n    'Restore the command button text\r\n    CmdRedraw.Caption = \"Redraw the Fractal\"\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CmdReset_Click()\r\n    toDraw = False\r\n    TxtXMin.Text = \"-1.75\"\r\n    TxtXMax.Text = \".75\"\r\n    TxtYMin.Text = \"-1.5\"\r\n    TxtYMax.Text = \"1.5\"\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\n    CmdRedraw_Click\r\nEnd Sub\r\n\r\n'ON STARTUP: set various variables to proper default values\r\nPrivate Sub Form_Load()\r\n    toDraw = False\r\n    IterationLimit = 400\r\n    iX = -1\r\n    iY = -1\r\n    tX = -1\r\n    tY = -1\r\nEnd Sub\r\n\r\n'MOUSE DOWN: on the main picture box\r\nPrivate Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Erase any previous boxes the user may have drawn\r\n    PicDraw.DrawMode = 6\r\n    PicDraw.Line (tX, tY)-(tX, iY)\r\n    PicDraw.Line (tX, tY)-(iX, tY)\r\n    PicDraw.Line (iX, iY)-(tX, iY)\r\n    PicDraw.Line (iX, iY)-(iX, tY)\r\n    PicDraw.DrawMode = 13\r\n    \r\n    'Note the current location and mark a mouse button as being \"down\"\r\n    iX = x\r\n    iY = y\r\n    tX = x\r\n    tY = y\r\n    toDraw = True\r\n    \r\nEnd Sub\r\n\r\n'MOUSE MOVE: on the main picture box\r\nPrivate Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'If a mouse button has been pressed, draw a rectangle around the current selection area\r\n    If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'MOUSE UP: on the main picture box\r\nPrivate Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    \r\n    'Mark the mouse button as being released\r\n    toDraw = False\r\n    \r\n    'Figure out the width and height of the selected area\r\n    iWidth = x - iX\r\n    iHeight = y - iY\r\n    \r\n    'Use some fancy math to calculate the approximate reference frame that the user has selected.\r\n    '(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)\r\n    Dim nX As Double, nY As Double\r\n    Dim oX As Double, oY As Double\r\n    Dim oSX As Double, oEX As Double\r\n    Dim oSY As Double, oEY As Double\r\n    \r\n    nX = x\r\n    nY = y\r\n    \r\n    oSX = TxtXMin\r\n    oEX = TxtXMax\r\n    oSY = TxtYMin\r\n    oEY = TxtYMax\r\n    \r\n    oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    oX = oSX + oX\r\n    \r\n    oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    oY = oSY + oY\r\n    \r\n    nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n    nX = oSX + nX\r\n    \r\n    nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n    nY = oSY + nY\r\n    \r\n    'Change the text boxes to match our new frame of reference\r\n    TxtXMin = oX\r\n    TxtXMax = nX\r\n    TxtYMin = oY\r\n    TxtYMax = nY\r\n    \r\nEnd Sub\r\n\r\n'SCROLLBAR: for changing the accuracy / speed of the fractal render\r\nPrivate Sub scrAccuracy_Change()\r\n    IterationLimit = scrAccuracy.Value * 100\r\nEnd Sub\r\n\r\n'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier.\r\nPrivate Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n    \r\n    Static NewX As Double, NewY As Double\r\n    \r\n    'Check for overflow (well, technically \"underflow\" :)\r\n    If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n    \r\n    'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)\r\n    'On Error GoTo 1\r\n    \r\n    NewX = (curX * curX) - (curY * curY) + origX\r\n    NewY = (2 * curX * curY) + origY\r\n    \r\n    If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Draw this pixel"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "SetPixelV PicDraw.hDC, x, y, RGB(red, green, blue)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: SetPixelV
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: hDC
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: RGB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: red
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: green
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: blue
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Next
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "x\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Refresh the image every 16 lines"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If y And 15 = 0 Then PicDraw.Refresh\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: y And 15 = 0
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AndKeyword
                                                                                                        text: And
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: 15 = 0
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "15"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "15"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "0"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "0"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Refresh
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Next
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "y\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Final image refresh"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "PicDraw.Refresh\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Refresh
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Restore the command button text"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "CmdRedraw.Caption = \"Redraw the Fractal\"\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: CmdRedraw.Caption
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: CmdRedraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Identifier
                                                                                                        text: Caption
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: StringLiteralExpression
                                                                                                    text: "\"Redraw the Fractal\""
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: StringLiteral
                                                                                                        text: "\"Redraw the Fractal\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub CmdReset_Click()\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: CmdReset_Click
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "toDraw = False\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: toDraw
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: toDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BooleanLiteralExpression
                                                                                                    text: "False"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: FalseKeyword
                                                                                                        text: "False"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtXMin.Text = \"-1.75\"\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: TxtXMin.Text
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: TextKeyword
                                                                                                        text: Text
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: StringLiteralExpression
                                                                                                    text: "\"-1.75\""
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: StringLiteral
                                                                                                        text: "\"-1.75\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtXMax.Text = \".75\"\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: TxtXMax.Text
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: TextKeyword
                                                                                                        text: Text
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: StringLiteralExpression
                                                                                                    text: "\".75\""
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: StringLiteral
                                                                                                        text: "\".75\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtYMin.Text = \"-1.5\"\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: TxtYMin.Text
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: TextKeyword
                                                                                                        text: Text
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: StringLiteralExpression
                                                                                                    text: "\"-1.5\""
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: StringLiteral
                                                                                                        text: "\"-1.5\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtYMax.Text = \"1.5\"\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: TxtYMax.Text
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: TextKeyword
                                                                                                        text: Text
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: StringLiteralExpression
                                                                                                    text: "\"1.5\""
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: StringLiteral
                                                                                                        text: "\"1.5\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "IterationLimit = 400\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: IterationLimit
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: IterationLimit
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "400"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "400"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iX = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iY = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tX = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tY = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "CmdRedraw_Click\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: CmdRedraw_Click
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'ON STARTUP: set various variables to proper default values"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub Form_Load()\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Form_Load
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "toDraw = False\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: toDraw
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: toDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BooleanLiteralExpression
                                                                                                    text: "False"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: FalseKeyword
                                                                                                        text: "False"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "IterationLimit = 400\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: IterationLimit
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: IterationLimit
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "400"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "400"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iX = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iY = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tX = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tY = -1\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: UnaryExpression
                                                                                                    text: "-1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "1"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "1"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'MOUSE DOWN: on the main picture box"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub PicDraw_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw_MouseDown
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Button
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Shift
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Erase any previous boxes the user may have drawn"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "PicDraw.DrawMode = 6\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: PicDraw.DrawMode
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: PicDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Identifier
                                                                                                        text: DrawMode
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "6"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "6"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "PicDraw.Line (tX, tY)-(tX, iY)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LineKeyword
                                                                                                    text: Line
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "PicDraw.Line (tX, tY)-(iX, tY)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LineKeyword
                                                                                                    text: Line
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "PicDraw.Line (iX, iY)-(tX, iY)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LineKeyword
                                                                                                    text: Line
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallStatement
                                                                                                text: "PicDraw.Line (iX, iY)-(iX, tY)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: PeriodOperator
                                                                                                    text: "."
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LineKeyword
                                                                                                    text: Line
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: tY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "PicDraw.DrawMode = 13\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: PicDraw.DrawMode
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: PicDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Identifier
                                                                                                        text: DrawMode
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "13"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "13"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Note the current location and mark a mouse button as being \"down\""
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iX = x\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iY = y\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tX = x\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tY = y\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "toDraw = True\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: toDraw
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: toDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BooleanLiteralExpression
                                                                                                    text: "True"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: TrueKeyword
                                                                                                        text: "True"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'MOUSE MOVE: on the main picture box"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub PicDraw_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw_MouseMove
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Button
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Shift
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'If a mouse button has been pressed, draw a rectangle around the current selection area"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If toDraw Then\r\n    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    End If\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: toDraw
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: toDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "    \r\n        'Set the draw style to \"invert\"\r\n        PicDraw.DrawMode = 6\r\n        \r\n        'Erase the old box\r\n        PicDraw.Line (tX, tY)-(tX, iY)\r\n        PicDraw.Line (tX, tY)-(iX, tY)\r\n        PicDraw.Line (iX, iY)-(tX, iY)\r\n        PicDraw.Line (iX, iY)-(iX, tY)\r\n        \r\n        'Draw a new box\r\n        PicDraw.Line (iX, iY)-(iX, y)\r\n        PicDraw.Line (iX, iY)-(x, iY)\r\n        PicDraw.Line (x, y)-(iX, y)\r\n        PicDraw.Line (x, y)-(x, iY)\r\n        \r\n        'Remember where this box is located\r\n        tX = x\r\n        tY = y\r\n        \r\n        'Reset the draw style to \"copy\"\r\n        PicDraw.DrawMode = 13\r\n        \r\n    "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Whitespace
                                                                                                        text: "    "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EndOfLineComment
                                                                                                        text: "'Set the draw style to \"invert\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "PicDraw.DrawMode = 6\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: MemberAccessExpression
                                                                                                            text: PicDraw.DrawMode
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: PicDraw
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: PeriodOperator
                                                                                                                text: "."
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Identifier
                                                                                                                text: DrawMode
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "6"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "6"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EndOfLineComment
                                                                                                        text: "'Erase the old box"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (tX, tY)-(tX, iY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (tX, tY)-(iX, tY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (iX, iY)-(tX, iY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (iX, iY)-(iX, tY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: tY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EndOfLineComment
                                                                                                        text: "'Draw a new box"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (iX, iY)-(iX, y)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (iX, iY)-(x, iY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (x, y)-(iX, y)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CallStatement
                                                                                                        text: "PicDraw.Line (x, y)-(x, iY)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: PicDraw
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LineKeyword
                                                                                                            text: Line
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Comma
                                                                                                            text: ","
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EndOfLineComment
                                                                                                        text: "'Remember where this box is located"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "tX = x\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: tX
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: tX
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: x
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: x
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "tY = y\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: tY
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: tY
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: y
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: y
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EndOfLineComment
                                                                                                        text: "'Reset the draw style to \"copy\""
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "PicDraw.DrawMode = 13\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: MemberAccessExpression
                                                                                                            text: PicDraw.DrawMode
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: PicDraw
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: PeriodOperator
                                                                                                                text: "."
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Identifier
                                                                                                                text: DrawMode
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "13"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "13"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "    "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: EndKeyword
                                                                                                    text: End
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'MOUSE UP: on the main picture box"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub PicDraw_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: PicDraw_MouseUp
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Button
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Shift
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IntegerKeyword
                                                                                                    text: Integer
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SingleKeyword
                                                                                                    text: Single
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Mark the mouse button as being released"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "toDraw = False\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: toDraw
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: toDraw
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BooleanLiteralExpression
                                                                                                    text: "False"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: FalseKeyword
                                                                                                        text: "False"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Figure out the width and height of the selected area"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iWidth = x - iX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iWidth
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iWidth
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: x - iX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: x
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: iX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: iX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "iHeight = y - iY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: iHeight
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iHeight
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: y - iY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: iY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: iY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Use some fancy math to calculate the approximate reference frame that the user has selected."
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'(Basically, translate the pixel width on-screen to the coordinate system used by Mandelbrot.)"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Dim nX As Double, nY As Double\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: DimKeyword
                                                                                                    text: Dim
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: nX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: nY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Dim oX As Double, oY As Double\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: DimKeyword
                                                                                                    text: Dim
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Dim oSX As Double, oEX As Double\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: DimKeyword
                                                                                                    text: Dim
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oSX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oEX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Dim oSY As Double, oEY As Double\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: DimKeyword
                                                                                                    text: Dim
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oSY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: oEY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nX = x\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nY = y\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oSX = TxtXMin\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oSX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oSX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtXMin
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oEX = TxtXMax\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oEX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oEX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtXMax
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oSY = TxtYMin\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oSY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oSY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtYMin
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oEY = TxtYMax\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oEY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oEY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtYMax
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oX = (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (iX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (iX / PicDraw.ScaleWidth)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: iX / PicDraw.ScaleWidth
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: iX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: iX
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: DivisionOperator
                                                                                                                text: /
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MemberAccessExpression
                                                                                                                text: PicDraw.ScaleWidth
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: PicDraw
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: PeriodOperator
                                                                                                                    text: "."
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Identifier
                                                                                                                    text: ScaleWidth
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: MultiplicationOperator
                                                                                                        text: "*"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (TxtXMax - TxtXMin)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: TxtXMax - TxtXMin
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtXMax
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtXMax
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtXMin
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtXMin
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oX = oSX + oX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: oSX + oX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oSX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oSX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oY = (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (iY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (iY / PicDraw.ScaleHeight)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: iY / PicDraw.ScaleHeight
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: iY
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: iY
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: DivisionOperator
                                                                                                                text: /
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MemberAccessExpression
                                                                                                                text: PicDraw.ScaleHeight
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: PicDraw
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: PeriodOperator
                                                                                                                    text: "."
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Identifier
                                                                                                                    text: ScaleHeight
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: MultiplicationOperator
                                                                                                        text: "*"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (TxtYMax - TxtYMin)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: TxtYMax - TxtYMin
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtYMax
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtYMax
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtYMin
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtYMin
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "oY = oSY + oY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: oSY + oY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oSY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oSY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nX = (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (nX / PicDraw.ScaleWidth) * (TxtXMax - TxtXMin)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (nX / PicDraw.ScaleWidth)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: nX / PicDraw.ScaleWidth
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: nX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: nX
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: DivisionOperator
                                                                                                                text: /
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MemberAccessExpression
                                                                                                                text: PicDraw.ScaleWidth
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: PicDraw
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: PeriodOperator
                                                                                                                    text: "."
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Identifier
                                                                                                                    text: ScaleWidth
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: MultiplicationOperator
                                                                                                        text: "*"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (TxtXMax - TxtXMin)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: TxtXMax - TxtXMin
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtXMax
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtXMax
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtXMin
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtXMin
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nX = oSX + nX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: oSX + nX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oSX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oSX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: nX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: nX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nY = (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (nY / PicDraw.ScaleHeight) * (TxtYMax - TxtYMin)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (nY / PicDraw.ScaleHeight)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: nY / PicDraw.ScaleHeight
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: nY
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: nY
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: DivisionOperator
                                                                                                                text: /
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MemberAccessExpression
                                                                                                                text: PicDraw.ScaleHeight
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: PicDraw
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: PeriodOperator
                                                                                                                    text: "."
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Identifier
                                                                                                                    text: ScaleHeight
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: MultiplicationOperator
                                                                                                        text: "*"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (TxtYMax - TxtYMin)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: TxtYMax - TxtYMin
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtYMax
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtYMax
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: TxtYMin
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: TxtYMin
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "nY = oSY + nY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: oSY + nY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: oSY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: oSY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: nY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: nY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Change the text boxes to match our new frame of reference"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtXMin = oX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtXMin
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtXMax = nX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtXMax
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtXMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtYMin = oY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtYMin
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMin
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: oY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: oY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "TxtYMax = nY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: TxtYMax
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: TxtYMax
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: nY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: nY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'SCROLLBAR: for changing the accuracy / speed of the fractal render"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Sub scrAccuracy_Change()\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubKeyword
                                                                                                    text: Sub
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: scrAccuracy_Change
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "IterationLimit = scrAccuracy.Value * 100\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: IterationLimit
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: IterationLimit
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: scrAccuracy.Value * 100
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: MemberAccessExpression
                                                                                                        text: scrAccuracy.Value
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: scrAccuracy
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: Value
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: MultiplicationOperator
                                                                                                        text: "*"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "100"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "100"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Sub
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Here is a standard recursive function for generating the Mandlebrot set. Technical details are available at the Wikipedia link referenced earlier."
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Private Function Calculate(ByVal origX As Double, ByVal origY As Double, ByVal curX As Double, ByVal curY As Double, ByVal counter As Long) As Long\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: PrivateKeyword
                                                                                                    text: Private
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: FunctionKeyword
                                                                                                    text: Function
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: Calculate
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ByValKeyword
                                                                                                    text: ByVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: origX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ByValKeyword
                                                                                                    text: ByVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: origY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ByValKeyword
                                                                                                    text: ByVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: curX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ByValKeyword
                                                                                                    text: ByVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: curY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ByValKeyword
                                                                                                    text: ByVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: counter
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LongKeyword
                                                                                                    text: Long
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LongKeyword
                                                                                                    text: Long
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: DimStatement
                                                                                                text: "Static NewX As Double, NewY As Double\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: StaticKeyword
                                                                                                    text: Static
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: NewX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Identifier
                                                                                                    text: NewY
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AsKeyword
                                                                                                    text: As
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DoubleKeyword
                                                                                                    text: Double
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'Check for overflow (well, technically \"underflow\" :)"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If curX < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    End If\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: curX < -1000000
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: curX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: curX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LessThanOperator
                                                                                                        text: "<"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: UnaryExpression
                                                                                                        text: "-1000000"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1000000"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1000000"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "        Calculate = counter\r\n        Exit Function\r\n    "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "Calculate = counter\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Calculate
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Calculate
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: counter
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: counter
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "        "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ExitStatement
                                                                                                        text: "Exit Function\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: ExitKeyword
                                                                                                            text: Exit
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: FunctionKeyword
                                                                                                            text: Function
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "    "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: ElseIfClause
                                                                                                    text: "ElseIf curY < -1000000 Then\r\n        Calculate = counter\r\n        Exit Function\r\n    "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ElseIfKeyword
                                                                                                        text: ElseIf
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: curY < -1000000
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: curY
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: curY
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LessThanOperator
                                                                                                            text: "<"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: UnaryExpression
                                                                                                            text: "-1000000"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "1000000"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IntegerLiteral
                                                                                                                    text: "1000000"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ThenKeyword
                                                                                                        text: Then
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CodeBlock
                                                                                                        text: "        Calculate = counter\r\n        Exit Function\r\n    "
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Whitespace
                                                                                                            text: "        "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AssignmentStatement
                                                                                                            text: "Calculate = counter\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Calculate
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Calculate
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: counter
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: counter
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "        "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: ExitStatement
                                                                                                            text: "Exit Function\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: ExitKeyword
                                                                                                                text: Exit
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: FunctionKeyword
                                                                                                                text: Function
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "    "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: EndKeyword
                                                                                                    text: End
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'If you so desire, you can also remove the if/then statements above and let VB do the underflow checking (uncomment this next line to allow)"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EndOfLineComment
                                                                                                text: "'On Error GoTo 1"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "NewX = (curX * curX) - (curY * curY) + origX\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: NewX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: NewX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (curX * curX) - (curY * curY) + origX
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: BinaryExpression
                                                                                                        text: (curX * curX) - (curY * curY)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: (curX * curX)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: curX * curX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: curX
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: curX
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: curX
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: curX
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: (curY * curY)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: curY * curY
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: curY
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: curY
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: curY
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: curY
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: origX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: origX
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "NewY = (2 * curX * curY) + origY\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: NewY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: NewY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (2 * curX * curY) + origY
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (2 * curX * curY)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: 2 * curX * curY
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: BinaryExpression
                                                                                                                text: 2 * curX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: NumericLiteralExpression
                                                                                                                    text: "2"
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IntegerLiteral
                                                                                                                        text: "2"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: curX
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: curX
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MultiplicationOperator
                                                                                                                text: "*"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: curY
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: curY
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: origY
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: origY
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If ((NewX * NewX) - (NewY * NewY)) > 2 Then\r\n1       Calculate = counter\r\n    Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    End If\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: ((NewX * NewX) - (NewY * NewY)) > 2
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: ((NewX * NewX) - (NewY * NewY))
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: (NewX * NewX) - (NewY * NewY)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: ParenthesizedExpression
                                                                                                                text: (NewX * NewX)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: LeftParenthesis
                                                                                                                    text: (
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: NewX * NewX
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: NewX
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: NewX
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: MultiplicationOperator
                                                                                                                        text: "*"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: NewX
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: NewX
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: RightParenthesis
                                                                                                                    text: )
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: ParenthesizedExpression
                                                                                                                text: (NewY * NewY)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: LeftParenthesis
                                                                                                                    text: (
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: NewY * NewY
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: NewY
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: NewY
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: MultiplicationOperator
                                                                                                                        text: "*"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: NewY
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: NewY
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: RightParenthesis
                                                                                                                    text: )
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: GreaterThanOperator
                                                                                                        text: ">"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "2"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "2"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "1       Calculate = counter\r\n    "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "1       Calculate = counter\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "       "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: Calculate = counter
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Calculate
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Calculate
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: counter
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: counter
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "    "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: ElseClause
                                                                                                    text: "Else\r\n        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ElseKeyword
                                                                                                        text: Else
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CodeBlock
                                                                                                        text: "        'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)\r\n        If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n    "
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Whitespace
                                                                                                            text: "        "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EndOfLineComment
                                                                                                            text: "'This line checks to see if we've exceeded the \"IterationLimit\" (IterationLimit controls accuracy / speed of execution)"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "        "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IfStatement
                                                                                                            text: "If counter >= IterationLimit Then\r\n            Calculate = IterationLimit\r\n        Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        End If\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IfKeyword
                                                                                                                text: If
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: counter >= IterationLimit
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: counter
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: counter
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: GreaterThanOrEqualOperator
                                                                                                                    text: ">="
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: IterationLimit
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: IterationLimit
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: ThenKeyword
                                                                                                                text: Then
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: CodeBlock
                                                                                                                text: "            Calculate = IterationLimit\r\n        "
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Whitespace
                                                                                                                    text: "            "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: AssignmentStatement
                                                                                                                    text: "Calculate = IterationLimit\r\n"
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: Calculate
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: Calculate
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: EqualityOperator
                                                                                                                        text: "="
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: IterationLimit
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: IterationLimit
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Newline
                                                                                                                        text: "\r\n"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: "        "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: ElseClause
                                                                                                                text: "Else\r\n            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        "
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: ElseKeyword
                                                                                                                    text: Else
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Newline
                                                                                                                    text: "\r\n"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: CodeBlock
                                                                                                                    text: "            counter = counter + 1\r\n            Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n        "
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Whitespace
                                                                                                                        text: "            "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: AssignmentStatement
                                                                                                                        text: "counter = counter + 1\r\n"
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: counter
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: counter
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: EqualityOperator
                                                                                                                            text: "="
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: counter + 1
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: counter
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: counter
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: AdditionOperator
                                                                                                                                text: +
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: NumericLiteralExpression
                                                                                                                                text: "1"
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: IntegerLiteral
                                                                                                                                    text: "1"
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: Newline
                                                                                                                            text: "\r\n"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: "            "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: AssignmentStatement
                                                                                                                        text: "Calculate = Calculate(origX, origY, NewX, NewY, counter)\r\n"
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Calculate
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Calculate
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: EqualityOperator
                                                                                                                            text: "="
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: CallExpression
                                                                                                                            text: "Calculate(origX, origY, NewX, NewY, counter)"
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Calculate
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: LeftParenthesis
                                                                                                                                text: (
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: ArgumentList
                                                                                                                                text: "origX, origY, NewX, NewY, counter"
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Argument
                                                                                                                                    text: origX
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: origX
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: origX
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: Comma
                                                                                                                                    text: ","
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Whitespace
                                                                                                                                    text: " "
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Argument
                                                                                                                                    text: origY
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: origY
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: origY
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: Comma
                                                                                                                                    text: ","
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Whitespace
                                                                                                                                    text: " "
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Argument
                                                                                                                                    text: NewX
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: NewX
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: NewX
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: Comma
                                                                                                                                    text: ","
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Whitespace
                                                                                                                                    text: " "
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Argument
                                                                                                                                    text: NewY
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: NewY
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: NewY
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: Comma
                                                                                                                                    text: ","
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Whitespace
                                                                                                                                    text: " "
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: Argument
                                                                                                                                    text: counter
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: counter
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: counter
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                              - kind: RightParenthesis
                                                                                                                                text: )
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Newline
                                                                                                                            text: "\r\n"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: "        "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: EndKeyword
                                                                                                                text: End
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IfKeyword
                                                                                                                text: If
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "    "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: EndKeyword
                                                                                                    text: End
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "    "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Unknown
                                                                                                text: Function
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
