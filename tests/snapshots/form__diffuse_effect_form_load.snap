---
source: tests/form.rs
expression: form_file
---
form:
  name: frmDiffuse
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          System:
            index: 5
        border_style: Sizable
        caption: Diffuse Image Filter - www.tannerhelland.com
        client_height: 9735
        client_left: 45
        client_top: 630
        client_width: 12330
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: HasContext
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 649
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 822
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: cmdDrawExplosion
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: "Animate \"\"Explosion\"\""
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 495
                help_context_id: 0
                left: 9600
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 10
                tab_stop: Included
                tool_tip_text: ""
                top: 1080
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 2535
        - name: chkWrap
          tag: ""
          index: 0
          kind:
            CheckBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                caption: Wrap pixels around image edges?
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                left: 120
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 9
                tab_stop: Included
                tool_tip_text: ""
                top: 1080
                use_mask_color: DoNotUseMaskColor
                value: Unchecked
                visible: Visible
                whats_this_help_id: 0
                width: 3855
        - name: hScrollY
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 2520
                max: 600
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 5
                tab_stop: Included
                top: 720
                value: 0
                visible: Visible
                whats_this_help_id: 0
                width: 6855
        - name: hScrollX
          tag: ""
          index: 0
          kind:
            HScrollBar:
              properties:
                causes_validation: "Yes"
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 255
                help_context_id: 0
                large_change: 1
                left: 2520
                max: 800
                min: 0
                mouse_icon: ~
                mouse_pointer: Default
                right_to_left: LeftToRight
                small_change: 1
                tab_index: 4
                tab_stop: Included
                top: 360
                value: 20
                visible: Visible
                whats_this_help_id: 0
                width: 6855
        - name: cmdReset
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: Show the Original Image
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 615
                help_context_id: 0
                left: 9600
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 2
                tab_stop: Included
                tool_tip_text: ""
                top: 240
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 2535
        - name: picMain
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 735
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 47
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 87
                tab_index: 0
                tab_stop: Included
                tool_tip_text: ""
                top: 1680
                visible: Visible
                whats_this_help_id: 0
                width: 1335
              controls: []
        - name: picBack
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 7530
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 500
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 800
                tab_index: 1
                tab_stop: Included
                tool_tip_text: ""
                top: 1680
                visible: Visible
                whats_this_help_id: 0
                width: 12030
              controls: []
        - name: lblY
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: 0 px
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 210
                left: 1800
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 8
                tool_tip_text: ""
                top: 720
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 360
                word_wrap: NonWrapping
        - name: lblX
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: 20 px
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 210
                left: 1800
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 7
                tool_tip_text: ""
                top: 360
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 465
                word_wrap: NonWrapping
        - name: Label1
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Vertical distance: "
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 210
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 6
                tool_tip_text: ""
                top: 720
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1455
                word_wrap: NonWrapping
        - name: Label2
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "Horizontal distance: "
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 210
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 3
                tool_tip_text: ""
                top: 360
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1650
                word_wrap: NonWrapping
      menus:
        - name: mnuFile
          tag: ""
          index: 0
          properties:
            caption: "&File"
            checked: false
            enabled: Enabled
            help_context_id: 0
            negotiate_position: None
            shortcut: ~
            visible: Visible
            window_list: false
          sub_menus:
            - name: mnuOpenImage
              tag: ""
              index: 0
              properties:
                caption: "&Open image"
                checked: false
                enabled: Enabled
                help_context_id: 0
                negotiate_position: None
                shortcut: ~
                visible: Visible
                window_list: false
              sub_menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmDiffuse
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'Diffuse/Spread Image Filter by Tanner Helland (published 2011)\r\n'\r\n'http://www.tannerhelland.com\r\n'\r\n'This project demonstrates a full implementation of a \"Diffuse\" (or \"Spread\" if you use GIMP) image filter.\r\n' A diffuse filter works by randomly rearranging pixels in an image.  The maximum distance that pixels can\r\n' be moved is specified by the user, and a wrap option is provided for image edges.  If wrap is set to true,\r\n' any pixels near the edge of the image that are selected for randomization can be moved to the opposite\r\n' side of the image, or \"wrapped around.\"\r\n'\r\n'For fun, I've included an animation option that runs a loop of increasingly large diffusion distances.\r\n' It makes for a fun kind of explosion effect, and it reminds me of how some old 8-bit games used to look.\r\n'\r\n'Enjoy the project, and be sure to let me know if you found the code useful.\r\n'\r\n'Also, if you enjoy free VB game and graphics code, subscribe to my RSS feed at\r\n' http://www.tannerhelland.com/feed/\r\n\r\nOption Explicit\r\n\r\nPrivate Sub chkWrap_Click()\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\n'This routine will draw an animated explosion (note: it may momentarily lock up an underpowered computer - so only do this after compilation, or consider yourself warned!)\r\nPrivate Sub cmdDrawExplosion_Click()\r\n\r\n    Dim x As Long\r\n    \r\n    For x = 0 To 200 Step 5\r\n        DrawDiffuse picBack, picMain, x, x, False\r\n    Next x\r\n\r\nEnd Sub\r\n\r\n'When the program is first loaded, several things needs to happen...\r\nPrivate Sub Form_Load()\r\n\r\n    'Draw the initial effect with a default value, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    ProcessDiffuse True\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\n'Apply a diffuse filter to an image using user-specified distances and, optionally, a paramater that defines wrapping around image edges\r\nPublic Sub DrawDiffuse(ByRef srcPic As PictureBox, ByRef dstPic As PictureBox, ByVal xDist As Single, ByVal yDist As Single, Optional ByVal wrapPixels As Boolean = False)\r\n\r\n    'These arrays will hold the source and destination image's pixel data, respectively\r\n    Dim srcImageData() As Byte, dstImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(srcPic)\r\n    iHeight = fDraw.GetImageHeight(srcPic)\r\n    fDraw.GetImageData2D srcPic, srcImageData()\r\n    fDraw.GetImageData2D srcPic, dstImageData()\r\n    \r\n    'These variables will hold temporary pixel color values (red, green, blue)\r\n    Dim r As Byte, g As Byte, b As Byte\r\n    \r\n    'Let's do simple checking to make sure the hue and saturation values we were passed don't exceed the\r\n    ' width of the source image\r\n    If xDist < 0 Then xDist = 0\r\n    If xDist > iWidth Then xDist = iWidth\r\n    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n    Dim halfDX As Long, halfDY As Long\r\n    halfDX = xDist / 2\r\n    halfDY = yDist / 2\r\n    \r\n    Dim diffuseX As Long, diffuseY As Long\r\n    Dim dstX As Long, dstY As Long\r\n    \r\n    'Seed the random number generator with a unique value\r\n    Randomize Timer\r\n    \r\n    'Loop through the image, adjusting pixel values as we go\r\n    Dim quickX As Long, quickX2 As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'Diffuse/Spread Image Filter by Tanner Helland (published 2011)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'http://www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This project demonstrates a full implementation of a \"Diffuse\" (or \"Spread\" if you use GIMP) image filter."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' A diffuse filter works by randomly rearranging pixels in an image.  The maximum distance that pixels can"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' be moved is specified by the user, and a wrap option is provided for image edges.  If wrap is set to true,"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' any pixels near the edge of the image that are selected for randomization can be moved to the opposite"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' side of the image, or \"wrapped around.\""
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'For fun, I've included an animation option that runs a loop of increasingly large diffusion distances."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' It makes for a fun kind of explosion effect, and it reminds me of how some old 8-bit games used to look."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Enjoy the project, and be sure to let me know if you found the code useful."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Also, if you enjoy free VB game and graphics code, subscribe to my RSS feed at"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' http://www.tannerhelland.com/feed/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub chkWrap_Click()\r\n    ProcessDiffuse\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: chkWrap_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    ProcessDiffuse\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "ProcessDiffuse\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: ProcessDiffuse
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This routine will draw an animated explosion (note: it may momentarily lock up an underpowered computer - so only do this after compilation, or consider yourself warned!)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmdDrawExplosion_Click()\r\n\r\n    Dim x As Long\r\n    \r\n    For x = 0 To 200 Step 5\r\n        DrawDiffuse picBack, picMain, x, x, False\r\n    Next x\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmdDrawExplosion_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "\r\n    Dim x As Long\r\n    \r\n    For x = 0 To 200 Step 5\r\n        DrawDiffuse picBack, picMain, x, x, False\r\n    Next x\r\n\r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim x As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: ForStatement
                text: "    For x = 0 To 200 Step 5\r\n        DrawDiffuse picBack, picMain, x, x, False\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "200"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "200"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StepKeyword
                    text: Step
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "5"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "5"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        DrawDiffuse picBack, picMain, x, x, False\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "DrawDiffuse picBack, picMain, x, x, False\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: DrawDiffuse
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: picBack
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: picMain
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: x
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: x
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: FalseKeyword
                            text: "False"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When the program is first loaded, several things needs to happen..."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub Form_Load()\r\n\r\n    'Draw the initial effect with a default value, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    ProcessDiffuse True\r\n    Me.Show\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: Form_Load
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "\r\n    'Draw the initial effect with a default value, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    ProcessDiffuse True\r\n    Me.Show\r\n    \r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Draw the initial effect with a default value, then update the image"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ParenthesizedExpression
                    text: (App.LogMode = 0)
                    is_token: false
                    children:
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: App.LogMode = 0
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: App.LogMode
                            is_token: false
                            children:
                              - kind: Identifier
                                text: App
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: LogMode
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AssignmentStatement
                    text: "Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n"
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Me.Caption
                        is_token: false
                        children:
                          - kind: MeKeyword
                            text: Me
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Caption
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: EqualityOperator
                        text: "="
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: "Me.Caption & \" - compile for significantly better performance!\""
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Me.Caption
                            is_token: false
                            children:
                              - kind: MeKeyword
                                text: Me
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Caption
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Ampersand
                            text: "&"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteralExpression
                            text: "\" - compile for significantly better performance!\""
                            is_token: false
                            children:
                              - kind: StringLiteral
                                text: "\" - compile for significantly better performance!\""
                                is_token: true
                                children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: LoadImageAutosized
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: App
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Path
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"\\sample.jpg\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "ProcessDiffuse True\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: ProcessDiffuse
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: TrueKeyword
                    text: "True"
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Me.Show\r\n"
                is_token: false
                children:
                  - kind: MeKeyword
                    text: Me
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Show
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Apply a diffuse filter to an image using user-specified distances and, optionally, a paramater that defines wrapping around image edges"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub DrawDiffuse(ByRef srcPic As PictureBox, ByRef dstPic As PictureBox, ByVal xDist As Single, ByVal yDist As Single, Optional ByVal wrapPixels As Boolean = False)\r\n\r\n    'These arrays will hold the source and destination image's pixel data, respectively\r\n    Dim srcImageData() As Byte, dstImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(srcPic)\r\n    iHeight = fDraw.GetImageHeight(srcPic)\r\n    fDraw.GetImageData2D srcPic, srcImageData()\r\n    fDraw.GetImageData2D srcPic, dstImageData()\r\n    \r\n    'These variables will hold temporary pixel color values (red, green, blue)\r\n    Dim r As Byte, g As Byte, b As Byte\r\n    \r\n    'Let's do simple checking to make sure the hue and saturation values we were passed don't exceed the\r\n    ' width of the source image\r\n    If xDist < 0 Then xDist = 0\r\n    If xDist > iWidth Then xDist = iWidth\r\n    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n    Dim halfDX As Long, halfDY As Long\r\n    halfDX = xDist / 2\r\n    halfDY = yDist / 2\r\n    \r\n    Dim diffuseX As Long, diffuseY As Long\r\n    Dim dstX As Long, dstY As Long\r\n    \r\n    'Seed the random number generator with a unique value\r\n    Randomize Timer\r\n    \r\n    'Loop through the image, adjusting pixel values as we go\r\n    Dim quickX As Long, quickX2 As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawDiffuse
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByRef srcPic As PictureBox, ByRef dstPic As PictureBox, ByVal xDist As Single, ByVal yDist As Single, Optional ByVal wrapPixels As Boolean = False)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcPic
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstPic
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: xDist
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: yDist
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: wrapPixels
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "False"
                is_token: false
                children:
                  - kind: FalseKeyword
                    text: "False"
                    is_token: true
                    children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "\r\n    'These arrays will hold the source and destination image's pixel data, respectively\r\n    Dim srcImageData() As Byte, dstImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(srcPic)\r\n    iHeight = fDraw.GetImageHeight(srcPic)\r\n    fDraw.GetImageData2D srcPic, srcImageData()\r\n    fDraw.GetImageData2D srcPic, dstImageData()\r\n    \r\n    'These variables will hold temporary pixel color values (red, green, blue)\r\n    Dim r As Byte, g As Byte, b As Byte\r\n    \r\n    'Let's do simple checking to make sure the hue and saturation values we were passed don't exceed the\r\n    ' width of the source image\r\n    If xDist < 0 Then xDist = 0\r\n    If xDist > iWidth Then xDist = iWidth\r\n    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n    Dim halfDX As Long, halfDY As Long\r\n    halfDX = xDist / 2\r\n    halfDY = yDist / 2\r\n    \r\n    Dim diffuseX As Long, diffuseY As Long\r\n    Dim dstX As Long, dstY As Long\r\n    \r\n    'Seed the random number generator with a unique value\r\n    Randomize Timer\r\n    \r\n    'Loop through the image, adjusting pixel values as we go\r\n    Dim quickX As Long, quickX2 As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'These arrays will hold the source and destination image's pixel data, respectively"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim srcImageData() As Byte, dstImageData() As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcImageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstImageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Coordinate variables"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim x As Long, y As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: y
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Image dimensions"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim iWidth As Long, iHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iWidth
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim fDraw As New FastDrawing\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NewKeyword
                    text: New
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FastDrawing
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iWidth = fDraw.GetImageWidth(srcPic)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageWidth(srcPic)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageWidth
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: srcPic
                        is_token: false
                        children:
                          - kind: Argument
                            text: srcPic
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: srcPic
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: srcPic
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iHeight = fDraw.GetImageHeight(srcPic)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageHeight(srcPic)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageHeight
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: srcPic
                        is_token: false
                        children:
                          - kind: Argument
                            text: srcPic
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: srcPic
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: srcPic
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "fDraw.GetImageData2D srcPic, srcImageData()\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GetImageData2D
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPic
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcImageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "fDraw.GetImageData2D srcPic, dstImageData()\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GetImageData2D
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPic
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstImageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'These variables will hold temporary pixel color values (red, green, blue)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim r As Byte, g As Byte, b As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: r
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: g
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: b
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Let's do simple checking to make sure the hue and saturation values we were passed don't exceed the"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' width of the source image"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If xDist < 0 Then xDist = 0\r\n    If xDist > iWidth Then xDist = iWidth\r\n    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n    Dim halfDX As Long, halfDY As Long\r\n    halfDX = xDist / 2\r\n    halfDY = yDist / 2\r\n    \r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: xDist < 0
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: xDist
                        is_token: false
                        children:
                          - kind: Identifier
                            text: xDist
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LessThanOperator
                        text: "<"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "0"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AssignmentStatement
                    text: "xDist = 0\r\n"
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: xDist
                        is_token: false
                        children:
                          - kind: Identifier
                            text: xDist
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: EqualityOperator
                        text: "="
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "0"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: IfStatement
                    text: "    If xDist > iWidth Then xDist = iWidth\r\n    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n    Dim halfDX As Long, halfDY As Long\r\n"
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: IfKeyword
                        text: If
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: xDist > iWidth
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: xDist
                            is_token: false
                            children:
                              - kind: Identifier
                                text: xDist
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: GreaterThanOperator
                            text: ">"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: iWidth
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iWidth
                                is_token: true
                                children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ThenKeyword
                        text: Then
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "xDist = iWidth\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: xDist
                            is_token: false
                            children:
                              - kind: Identifier
                                text: xDist
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: iWidth
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iWidth
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "    If yDist < 0 Then yDist = 0\r\n    If yDist > iHeight Then yDist = iHeight\r\n    \r\n    'These values will be used to calculate the diffused pixels\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: yDist < 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: yDist
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: yDist
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: LessThanOperator
                                text: "<"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "yDist = 0\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: yDist
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: yDist
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: IfStatement
                            text: "    If yDist > iHeight Then yDist = iHeight\r\n    \r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: IfKeyword
                                text: If
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: yDist > iHeight
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: yDist
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: yDist
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: GreaterThanOperator
                                    text: ">"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: iHeight
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: iHeight
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: ThenKeyword
                                text: Then
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "yDist = iHeight\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: yDist
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: yDist
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: iHeight
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: iHeight
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'These values will be used to calculate the diffused pixels"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimKeyword
                        text: Dim
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: halfDX
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AsKeyword
                        text: As
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LongKeyword
                        text: Long
                        is_token: true
                        children: []
                      - kind: Comma
                        text: ","
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: halfDY
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AsKeyword
                        text: As
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LongKeyword
                        text: Long
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: AssignmentStatement
                    text: "halfDX = xDist / 2\r\n"
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: halfDX
                        is_token: false
                        children:
                          - kind: Identifier
                            text: halfDX
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: EqualityOperator
                        text: "="
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: xDist / 2
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: xDist
                            is_token: false
                            children:
                              - kind: Identifier
                                text: xDist
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: DivisionOperator
                            text: /
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "2"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "2"
                                is_token: true
                                children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: AssignmentStatement
                    text: "halfDY = yDist / 2\r\n"
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: halfDY
                        is_token: false
                        children:
                          - kind: Identifier
                            text: halfDY
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: EqualityOperator
                        text: "="
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: yDist / 2
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: yDist
                            is_token: false
                            children:
                              - kind: Identifier
                                text: yDist
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: DivisionOperator
                            text: /
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "2"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "2"
                                is_token: true
                                children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim diffuseX As Long, diffuseY As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: diffuseX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: diffuseY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim dstX As Long, dstY As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Seed the random number generator with a unique value"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: RandomizeStatement
                text: "    Randomize Timer\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: RandomizeKeyword
                    text: Randomize
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Timer
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Loop through the image, adjusting pixel values as we go"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim quickX As Long, quickX2 As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: quickX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: quickX2
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: ForStatement
                text: "    For x = 0 To iWidth - 1\r\n    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: iWidth - 1
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: iWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: iWidth
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                    is_token: false
                    children:
                      - kind: ForStatement
                        text: "    For y = 0 To iHeight - 1\r\n        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: iHeight - 1
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: iHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: iHeight
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "        \r\n        'To calculate a new pixel position, we add a random value between 0 and the specified max distance.\r\n        ' Then we subtract half that value, so the pixel can move to the right OR left (up AND down).\r\n        diffuseX = Rnd * xDist - halfDX\r\n        diffuseY = Rnd * yDist - halfDY\r\n        dstX = x + diffuseX\r\n        dstY = y + diffuseY\r\n        \r\n        'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)\r\n        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'To calculate a new pixel position, we add a random value between 0 and the specified max distance."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "' Then we subtract half that value, so the pixel can move to the right OR left (up AND down)."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "diffuseX = Rnd * xDist - halfDX\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: diffuseX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: diffuseX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: Rnd * xDist - halfDX
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: Rnd * xDist
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Rnd
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Rnd
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: xDist
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: xDist
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: halfDX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: halfDX
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "diffuseY = Rnd * yDist - halfDY\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: diffuseY
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: diffuseY
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: Rnd * yDist - halfDY
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: Rnd * yDist
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Rnd
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Rnd
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: yDist
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: yDist
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: halfDY
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: halfDY
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "dstX = x + diffuseX\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: dstX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: dstX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: x + diffuseX
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: diffuseX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: diffuseX
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "dstY = y + diffuseY\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: dstY
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: dstY
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: y + diffuseY
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: y
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: y
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: diffuseY
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: diffuseY
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'If wrapPixels is TRUE, wrap this pixel around to the other side (if necessary)"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "        If wrapPixels Then\r\n            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: wrapPixels
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: wrapPixels
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        "
                                    is_token: false
                                    children:
                                      - kind: IfStatement
                                        text: "            If dstX < 0 Then dstX = iWidth - 1 + dstX\r\n            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        "
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: dstX < 0
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: dstX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: dstX
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOperator
                                                text: "<"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "dstX = iWidth - 1 + dstX\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: dstX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: dstX
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: iWidth - 1 + dstX
                                                is_token: false
                                                children:
                                                  - kind: BinaryExpression
                                                    text: iWidth - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: iWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: dstX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: dstX
                                                        is_token: true
                                                        children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: IfStatement
                                            text: "            If dstY < 0 Then dstY = iHeight - 1 + dstY\r\n            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n        "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "            "
                                                is_token: true
                                                children: []
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: dstY < 0
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: dstY
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: dstY
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LessThanOperator
                                                    text: "<"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "dstY = iHeight - 1 + dstY\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: dstY
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: dstY
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iHeight - 1 + dstY
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: iHeight - 1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: iHeight
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: iHeight
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: SubtractionOperator
                                                            text: "-"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AdditionOperator
                                                        text: +
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: dstY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: dstY
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: IfStatement
                                                text: "            If dstX > iWidth - 1 Then dstX = dstX - iWidth + 1\r\n            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n        'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries\r\n"
                                                is_token: false
                                                children:
                                                  - kind: Whitespace
                                                    text: "            "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: dstX > iWidth - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: dstX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: dstX
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: GreaterThanOperator
                                                        text: ">"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: iWidth - 1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: iWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: iWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: SubtractionOperator
                                                            text: "-"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "dstX = dstX - iWidth + 1\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: dstX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: dstX
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: dstX - iWidth + 1
                                                        is_token: false
                                                        children:
                                                          - kind: BinaryExpression
                                                            text: dstX - iWidth
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: dstX
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: dstX
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: iWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: iWidth
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AdditionOperator
                                                            text: +
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: IfStatement
                                                    text: "            If dstY > iHeight - 1 Then dstY = dstY - iHeight + 1\r\n        \r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: dstY > iHeight - 1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: dstY
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: dstY
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: GreaterThanOperator
                                                            text: ">"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: iHeight - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: iHeight
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: iHeight
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "dstY = dstY - iHeight + 1\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: dstY
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: dstY
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: dstY - iHeight + 1
                                                            is_token: false
                                                            children:
                                                              - kind: BinaryExpression
                                                                text: dstY - iHeight
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: dstY
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: dstY
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubtractionOperator
                                                                    text: "-"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: iHeight
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iHeight
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: EndOfLineComment
                                                    text: "'If wrapPixels is FALSE, then check to make sure this pixel falls within image boundaries"
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                  - kind: ElseClause
                                    text: "Else\r\n            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                                    is_token: false
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: CodeBlock
                                        text: "            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfStatement
                                            text: "            If dstX < 0 Then dstX = 0\r\n            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "            "
                                                is_token: true
                                                children: []
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: dstX < 0
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: dstX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: dstX
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LessThanOperator
                                                    text: "<"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "dstX = 0\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: dstX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: dstX
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: IfStatement
                                                text: "            If dstY < 0 Then dstY = 0\r\n            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n"
                                                is_token: false
                                                children:
                                                  - kind: Whitespace
                                                    text: "            "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: dstY < 0
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: dstY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: dstY
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: LessThanOperator
                                                        text: "<"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "0"
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "dstY = 0\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: dstY
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: dstY
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "0"
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: IfStatement
                                                    text: "            If dstX > iWidth - 1 Then dstX = iWidth - 1\r\n            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: dstX > iWidth - 1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: dstX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: dstX
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: GreaterThanOperator
                                                            text: ">"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: iWidth - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: iWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: iWidth
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "dstX = iWidth - 1\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: dstX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: dstX
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: iWidth - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: iWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: iWidth
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: IfStatement
                                                        text: "            If dstY > iHeight - 1 Then dstY = iHeight - 1\r\n        End If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n    \r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Whitespace
                                                            text: "            "
                                                            is_token: true
                                                            children: []
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: dstY > iHeight - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: dstY
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: dstY
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: GreaterThanOperator
                                                                text: ">"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: iHeight - 1
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: iHeight
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iHeight
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubtractionOperator
                                                                    text: "-"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "dstY = iHeight - 1\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: dstY
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: dstY
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: iHeight - 1
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: iHeight
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iHeight
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubtractionOperator
                                                                    text: "-"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndKeyword
                                                            text: End
                                                            is_token: true
                                                            children: []
                                                          - kind: IfStatement
                                                            text: " If\r\n    \r\n        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    End If\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: "\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: CodeBlock
                                                                text: "        quickX = x * 3\r\n        quickX2 = dstX * 3\r\n        \r\n        'Swap the pixels at these two locations\r\n        b = srcImageData(quickX2, dstY)\r\n        g = srcImageData(quickX2 + 1, dstY)\r\n        r = srcImageData(quickX2 + 2, dstY)\r\n        \r\n        dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n        dstImageData(quickX2 + 1, dstY) = srcImageData(quickX + 1, y)\r\n        dstImageData(quickX2 + 2, dstY) = srcImageData(quickX + 2, y)\r\n        \r\n        dstImageData(quickX, y) = b\r\n        dstImageData(quickX + 1, y) = g\r\n        dstImageData(quickX + 2, y) = r\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n\r\nEnd Sub\r\n\r\n'Reset the foreground image to look like the original image\r\nPrivate Sub cmdReset_Click()\r\n    LoadImageAutosized vbNullString\r\nEnd Sub\r\n\r\n'When the scroll bars are changed, make the associated labels match and redraw the image\r\nPrivate Sub hScrollX_Change()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollX_Scroll()\r\n    lblX.Caption = hScrollX.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Change()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub hScrollY_Scroll()\r\n    lblY.Caption = hScrollY.Value & \" px\"\r\n    ProcessDiffuse\r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        ProcessDiffuse True\r\n        \r\n    "
                                                                is_token: false
                                                                children:
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "quickX = x * 3\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: quickX
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: quickX
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: x * 3
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: MultiplicationOperator
                                                                            text: "*"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "3"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "3"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "quickX2 = dstX * 3\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: quickX2
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: quickX2
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: dstX * 3
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: dstX
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: dstX
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: MultiplicationOperator
                                                                            text: "*"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "3"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "3"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Swap the pixels at these two locations"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "b = srcImageData(quickX2, dstY)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: b
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: b
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: "srcImageData(quickX2, dstY)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: srcImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX2, dstY"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX2
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: quickX2
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: quickX2
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: dstY
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: dstY
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: dstY
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "g = srcImageData(quickX2 + 1, dstY)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: g
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: g
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: "srcImageData(quickX2 + 1, dstY)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: srcImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX2 + 1, dstY"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX2 + 1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: BinaryExpression
                                                                                    text: quickX2 + 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: quickX2
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: quickX2
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AdditionOperator
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "1"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "1"
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: dstY
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: dstY
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: dstY
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "r = srcImageData(quickX2 + 2, dstY)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: r
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: r
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: "srcImageData(quickX2 + 2, dstY)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: srcImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX2 + 2, dstY"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX2 + 2
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: BinaryExpression
                                                                                    text: quickX2 + 2
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: quickX2
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: quickX2
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AdditionOperator
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "2"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "2"
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: dstY
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: dstY
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: dstY
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "dstImageData(quickX2, dstY) = srcImageData(quickX, y)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: "dstImageData(quickX2, dstY)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: dstImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX2, dstY"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX2
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: quickX2
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: quickX2
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: dstY
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: dstY
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: dstY
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: "srcImageData(quickX, y)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: srcImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX, y"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: quickX
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: quickX
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: y
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: y
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: dstImageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: quickX2
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "1,"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: IdentifierExpression
                                                                        text: ","
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "dstY) = srcImageData(quickX + 1, y)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: dstY
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: dstY
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: BinaryExpression
                                                                        text: ") = srcImageData(quickX + 1, y)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: )
                                                                            is_token: false
                                                                            children:
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "srcImageData(quickX + 1, y)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: srcImageData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "quickX + 1, y"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: quickX + 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: BinaryExpression
                                                                                        text: quickX + 1
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: quickX
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: quickX
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AdditionOperator
                                                                                            text: +
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "1"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "1"
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: y
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: dstImageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: quickX2
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "2,"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "2"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "2"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: IdentifierExpression
                                                                        text: ","
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "dstY) = srcImageData(quickX + 2, y)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: dstY
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: dstY
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: BinaryExpression
                                                                        text: ") = srcImageData(quickX + 2, y)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: )
                                                                            is_token: false
                                                                            children:
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "srcImageData(quickX + 2, y)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: srcImageData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "quickX + 2, y"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: quickX + 2
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: BinaryExpression
                                                                                        text: quickX + 2
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: quickX
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: quickX
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AdditionOperator
                                                                                            text: +
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "2"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "2"
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: y
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "dstImageData(quickX, y) = b\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: "dstImageData(quickX, y)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: dstImageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "quickX, y"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: quickX
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: quickX
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: quickX
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: y
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: y
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: b
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: b
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: dstImageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: quickX
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "1,"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: IdentifierExpression
                                                                        text: ","
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "y) = g\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: BinaryExpression
                                                                        text: ) = g
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: )
                                                                            is_token: false
                                                                            children:
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: g
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: g
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: dstImageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: quickX
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "2,"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "2"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "2"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: IdentifierExpression
                                                                        text: ","
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "y) = r\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: BinaryExpression
                                                                        text: ) = r
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: )
                                                                            is_token: false
                                                                            children:
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: r
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: r
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Next
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "y\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: y
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Next
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "x\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Draw the new image data to the screen"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "fDraw.SetImageData2D dstPic, iWidth, iHeight, dstImageData()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: fDraw
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: SetImageData2D
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: dstPic
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: iWidth
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: iHeight
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: dstImageData
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Reset the foreground image to look like the original image"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub cmdReset_Click()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: cmdReset_Click
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "LoadImageAutosized vbNullString\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: LoadImageAutosized
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: vbNullString
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'When the scroll bars are changed, make the associated labels match and redraw the image"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub hScrollX_Change()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: hScrollX_Change
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "lblX.Caption = hScrollX.Value & \" px\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: lblX.Caption
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: lblX
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Caption
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "hScrollX.Value & \" px\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: MemberAccessExpression
                                                                            text: hScrollX.Value
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: hScrollX
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Value
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Ampersand
                                                                            text: "&"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: StringLiteralExpression
                                                                            text: "\" px\""
                                                                            is_token: false
                                                                            children:
                                                                              - kind: StringLiteral
                                                                                text: "\" px\""
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "ProcessDiffuse\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: ProcessDiffuse
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub hScrollX_Scroll()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: hScrollX_Scroll
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "lblX.Caption = hScrollX.Value & \" px\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: lblX.Caption
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: lblX
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Caption
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "hScrollX.Value & \" px\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: MemberAccessExpression
                                                                            text: hScrollX.Value
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: hScrollX
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Value
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Ampersand
                                                                            text: "&"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: StringLiteralExpression
                                                                            text: "\" px\""
                                                                            is_token: false
                                                                            children:
                                                                              - kind: StringLiteral
                                                                                text: "\" px\""
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "ProcessDiffuse\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: ProcessDiffuse
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub hScrollY_Change()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: hScrollY_Change
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "lblY.Caption = hScrollY.Value & \" px\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: lblY.Caption
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: lblY
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Caption
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "hScrollY.Value & \" px\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: MemberAccessExpression
                                                                            text: hScrollY.Value
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: hScrollY
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Value
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Ampersand
                                                                            text: "&"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: StringLiteralExpression
                                                                            text: "\" px\""
                                                                            is_token: false
                                                                            children:
                                                                              - kind: StringLiteral
                                                                                text: "\" px\""
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "ProcessDiffuse\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: ProcessDiffuse
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub hScrollY_Scroll()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: hScrollY_Scroll
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "lblY.Caption = hScrollY.Value & \" px\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: lblY.Caption
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: lblY
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Caption
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "hScrollY.Value & \" px\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: MemberAccessExpression
                                                                            text: hScrollY.Value
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: hScrollY
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Value
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Ampersand
                                                                            text: "&"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: StringLiteralExpression
                                                                            text: "\" px\""
                                                                            is_token: false
                                                                            children:
                                                                              - kind: StringLiteral
                                                                                text: "\" px\""
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "ProcessDiffuse\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: ProcessDiffuse
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Unknown
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Unknown
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Private Sub MnuOpenImage_Click()\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: PrivateKeyword
                                                                        text: Private
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: MnuOpenImage_Click
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Windows common dialog interface"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Dim cDialog As pdOpenSaveDialog\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: DimKeyword
                                                                        text: Dim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: cDialog
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: pdOpenSaveDialog
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: SetStatement
                                                                    text: "    Set cDialog = New pdOpenSaveDialog\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SetKeyword
                                                                        text: Set
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: cDialog
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NewKeyword
                                                                        text: New
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: pdOpenSaveDialog
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "' subset of modern image file types."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Dim cdfStr As String\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: DimKeyword
                                                                        text: Dim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: cdfStr
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: StringKeyword
                                                                        text: String
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: cdfStr
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: cdfStr
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: StringLiteralExpression
                                                                        text: "\"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: StringLiteral
                                                                            text: "\"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\""
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: cdfStr
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: cdfStr
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: cdfStr
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: cdfStr
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Ampersand
                                                                            text: "&"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: StringLiteralExpression
                                                                            text: "\"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                                                            is_token: false
                                                                            children:
                                                                              - kind: StringLiteral
                                                                                text: "\"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Dim sFile As String\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: DimKeyword
                                                                        text: Dim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: sFile
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: StringKeyword
                                                                        text: String
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: IfStatement
                                                                    text: "    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: "cDialog.GetOpenFileName(sFile, , "
                                                                        is_token: false
                                                                        children:
                                                                          - kind: MemberAccessExpression
                                                                            text: cDialog.GetOpenFileName
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: cDialog
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: GetOpenFileName
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "sFile, , "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: sFile
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: sFile
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: sFile
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Argument
                                                                                text: ","
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: ","
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Comma
                                                                                        text: ","
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: TrueKeyword
                                                                        text: "True"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: FalseKeyword
                                                                        text: "False"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: cdfStr
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: StringLiteral
                                                                        text: "\"Select image\""
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Comma
                                                                        text: ","
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MeKeyword
                                                                        text: Me
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: hWnd
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ThenKeyword
                                                                        text: Then
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Load the image and refresh the effect"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "LoadImageAutosized sFile\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: LoadImageAutosized
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: sFile
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "ProcessDiffuse True\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: ProcessDiffuse
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: TrueKeyword
                                                                        text: "True"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                              - kind: EndKeyword
                                                                text: End
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: EndKeyword
                                                        text: End
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubKeyword
                                                        text: Sub
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: EndOfLineComment
                                                text: "'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: DimStatement
                                            text: "Private Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n"
                                            is_token: false
                                            children:
                                              - kind: PrivateKeyword
                                                text: Private
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubKeyword
                                                text: Sub
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: LoadImageAutosized
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: OptionalKeyword
                                                text: Optional
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ByValKeyword
                                                text: ByVal
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: srcFilePath
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: StringKeyword
                                                text: String
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: vbNullString
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: IfStatement
                                            text: "    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: (LenB(srcFilePath) <> 0)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: LenB(srcFilePath) <> 0
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: LenB(srcFilePath)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: LenB
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: srcFilePath
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: srcFilePath
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: srcFilePath
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: srcFilePath
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: InequalityOperator
                                                        text: "<>"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "0"
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "picBack.Picture = LoadPicture(srcFilePath)\r\n"
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: picBack.Picture
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: picBack
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: Picture
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: CallExpression
                                                    text: LoadPicture(srcFilePath)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: LoadPicture
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: srcFilePath
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: srcFilePath
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: srcFilePath
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: srcFilePath
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "'Copy the image, automatically resized, from the background picture box to the foreground one"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: DimStatement
                                            text: "Dim fDraw As FastDrawing\r\n"
                                            is_token: false
                                            children:
                                              - kind: DimKeyword
                                                text: Dim
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: fDraw
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: FastDrawing
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: SetStatement
                                            text: "    Set fDraw = New FastDrawing\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: SetKeyword
                                                text: Set
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: fDraw
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NewKeyword
                                                text: New
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: FastDrawing
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: DimStatement
                                            text: "Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n"
                                            is_token: false
                                            children:
                                              - kind: DimKeyword
                                                text: Dim
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: ImageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ByteKeyword
                                                text: Byte
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: imgWidth
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LongKeyword
                                                text: Long
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: imgHeight
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LongKeyword
                                                text: Long
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: imgWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: imgWidth
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: fDraw.GetImageWidth(Me.picBack)
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: fDraw.GetImageWidth
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: fDraw
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: GetImageWidth
                                                        is_token: true
                                                        children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: Me.picBack
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: Me.picBack
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: Me.picBack
                                                            is_token: false
                                                            children:
                                                              - kind: MeKeyword
                                                                text: Me
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: picBack
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: imgHeight
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: imgHeight
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: fDraw.GetImageHeight(Me.picBack)
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: fDraw.GetImageHeight
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: fDraw
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: GetImageHeight
                                                        is_token: true
                                                        children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: Me.picBack
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: Me.picBack
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: Me.picBack
                                                            is_token: false
                                                            children:
                                                              - kind: MeKeyword
                                                                text: Me
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: picBack
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: CallStatement
                                            text: "fDraw.GetImageData2D Me.picBack, ImageData()\r\n"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: fDraw
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: GetImageData2D
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MeKeyword
                                                text: Me
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: picBack
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: ImageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "Me.picMain.Width = imgWidth + 2\r\n"
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: Me.picMain.Width
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: Me.picMain
                                                    is_token: false
                                                    children:
                                                      - kind: MeKeyword
                                                        text: Me
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: picMain
                                                        is_token: true
                                                        children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: WidthKeyword
                                                    text: Width
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: imgWidth + 2
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: imgWidth
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: imgWidth
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "2"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "2"
                                                        is_token: true
                                                        children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "Me.picMain.Height = imgHeight + 2\r\n"
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: Me.picMain.Height
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: Me.picMain
                                                    is_token: false
                                                    children:
                                                      - kind: MeKeyword
                                                        text: Me
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: picMain
                                                        is_token: true
                                                        children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Height
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: imgHeight + 2
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: imgHeight
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: imgHeight
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "2"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "2"
                                                        is_token: true
                                                        children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: CallStatement
                                            text: "fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: fDraw
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: SetImageData2D
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MeKeyword
                                                text: Me
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: picMain
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: imgWidth
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: imgHeight
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: ImageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "'Resize the form to automatically contain the new picture box dimensions."
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "' (This performs some sloppy checks to keep the form from resizing larger than the primary display,"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "'  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: DimStatement
                                            text: "Dim newWidth As Long, minWidth As Long\r\n"
                                            is_token: false
                                            children:
                                              - kind: DimKeyword
                                                text: Dim
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: newWidth
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LongKeyword
                                                text: Long
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: minWidth
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AsKeyword
                                                text: As
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LongKeyword
                                                text: Long
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "minWidth = (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: minWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: minWidth
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: (cmdReset.Left + cmdReset.Width + 20) * Screen.TwipsPerPixelX
                                                is_token: false
                                                children:
                                                  - kind: ParenthesizedExpression
                                                    text: (cmdReset.Left + cmdReset.Width + 20)
                                                    is_token: false
                                                    children:
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: cmdReset.Left + cmdReset.Width + 20
                                                        is_token: false
                                                        children:
                                                          - kind: BinaryExpression
                                                            text: cmdReset.Left + cmdReset.Width
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: cmdReset.Left
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: cmdReset
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Left
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MemberAccessExpression
                                                                text: cmdReset.Width
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: cmdReset
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: WidthKeyword
                                                                    text: Width
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AdditionOperator
                                                            text: +
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "20"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "20"
                                                                is_token: true
                                                                children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: MultiplicationOperator
                                                    text: "*"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: MemberAccessExpression
                                                    text: Screen.TwipsPerPixelX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: Screen
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: TwipsPerPixelX
                                                        is_token: true
                                                        children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: IfStatement
                                            text: "    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: "(imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50)"
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: "imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: imgWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: imgWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: LessThanOperator
                                                        text: "<"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: "(Screen.Width \\ Screen.TwipsPerPixelX) - 50"
                                                        is_token: false
                                                        children:
                                                          - kind: ParenthesizedExpression
                                                            text: "(Screen.Width \\ Screen.TwipsPerPixelX)"
                                                            is_token: false
                                                            children:
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: "Screen.Width \\ Screen.TwipsPerPixelX"
                                                                is_token: false
                                                                children:
                                                                  - kind: MemberAccessExpression
                                                                    text: Screen.Width
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: Screen
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: WidthKeyword
                                                                        text: Width
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BackwardSlashOperator
                                                                    text: "\\"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: MemberAccessExpression
                                                                    text: Screen.TwipsPerPixelX
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: Screen
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: TwipsPerPixelX
                                                                        is_token: true
                                                                        children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: SubtractionOperator
                                                            text: "-"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "50"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "50"
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: CodeBlock
                                                text: "        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n'If the user changes any of the available options, this routine will be triggered.\r\n' All it does is call the diffuse function with proper values.\r\nPrivate Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n\r\n    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n    \r\n    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n    \r\nEnd Sub\r\n"
                                                is_token: false
                                                children:
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: newWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: newWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX
                                                        is_token: false
                                                        children:
                                                          - kind: ParenthesizedExpression
                                                            text: (imgWidth + picMain.Left * 4)
                                                            is_token: false
                                                            children:
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: imgWidth + picMain.Left * 4
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: imgWidth
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: imgWidth
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: picMain.Left * 4
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: picMain.Left
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: picMain
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Left
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "4"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "4"
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MemberAccessExpression
                                                            text: Screen.TwipsPerPixelX
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Screen
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: TwipsPerPixelX
                                                                is_token: true
                                                                children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: IfStatement
                                                    text: "        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ParenthesizedExpression
                                                        text: (newWidth < minWidth)
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: newWidth < minWidth
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: newWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: newWidth
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: LessThanOperator
                                                                text: "<"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: minWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: minWidth
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "newWidth = minWidth\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: newWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: newWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: minWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: minWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "Me.Width = newWidth\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: Me.Width
                                                            is_token: false
                                                            children:
                                                              - kind: MeKeyword
                                                                text: Me
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: WidthKeyword
                                                                text: Width
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: newWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: newWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndKeyword
                                                        text: End
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: " If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\nEnd Sub\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: "\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: IfStatement
                                                            text: "If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n    \r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: "(imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50)"
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: "imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: imgHeight
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: imgHeight
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LessThanOperator
                                                                        text: "<"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: "(Screen.Height \\ Screen.TwipsPerPixelY) - 50"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: ParenthesizedExpression
                                                                            text: "(Screen.Height \\ Screen.TwipsPerPixelY)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: "Screen.Height \\ Screen.TwipsPerPixelY"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: MemberAccessExpression
                                                                                    text: Screen.Height
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: Screen
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: PeriodOperator
                                                                                        text: "."
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: Height
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BackwardSlashOperator
                                                                                    text: "\\"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: MemberAccessExpression
                                                                                    text: Screen.TwipsPerPixelY
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: Screen
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: PeriodOperator
                                                                                        text: "."
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: TwipsPerPixelY
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubtractionOperator
                                                                            text: "-"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "50"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "50"
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ThenKeyword
                                                                text: Then
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "Me.Height = (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: MemberAccessExpression
                                                                    text: Me.Height
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MeKeyword
                                                                        text: Me
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: Height
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: (imgHeight + picMain.TOp * 1.75) * Screen.TwipsPerPixelY
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ParenthesizedExpression
                                                                        text: (imgHeight + picMain.TOp * 1.75)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: imgHeight + picMain.TOp * 1.75
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: imgHeight
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: imgHeight
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AdditionOperator
                                                                                text: +
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: picMain.TOp * 1.75
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: MemberAccessExpression
                                                                                    text: picMain.TOp
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: picMain
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: PeriodOperator
                                                                                        text: "."
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: TOp
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: MultiplicationOperator
                                                                                    text: "*"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1.75"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: SingleLiteral
                                                                                        text: "1.75"
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MemberAccessExpression
                                                                        text: Screen.TwipsPerPixelY
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: Screen
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: TwipsPerPixelY
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: EndKeyword
                                                            text: End
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: SubKeyword
                                                            text: Sub
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: EndOfLineComment
                                                    text: "'If the user changes any of the available options, this routine will be triggered."
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: EndOfLineComment
                                                    text: "' All it does is call the diffuse function with proper values."
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: DimStatement
                                                    text: "Private Sub ProcessDiffuse(Optional ByVal updateScrollLimits As Boolean = False)\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: PrivateKeyword
                                                        text: Private
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubKeyword
                                                        text: Sub
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: ProcessDiffuse
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: OptionalKeyword
                                                        text: Optional
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ByValKeyword
                                                        text: ByVal
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: updateScrollLimits
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AsKeyword
                                                        text: As
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BooleanKeyword
                                                        text: Boolean
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: FalseKeyword
                                                        text: "False"
                                                        is_token: true
                                                        children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: "    If updateScrollLimits Then\r\n        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    End If\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: updateScrollLimits
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: updateScrollLimits
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: CodeBlock
                                                        text: "        hScrollX.Min = 0\r\n        hScrollX.Max = picBack.ScaleWidth\r\n        hScrollY.Min = 0\r\n        hScrollY.Max = picBack.ScaleHeight\r\n    "
                                                        is_token: false
                                                        children:
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "hScrollX.Min = 0\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: hScrollX.Min
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: hScrollX
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Min
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "hScrollX.Max = picBack.ScaleWidth\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: hScrollX.Max
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: hScrollX
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Max
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MemberAccessExpression
                                                                text: picBack.ScaleWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: picBack
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: ScaleWidth
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "hScrollY.Min = 0\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: hScrollY.Min
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: hScrollY
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Min
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "hScrollY.Max = picBack.ScaleHeight\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: hScrollY.Max
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: hScrollY
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Max
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MemberAccessExpression
                                                                text: picBack.ScaleHeight
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: picBack
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: ScaleHeight
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                      - kind: EndKeyword
                                                        text: End
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "    "
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: "    If (chkWrap.Value = vbChecked) Then\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    End If\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ParenthesizedExpression
                                                        text: (chkWrap.Value = vbChecked)
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: chkWrap.Value = vbChecked
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: chkWrap.Value
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: chkWrap
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Value
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: vbChecked
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: vbChecked
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: CodeBlock
                                                        text: "        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n    "
                                                        is_token: false
                                                        children:
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallStatement
                                                            text: "DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, True\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: DrawDiffuse
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: picBack
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: picMain
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: hScrollX
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Value
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: hScrollY
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Value
                                                                is_token: true
                                                                children: []
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: TrueKeyword
                                                                text: "True"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                      - kind: ElseClause
                                                        text: "Else\r\n        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    "
                                                        is_token: false
                                                        children:
                                                          - kind: ElseKeyword
                                                            text: Else
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: CodeBlock
                                                            text: "        DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n    "
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "        "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallStatement
                                                                text: "DrawDiffuse picBack, picMain, hScrollX.Value, hScrollY.Value, False\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: DrawDiffuse
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: picBack
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: picMain
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: hScrollX
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Value
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: hScrollY
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Value
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: FalseKeyword
                                                                    text: "False"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                      - kind: EndKeyword
                                                        text: End
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "    "
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: Unknown
                                                    text: End
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Unknown
                                                    text: Sub
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
