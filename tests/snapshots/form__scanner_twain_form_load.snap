---
source: tests/form.rs
expression: form_file
---
form:
  name: frmScanner
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          System:
            index: 5
        border_style: Sizable
        caption: VB6 Scanner Interface by Tanner Helland - www.tannerhelland.com
        client_height: 7500
        client_left: 120
        client_top: 450
        client_width: 10560
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: HasContext
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 500
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 704
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: frameScanOptions
          tag: ""
          index: 0
          kind:
            Frame:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                caption: "Scan Options:"
                clip_controls: Clipped
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 1455
                help_context_id: 0
                left: 240
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 6
                tool_tip_text: ""
                top: 2640
                visible: Visible
                whats_this_help_id: 0
                width: 2895
              controls:
                - name: optLoadImage
                  tag: ""
                  index: 0
                  kind:
                    OptionButton:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        back_color:
                          System:
                            index: 5
                        caption: Load image at original size
                        causes_validation: "Yes"
                        disabled_picture: ~
                        down_picture: ~
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        help_context_id: 0
                        left: 120
                        mask_color:
                          RGB:
                            red: 192
                            green: 192
                            blue: 192
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        picture: ~
                        right_to_left: LeftToRight
                        style: Standard
                        tab_index: 8
                        tab_stop: Included
                        tool_tip_text: ""
                        top: 480
                        use_mask_color: DoNotUseMaskColor
                        value: UnSelected
                        visible: Visible
                        whats_this_help_id: 0
                        width: 2655
                - name: optLoadImage
                  tag: ""
                  index: 1
                  kind:
                    OptionButton:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        back_color:
                          System:
                            index: 5
                        caption: Resize image to fit the picture box on the right
                        causes_validation: "Yes"
                        disabled_picture: ~
                        down_picture: ~
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 375
                        help_context_id: 0
                        left: 120
                        mask_color:
                          RGB:
                            red: 192
                            green: 192
                            blue: 192
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        picture: ~
                        right_to_left: LeftToRight
                        style: Standard
                        tab_index: 7
                        tab_stop: Included
                        tool_tip_text: ""
                        top: 840
                        use_mask_color: DoNotUseMaskColor
                        value: UnSelected
                        visible: Visible
                        whats_this_help_id: 0
                        width: 2655
        - name: picBuffer
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 615
                help_context_id: 0
                left: 240
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 39
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 39
                tab_index: 4
                tab_stop: Included
                tool_tip_text: ""
                top: 5400
                visible: Visible
                whats_this_help_id: 0
                width: 615
              controls: []
        - name: picScan
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 6975
                help_context_id: 0
                left: 3480
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 463
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 463
                tab_index: 2
                tab_stop: Included
                tool_tip_text: ""
                top: 360
                visible: Visible
                whats_this_help_id: 0
                width: 6975
              controls: []
        - name: cmdScanImage
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: "Step 2: Scan Image"
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 615
                help_context_id: 0
                left: 240
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 1
                tab_stop: Included
                tool_tip_text: ""
                top: 1800
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 2895
        - name: cmdSelectScanner
          tag: ""
          index: 0
          kind:
            CommandButton:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 15
                cancel: false
                caption: "Step 1: Select Scanner (optional)"
                causes_validation: "Yes"
                default: false
                disabled_picture: ~
                down_picture: ~
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                height: 615
                help_context_id: 0
                left: 240
                mask_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                style: Standard
                tab_index: 0
                tab_stop: Included
                tool_tip_text: ""
                top: 360
                use_mask_color: DoNotUseMaskColor
                whats_this_help_id: 0
                width: 2895
        - name: Label1
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 15
                back_style: Opaque
                border_style: None
                caption: "(If a scanner is not manually selected, the program will use the default system scanner)"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  RGB:
                    red: 64
                    green: 64
                    blue: 64
                height: 615
                left: 240
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 5
                tool_tip_text: ""
                top: 1080
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 2895
                word_wrap: NonWrapping
        - name: lblSuccess
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: Image acquired successfully!
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  RGB:
                    red: 0
                    green: 0
                    blue: 192
                height: 375
                left: 240
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 3
                tool_tip_text: ""
                top: 4320
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 2895
                word_wrap: NonWrapping
      menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmScanner
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'This project includes code for basic scanner interaction.  It's primarily an interface to the\r\n' \"EZTW32\" DLL file, which is required because VB does not have native scanner support.\r\n'\r\n'The EZTW32 library is a free, public domain TWAIN32-compliant library.  You can learn more\r\n' about it at http://eztwain.com/\r\n'\r\n'This project was designed against v1.19 of the EZTW32 library (2009.02.22).  It may not work with\r\n' other versions of the library.  Additional documentation regarding the use of EZTW32 is\r\n' available from the EZTW32 developers at http://eztwain.com/ezt1_download.htm\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\n\r\nOption Explicit\r\n\r\n'EZTW32 functions for interfacing with a scanner\r\nPrivate Declare Function TWAIN_AcquireToFilename Lib \"EZTW32.dll\" (ByVal hwndApp As Long, ByVal sFile As String) As Long\r\nPrivate Declare Function TWAIN_SelectImageSource Lib \"EZTW32.dll\" (ByVal hwndApp As Long) As Long\r\nPrivate Declare Function TWAIN_IsAvailable Lib \"EZTW32.dll\" () As Long\r\n\r\n'API calls for explicitly allocating DLLs.  These allow you to load a DLL from an arbitrary location\r\n' (i.e. without manually copying it into your system directory)\r\nPrivate Declare Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As Long\r\nPrivate Declare Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As Long) As Long\r\n\r\n'API calls for resizing an image (faster and more accurate than VB's PaintPicture function)\r\nPrivate Declare Function StretchBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal ClipX As Long, ByVal ClipY As Long, ByVal dwRop As Long) As Long\r\nPrivate Declare Function SetStretchBltMode Lib \"gdi32\" (ByVal hDestDC As Long, ByVal nStretchMode As Long) As Long\r\nPrivate Const STRETCHBLT_HALFTONE As Long = 4\r\n\r\n'Used to store the memory address of the EZTW32 library once it's been loaded\r\nDim hLib As Long\r\n\r\n'Location of the project's folder (used to find the required DLL)\r\nDim ProgramPath As String\r\n\r\n'Whether or not a valid scanner is available for use\r\nDim ScanEnabled As Boolean\r\n\r\nPrivate Sub cmdScanImage_Click()\r\n\r\n    'If this is not the first scan the user has performed, hide the \"successful scan\" label\r\n    lblSuccess.Visible = False\r\n\r\n    'Make sure that the scanner was successfully found before attempting to scan an image\r\n    If (Not ScanEnabled) Then\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n\r\n    'Basic scanner capture code\r\n    On Error GoTo ScanError\r\n    Dim ScannerCaptureFile As String, ScanCheck As Long\r\n    'ScanCheck is used to store the return values of the EZTW32.dll scanner functions.  We start by setting it\r\n    ' to an arbitrary value that only we know; if an error occurs and this value is still present, it means an\r\n    ' error occurred outside of the EZTW32 library.\r\n    ScanCheck = -5\r\n    \r\n    'A temporary file is required by the scanner; we will place it in the project folder, then delete it when finished\r\n    ScannerCaptureFile = ProgramPath & \"VBScanInterface.bmp\"\r\n    \r\n    'This line uses the EZTW32.dll file to scan the image and send it to a temporary file\r\n    ScanCheck = TWAIN_AcquireToFilename(frmScanner.hWnd, ScannerCaptureFile)\r\n    \r\n    'If the image was successfully scanned, load it into the available picture box\r\n    If ScanCheck = 0 Then\r\n        picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n        \r\n        'Be polite and remove the temporary file acquired from the scanner\r\n        Kill ScannerCaptureFile\r\n        \r\n        'Resize the image if the user has requested it\r\n        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n        \r\n        'Let the user know that everything worked\r\n        lblSuccess.Visible = True\r\n        \r\n        'Return focus to this project\r\n        frmScanner.SetFocus\r\n    Else\r\n        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    End If\r\n    \r\n    Exit Sub\r\n\r\n'Something went wrong\r\nScanError:\r\n    \r\n    Dim scanErrMessage As String\r\n    \r\n    Select Case ScanCheck\r\n        Case -5\r\n            scanErrMessage = \"Unknown error occurred.\"\r\n        Case -4\r\n            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        Case -3\r\n            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        Case -2\r\n            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        Case -1\r\n            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        Case Else\r\n            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    End Select\r\n    \r\n    MsgBox scanErrMessage, vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n\r\nEnd Sub\r\n\r\n'This button allows the user to select which scanner they want to use.  If the user does not select a scanner, the default system scanner will be used.\r\nPrivate Sub cmdSelectScanner_Click()\r\n    \r\n    'Only launch the scanner select form if the EZTW32.dll file was successfully found at program load\r\n    If ScanEnabled Then\r\n        TWAIN_SelectImageSource (frmScanner.hWnd)\r\n    Else\r\n    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the project is first loaded, several parameters need to be determined.\r\nPrivate Sub Form_Load()\r\n    \r\n    'Remember the folder from which the program was launched\r\n    ProgramPath = App.Path\r\n    If Right(ProgramPath, 1) <> \"\\\" Then ProgramPath = ProgramPath & \"\\\"\r\n\r\n    'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to\r\n    ' copy the file into their system directory.  However, it requires a bit of extra code.\r\n    hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n\r\n    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \r\n    'Unload the scanner DLL from memory.\r\n    FreeLibrary hLib\r\n    \r\nEnd Sub\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This project includes code for basic scanner interaction.  It's primarily an interface to the"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' \"EZTW32\" DLL file, which is required because VB does not have native scanner support."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The EZTW32 library is a free, public domain TWAIN32-compliant library.  You can learn more"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' about it at http://eztwain.com/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This project was designed against v1.19 of the EZTW32 library (2009.02.22).  It may not work with"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' other versions of the library.  Additional documentation regarding the use of EZTW32 is"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' available from the EZTW32 developers at http://eztwain.com/ezt1_download.htm"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'EZTW32 functions for interfacing with a scanner"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function TWAIN_AcquireToFilename Lib \"EZTW32.dll\" (ByVal hwndApp As Long, ByVal sFile As String) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: TWAIN_AcquireToFilename
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"EZTW32.dll\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hwndApp As Long, ByVal sFile As String)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hwndApp
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: sFile
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function TWAIN_SelectImageSource Lib \"EZTW32.dll\" (ByVal hwndApp As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: TWAIN_SelectImageSource
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"EZTW32.dll\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal hwndApp As Long)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hwndApp
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function TWAIN_IsAvailable Lib \"EZTW32.dll\" () As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: TWAIN_IsAvailable
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"EZTW32.dll\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'API calls for explicitly allocating DLLs.  These allow you to load a DLL from an arbitrary location"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' (i.e. without manually copying it into your system directory)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: LoadLibrary
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"kernel32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AliasKeyword
            text: Alias
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"LoadLibraryA\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal lpLibFileName As String)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpLibFileName
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: FreeLibrary
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"kernel32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal hLibModule As Long)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hLibModule
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'API calls for resizing an image (faster and more accurate than VB's PaintPicture function)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function StretchBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal ClipX As Long, ByVal ClipY As Long, ByVal dwRop As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: StretchBlt
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDestDC As Long, ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal ClipX As Long, ByVal ClipY As Long, ByVal dwRop As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDestDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: X
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hSrcDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: xSrc
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ySrc
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ClipX
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ClipY
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dwRop
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function SetStretchBltMode Lib \"gdi32\" (ByVal hDestDC As Long, ByVal nStretchMode As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: SetStretchBltMode
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDestDC As Long, ByVal nStretchMode As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDestDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nStretchMode
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private Const STRETCHBLT_HALFTONE As Long = 4\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: STRETCHBLT_HALFTONE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "4"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Used to store the memory address of the EZTW32 library once it's been loaded"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim hLib As Long\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: hLib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Location of the project's folder (used to find the required DLL)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim ProgramPath As String\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: ProgramPath
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Whether or not a valid scanner is available for use"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim ScanEnabled As Boolean\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: ScanEnabled
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmdScanImage_Click()\r\n\r\n    'If this is not the first scan the user has performed, hide the \"successful scan\" label\r\n    lblSuccess.Visible = False\r\n\r\n    'Make sure that the scanner was successfully found before attempting to scan an image\r\n    If (Not ScanEnabled) Then\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n\r\n    'Basic scanner capture code\r\n    On Error GoTo ScanError\r\n    Dim ScannerCaptureFile As String, ScanCheck As Long\r\n    'ScanCheck is used to store the return values of the EZTW32.dll scanner functions.  We start by setting it\r\n    ' to an arbitrary value that only we know; if an error occurs and this value is still present, it means an\r\n    ' error occurred outside of the EZTW32 library.\r\n    ScanCheck = -5\r\n    \r\n    'A temporary file is required by the scanner; we will place it in the project folder, then delete it when finished\r\n    ScannerCaptureFile = ProgramPath & \"VBScanInterface.bmp\"\r\n    \r\n    'This line uses the EZTW32.dll file to scan the image and send it to a temporary file\r\n    ScanCheck = TWAIN_AcquireToFilename(frmScanner.hWnd, ScannerCaptureFile)\r\n    \r\n    'If the image was successfully scanned, load it into the available picture box\r\n    If ScanCheck = 0 Then\r\n        picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n        \r\n        'Be polite and remove the temporary file acquired from the scanner\r\n        Kill ScannerCaptureFile\r\n        \r\n        'Resize the image if the user has requested it\r\n        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n        \r\n        'Let the user know that everything worked\r\n        lblSuccess.Visible = True\r\n        \r\n        'Return focus to this project\r\n        frmScanner.SetFocus\r\n    Else\r\n        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    End If\r\n    \r\n    Exit Sub\r\n\r\n'Something went wrong\r\nScanError:\r\n    \r\n    Dim scanErrMessage As String\r\n    \r\n    Select Case ScanCheck\r\n        Case -5\r\n            scanErrMessage = \"Unknown error occurred.\"\r\n        Case -4\r\n            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        Case -3\r\n            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        Case -2\r\n            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        Case -1\r\n            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        Case Else\r\n            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    End Select\r\n    \r\n    MsgBox scanErrMessage, vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmdScanImage_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "\r\n    'If this is not the first scan the user has performed, hide the \"successful scan\" label\r\n    lblSuccess.Visible = False\r\n\r\n    'Make sure that the scanner was successfully found before attempting to scan an image\r\n    If (Not ScanEnabled) Then\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n\r\n    'Basic scanner capture code\r\n    On Error GoTo ScanError\r\n    Dim ScannerCaptureFile As String, ScanCheck As Long\r\n    'ScanCheck is used to store the return values of the EZTW32.dll scanner functions.  We start by setting it\r\n    ' to an arbitrary value that only we know; if an error occurs and this value is still present, it means an\r\n    ' error occurred outside of the EZTW32 library.\r\n    ScanCheck = -5\r\n    \r\n    'A temporary file is required by the scanner; we will place it in the project folder, then delete it when finished\r\n    ScannerCaptureFile = ProgramPath & \"VBScanInterface.bmp\"\r\n    \r\n    'This line uses the EZTW32.dll file to scan the image and send it to a temporary file\r\n    ScanCheck = TWAIN_AcquireToFilename(frmScanner.hWnd, ScannerCaptureFile)\r\n    \r\n    'If the image was successfully scanned, load it into the available picture box\r\n    If ScanCheck = 0 Then\r\n        picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n        \r\n        'Be polite and remove the temporary file acquired from the scanner\r\n        Kill ScannerCaptureFile\r\n        \r\n        'Resize the image if the user has requested it\r\n        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n        \r\n        'Let the user know that everything worked\r\n        lblSuccess.Visible = True\r\n        \r\n        'Return focus to this project\r\n        frmScanner.SetFocus\r\n    Else\r\n        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    End If\r\n    \r\n    Exit Sub\r\n\r\n'Something went wrong\r\nScanError:\r\n    \r\n    Dim scanErrMessage As String\r\n    \r\n    Select Case ScanCheck\r\n        Case -5\r\n            scanErrMessage = \"Unknown error occurred.\"\r\n        Case -4\r\n            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        Case -3\r\n            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        Case -2\r\n            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        Case -1\r\n            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        Case Else\r\n            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    End Select\r\n    \r\n    MsgBox scanErrMessage, vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n\r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If this is not the first scan the user has performed, hide the \"successful scan\" label"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lblSuccess.Visible = False\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: lblSuccess.Visible
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lblSuccess
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Visible
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BooleanLiteralExpression
                    text: "False"
                    is_token: false
                    children:
                      - kind: FalseKeyword
                        text: "False"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Make sure that the scanner was successfully found before attempting to scan an image"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (Not ScanEnabled) Then\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ParenthesizedExpression
                    text: (Not ScanEnabled)
                    is_token: false
                    children:
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: UnaryExpression
                        text: Not ScanEnabled
                        is_token: false
                        children:
                          - kind: NotKeyword
                            text: Not
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: ScanEnabled
                            is_token: false
                            children:
                              - kind: Identifier
                                text: ScanEnabled
                                is_token: true
                                children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: MsgBox
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteral
                            text: "\"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\""
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Ampersand
                            text: "&"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbCrLf
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Ampersand
                            text: "&"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbCrLf
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Ampersand
                            text: "&"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteral
                            text: "\"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\""
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbCritical
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AdditionOperator
                            text: +
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbOKOnly
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AdditionOperator
                            text: +
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbApplicationModal
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteral
                            text: "\"Scanner Interface Error\""
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: ExitStatement
                        text: "        Exit Sub\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: ExitKeyword
                            text: Exit
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubKeyword
                            text: Sub
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Basic scanner capture code"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: OnErrorStatement
                text: "    On Error GoTo ScanError\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: OnKeyword
                    text: "On"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ErrorKeyword
                    text: Error
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: GotoKeyword
                    text: GoTo
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ScanError
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim ScannerCaptureFile As String, ScanCheck As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ScannerCaptureFile
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringKeyword
                    text: String
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ScanCheck
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'ScanCheck is used to store the return values of the EZTW32.dll scanner functions.  We start by setting it"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' to an arbitrary value that only we know; if an error occurs and this value is still present, it means an"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' error occurred outside of the EZTW32 library."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ScanCheck = -5\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ScanCheck
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ScanCheck
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-5"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "5"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "5"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'A temporary file is required by the scanner; we will place it in the project folder, then delete it when finished"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ScannerCaptureFile = ProgramPath & \"VBScanInterface.bmp\"\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ScannerCaptureFile
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ScannerCaptureFile
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "ProgramPath & \"VBScanInterface.bmp\""
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: ProgramPath
                        is_token: false
                        children:
                          - kind: Identifier
                            text: ProgramPath
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: StringLiteralExpression
                        text: "\"VBScanInterface.bmp\""
                        is_token: false
                        children:
                          - kind: StringLiteral
                            text: "\"VBScanInterface.bmp\""
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This line uses the EZTW32.dll file to scan the image and send it to a temporary file"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ScanCheck = TWAIN_AcquireToFilename(frmScanner.hWnd, ScannerCaptureFile)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ScanCheck
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ScanCheck
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "TWAIN_AcquireToFilename(frmScanner.hWnd, ScannerCaptureFile)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: TWAIN_AcquireToFilename
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "frmScanner.hWnd, ScannerCaptureFile"
                        is_token: false
                        children:
                          - kind: Argument
                            text: frmScanner.hWnd
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: frmScanner.hWnd
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: frmScanner
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: hWnd
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: ScannerCaptureFile
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: ScannerCaptureFile
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: ScannerCaptureFile
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If the image was successfully scanned, load it into the available picture box"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If ScanCheck = 0 Then\r\n        picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n        \r\n        'Be polite and remove the temporary file acquired from the scanner\r\n        Kill ScannerCaptureFile\r\n        \r\n        'Resize the image if the user has requested it\r\n        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n        \r\n        'Let the user know that everything worked\r\n        lblSuccess.Visible = True\r\n        \r\n        'Return focus to this project\r\n        frmScanner.SetFocus\r\n    Else\r\n        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: ScanCheck = 0
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: ScanCheck
                        is_token: false
                        children:
                          - kind: Identifier
                            text: ScanCheck
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: EqualityOperator
                        text: "="
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "0"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n        \r\n        'Be polite and remove the temporary file acquired from the scanner\r\n        Kill ScannerCaptureFile\r\n        \r\n        'Resize the image if the user has requested it\r\n        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n        \r\n        'Let the user know that everything worked\r\n        lblSuccess.Visible = True\r\n        \r\n        'Return focus to this project\r\n        frmScanner.SetFocus\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "picBuffer.Picture = LoadPicture(ScannerCaptureFile)\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: picBuffer.Picture
                            is_token: false
                            children:
                              - kind: Identifier
                                text: picBuffer
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: LoadPicture(ScannerCaptureFile)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: LoadPicture
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: ScannerCaptureFile
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: ScannerCaptureFile
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: ScannerCaptureFile
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: ScannerCaptureFile
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Be polite and remove the temporary file acquired from the scanner"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: KillStatement
                        text: "        Kill ScannerCaptureFile\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: KillKeyword
                            text: Kill
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScannerCaptureFile
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Resize the image if the user has requested it"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "        If optLoadImage(0).Value Then\r\n            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MemberAccessExpression
                            text: optLoadImage(0).Value
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: optLoadImage(0)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: optLoadImage
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Value
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            '...no resize\r\n            picScan.AutoSize = True\r\n            picScan.Picture = picBuffer.Picture\r\n            picScan.Refresh\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'...no resize"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picScan.AutoSize = True\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picScan.AutoSize
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: AutoSize
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BooleanLiteralExpression
                                    text: "True"
                                    is_token: false
                                    children:
                                      - kind: TrueKeyword
                                        text: "True"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picScan.Picture = picBuffer.Picture\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picScan.Picture
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: Picture
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MemberAccessExpression
                                    text: picBuffer.Picture
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picBuffer
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: Picture
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "picScan.Refresh\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picScan
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Refresh
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: ElseClause
                            text: "Else\r\n            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        "
                            is_token: false
                            children:
                              - kind: ElseKeyword
                                text: Else
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: CodeBlock
                                text: "            '...resize\r\n            picScan.AutoSize = False\r\n            \r\n            'Setting the HALFTONE mode results in a slower, but higher-quality image resize\r\n            SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n            StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n            picScan.Picture = picScan.Image\r\n            picScan.Refresh\r\n        "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: EndOfLineComment
                                    text: "'...resize"
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "picScan.AutoSize = False\r\n"
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: picScan.AutoSize
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: picScan
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: AutoSize
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BooleanLiteralExpression
                                        text: "False"
                                        is_token: false
                                        children:
                                          - kind: FalseKeyword
                                            text: "False"
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: EndOfLineComment
                                    text: "'Setting the HALFTONE mode results in a slower, but higher-quality image resize"
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: CallStatement
                                    text: "SetStretchBltMode picScan.hDC, STRETCHBLT_HALFTONE\r\n"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: SetStretchBltMode
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: hDC
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: STRETCHBLT_HALFTONE
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: CallStatement
                                    text: "StretchBlt picScan.hDC, 0, 0, picScan.ScaleWidth, picScan.ScaleHeight, picBuffer.hDC, 0, 0, picBuffer.ScaleWidth, picBuffer.ScaleHeight, vbSrcCopy\r\n"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: StretchBlt
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: hDC
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleWidth
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleHeight
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picBuffer
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: hDC
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picBuffer
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleWidth
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: picBuffer
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleHeight
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: vbSrcCopy
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "picScan.Picture = picScan.Image\r\n"
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: picScan.Picture
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: picScan
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Picture
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MemberAccessExpression
                                        text: picScan.Image
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: picScan
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Image
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: CallStatement
                                    text: "picScan.Refresh\r\n"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picScan
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: Refresh
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Let the user know that everything worked"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "lblSuccess.Visible = True\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: lblSuccess.Visible
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lblSuccess
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Visible
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BooleanLiteralExpression
                            text: "True"
                            is_token: false
                            children:
                              - kind: TrueKeyword
                                text: "True"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Return focus to this project"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "frmScanner.SetFocus\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: frmScanner
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: SetFocus
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "        'If the scan was unsuccessful, let the user know what happened\r\n        GoTo ScanError\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'If the scan was unsuccessful, let the user know what happened"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: GotoStatement
                            text: "        GoTo ScanError\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: GotoKeyword
                                text: GoTo
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ScanError
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: ExitStatement
                text: "    Exit Sub\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ExitKeyword
                    text: Exit
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SubKeyword
                    text: Sub
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Something went wrong"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: LabelStatement
                text: "ScanError:\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: ScanError
                    is_token: true
                    children: []
                  - kind: ColonOperator
                    text: ":"
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim scanErrMessage As String\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: scanErrMessage
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringKeyword
                    text: String
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: SelectCaseStatement
                text: "    Select Case ScanCheck\r\n        Case -5\r\n            scanErrMessage = \"Unknown error occurred.\"\r\n        Case -4\r\n            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        Case -3\r\n            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        Case -2\r\n            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        Case -1\r\n            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        Case Else\r\n            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    End Select\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: SelectKeyword
                    text: Select
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CaseKeyword
                    text: Case
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: ScanCheck
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ScanCheck
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: "        "
                    is_token: true
                    children: []
                  - kind: CaseClause
                    text: "Case -5\r\n            scanErrMessage = \"Unknown error occurred.\"\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "5"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"Unknown error occurred.\"\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"Unknown error occurred.\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"Unknown error occurred.\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Unknown error occurred.\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case -4\r\n            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "4"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Scan successful, but temporary file save failed.  Is it possible that your hard drive is full (or almost full)?\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case -3\r\n            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "3"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Unable to acquire DIB lock.  Please make sure no other programs are accessing the scanner.  If the problem persists, reboot and try again.\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case -2\r\n            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "2"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Temporary file access error.  This can be caused when running on a system with limited access rights.  Please enable admin rights and try again.\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case -1\r\n            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"Scan failed.  (This may happen if the user canceled the scan dialog.)\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"Scan failed.  (This may happen if the user canceled the scan dialog.)\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Scan failed.  (This may happen if the user canceled the scan dialog.)\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseElseClause
                    text: "Case Else\r\n            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "scanErrMessage = \"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\"\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: scanErrMessage
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: scanErrMessage
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteralExpression
                                text: "\"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"The scanner returned an error code that wasn't specified in the EZTW32.dll documentation.  Please visit http://www.eztwain.com for more information.\""
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SelectKeyword
                    text: Select
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "MsgBox scanErrMessage, vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: MsgBox
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: scanErrMessage
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: vbCritical
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AdditionOperator
                    text: +
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: vbOKOnly
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AdditionOperator
                    text: +
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: vbApplicationModal
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Scanner Interface Error\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This button allows the user to select which scanner they want to use.  If the user does not select a scanner, the default system scanner will be used."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmdSelectScanner_Click()\r\n    \r\n    'Only launch the scanner select form if the EZTW32.dll file was successfully found at program load\r\n    If ScanEnabled Then\r\n        TWAIN_SelectImageSource (frmScanner.hWnd)\r\n    Else\r\n    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmdSelectScanner_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'Only launch the scanner select form if the EZTW32.dll file was successfully found at program load\r\n    If ScanEnabled Then\r\n        TWAIN_SelectImageSource (frmScanner.hWnd)\r\n    Else\r\n    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Only launch the scanner select form if the EZTW32.dll file was successfully found at program load"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If ScanEnabled Then\r\n        TWAIN_SelectImageSource (frmScanner.hWnd)\r\n    Else\r\n    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: ScanEnabled
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ScanEnabled
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        TWAIN_SelectImageSource (frmScanner.hWnd)\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "TWAIN_SelectImageSource (frmScanner.hWnd)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: TWAIN_SelectImageSource
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: frmScanner
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hWnd
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "    'If the EZTW32.dll file doesn't exist...\r\n        MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n        Exit Sub\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'If the EZTW32.dll file doesn't exist..."
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "MsgBox \"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\" & vbCrLf & vbCrLf & \"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\", vbCritical + vbOKOnly + vbApplicationModal, \"Scanner Interface Error\"\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: MsgBox
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteral
                                text: "\"The scanner/digital camera interface plug-in (EZTW32.dll) was marked as missing upon program initialization.\""
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbCrLf
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbCrLf
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteral
                                text: "\"To enable scanner support, please copy the EZTW32.dll file (available for download from http://eztwain.com/ezt1_download.htm) into this application directory and reload the program.\""
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbCritical
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: AdditionOperator
                                text: +
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbOKOnly
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: AdditionOperator
                                text: +
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbApplicationModal
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: StringLiteral
                                text: "\"Scanner Interface Error\""
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: ExitStatement
                            text: "        Exit Sub\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: ExitKeyword
                                text: Exit
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubKeyword
                                text: Sub
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When the project is first loaded, several parameters need to be determined."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub Form_Load()\r\n    \r\n    'Remember the folder from which the program was launched\r\n    ProgramPath = App.Path\r\n    If Right(ProgramPath, 1) <> \"\\\" Then ProgramPath = ProgramPath & \"\\\"\r\n\r\n    'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to\r\n    ' copy the file into their system directory.  However, it requires a bit of extra code.\r\n    hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n\r\n    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \r\n    'Unload the scanner DLL from memory.\r\n    FreeLibrary hLib\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: Form_Load
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'Remember the folder from which the program was launched\r\n    ProgramPath = App.Path\r\n    If Right(ProgramPath, 1) <> \"\\\" Then ProgramPath = ProgramPath & \"\\\"\r\n\r\n    'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to\r\n    ' copy the file into their system directory.  However, it requires a bit of extra code.\r\n    hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n\r\n    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \r\n    'Unload the scanner DLL from memory.\r\n    FreeLibrary hLib\r\n    \r\nEnd Sub\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Remember the folder from which the program was launched"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ProgramPath = App.Path\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ProgramPath
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ProgramPath
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: App.Path
                    is_token: false
                    children:
                      - kind: Identifier
                        text: App
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Path
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: IfStatement
                text: "    If Right(ProgramPath, 1) <> \"\\\" Then ProgramPath = ProgramPath & \"\\\"\r\n\r\n    'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to\r\n    ' copy the file into their system directory.  However, it requires a bit of extra code.\r\n    hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n\r\n    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \r\n    'Unload the scanner DLL from memory.\r\n    FreeLibrary hLib\r\n    \r\nEnd Sub\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "Right(ProgramPath, 1) <> \"\\\" Then ProgramPath = ProgramPath & \"\\\""
                    is_token: false
                    children:
                      - kind: CallExpression
                        text: "Right(ProgramPath, 1)"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Right
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: ArgumentList
                            text: "ProgramPath, 1"
                            is_token: false
                            children:
                              - kind: Argument
                                text: ProgramPath
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: ProgramPath
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: ProgramPath
                                        is_token: true
                                        children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Argument
                                text: "1"
                                is_token: false
                                children:
                                  - kind: NumericLiteralExpression
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "1"
                                        is_token: true
                                        children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: InequalityOperator
                        text: "<>"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: "\"\\\" Then ProgramPath = ProgramPath & \"\\\""
                        is_token: false
                        children:
                          - kind: StringLiteralExpression
                            text: "\"\\\" Then ProgramPath = ProgramPath & \""
                            is_token: false
                            children:
                              - kind: StringLiteral
                                text: "\"\\\" Then ProgramPath = ProgramPath & \""
                                is_token: true
                                children: []
                          - kind: BackwardSlashOperator
                            text: "\\"
                            is_token: true
                            children: []
                          - kind: StringLiteralExpression
                            text: "\""
                            is_token: false
                            children:
                              - kind: StringLiteral
                                text: "\""
                                is_token: true
                                children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "\r\n    'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to\r\n    ' copy the file into their system directory.  However, it requires a bit of extra code.\r\n    hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n\r\n    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \r\n    'Unload the scanner DLL from memory.\r\n    FreeLibrary hLib\r\n    \r\nEnd Sub\r\n"
                    is_token: false
                    children:
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'This code allows us to load the scanner DLL from any location; this is easier than forcing the user to"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' copy the file into their system directory.  However, it requires a bit of extra code."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "hLib = LoadLibrary(ProgramPath & \"EZTW32.dll\")\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: hLib
                            is_token: false
                            children:
                              - kind: Identifier
                                text: hLib
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: "LoadLibrary(ProgramPath & \"EZTW32.dll\")"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: LoadLibrary
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: "ProgramPath & \"EZTW32.dll\""
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: "ProgramPath & \"EZTW32.dll\""
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: "ProgramPath & \"EZTW32.dll\""
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: ProgramPath
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: ProgramPath
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Ampersand
                                            text: "&"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: StringLiteralExpression
                                            text: "\"EZTW32.dll\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\"EZTW32.dll\""
                                                is_token: true
                                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "    If TWAIN_IsAvailable() = 0 Then\r\n        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    Else\r\n        ScanEnabled = True\r\n    End If\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: TWAIN_IsAvailable() = 0
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: TWAIN_IsAvailable()
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: TWAIN_IsAvailable
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: ""
                                    is_token: false
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "        ScanEnabled = False\r\n        MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n    "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "ScanEnabled = False\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: ScanEnabled
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: ScanEnabled
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BooleanLiteralExpression
                                    text: "False"
                                    is_token: false
                                    children:
                                      - kind: FalseKeyword
                                        text: "False"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "MsgBox \"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\", vbOKOnly + vbCritical, \"Scanner DLL missing\"\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: MsgBox
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringLiteral
                                    text: "\"Unfortunately, this program was unable to locate the DLL file necessary for scanner support.  Please ensure that a file called EZTW32.dll is located in the same directory as this project file, then restart the project.  Thanks!\""
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: vbOKOnly
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AdditionOperator
                                    text: +
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: vbCritical
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringLiteral
                                    text: "\"Scanner DLL missing\""
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                          - kind: ElseClause
                            text: "Else\r\n        ScanEnabled = True\r\n    "
                            is_token: false
                            children:
                              - kind: ElseKeyword
                                text: Else
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: CodeBlock
                                text: "        ScanEnabled = True\r\n    "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "ScanEnabled = True\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: ScanEnabled
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: ScanEnabled
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BooleanLiteralExpression
                                        text: "True"
                                        is_token: false
                                        children:
                                          - kind: TrueKeyword
                                            text: "True"
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "    "
                                    is_token: true
                                    children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: End
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: Sub
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Private Sub Form_Unload(Cancel As Integer)\r\n"
                        is_token: false
                        children:
                          - kind: PrivateKeyword
                            text: Private
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubKeyword
                            text: Sub
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Form_Unload
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Cancel
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerKeyword
                            text: Integer
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Unload the scanner DLL from memory."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "FreeLibrary hLib\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: FreeLibrary
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hLib
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: End
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: Sub
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
