---
source: tests/form.rs
expression: form_file
---
form:
  name: frmHistogram
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          RGB:
            red: 192
            green: 192
            blue: 192
        border_style: Sizable
        caption: " Histogram"
        client_height: 6810
        client_left: 13200
        client_top: 2805
        client_width: 4125
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: HasContext
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 454
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 275
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: Frame1
          tag: ""
          index: 0
          kind:
            Frame:
              properties:
                appearance: ThreeD
                back_color:
                  RGB:
                    red: 192
                    green: 192
                    blue: 192
                border_style: FixedSingle
                caption: Statistics
                clip_controls: Clipped
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 18
                height: 1455
                help_context_id: 0
                left: 120
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 6
                tool_tip_text: ""
                top: 5280
                visible: Visible
                whats_this_help_id: 0
                width: 3855
              controls:
                - name: lblMaxCount
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: ""
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        left: 1320
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 13
                        tool_tip_text: ""
                        top: 1080
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 2415
                        word_wrap: NonWrapping
                - name: Label5
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: "Maximum count:"
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 210
                        left: 120
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 12
                        tool_tip_text: ""
                        top: 1080
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 1155
                        word_wrap: NonWrapping
                - name: lblCount
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: ""
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        left: 600
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 11
                        tool_tip_text: ""
                        top: 840
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 3135
                        word_wrap: NonWrapping
                - name: Label4
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: "Count:"
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        left: 120
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 10
                        tool_tip_text: ""
                        top: 840
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 495
                        word_wrap: NonWrapping
                - name: lblLevel
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: ""
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        left: 600
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 9
                        tool_tip_text: ""
                        top: 600
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 3135
                        word_wrap: NonWrapping
                - name: Line1
                  tag: ""
                  index: 0
                  kind:
                    Line:
                      properties:
                        border_color:
                          System:
                            index: 8
                        border_style: Solid
                        border_width: 1
                        draw_mode: CopyPen
                        visible: Visible
                        x1: 120
                        y1: 530
                        x2: 3720
                        y2: 530
                - name: Label3
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: "Level:"
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 255
                        left: 120
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 8
                        tool_tip_text: ""
                        top: 600
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 495
                        word_wrap: NonWrapping
                - name: lblTotalPixels
                  tag: ""
                  index: 0
                  kind:
                    Label:
                      properties:
                        alignment: LeftJustify
                        appearance: ThreeD
                        auto_size: Fixed
                        back_color:
                          System:
                            index: 5
                        back_style: Opaque
                        border_style: None
                        caption: "Total pixels:"
                        data_field: ""
                        data_format: ""
                        data_member: ""
                        data_source: ""
                        drag_icon: ~
                        drag_mode: Manual
                        enabled: Enabled
                        fore_color:
                          System:
                            index: 8
                        height: 210
                        left: 120
                        link_item: ""
                        link_mode: None
                        link_timeout: 50
                        link_topic: ""
                        mouse_icon: ~
                        mouse_pointer: Default
                        ole_drop_mode: None
                        right_to_left: LeftToRight
                        tab_index: 7
                        tool_tip_text: ""
                        top: 240
                        use_mnemonic: true
                        visible: Visible
                        whats_this_help_id: 0
                        width: 855
                        word_wrap: NonWrapping
        - name: picGradient
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 255
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 15
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 256
                tab_index: 5
                tab_stop: Included
                tool_tip_text: ""
                top: 4950
                visible: Visible
                whats_this_help_id: 0
                width: 3870
        - name: cmbHistSource
          tag: ""
          index: 0
          kind:
            ComboBox:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                integral_height: true
                left: 1560
                locked: false
                mouse_icon: ~
                mouse_pointer: Default
                ole_drag_mode: Manual
                ole_drop_mode: None
                right_to_left: LeftToRight
                sorted: false
                style: DropDownCombo
                tab_index: 2
                tab_stop: Included
                text: ""
                tool_tip_text: ""
                top: 120
                visible: Visible
                whats_this_help_id: 0
                width: 2415
        - name: cmbHistMethod
          tag: ""
          index: 0
          kind:
            ComboBox:
              properties:
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 330
                help_context_id: 0
                integral_height: true
                left: 1560
                locked: false
                mouse_icon: ~
                mouse_pointer: Default
                ole_drag_mode: Manual
                ole_drop_mode: None
                right_to_left: LeftToRight
                sorted: false
                style: DropDownCombo
                tab_index: 1
                tab_stop: Included
                text: ""
                tool_tip_text: ""
                top: 480
                visible: Visible
                whats_this_help_id: 0
                width: 2415
        - name: picH
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 3975
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 263
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 256
                tab_index: 0
                tab_stop: Included
                tool_tip_text: ""
                top: 960
                visible: Visible
                whats_this_help_id: 0
                width: 3870
        - name: Label2
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Drawing Method:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 210
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 4
                tool_tip_text: ""
                top: 540
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1230
                word_wrap: NonWrapping
        - name: Label1
          tag: ""
          index: 0
          kind:
            Label:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                back_style: Opaque
                border_style: None
                caption: "Histogram Source:"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 210
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                ole_drop_mode: None
                right_to_left: LeftToRight
                tab_index: 3
                tool_tip_text: ""
                top: 180
                use_mnemonic: true
                visible: Visible
                whats_this_help_id: 0
                width: 1335
                word_wrap: NonWrapping
      menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmHistogram
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\nOption Explicit\r\n\r\n'Throughout this form, the following array locations refer to a type of histogram:\r\n'0 - Red\r\n'1 - Green\r\n'2 - Blue\r\n'3 - Luminance\r\n'This applies especially to the hData() and hMax() arrays\r\n\r\n'Histogram data for each particular type (r/g/b/luminance)\r\nDim hData(0 To 3, 0 To 255) As Single\r\n'Maximum histogram values (r/g/b/luminance)\r\nDim hMax(0 To 3) As Single\r\n'Loop and position variables\r\nDim x As Long, y As Long\r\n\r\n'When either combo box is used, remember what was selected and then draw the new\r\n'histogram\r\nPrivate Sub cmbHistMethod_Click()\r\n    lastHistMethod = cmbHistMethod.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\nEnd Sub\r\n\r\nPrivate Sub cmbHistSource_Click()\r\n    lastHistSource = cmbHistSource.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\nEnd Sub\r\n\r\n\r\n'Generate the histogram data upon form load (we only need to do it once per image)\r\nPrivate Sub Form_Load()\r\n        \r\n    GenerateHistogram\r\n    \r\n    'Clear out the combo box that displays histogram sources and fill it with\r\n    'appropriate choices\r\n    cmbHistSource.Clear\r\n    cmbHistSource.AddItem \"Red\"\r\n    cmbHistSource.AddItem \"Green\"\r\n    cmbHistSource.AddItem \"Blue\"\r\n    cmbHistSource.AddItem \"Luminance\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistSource.ListIndex = lastHistSource\r\n    \r\n    'Clear out the combo box that displays histogram drawing methods and fill it\r\n    'with appropriate choices\r\n    cmbHistMethod.Clear\r\n    cmbHistMethod.AddItem \"Connecting lines\"\r\n    cmbHistMethod.AddItem \"Solid bars\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistMethod.ListIndex = lastHistMethod\r\n    \r\nEnd Sub\r\n\r\n'Subroutine to draw a histogram.  hType tells us what histogram to draw:\r\n'0 - Red\r\n'1 - Green\r\n'2 - Blue\r\n'3 - Luminance\r\n'drawMethod tells us what kind of histogram to draw:\r\n'0 - Connected lines (like a line graph)\r\n'1 - Solid bars (like a bar graph)\r\nPrivate Sub DrawHistogram(ByVal hType As Long, ByVal drawMethod As Long)\r\n    \r\n    'Clear out whatever was there before\r\n    picH.Cls\r\n    \r\n    'tHeight is used to determine the height of the maximum value in the\r\n    'histogram.  We want it to be slightly shorter than the height of the\r\n    'picture box; this way the tallest histogram value fills the entire picture\r\n    Dim tHeight As Long\r\n    tHeight = picH.ScaleHeight - 2\r\n    \r\n    'LastX and LastY are used to draw a connecting line between histogram points\r\n    Dim LastX As Long, LastY As Long\r\n    \r\n    'The type of histogram we're drawing will determine the color of the histogram\r\n    'line - we'll make it match what we're drawing (red/green/blue/black)\r\n    Select Case hType\r\n        'Red\r\n        Case 0\r\n            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        Case 1\r\n            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        Case 2\r\n            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        Case 3\r\n            picH.ForeColor = RGB(0, 0, 0)\r\n    End Select\r\n    \r\n    'Now draw a little gradient below the histogram window (just 'cause Photoshop\r\n    'does it and it adds a nice touch, hehe ;)\r\n    If hType < 3 Then\r\n        'Draw a gradient from black to the color of the current histogram model\r\n        DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n    Else\r\n        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    End If\r\n    \r\n    'Now we'll draw the histogram.  Pay careful attention to this section of code\r\n    \r\n    'For the first point there is no last 'x' or 'y', so we'll just make it the\r\n    'same as the first value in the histogram. (We care about this only if we're\r\n    'drawing a \"connected lines\" type of histogram.)\r\n    LastX = 0\r\n    LastY = tHeight - (hData(hType, 0) / hMax(hType)) * tHeight\r\n    \r\n    'Run a loop through every histogram value...\r\n    For x = 0 To 255\r\n        'This is the most complicated line in the project.  The y-value of the\r\n        'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with\r\n        'tHeight being the tallest possible value (when RData(x) = MaxVal).  We\r\n        'then subtract that value from tHeight because y values INCREASE as we\r\n        'move DOWN a picture box - remember that (0,0) is in the top left.\r\n        y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n        'For connecting lines...\r\n        If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n    Next x\r\n    \r\n    'Last but not least, generate the statistics at the bottom of the form\r\n    \r\n    'Total number of pixels\r\n    Dim fDraw As New FastDrawing\r\n    Dim iWidth As Long, iHeight As Long\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    lblTotalPixels.Caption = \"Total pixels: \" & (iWidth * iHeight)\r\n    \r\n    'Maximum value\r\n    lblMaxCount.Caption = hMax(hType)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Terminate()\r\n    Unload Me\r\nEnd Sub\r\n\r\n'When the mouse moves over the histogram, display the level and count for the histogram\r\n'entry at the x-value over which the mouse passes\r\nPrivate Sub picH_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    lblLevel.Caption = x\r\n    lblCount.Caption = hData(lastHistSource, x)\r\nEnd Sub\r\n\r\nPublic Sub GenerateHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'If the histogram has already been used, we need to clear out all the\r\n    'maximum values and histogram values\r\n    For x = 0 To 3\r\n        hMax(x) = 0\r\n        For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the image, gathering what we need to\r\n    'calculate our histogram\r\n    Dim quickX As Long\r\n    For x = 0 To iWidth - 1\r\n        quickX = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the completed array to find maximum values\r\n    For x = 0 To 255\r\n        'Red\r\n        If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n        If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n        If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n        If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n    \r\n    'When all has been completed, off we go to draw the histogram.  Yay.\r\n    'We'll always draw the luminance histogram first; if the user has already looked\r\n    'at a particular histogram, remember which one and display it instead.\r\n    DrawHistogram lastHistSource, lastHistMethod\r\n\r\nEnd Sub\r\n\r\n\r\n'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it.\r\nPublic Sub StretchHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long\r\n    \r\n    'These variables will store the maximum red, green, and blue values in this image\r\n    Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n    Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n\r\n    'Reset the minimum values to a non-minimum value\r\n    rMin = 255: gMin = 255: bMin = 255\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Throughout this form, the following array locations refer to a type of histogram:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'0 - Red"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'1 - Green"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'2 - Blue"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'3 - Luminance"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This applies especially to the hData() and hMax() arrays"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Histogram data for each particular type (r/g/b/luminance)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim hData(0 To 3, 0 To 255) As Single\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: hData
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "0"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "0"
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ToKeyword
            text: To
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "3"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "3"
                is_token: true
                children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "0"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "0"
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ToKeyword
            text: To
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "255"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "255"
                is_token: true
                children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: EndOfLineComment
        text: "'Maximum histogram values (r/g/b/luminance)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim hMax(0 To 3) As Single\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: hMax
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "0"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "0"
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ToKeyword
            text: To
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "3"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "3"
                is_token: true
                children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: EndOfLineComment
        text: "'Loop and position variables"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Dim x As Long, y As Long\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: x
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: y
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When either combo box is used, remember what was selected and then draw the new"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'histogram"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmbHistMethod_Click()\r\n    lastHistMethod = cmbHistMethod.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmbHistMethod_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    lastHistMethod = cmbHistMethod.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lastHistMethod = cmbHistMethod.ListIndex\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: lastHistMethod
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lastHistMethod
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: cmbHistMethod.ListIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: cmbHistMethod
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ListIndex
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawHistogram
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ListIndex
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: cmbHistMethod
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ListIndex
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub cmbHistSource_Click()\r\n    lastHistSource = cmbHistSource.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: cmbHistSource_Click
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    lastHistSource = cmbHistSource.ListIndex\r\n    DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lastHistSource = cmbHistSource.ListIndex\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: lastHistSource
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lastHistSource
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: cmbHistSource.ListIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: cmbHistSource
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ListIndex
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawHistogram cmbHistSource.ListIndex, cmbHistMethod.ListIndex\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawHistogram
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ListIndex
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: cmbHistMethod
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: ListIndex
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Generate the histogram data upon form load (we only need to do it once per image)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub Form_Load()\r\n        \r\n    GenerateHistogram\r\n    \r\n    'Clear out the combo box that displays histogram sources and fill it with\r\n    'appropriate choices\r\n    cmbHistSource.Clear\r\n    cmbHistSource.AddItem \"Red\"\r\n    cmbHistSource.AddItem \"Green\"\r\n    cmbHistSource.AddItem \"Blue\"\r\n    cmbHistSource.AddItem \"Luminance\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistSource.ListIndex = lastHistSource\r\n    \r\n    'Clear out the combo box that displays histogram drawing methods and fill it\r\n    'with appropriate choices\r\n    cmbHistMethod.Clear\r\n    cmbHistMethod.AddItem \"Connecting lines\"\r\n    cmbHistMethod.AddItem \"Solid bars\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistMethod.ListIndex = lastHistMethod\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: Form_Load
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "        \r\n    GenerateHistogram\r\n    \r\n    'Clear out the combo box that displays histogram sources and fill it with\r\n    'appropriate choices\r\n    cmbHistSource.Clear\r\n    cmbHistSource.AddItem \"Red\"\r\n    cmbHistSource.AddItem \"Green\"\r\n    cmbHistSource.AddItem \"Blue\"\r\n    cmbHistSource.AddItem \"Luminance\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistSource.ListIndex = lastHistSource\r\n    \r\n    'Clear out the combo box that displays histogram drawing methods and fill it\r\n    'with appropriate choices\r\n    cmbHistMethod.Clear\r\n    cmbHistMethod.AddItem \"Connecting lines\"\r\n    cmbHistMethod.AddItem \"Solid bars\"\r\n    'Set the current combo box option to be whatever we used last\r\n    cmbHistMethod.ListIndex = lastHistMethod\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "        "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GenerateHistogram\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GenerateHistogram
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Clear out the combo box that displays histogram sources and fill it with"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'appropriate choices"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistSource.Clear\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Clear
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistSource.AddItem \"Red\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Red\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistSource.AddItem \"Green\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Green\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistSource.AddItem \"Blue\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Blue\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistSource.AddItem \"Luminance\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistSource
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Luminance\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set the current combo box option to be whatever we used last"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "cmbHistSource.ListIndex = lastHistSource\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: cmbHistSource.ListIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: cmbHistSource
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ListIndex
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: lastHistSource
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lastHistSource
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Clear out the combo box that displays histogram drawing methods and fill it"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'with appropriate choices"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistMethod.Clear\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistMethod
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Clear
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistMethod.AddItem \"Connecting lines\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistMethod
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Connecting lines\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "cmbHistMethod.AddItem \"Solid bars\"\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: cmbHistMethod
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: AddItem
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StringLiteral
                    text: "\"Solid bars\""
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set the current combo box option to be whatever we used last"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "cmbHistMethod.ListIndex = lastHistMethod\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: cmbHistMethod.ListIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: cmbHistMethod
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ListIndex
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: lastHistMethod
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lastHistMethod
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Subroutine to draw a histogram.  hType tells us what histogram to draw:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'0 - Red"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'1 - Green"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'2 - Blue"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'3 - Luminance"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'drawMethod tells us what kind of histogram to draw:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'0 - Connected lines (like a line graph)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'1 - Solid bars (like a bar graph)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub DrawHistogram(ByVal hType As Long, ByVal drawMethod As Long)\r\n    \r\n    'Clear out whatever was there before\r\n    picH.Cls\r\n    \r\n    'tHeight is used to determine the height of the maximum value in the\r\n    'histogram.  We want it to be slightly shorter than the height of the\r\n    'picture box; this way the tallest histogram value fills the entire picture\r\n    Dim tHeight As Long\r\n    tHeight = picH.ScaleHeight - 2\r\n    \r\n    'LastX and LastY are used to draw a connecting line between histogram points\r\n    Dim LastX As Long, LastY As Long\r\n    \r\n    'The type of histogram we're drawing will determine the color of the histogram\r\n    'line - we'll make it match what we're drawing (red/green/blue/black)\r\n    Select Case hType\r\n        'Red\r\n        Case 0\r\n            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        Case 1\r\n            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        Case 2\r\n            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        Case 3\r\n            picH.ForeColor = RGB(0, 0, 0)\r\n    End Select\r\n    \r\n    'Now draw a little gradient below the histogram window (just 'cause Photoshop\r\n    'does it and it adds a nice touch, hehe ;)\r\n    If hType < 3 Then\r\n        'Draw a gradient from black to the color of the current histogram model\r\n        DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n    Else\r\n        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    End If\r\n    \r\n    'Now we'll draw the histogram.  Pay careful attention to this section of code\r\n    \r\n    'For the first point there is no last 'x' or 'y', so we'll just make it the\r\n    'same as the first value in the histogram. (We care about this only if we're\r\n    'drawing a \"connected lines\" type of histogram.)\r\n    LastX = 0\r\n    LastY = tHeight - (hData(hType, 0) / hMax(hType)) * tHeight\r\n    \r\n    'Run a loop through every histogram value...\r\n    For x = 0 To 255\r\n        'This is the most complicated line in the project.  The y-value of the\r\n        'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with\r\n        'tHeight being the tallest possible value (when RData(x) = MaxVal).  We\r\n        'then subtract that value from tHeight because y values INCREASE as we\r\n        'move DOWN a picture box - remember that (0,0) is in the top left.\r\n        y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n        'For connecting lines...\r\n        If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n    Next x\r\n    \r\n    'Last but not least, generate the statistics at the bottom of the form\r\n    \r\n    'Total number of pixels\r\n    Dim fDraw As New FastDrawing\r\n    Dim iWidth As Long, iHeight As Long\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    lblTotalPixels.Caption = \"Total pixels: \" & (iWidth * iHeight)\r\n    \r\n    'Maximum value\r\n    lblMaxCount.Caption = hMax(hType)\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawHistogram
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hType As Long, ByVal drawMethod As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hType
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: drawMethod
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'Clear out whatever was there before\r\n    picH.Cls\r\n    \r\n    'tHeight is used to determine the height of the maximum value in the\r\n    'histogram.  We want it to be slightly shorter than the height of the\r\n    'picture box; this way the tallest histogram value fills the entire picture\r\n    Dim tHeight As Long\r\n    tHeight = picH.ScaleHeight - 2\r\n    \r\n    'LastX and LastY are used to draw a connecting line between histogram points\r\n    Dim LastX As Long, LastY As Long\r\n    \r\n    'The type of histogram we're drawing will determine the color of the histogram\r\n    'line - we'll make it match what we're drawing (red/green/blue/black)\r\n    Select Case hType\r\n        'Red\r\n        Case 0\r\n            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        Case 1\r\n            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        Case 2\r\n            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        Case 3\r\n            picH.ForeColor = RGB(0, 0, 0)\r\n    End Select\r\n    \r\n    'Now draw a little gradient below the histogram window (just 'cause Photoshop\r\n    'does it and it adds a nice touch, hehe ;)\r\n    If hType < 3 Then\r\n        'Draw a gradient from black to the color of the current histogram model\r\n        DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n    Else\r\n        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    End If\r\n    \r\n    'Now we'll draw the histogram.  Pay careful attention to this section of code\r\n    \r\n    'For the first point there is no last 'x' or 'y', so we'll just make it the\r\n    'same as the first value in the histogram. (We care about this only if we're\r\n    'drawing a \"connected lines\" type of histogram.)\r\n    LastX = 0\r\n    LastY = tHeight - (hData(hType, 0) / hMax(hType)) * tHeight\r\n    \r\n    'Run a loop through every histogram value...\r\n    For x = 0 To 255\r\n        'This is the most complicated line in the project.  The y-value of the\r\n        'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with\r\n        'tHeight being the tallest possible value (when RData(x) = MaxVal).  We\r\n        'then subtract that value from tHeight because y values INCREASE as we\r\n        'move DOWN a picture box - remember that (0,0) is in the top left.\r\n        y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n        'For connecting lines...\r\n        If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n    Next x\r\n    \r\n    'Last but not least, generate the statistics at the bottom of the form\r\n    \r\n    'Total number of pixels\r\n    Dim fDraw As New FastDrawing\r\n    Dim iWidth As Long, iHeight As Long\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    lblTotalPixels.Caption = \"Total pixels: \" & (iWidth * iHeight)\r\n    \r\n    'Maximum value\r\n    lblMaxCount.Caption = hMax(hType)\r\n\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Clear out whatever was there before"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "picH.Cls\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: picH
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Cls
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'tHeight is used to determine the height of the maximum value in the"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'histogram.  We want it to be slightly shorter than the height of the"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'picture box; this way the tallest histogram value fills the entire picture"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "tHeight = picH.ScaleHeight - 2\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: tHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: tHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: picH.ScaleHeight - 2
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: picH.ScaleHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: picH
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleHeight
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "2"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "2"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'LastX and LastY are used to draw a connecting line between histogram points"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim LastX As Long, LastY As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: LastX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: LastY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'The type of histogram we're drawing will determine the color of the histogram"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'line - we'll make it match what we're drawing (red/green/blue/black)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: SelectCaseStatement
                text: "Select Case hType\r\n        'Red\r\n        Case 0\r\n            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        Case 1\r\n            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        Case 2\r\n            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        Case 3\r\n            picH.ForeColor = RGB(0, 0, 0)\r\n    End Select\r\n"
                is_token: false
                children:
                  - kind: SelectKeyword
                    text: Select
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CaseKeyword
                    text: Case
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: hType
                    is_token: false
                    children:
                      - kind: Identifier
                        text: hType
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: "        "
                    is_token: true
                    children: []
                  - kind: EndOfLineComment
                    text: "'Red"
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: "        "
                    is_token: true
                    children: []
                  - kind: CaseClause
                    text: "Case 0\r\n            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            picH.ForeColor = RGB(255, 0, 0)\r\n        'Green\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "picH.ForeColor = RGB(255, 0, 0)\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: picH.ForeColor
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picH
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: ForeColor
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "RGB(255, 0, 0)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: RGB
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "255, 0, 0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "255"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Green"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case 1\r\n            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            picH.ForeColor = RGB(0, 255, 0)\r\n        'Blue\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "picH.ForeColor = RGB(0, 255, 0)\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: picH.ForeColor
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picH
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: ForeColor
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "RGB(0, 255, 0)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: RGB
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0, 255, 0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "255"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Blue"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case 2\r\n            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "2"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            picH.ForeColor = RGB(0, 0, 255)\r\n        'Luminance\r\n        "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "picH.ForeColor = RGB(0, 0, 255)\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: picH.ForeColor
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picH
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: ForeColor
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "RGB(0, 0, 255)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: RGB
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0, 0, 255"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "255"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Luminance"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                  - kind: CaseClause
                    text: "Case 3\r\n            picH.ForeColor = RGB(0, 0, 0)\r\n    "
                    is_token: false
                    children:
                      - kind: CaseKeyword
                        text: Case
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: IntegerLiteral
                        text: "3"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "            picH.ForeColor = RGB(0, 0, 0)\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "            "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "picH.ForeColor = RGB(0, 0, 0)\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: picH.ForeColor
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picH
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: ForeColor
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "RGB(0, 0, 0)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: RGB
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0, 0, 0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SelectKeyword
                    text: Select
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Now draw a little gradient below the histogram window (just 'cause Photoshop"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'does it and it adds a nice touch, hehe ;)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: IfStatement
                text: "If hType < 3 Then\r\n        'Draw a gradient from black to the color of the current histogram model\r\n        DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n    Else\r\n        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: hType < 3
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: hType
                        is_token: false
                        children:
                          - kind: Identifier
                            text: hType
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LessThanOperator
                        text: "<"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "3"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "3"
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        'Draw a gradient from black to the color of the current histogram model\r\n        DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Draw a gradient from black to the color of the current histogram model"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "DrawGradient picGradient, RGB(0, 0, 0), picH.ForeColor\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: DrawGradient
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: picGradient
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: RGB
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: picH
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ForeColor
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: CodeBlock
                        text: "        'For luminance, draw a gradient from black to white\r\n        DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'For luminance, draw a gradient from black to white"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "DrawGradient picGradient, RGB(0, 0, 0), RGB(255, 255, 255)\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: DrawGradient
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: picGradient
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: RGB
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: RGB
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Now we'll draw the histogram.  Pay careful attention to this section of code"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'For the first point there is no last 'x' or 'y', so we'll just make it the"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'same as the first value in the histogram. (We care about this only if we're"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'drawing a \"connected lines\" type of histogram.)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "LastX = 0\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: LastX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: LastX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "LastY = tHeight - (hData(hType, 0) / hMax(hType)) * tHeight\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: LastY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: LastY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "tHeight - (hData(hType, 0) / hMax(hType)) * tHeight"
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: tHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: tHeight
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: "(hData(hType, 0) / hMax(hType)) * tHeight"
                        is_token: false
                        children:
                          - kind: ParenthesizedExpression
                            text: "(hData(hType, 0) / hMax(hType))"
                            is_token: false
                            children:
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: "hData(hType, 0) / hMax(hType)"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(hType, 0)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "hType, 0"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: hType
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: hType
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: hType
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: DivisionOperator
                                    text: /
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: hMax(hType)
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hMax
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: hType
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: hType
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: hType
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: hType
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: tHeight
                            is_token: false
                            children:
                              - kind: Identifier
                                text: tHeight
                                is_token: true
                                children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Run a loop through every histogram value..."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For x = 0 To 255\r\n        'This is the most complicated line in the project.  The y-value of the\r\n        'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with\r\n        'tHeight being the tallest possible value (when RData(x) = MaxVal).  We\r\n        'then subtract that value from tHeight because y values INCREASE as we\r\n        'move DOWN a picture box - remember that (0,0) is in the top left.\r\n        y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n        'For connecting lines...\r\n        If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        'This is the most complicated line in the project.  The y-value of the\r\n        'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with\r\n        'tHeight being the tallest possible value (when RData(x) = MaxVal).  We\r\n        'then subtract that value from tHeight because y values INCREASE as we\r\n        'move DOWN a picture box - remember that (0,0) is in the top left.\r\n        y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n        'For connecting lines...\r\n        If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'This is the most complicated line in the project.  The y-value of the"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'histogram is drawn as a percentage (RData(x) / MaxVal) * tHeight) with"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'tHeight being the tallest possible value (when RData(x) = MaxVal).  We"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'then subtract that value from tHeight because y values INCREASE as we"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'move DOWN a picture box - remember that (0,0) is in the top left."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "y = tHeight - (hData(hType, x) / hMax(hType)) * tHeight\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "tHeight - (hData(hType, x) / hMax(hType)) * tHeight"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: tHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: tHeight
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: "(hData(hType, x) / hMax(hType)) * tHeight"
                                is_token: false
                                children:
                                  - kind: ParenthesizedExpression
                                    text: "(hData(hType, x) / hMax(hType))"
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: "hData(hType, x) / hMax(hType)"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: "hData(hType, x)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: hData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "hType, x"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: hType
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: hType
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: hType
                                                            is_token: true
                                                            children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: DivisionOperator
                                            text: /
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: hMax(hType)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: hMax
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: hType
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: hType
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: hType
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: hType
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MultiplicationOperator
                                    text: "*"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: tHeight
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: tHeight
                                        is_token: true
                                        children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'For connecting lines..."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If drawMethod = 0 Then\r\n            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: drawMethod = 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: drawMethod
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: drawMethod
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            'Then draw a line from the last (x,y) to the current (x,y)\r\n            picH.Line (LastX, LastY)-(x, y)\r\n            LastX = x\r\n            LastY = y\r\n        'For a bar graph...\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Then draw a line from the last (x,y) to the current (x,y)"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "picH.Line (LastX, LastY)-(x, y)\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picH
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: LineKeyword
                                    text: Line
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: LastX
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: LastY
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: SubtractionOperator
                                    text: "-"
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: x
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: y
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "LastX = x\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: LastX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: LastX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: x
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "LastY = y\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: LastY
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: LastY
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: y
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: y
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'For a bar graph..."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: ElseIfClause
                            text: "ElseIf drawMethod = 1 Then\r\n            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        "
                            is_token: false
                            children:
                              - kind: ElseIfKeyword
                                text: ElseIf
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: drawMethod = 1
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: drawMethod
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: drawMethod
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "1"
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: ThenKeyword
                                text: Then
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: CodeBlock
                                text: "            'Draw a line from the bottom of the picture box to the calculated y-value\r\n            picH.Line (x, tHeight)-(x, y)\r\n        "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: EndOfLineComment
                                    text: "'Draw a line from the bottom of the picture box to the calculated y-value"
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: CallStatement
                                    text: "picH.Line (x, tHeight)-(x, y)\r\n"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picH
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: LineKeyword
                                        text: Line
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: x
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: tHeight
                                        is_token: true
                                        children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: x
                                        is_token: true
                                        children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: y
                                        is_token: true
                                        children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Last but not least, generate the statistics at the bottom of the form"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Total number of pixels"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim fDraw As New FastDrawing\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NewKeyword
                    text: New
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FastDrawing
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim iWidth As Long, iHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iWidth
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageWidth(frmMain.PicMain)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageWidth
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: frmMain.PicMain
                        is_token: false
                        children:
                          - kind: Argument
                            text: frmMain.PicMain
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: frmMain
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: PicMain
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageHeight(frmMain.PicMain)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageHeight
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: frmMain.PicMain
                        is_token: false
                        children:
                          - kind: Argument
                            text: frmMain.PicMain
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: frmMain
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: PicMain
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lblTotalPixels.Caption = \"Total pixels: \" & (iWidth * iHeight)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: lblTotalPixels.Caption
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lblTotalPixels
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Caption
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "\"Total pixels: \" & (iWidth * iHeight)"
                    is_token: false
                    children:
                      - kind: StringLiteralExpression
                        text: "\"Total pixels: \""
                        is_token: false
                        children:
                          - kind: StringLiteral
                            text: "\"Total pixels: \""
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ParenthesizedExpression
                        text: (iWidth * iHeight)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: iWidth * iHeight
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: iWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: iWidth
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: iHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: iHeight
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Maximum value"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lblMaxCount.Caption = hMax(hType)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: lblMaxCount.Caption
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lblMaxCount
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Caption
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: hMax(hType)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: hMax
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: hType
                        is_token: false
                        children:
                          - kind: Argument
                            text: hType
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: hType
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hType
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub Form_Terminate()\r\n    Unload Me\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: Form_Terminate
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    Unload Me\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: UnloadStatement
                text: "Unload Me\r\n"
                is_token: false
                children:
                  - kind: UnloadKeyword
                    text: Unload
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MeKeyword
                    text: Me
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When the mouse moves over the histogram, display the level and count for the histogram"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'entry at the x-value over which the mouse passes"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Private Sub picH_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n    lblLevel.Caption = x\r\n    lblCount.Caption = hData(lastHistSource, x)\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: picH_MouseMove
            is_token: true
            children: []
          - kind: ParameterList
            text: "(Button As Integer, Shift As Integer, x As Single, y As Single)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: Identifier
                text: Button
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: IntegerKeyword
                text: Integer
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Shift
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: IntegerKeyword
                text: Integer
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: SingleKeyword
                text: Single
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    lblLevel.Caption = x\r\n    lblCount.Caption = hData(lastHistSource, x)\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lblLevel.Caption = x\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: lblLevel.Caption
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lblLevel
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Caption
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lblCount.Caption = hData(lastHistSource, x)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: lblCount.Caption
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lblCount
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Caption
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "hData(lastHistSource, x)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: hData
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "lastHistSource, x"
                        is_token: false
                        children:
                          - kind: Argument
                            text: lastHistSource
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lastHistSource
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lastHistSource
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: x
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: x
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: x
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub GenerateHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'If the histogram has already been used, we need to clear out all the\r\n    'maximum values and histogram values\r\n    For x = 0 To 3\r\n        hMax(x) = 0\r\n        For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the image, gathering what we need to\r\n    'calculate our histogram\r\n    Dim quickX As Long\r\n    For x = 0 To iWidth - 1\r\n        quickX = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the completed array to find maximum values\r\n    For x = 0 To 255\r\n        'Red\r\n        If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n        If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n        If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n        If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n    \r\n    'When all has been completed, off we go to draw the histogram.  Yay.\r\n    'We'll always draw the luminance histogram first; if the user has already looked\r\n    'at a particular histogram, remember which one and display it instead.\r\n    DrawHistogram lastHistSource, lastHistMethod\r\n\r\nEnd Sub\r\n\r\n\r\n'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it.\r\nPublic Sub StretchHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long\r\n    \r\n    'These variables will store the maximum red, green, and blue values in this image\r\n    Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n    Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n\r\n    'Reset the minimum values to a non-minimum value\r\n    rMin = 255: gMin = 255: bMin = 255\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GenerateHistogram
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'If the histogram has already been used, we need to clear out all the\r\n    'maximum values and histogram values\r\n    For x = 0 To 3\r\n        hMax(x) = 0\r\n        For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the image, gathering what we need to\r\n    'calculate our histogram\r\n    Dim quickX As Long\r\n    For x = 0 To iWidth - 1\r\n        quickX = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Run a quick loop through the completed array to find maximum values\r\n    For x = 0 To 255\r\n        'Red\r\n        If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n        If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n        If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n        If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n    \r\n    'When all has been completed, off we go to draw the histogram.  Yay.\r\n    'We'll always draw the luminance histogram first; if the user has already looked\r\n    'at a particular histogram, remember which one and display it instead.\r\n    DrawHistogram lastHistSource, lastHistMethod\r\n\r\nEnd Sub\r\n\r\n\r\n'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it.\r\nPublic Sub StretchHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long\r\n    \r\n    'These variables will store the maximum red, green, and blue values in this image\r\n    Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n    Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n\r\n    'Reset the minimum values to a non-minimum value\r\n    rMin = 255: gMin = 255: bMin = 255\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'This array will hold the image's pixel data"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim imageData() As Byte\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Image dimensions"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim iWidth As Long, iHeight As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iWidth
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: iHeight
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim fDraw As New FastDrawing\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NewKeyword
                    text: New
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: FastDrawing
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageWidth(frmMain.PicMain)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageWidth
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: frmMain.PicMain
                        is_token: false
                        children:
                          - kind: Argument
                            text: frmMain.PicMain
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: frmMain
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: PicMain
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: iHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: iHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: fDraw.GetImageHeight(frmMain.PicMain)
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: fDraw.GetImageHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageHeight
                            is_token: true
                            children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: frmMain.PicMain
                        is_token: false
                        children:
                          - kind: Argument
                            text: frmMain.PicMain
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: frmMain
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: PicMain
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: fDraw
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GetImageData2D
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: frmMain
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: PicMain
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imageData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'These variables will hold temporary histogram values"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim r As Long, g As Long, b As Long, L As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: r
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: g
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: b
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: L
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If the histogram has already been used, we need to clear out all the"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'maximum values and histogram values"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For x = 0 To 3\r\n        hMax(x) = 0\r\n        For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "3"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "3"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        hMax(x) = 0\r\n        For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "hMax(x) = 0\r\n"
                        is_token: false
                        children:
                          - kind: CallExpression
                            text: hMax(x)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: hMax
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: x
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: x
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "For y = 0 To 255\r\n            hData(x, y) = 0\r\n        Next y\r\n"
                        is_token: false
                        children:
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "255"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            hData(x, y) = 0\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "hData(x, y) = 0\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(x, y)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "x, y"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: x
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: y
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: y
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Run a quick loop through the image, gathering what we need to"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'calculate our histogram"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim quickX As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: quickX
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For x = 0 To iWidth - 1\r\n        quickX = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: iWidth - 1
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: iWidth
                        is_token: false
                        children:
                          - kind: Identifier
                            text: iWidth
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        quickX = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "quickX = x * 3\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: quickX
                            is_token: false
                            children:
                              - kind: Identifier
                                text: quickX
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: x * 3
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: x
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: x
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "3"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "3"
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "For y = 0 To iHeight - 1\r\n        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    Next y\r\n"
                        is_token: false
                        children:
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: iHeight - 1
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: iHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: iHeight
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "        'We have to gather the red, green, and blue in order to calculate luminance\r\n        r = imageData(quickX + 2, y)\r\n        g = imageData(quickX + 1, y)\r\n        b = imageData(quickX, y)\r\n        'Rather than generate authentic luminance (which requires an HSL\r\n        'conversion routine), we'll use the shortcut formula - averaging\r\n        'R, G, and B.  This is plenty accurate for a project like this.\r\n        L = (r + g + b) \\ 3\r\n        'Increment each value in the array, depending on its present value;\r\n        'this will let us see how many of each color value (and luminance\r\n        'value) there is in the image\r\n        'Red\r\n        hData(0, r) = hData(0, r) + 1\r\n        'Green\r\n        hData(1, g) = hData(1, g) + 1\r\n        'Blue\r\n        hData(2, b) = hData(2, b) + 1\r\n        'Luminance\r\n        hData(3, L) = hData(3, L) + 1\r\n    "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'We have to gather the red, green, and blue in order to calculate luminance"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "r = imageData(quickX + 2, y)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: r
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: r
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "imageData(quickX + 2, y)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: imageData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "quickX + 2, y"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: quickX + 2
                                            is_token: false
                                            children:
                                              - kind: BinaryExpression
                                                text: quickX + 2
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: quickX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: quickX
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "2"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "2"
                                                        is_token: true
                                                        children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: y
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "g = imageData(quickX + 1, y)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: g
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: g
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "imageData(quickX + 1, y)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: imageData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "quickX + 1, y"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: quickX + 1
                                            is_token: false
                                            children:
                                              - kind: BinaryExpression
                                                text: quickX + 1
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: quickX
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: quickX
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: y
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "b = imageData(quickX, y)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: b
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: b
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "imageData(quickX, y)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: imageData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "quickX, y"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: quickX
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: quickX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: quickX
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: y
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Rather than generate authentic luminance (which requires an HSL"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'conversion routine), we'll use the shortcut formula - averaging"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'R, G, and B.  This is plenty accurate for a project like this."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "L = (r + g + b) \\ 3\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: L
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: L
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "(r + g + b) \\ 3"
                                    is_token: false
                                    children:
                                      - kind: ParenthesizedExpression
                                        text: (r + g + b)
                                        is_token: false
                                        children:
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: r + g + b
                                            is_token: false
                                            children:
                                              - kind: BinaryExpression
                                                text: r + g
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: r
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: r
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AdditionOperator
                                                    text: +
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: g
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: g
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AdditionOperator
                                                text: +
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: b
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: b
                                                    is_token: true
                                                    children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BackwardSlashOperator
                                        text: "\\"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "3"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Increment each value in the array, depending on its present value;"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'this will let us see how many of each color value (and luminance"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'value) there is in the image"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Red"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "hData(0, r) = hData(0, r) + 1\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(0, r)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "0, r"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: r
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: r
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: r
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "hData(0, r) + 1"
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: "hData(0, r)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: hData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "0, r"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: r
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: r
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: r
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Green"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "hData(1, g) = hData(1, g) + 1\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(1, g)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "1, g"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: g
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: g
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: g
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "hData(1, g) + 1"
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: "hData(1, g)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: hData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "1, g"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: g
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: g
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: g
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Blue"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "hData(2, b) = hData(2, b) + 1\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(2, b)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "2, b"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "2"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "2"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "2"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: b
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: b
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: b
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "hData(2, b) + 1"
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: "hData(2, b)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: hData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "2, b"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: "2"
                                                is_token: false
                                                children:
                                                  - kind: NumericLiteralExpression
                                                    text: "2"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "2"
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: b
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: b
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: b
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Luminance"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "hData(3, L) = hData(3, L) + 1\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "hData(3, L)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hData
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "3, L"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "3"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "3"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "3"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: L
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: L
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: L
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "hData(3, L) + 1"
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: "hData(3, L)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: hData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "3, L"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: "3"
                                                is_token: false
                                                children:
                                                  - kind: NumericLiteralExpression
                                                    text: "3"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "3"
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: L
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: L
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: L
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: y
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Run a quick loop through the completed array to find maximum values"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For x = 0 To 255\r\n        'Red\r\n        If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n        If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n        If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n        If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n    \r\n    'When all has been completed, off we go to draw the histogram.  Yay.\r\n    'We'll always draw the luminance histogram first; if the user has already looked\r\n    'at a particular histogram, remember which one and display it instead.\r\n    DrawHistogram lastHistSource, lastHistMethod\r\n\r\nEnd Sub\r\n\r\n\r\n'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it.\r\nPublic Sub StretchHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long\r\n    \r\n    'These variables will store the maximum red, green, and blue values in this image\r\n    Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n    Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n\r\n    'Reset the minimum values to a non-minimum value\r\n    rMin = 255: gMin = 255: bMin = 255\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        'Red\r\n        If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n        If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n        If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n        If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n    \r\n    'When all has been completed, off we go to draw the histogram.  Yay.\r\n    'We'll always draw the luminance histogram first; if the user has already looked\r\n    'at a particular histogram, remember which one and display it instead.\r\n    DrawHistogram lastHistSource, lastHistMethod\r\n\r\nEnd Sub\r\n\r\n\r\n'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it.\r\nPublic Sub StretchHistogram()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long\r\n    \r\n    'These variables will store the maximum red, green, and blue values in this image\r\n    Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n    Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n\r\n    'Reset the minimum values to a non-minimum value\r\n    rMin = 255: gMin = 255: bMin = 255\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Red"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If hData(0, x) > hMax(0) Then hMax(0) = hData(0, x)\r\n        'Green\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "hData(0, x) > hMax(0)"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: "hData(0, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: GreaterThanOperator
                                text: ">"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: hMax(0)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "hMax(0) = hData(0, x)\r\n"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: hMax(0)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "hData(0, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "0, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "0"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Green"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If hData(1, x) > hMax(1) Then hMax(1) = hData(1, x)\r\n        'Blue\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "hData(1, x) > hMax(1)"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: "hData(1, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "1, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: GreaterThanOperator
                                text: ">"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: hMax(1)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "hMax(1) = hData(1, x)\r\n"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: hMax(1)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "hData(1, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "1, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Blue"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If hData(2, x) > hMax(2) Then hMax(2) = hData(2, x)\r\n        'Luminance\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "hData(2, x) > hMax(2)"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: "hData(2, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "2, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "2"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "2"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "2"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: GreaterThanOperator
                                text: ">"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: hMax(2)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "2"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "2"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "2"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "hMax(2) = hData(2, x)\r\n"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: hMax(2)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "2"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "2"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "2"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "hData(2, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "2, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "2"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "2"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "2"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Luminance"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If hData(3, x) > hMax(3) Then hMax(3) = hData(3, x)\r\n    Next x\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "hData(3, x) > hMax(3)"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: "hData(3, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "3, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "3"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "3"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: GreaterThanOperator
                                text: ">"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: hMax(3)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "3"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "3"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "3"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "hMax(3) = hData(3, x)\r\n"
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: hMax(3)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hMax
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "3"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "3"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "3"
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "hData(3, x)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hData
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "3, x"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "3"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "3"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: x
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'When all has been completed, off we go to draw the histogram.  Yay."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'We'll always draw the luminance histogram first; if the user has already looked"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'at a particular histogram, remember which one and display it instead."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "DrawHistogram lastHistSource, lastHistMethod\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: DrawHistogram
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: lastHistSource
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: lastHistMethod
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: End
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: Sub
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'StretchHistogram - if an image histogram doesn't reach from 0 to 255, make it."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Public Sub StretchHistogram()\r\n"
                        is_token: false
                        children:
                          - kind: PublicKeyword
                            text: Public
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubKeyword
                            text: Sub
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: StretchHistogram
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'This array will hold the image's pixel data"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim imageData() As Byte\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: imageData
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Image dimensions"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim iWidth As Long, iHeight As Long\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: iWidth
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: iHeight
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim fDraw As New FastDrawing\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NewKeyword
                            text: New
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: FastDrawing
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: iWidth
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iWidth
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: fDraw.GetImageWidth(frmMain.PicMain)
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: fDraw.GetImageWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: fDraw
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: GetImageWidth
                                    is_token: true
                                    children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: frmMain.PicMain
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: frmMain.PicMain
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: frmMain
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: PicMain
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: iHeight
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iHeight
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: fDraw.GetImageHeight(frmMain.PicMain)
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: fDraw.GetImageHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: fDraw
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: GetImageHeight
                                    is_token: true
                                    children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: frmMain.PicMain
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: frmMain.PicMain
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: frmMain.PicMain
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: frmMain
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: PicMain
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: fDraw
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: GetImageData2D
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: frmMain
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicMain
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: imageData
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'These variables will hold temporary histogram values"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim r As Long, g As Long, b As Long\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: r
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: g
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: b
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'These variables will store the maximum red, green, and blue values in this image"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim rMax As Byte, gMax As Byte, bMax As Byte\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: rMax
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: gMax
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: bMax
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim rMin As Byte, gMin As Byte, bMin As Byte\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: rMin
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: gMin
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: bMin
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ByteKeyword
                            text: Byte
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Reset the minimum values to a non-minimum value"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: rMin = 255
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: rMin
                            is_token: false
                            children:
                              - kind: Identifier
                                text: rMin
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "255"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                      - kind: Unknown
                        text: ":"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: gMin = 255
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: gMin
                            is_token: false
                            children:
                              - kind: Identifier
                                text: gMin
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "255"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                      - kind: Unknown
                        text: ":"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "bMin = 255\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: bMin
                            is_token: false
                            children:
                              - kind: Identifier
                                text: bMin
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "255"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "255"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'This is used to access array locations quickly"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim quickVal As Long\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: quickVal
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                        is_token: false
                        children:
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: x
                            is_token: false
                            children:
                              - kind: Identifier
                                text: x
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: iWidth - 1
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: iWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: iWidth
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "quickVal = x * 3\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: quickVal
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: quickVal
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: x * 3
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MultiplicationOperator
                                        text: "*"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "3"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "3"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For y = 0 To iHeight - 1\r\n        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: y
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: y
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: iHeight - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: iHeight
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: iHeight
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        'Grab values for this pixel\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        \r\n        'Track maximum values of each color\r\n        If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n    Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n    rDif = rMax - rMin\r\n    gDif = gMax - gMin\r\n    bDif = bMax - bMin\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n    \r\nEnd Sub\r\n\r\n'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,\r\n' with roughly the same amount of pixels at each brightness level\r\nPublic Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'These arrays will hold brightness counts (used for the equalization formula)\r\n    Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'First, tally the amount of each color (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Single\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    \r\n    'Handle red as necessary\r\n    If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle green as necessary\r\n    If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Handle blue as necessary\r\n    If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n    \r\n    'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Grab values for this pixel"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "r = imageData(quickVal + 2, y)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: r
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: r
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: "imageData(quickVal + 2, y)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: imageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "quickVal + 2, y"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: quickVal + 2
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: quickVal + 2
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: quickVal
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: quickVal
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AdditionOperator
                                                            text: +
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "2"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "2"
                                                                is_token: true
                                                                children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "g = imageData(quickVal + 1, y)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: g
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: g
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: "imageData(quickVal + 1, y)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: imageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "quickVal + 1, y"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: quickVal + 1
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: quickVal + 1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: quickVal
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: quickVal
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AdditionOperator
                                                            text: +
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "b = imageData(quickVal, y)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: b
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: b
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: "imageData(quickVal, y)"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: imageData
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: "quickVal, y"
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: quickVal
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: quickVal
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: quickVal
                                                            is_token: true
                                                            children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Argument
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: y
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Track maximum values of each color"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If r < rMin Then rMin = r\r\n        If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n    ' red, green, and blue values\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: r < rMin
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: r
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: r
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOperator
                                                text: "<"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: rMin
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: rMin
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "rMin = r\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: rMin
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: rMin
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: r
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: r
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "        "
                                            is_token: true
                                            children: []
                                          - kind: IfStatement
                                            text: "If r > rMax Then rMax = r\r\n        If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n    'Based on maximum and minimum values, calculate the current range of\r\n"
                                            is_token: false
                                            children:
                                              - kind: IfKeyword
                                                text: If
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: r > rMax
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: r
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: r
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: GreaterThanOperator
                                                    text: ">"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: rMax
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rMax
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ThenKeyword
                                                text: Then
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "rMax = r\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: rMax
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rMax
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: r
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: r
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If g < gMin Then gMin = g\r\n        If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n    \r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: g < gMin
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: g
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: g
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: LessThanOperator
                                                        text: "<"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: gMin
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: gMin
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "gMin = g\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: gMin
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: gMin
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: g
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: g
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: "If g > gMax Then gMax = g\r\n        If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n    Next x\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: g > gMax
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: g
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: g
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: GreaterThanOperator
                                                            text: ">"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: gMax
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gMax
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "gMax = g\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: gMax
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gMax
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: g
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: g
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: "If b < bMin Then bMin = b\r\n        If b > bMax Then bMax = b\r\n        \r\n    Next y\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: b < bMin
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: b
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: b
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: LessThanOperator
                                                                text: "<"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: bMin
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bMin
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "bMin = b\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: bMin
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bMin
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: b
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: b
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: IfStatement
                                                            text: "If b > bMax Then bMax = b\r\n        \r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: b > bMax
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: b
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: b
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: GreaterThanOperator
                                                                    text: ">"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: bMax
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: bMax
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ThenKeyword
                                                                text: Then
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "bMax = b\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: bMax
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: bMax
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: b
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: b
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "        "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: NextKeyword
                                                            text: Next
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: y
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: NextKeyword
                                                        text: Next
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: x
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "    "
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'Based on maximum and minimum values, calculate the current range of"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "    "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "' red, green, and blue values"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim rDif As Integer, gDif As Integer, bDif As Integer\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: rDif
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerKeyword
                                            text: Integer
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: gDif
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerKeyword
                                            text: Integer
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: bDif
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerKeyword
                                            text: Integer
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "rDif = rMax - rMin\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: rDif
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: rDif
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: rMax - rMin
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: rMax
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: rMax
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: rMin
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: rMin
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "gDif = gMax - gMin\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: gDif
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: gDif
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: gMax - gMin
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: gMax
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: gMax
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: gMin
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: gMin
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "bDif = bMax - bMin\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: bDif
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: bDif
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: bMax - bMin
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: bMax
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: bMax
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: bMin
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: bMin
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: ForStatement
                                        text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n"
                                        is_token: false
                                        children:
                                          - kind: ForKeyword
                                            text: For
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: iWidth - 1
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: iWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iWidth
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "quickVal = x * 3\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: quickVal
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: quickVal
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: x * 3
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "3"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "3"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: y
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iHeight - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: iHeight
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iHeight
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Use this formula to force pixels to a new \"stretched\" value\r\n        r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n        g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n        b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "r = imageData(quickVal + 2, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: r
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: r
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal + 2, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal + 2, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal + 2
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: quickVal + 2
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: quickVal
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: quickVal
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "2"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "2"
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "g = imageData(quickVal + 1, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: g
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: g
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal + 1, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal + 1, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal + 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: quickVal + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: quickVal
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: quickVal
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "b = imageData(quickVal, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: b
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: b
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: quickVal
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: quickVal
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'Use this formula to force pixels to a new \"stretched\" value"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "r = 255 * CSng(CSng(r - rMin) / CSng(rDif))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: r
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: r
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: 255 * CSng(CSng(r - rMin) / CSng(rDif))
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "255"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "255"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MultiplicationOperator
                                                                text: "*"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallExpression
                                                                text: CSng(CSng(r - rMin) / CSng(rDif))
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: CSng
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: CSng(r - rMin) / CSng(rDif)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: CSng(r - rMin) / CSng(rDif)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: CSng(r - rMin) / CSng(rDif)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: CSng(r - rMin)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: r - rMin
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: r - rMin
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: r - rMin
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: r
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: r
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: SubtractionOperator
                                                                                                text: "-"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rMin
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rMin
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: CSng(rDif)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: rDif
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: rDif
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: rDif
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rDif
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "g = 255 * CSng(CSng(g - gMin) / CSng(gDif))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: g
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: g
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: 255 * CSng(CSng(g - gMin) / CSng(gDif))
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "255"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "255"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MultiplicationOperator
                                                                text: "*"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallExpression
                                                                text: CSng(CSng(g - gMin) / CSng(gDif))
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: CSng
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: CSng(g - gMin) / CSng(gDif)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: CSng(g - gMin) / CSng(gDif)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: CSng(g - gMin) / CSng(gDif)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: CSng(g - gMin)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: g - gMin
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: g - gMin
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: g - gMin
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: g
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: g
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: SubtractionOperator
                                                                                                text: "-"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: gMin
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: gMin
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: CSng(gDif)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: gDif
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: gDif
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: gDif
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: gDif
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "b = 255 * CSng(CSng(b - bMin) / CSng(bDif))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: b
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: b
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: 255 * CSng(CSng(b - bMin) / CSng(bDif))
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "255"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "255"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MultiplicationOperator
                                                                text: "*"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallExpression
                                                                text: CSng(CSng(b - bMin) / CSng(bDif))
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: CSng
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: CSng(b - bMin) / CSng(bDif)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: CSng(b - bMin) / CSng(bDif)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: CSng(b - bMin) / CSng(bDif)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: CSng(b - bMin)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: b - bMin
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: b - bMin
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: b - bMin
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: b
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: b
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: SubtractionOperator
                                                                                                text: "-"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: bMin
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: bMin
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: CSng(bDif)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CSng
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: bDif
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: bDif
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: bDif
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: bDif
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: imageData
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: quickVal
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: +
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "2,"
                                                        is_token: false
                                                        children:
                                                          - kind: NumericLiteralExpression
                                                            text: "2"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "2"
                                                                is_token: true
                                                                children: []
                                                          - kind: IdentifierExpression
                                                            text: ","
                                                            is_token: false
                                                            children:
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "y) = r\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: y
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                          - kind: BinaryExpression
                                                            text: ) = r
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: )
                                                                is_token: false
                                                                children:
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: r
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: r
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: imageData
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: quickVal
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Unknown
                                                        text: +
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "1,"
                                                        is_token: false
                                                        children:
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                          - kind: IdentifierExpression
                                                            text: ","
                                                            is_token: false
                                                            children:
                                                              - kind: Comma
                                                                text: ","
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "y) = g\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: y
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                          - kind: BinaryExpression
                                                            text: ) = g
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: )
                                                                is_token: false
                                                                children:
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: g
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: g
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "imageData(quickVal, y) = b\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: quickVal
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: quickVal
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: b
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: b
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                  - kind: NextKeyword
                                                    text: Next
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                          - kind: NextKeyword
                                            text: Next
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Draw the new image"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: SetImageData2D
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: frmMain
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: PicMain
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: iWidth
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: iHeight
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Draw the new histogram"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "frmHistogram.GenerateHistogram\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: frmHistogram
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: GenerateHistogram
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: End
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: Sub
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'EqualizeHistogram - attempt to redistribute values across the brightness spectrum,"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "' with roughly the same amount of pixels at each brightness level"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Public Sub EqualizeHistogram(ByVal HandleR As Boolean, ByVal HandleG As Boolean, ByVal HandleB As Boolean)\r\n"
                                        is_token: false
                                        children:
                                          - kind: PublicKeyword
                                            text: Public
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubKeyword
                                            text: Sub
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: EqualizeHistogram
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ByValKeyword
                                            text: ByVal
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: HandleR
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BooleanKeyword
                                            text: Boolean
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ByValKeyword
                                            text: ByVal
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: HandleG
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BooleanKeyword
                                            text: Boolean
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ByValKeyword
                                            text: ByVal
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: HandleB
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BooleanKeyword
                                            text: Boolean
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'This array will hold the image's pixel data"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim imageData() As Byte\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ByteKeyword
                                            text: Byte
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Image dimensions"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim iWidth As Long, iHeight As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: iWidth
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: iHeight
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim fDraw As New FastDrawing\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NewKeyword
                                            text: New
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: FastDrawing
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: iWidth
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: iWidth
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: fDraw.GetImageWidth(frmMain.PicMain)
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: fDraw.GetImageWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: fDraw
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: GetImageWidth
                                                    is_token: true
                                                    children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: frmMain.PicMain
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: frmMain.PicMain
                                                    is_token: false
                                                    children:
                                                      - kind: MemberAccessExpression
                                                        text: frmMain.PicMain
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: frmMain
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: PicMain
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: iHeight
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: iHeight
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: fDraw.GetImageHeight(frmMain.PicMain)
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: fDraw.GetImageHeight
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: fDraw
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: GetImageHeight
                                                    is_token: true
                                                    children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: frmMain.PicMain
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: frmMain.PicMain
                                                    is_token: false
                                                    children:
                                                      - kind: MemberAccessExpression
                                                        text: frmMain.PicMain
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: frmMain
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: PicMain
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: GetImageData2D
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: frmMain
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: PicMain
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'These variables will hold temporary histogram values"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim r As Long, g As Long, b As Long, L As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: r
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: g
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: b
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: L
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'These arrays will hold brightness counts (used for the equalization formula)"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim rData(0 To 255) As Long, gData(0 To 255) As Long, bData(0 To 255) As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: rData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: gData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: bData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'This is used to access array locations quickly"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim quickVal As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: quickVal
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'First, tally the amount of each color (i.e. build the histogram)"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: ForStatement
                                        text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    Next x\r\n"
                                        is_token: false
                                        children:
                                          - kind: ForKeyword
                                            text: For
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: iWidth - 1
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: iWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iWidth
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n    "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "quickVal = x * 3\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: quickVal
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: quickVal
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: x * 3
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "3"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "3"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    Next y\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: y
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: y
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iHeight - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: iHeight
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iHeight
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        rData(r) = rData(r) + 1\r\n        gData(g) = gData(g) + 1\r\n        bData(b) = bData(b) + 1\r\n    "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "r = imageData(quickVal + 2, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: r
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: r
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal + 2, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal + 2, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal + 2
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: quickVal + 2
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: quickVal
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: quickVal
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "2"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "2"
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "g = imageData(quickVal + 1, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: g
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: g
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal + 1, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal + 1, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal + 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: quickVal + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: quickVal
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: quickVal
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "b = imageData(quickVal, y)\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: b
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: b
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: "imageData(quickVal, y)"
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: imageData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: "quickVal, y"
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: quickVal
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: quickVal
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: quickVal
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Argument
                                                                    text: y
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "rData(r) = rData(r) + 1\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: rData(r)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: rData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: r
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: r
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: r
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: r
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: rData(r) + 1
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: rData(r)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: rData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: r
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: r
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: r
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: r
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "gData(g) = gData(g) + 1\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: gData(g)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: g
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: g
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: g
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: g
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: gData(g) + 1
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: gData(g)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: gData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: g
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: g
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: g
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: g
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "bData(b) = bData(b) + 1\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: bData(b)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: bData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: b
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: b
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: b
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: b
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: bData(b) + 1
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: bData(b)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: b
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: b
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: b
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: b
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                  - kind: NextKeyword
                                                    text: Next
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: y
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                          - kind: NextKeyword
                                            text: Next
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Compute our scaling factor"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim scaleFactor As Single\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: scaleFactor
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SingleKeyword
                                            text: Single
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "scaleFactor = 255 / (iWidth * iHeight)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: scaleFactor
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: scaleFactor
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: 255 / (iWidth * iHeight)
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "255"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "255"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: DivisionOperator
                                                text: /
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: (iWidth * iHeight)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iWidth * iHeight
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: iWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: iHeight
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iHeight
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Handle red as necessary"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If HandleR Then\r\n        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    End If\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: HandleR
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: HandleR
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        rData(0) = rData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n    "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "rData(0) = rData(0) * scaleFactor\r\n"
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: rData(0)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rData
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: rData(0) * scaleFactor
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: rData(0)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: rData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: scaleFactor
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: scaleFactor
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For x = 1 To 255\r\n            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        Next x\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: x
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "255"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "255"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "            rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n        "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "rData(x) = rData(x - 1) + (scaleFactor * rData(x))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: rData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: rData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: rData(x - 1) + (scaleFactor * rData(x))
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: rData(x - 1)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: rData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: x - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: (scaleFactor * rData(x))
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: scaleFactor * rData(x)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: scaleFactor
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: scaleFactor
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: rData(x)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: rData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                  - kind: NextKeyword
                                                    text: Next
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                          - kind: EndKeyword
                                            text: End
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Handle green as necessary"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If HandleG Then\r\n        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    End If\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: HandleG
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: HandleG
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        gData(0) = gData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n    "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "gData(0) = gData(0) * scaleFactor\r\n"
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: gData(0)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: gData
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: gData(0) * scaleFactor
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: gData(0)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: gData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: scaleFactor
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: scaleFactor
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For x = 1 To 255\r\n            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        Next x\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: x
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "255"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "255"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "            gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n        "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "gData(x) = gData(x - 1) + (scaleFactor * gData(x))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: gData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: gData(x - 1) + (scaleFactor * gData(x))
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: gData(x - 1)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: gData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: x - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: (scaleFactor * gData(x))
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: scaleFactor * gData(x)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: scaleFactor
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: scaleFactor
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: gData(x)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: gData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                  - kind: NextKeyword
                                                    text: Next
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                          - kind: EndKeyword
                                            text: End
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Handle blue as necessary"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If HandleB Then\r\n        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    End If\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: HandleB
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: HandleB
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        bData(0) = bData(0) * scaleFactor\r\n        For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n    "
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "bData(0) = bData(0) * scaleFactor\r\n"
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: bData(0)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: bData
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: "0"
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: bData(0) * scaleFactor
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: bData(0)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: bData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: scaleFactor
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: scaleFactor
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For x = 1 To 255\r\n            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        Next x\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: x
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "255"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "255"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "            bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n        "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "            "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "bData(x) = bData(x - 1) + (scaleFactor * bData(x))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: bData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: bData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: bData(x - 1) + (scaleFactor * bData(x))
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: bData(x - 1)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: BinaryExpression
                                                                            text: x - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ParenthesizedExpression
                                                                text: (scaleFactor * bData(x))
                                                                is_token: false
                                                                children:
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: scaleFactor * bData(x)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: scaleFactor
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: scaleFactor
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallExpression
                                                                        text: bData(x)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: bData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                  - kind: NextKeyword
                                                    text: Next
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                          - kind: EndKeyword
                                            text: End
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Integerize all the look-up values"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: ForStatement
                                        text: "For x = 0 To 255\r\n        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                        is_token: false
                                        children:
                                          - kind: ForKeyword
                                            text: For
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ToKeyword
                                            text: To
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "255"
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        rData(x) = Int(rData(x))\r\n        If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "rData(x) = Int(rData(x))\r\n"
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: rData(x)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: rData
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: x
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: CallExpression
                                                    text: Int(rData(x))
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: Int
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: rData(x)
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: rData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: rData(x)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: rData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If rData(x) > 255 Then rData(x) = 255\r\n        gData(x) = Int(gData(x))\r\n        If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: rData(x) > 255
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: rData(x)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: rData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: GreaterThanOperator
                                                        text: ">"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "255"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "255"
                                                            is_token: true
                                                            children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "rData(x) = 255\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: rData(x)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: rData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "255"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "255"
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "gData(x) = Int(gData(x))\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: gData(x)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: gData
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallExpression
                                                        text: Int(gData(x))
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: Int
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: gData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: gData(x)
                                                                is_token: false
                                                                children:
                                                                  - kind: CallExpression
                                                                    text: gData(x)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: gData
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: "If gData(x) > 255 Then gData(x) = 255\r\n        bData(x) = Int(bData(x))\r\n        If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n    \r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: gData(x) > 255
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: gData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: GreaterThanOperator
                                                            text: ">"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "255"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "255"
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ThenKeyword
                                                        text: Then
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "gData(x) = 255\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: gData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: gData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "255"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "255"
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "bData(x) = Int(bData(x))\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: bData(x)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: bData
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: Int(bData(x))
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: Int
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: bData(x)
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: bData(x)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: bData(x)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: bData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: "If bData(x) > 255 Then bData(x) = 255\r\n    Next x\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: bData(x) > 255
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: bData(x)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: GreaterThanOperator
                                                                text: ">"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "255"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "255"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "bData(x) = 255\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: CallExpression
                                                                text: bData(x)
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: bData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ArgumentList
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Argument
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "255"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "255"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: NextKeyword
                                                            text: Next
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: x
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "    "
                                                    is_token: true
                                                    children: []
                                                  - kind: EndOfLineComment
                                                    text: "'Apply the equalized values"
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: ForStatement
                                                text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                is_token: false
                                                children:
                                                  - kind: ForKeyword
                                                    text: For
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: x
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: x
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ToKeyword
                                                    text: To
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iWidth - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: iWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "quickVal = x * 3\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: quickVal
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: quickVal
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: x * 3
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MultiplicationOperator
                                                                text: "*"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "3"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "3"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: ForStatement
                                                        text: "For y = 0 To iHeight - 1\r\n        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: ForKeyword
                                                            text: For
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: y
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: y
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "0"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "0"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ToKeyword
                                                            text: To
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: iHeight - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: iHeight
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: iHeight
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: CodeBlock
                                                            text: "        If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,\r\n' with roughly the same amount of pixels at each luminance level\r\nPublic Sub EqualizeLuminance()\r\n    \r\n    'This array will hold the image's pixel data\r\n    Dim imageData() As Byte\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n    iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n    fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n    \r\n    'These variables will hold temporary histogram values\r\n    Dim r As Long, g As Long, b As Long, L As Long\r\n    \r\n    'This is used to access array locations quickly\r\n    Dim quickVal As Long\r\n    \r\n    'This array will hold our luminance values\r\n    Dim lum(0 To 255) As Single\r\n    \r\n    'These values are used to convert between RGB and HSL\r\n    Dim hh As Single, ss As Single, ll As Single\r\n    \r\n    'First, tally the luminance amounts (i.e. build the histogram)\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n    \r\n    'Compute our scaling factor\r\n    Dim scaleFactor As Double\r\n    scaleFactor = 255 / (iWidth * iHeight)\r\n    'Equalize the luminance\r\n    lum(0) = lum(0) * scaleFactor\r\n    For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n   'Integerize all the look-up values\r\n    For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "        "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfStatement
                                                                text: "If HandleR Then imageData(quickVal + 2, y) = rData(imageData(quickVal + 2, y))\r\n        If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n    \r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IfKeyword
                                                                    text: If
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: HandleR
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: HandleR
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ThenKeyword
                                                                    text: Then
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: imageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: quickVal
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "2,"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "2"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "2"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: IdentifierExpression
                                                                        text: ","
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "y) = rData(imageData(quickVal + 2, y))\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: BinaryExpression
                                                                        text: ") = rData(imageData(quickVal + 2, y))"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: )
                                                                            is_token: false
                                                                            children:
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "rData(imageData(quickVal + 2, y))"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: rData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "imageData(quickVal + 2, y)"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: "imageData(quickVal + 2, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: "imageData(quickVal + 2, y)"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: imageData
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: "quickVal + 2, y"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: quickVal + 2
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: BinaryExpression
                                                                                                    text: quickVal + 2
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: quickVal
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: quickVal
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "2"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "2"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Argument
                                                                                                text: y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IfStatement
                                                                    text: "If HandleG Then imageData(quickVal + 1, y) = gData(imageData(quickVal + 1, y))\r\n        If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n    Next x\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: HandleG
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: HandleG
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ThenKeyword
                                                                        text: Then
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: imageData
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: quickVal
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AdditionOperator
                                                                        text: +
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "1,"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: IdentifierExpression
                                                                            text: ","
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "y) = gData(imageData(quickVal + 1, y))\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: y
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: y
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: BinaryExpression
                                                                            text: ") = gData(imageData(quickVal + 1, y))"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: )
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: "gData(imageData(quickVal + 1, y))"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: gData
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: "imageData(quickVal + 1, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: "imageData(quickVal + 1, y)"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal + 1, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal + 1, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal + 1
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: BinaryExpression
                                                                                                        text: quickVal + 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: quickVal
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: quickVal
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AdditionOperator
                                                                                                            text: +
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If HandleB Then imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n    Next y\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: HandleB
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: HandleB
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "imageData(quickVal, y) = bData(imageData(quickVal, y))\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: "imageData(quickVal, y)"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: imageData
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: "quickVal, y"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: quickVal
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: quickVal
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: quickVal
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Comma
                                                                                        text: ","
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Argument
                                                                                        text: y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: y
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: "bData(imageData(quickVal, y))"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: bData
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: "imageData(quickVal, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: "imageData(quickVal, y)"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: quickVal
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: quickVal
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NextKeyword
                                                                            text: Next
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NextKeyword
                                                                        text: Next
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "    "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Draw the new image"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallStatement
                                                                text: "fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: fDraw
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: SetImageData2D
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: frmMain
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: PicMain
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: iWidth
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: iHeight
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: imageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Draw the new histogram"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallStatement
                                                                text: "frmHistogram.GenerateHistogram\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: frmHistogram
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: GenerateHistogram
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Unknown
                                                                text: End
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Unknown
                                                                text: Sub
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'EqualizeLuminance - attempt to redistribute values across the luminance spectrum,"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "' with roughly the same amount of pixels at each luminance level"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Public Sub EqualizeLuminance()\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: PublicKeyword
                                                                    text: Public
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubKeyword
                                                                    text: Sub
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: EqualizeLuminance
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'This array will hold the image's pixel data"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim imageData() As Byte\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: imageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ByteKeyword
                                                                    text: Byte
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Image dimensions"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim iWidth As Long, iHeight As Long\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: iWidth
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: iHeight
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim fDraw As New FastDrawing\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: fDraw
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NewKeyword
                                                                    text: New
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: FastDrawing
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "iWidth = fDraw.GetImageWidth(frmMain.PicMain)\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: iWidth
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iWidth
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallExpression
                                                                    text: fDraw.GetImageWidth(frmMain.PicMain)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: fDraw.GetImageWidth
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: fDraw
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: GetImageWidth
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: frmMain.PicMain
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: frmMain.PicMain
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: frmMain.PicMain
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: frmMain
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: PicMain
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "iHeight = fDraw.GetImageHeight(frmMain.PicMain)\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: iHeight
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iHeight
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallExpression
                                                                    text: fDraw.GetImageHeight(frmMain.PicMain)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: fDraw.GetImageHeight
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: fDraw
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: GetImageHeight
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: frmMain.PicMain
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: frmMain.PicMain
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: frmMain.PicMain
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: frmMain
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: PicMain
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: CallStatement
                                                                text: "fDraw.GetImageData2D frmMain.PicMain, imageData()\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: fDraw
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: GetImageData2D
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: frmMain
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: PicMain
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: imageData
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'These variables will hold temporary histogram values"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim r As Long, g As Long, b As Long, L As Long\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: r
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: g
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: b
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: L
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'This is used to access array locations quickly"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim quickVal As Long\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: quickVal
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LongKeyword
                                                                    text: Long
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'This array will hold our luminance values"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim lum(0 To 255) As Single\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: lum
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LeftParenthesis
                                                                    text: (
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ToKeyword
                                                                    text: To
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "255"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "255"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: RightParenthesis
                                                                    text: )
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SingleKeyword
                                                                    text: Single
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'These values are used to convert between RGB and HSL"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim hh As Single, ss As Single, ll As Single\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: hh
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SingleKeyword
                                                                    text: Single
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: ss
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SingleKeyword
                                                                    text: Single
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Comma
                                                                    text: ","
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: ll
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SingleKeyword
                                                                    text: Single
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'First, tally the luminance amounts (i.e. build the histogram)"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: ForStatement
                                                                text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    Next x\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: ForKeyword
                                                                    text: For
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ToKeyword
                                                                    text: To
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: iWidth - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: iWidth
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: iWidth
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubtractionOperator
                                                                        text: "-"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n    "
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "quickVal = x * 3\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: quickVal
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: quickVal
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: x * 3
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "3"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "3"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ForStatement
                                                                        text: "For y = 0 To iHeight - 1\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    Next y\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: ForKeyword
                                                                            text: For
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: y
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: y
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "0"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ToKeyword
                                                                            text: To
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: iHeight - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: iHeight
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iHeight
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        lum(ll) = lum(ll) + 1\r\n    "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "r = imageData(quickVal + 2, y)\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: r
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: r
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CallExpression
                                                                                    text: "imageData(quickVal + 2, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: imageData
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: "quickVal + 2, y"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: quickVal + 2
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: BinaryExpression
                                                                                                text: quickVal + 2
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: quickVal
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: quickVal
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AdditionOperator
                                                                                                    text: +
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "2"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "2"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Argument
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "g = imageData(quickVal + 1, y)\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: g
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: g
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CallExpression
                                                                                    text: "imageData(quickVal + 1, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: imageData
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: "quickVal + 1, y"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: quickVal + 1
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: BinaryExpression
                                                                                                text: quickVal + 1
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: quickVal
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: quickVal
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AdditionOperator
                                                                                                    text: +
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "1"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Argument
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "b = imageData(quickVal, y)\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: b
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: b
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CallExpression
                                                                                    text: "imageData(quickVal, y)"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: imageData
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: "quickVal, y"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: quickVal
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: quickVal
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: quickVal
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Argument
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallStatement
                                                                                text: "tRGBToHSL r, g, b, hh, ss, ll\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: tRGBToHSL
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: r
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: g
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: b
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: hh
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: ss
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: ll
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "lum(ll) = lum(ll) + 1\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: CallExpression
                                                                                    text: lum(ll)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: lum
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: ll
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: ll
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: ll
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: ll
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: lum(ll) + 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: lum(ll)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: lum
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: ll
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: ll
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: ll
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: ll
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AdditionOperator
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "1"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "1"
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "    "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: NextKeyword
                                                                            text: Next
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: y
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: NextKeyword
                                                                    text: Next
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Compute our scaling factor"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: DimStatement
                                                                text: "Dim scaleFactor As Double\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: DimKeyword
                                                                    text: Dim
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: scaleFactor
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AsKeyword
                                                                    text: As
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DoubleKeyword
                                                                    text: Double
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "scaleFactor = 255 / (iWidth * iHeight)\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: scaleFactor
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: scaleFactor
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: 255 / (iWidth * iHeight)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: NumericLiteralExpression
                                                                        text: "255"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "255"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: DivisionOperator
                                                                        text: /
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ParenthesizedExpression
                                                                        text: (iWidth * iHeight)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: iWidth * iHeight
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: iWidth
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iWidth
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: iHeight
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iHeight
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Equalize the luminance"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: AssignmentStatement
                                                                text: "lum(0) = lum(0) * scaleFactor\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: CallExpression
                                                                    text: lum(0)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: lum
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: "0"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: lum(0) * scaleFactor
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: lum(0)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: lum
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "0"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "0"
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: MultiplicationOperator
                                                                        text: "*"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: scaleFactor
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: scaleFactor
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: ForStatement
                                                                text: "For x = 1 To 255\r\n        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    Next x\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: ForKeyword
                                                                    text: For
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ToKeyword
                                                                    text: To
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "255"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "255"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "        lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n    "
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "lum(x) = lum(x - 1) + (scaleFactor * lum(x))\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: CallExpression
                                                                            text: lum(x)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: lum
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: x
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: lum(x - 1) + (scaleFactor * lum(x))
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: lum(x - 1)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: lum
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: x - 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: x - 1
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: x - 1
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: SubtractionOperator
                                                                                                text: "-"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "1"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "1"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AdditionOperator
                                                                                text: +
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ParenthesizedExpression
                                                                                text: (scaleFactor * lum(x))
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: scaleFactor * lum(x)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: scaleFactor
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: scaleFactor
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: MultiplicationOperator
                                                                                        text: "*"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CallExpression
                                                                                        text: lum(x)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: lum
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: NextKeyword
                                                                    text: Next
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: "   "
                                                                is_token: true
                                                                children: []
                                                              - kind: EndOfLineComment
                                                                text: "'Integerize all the look-up values"
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: "    "
                                                                is_token: true
                                                                children: []
                                                              - kind: ForStatement
                                                                text: "For x = 0 To 255\r\n        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: ForKeyword
                                                                    text: For
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: x
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: x
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EqualityOperator
                                                                    text: "="
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "0"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "0"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ToKeyword
                                                                    text: To
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "255"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "255"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CodeBlock
                                                                    text: "        lum(x) = Int(lum(x))\r\n        If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n    \r\n    'Apply the equalized values\r\n    For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n    \r\n    'Draw the new image\r\n    fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n    \r\n    'Draw the new histogram\r\n    frmHistogram.GenerateHistogram\r\n\r\nEnd Sub\r\n\r\n'All routines below this point are used to convert pixels between the RGB color space\r\n' and an HSL color space.  An explanation of these functions is beyond the scope of\r\n' this project - so I'm afraid you'll just have to take them on faith for now.  :)\r\nPrivate Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\nDim Max As Single\r\nDim Min As Single\r\nDim delta As Single\r\nDim rR As Single, rG As Single, rB As Single\r\n   rR = r / 255: rG = g / 255: rB = b / 255\r\n\r\n        Max = Maximum(rR, rG, rB)\r\n        Min = Minimum(rR, rG, rB)\r\n        L = (Max + Min) / 2\r\n        If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n    \r\n    L = Int(L * 255)\r\n    \r\nEnd Sub\r\n\r\nPublic Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\nDim rR As Single, rG As Single, rB As Single\r\nDim Min As Single, Max As Single\r\n\r\n   If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n   r = rR * 255: g = rG * 255: b = rB * 255\r\nEnd Sub\r\n\r\nPrivate Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\nPrivate Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n   If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\nEnd Function\r\n\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "lum(x) = Int(lum(x))\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: CallExpression
                                                                            text: lum(x)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: lum
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: x
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: Int(lum(x))
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Int
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: lum(x)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: lum(x)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: lum(x)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: lum
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If lum(x) > 255 Then lum(x) = 255\r\n    Next x\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: lum(x) > 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: lum(x)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: lum
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: GreaterThanOperator
                                                                                text: ">"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "lum(x) = 255\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: CallExpression
                                                                                text: lum(x)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: lum
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NextKeyword
                                                                            text: Next
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'Apply the equalized values"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ForStatement
                                                                        text: "For x = 0 To iWidth - 1\r\n        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    Next x\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: ForKeyword
                                                                            text: For
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "0"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "0"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ToKeyword
                                                                            text: To
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: iWidth - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: iWidth
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iWidth
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "        quickVal = x * 3\r\n    For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n    "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "quickVal = x * 3\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: quickVal
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: quickVal
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: x * 3
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: x
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: MultiplicationOperator
                                                                                        text: "*"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "3"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "3"
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "    "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ForStatement
                                                                                text: "For y = 0 To iHeight - 1\r\n        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    Next y\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: ForKeyword
                                                                                    text: For
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: y
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "0"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "0"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ToKeyword
                                                                                    text: To
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: iHeight - 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: iHeight
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: iHeight
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: SubtractionOperator
                                                                                        text: "-"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "1"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "1"
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CodeBlock
                                                                                    text: "        'Get the temporary values\r\n        r = imageData(quickVal + 2, y)\r\n        g = imageData(quickVal + 1, y)\r\n        b = imageData(quickVal, y)\r\n        'Get the hue and saturation\r\n        tRGBToHSL r, g, b, hh, ss, ll\r\n        'Convert back to RGB using our artificial luminance values\r\n        tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n        'Assign those values into the array\r\n        imageData(quickVal + 2, y) = r\r\n        imageData(quickVal + 1, y) = g\r\n        imageData(quickVal, y) = b\r\n    "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndOfLineComment
                                                                                        text: "'Get the temporary values"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "r = imageData(quickVal + 2, y)\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: r
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: r
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal + 2, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal + 2, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal + 2
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: BinaryExpression
                                                                                                        text: quickVal + 2
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: quickVal
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: quickVal
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AdditionOperator
                                                                                                            text: +
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "2"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "2"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "g = imageData(quickVal + 1, y)\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: g
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: g
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal + 1, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal + 1, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal + 1
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: BinaryExpression
                                                                                                        text: quickVal + 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: quickVal
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: quickVal
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AdditionOperator
                                                                                                            text: +
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "b = imageData(quickVal, y)\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: b
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: b
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: quickVal
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: quickVal
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndOfLineComment
                                                                                        text: "'Get the hue and saturation"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CallStatement
                                                                                        text: "tRGBToHSL r, g, b, hh, ss, ll\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: tRGBToHSL
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: r
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: g
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: b
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: hh
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: ss
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: ll
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndOfLineComment
                                                                                        text: "'Convert back to RGB using our artificial luminance values"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CallStatement
                                                                                        text: "tHSLToRGB hh, ss, lum(ll) / 255, r, g, b\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: tHSLToRGB
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: hh
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: ss
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: lum
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: ll
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: DivisionOperator
                                                                                            text: /
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IntegerLiteral
                                                                                            text: "255"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: r
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: g
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Comma
                                                                                            text: ","
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: b
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndOfLineComment
                                                                                        text: "'Assign those values into the array"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: imageData
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: quickVal
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "2,"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "2"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "2"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: ","
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "y) = r\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: y
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: ) = r
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: )
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: r
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: r
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: imageData
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: quickVal
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Unknown
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "1,"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "1"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "1"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: ","
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "y) = g\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: y
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: ) = g
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: )
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: g
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: g
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "imageData(quickVal, y) = b\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: "imageData(quickVal, y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: imageData
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "quickVal, y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: quickVal
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: quickVal
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: quickVal
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: b
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: b
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "    "
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: NextKeyword
                                                                                    text: Next
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: y
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "    "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: NextKeyword
                                                                            text: Next
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'Draw the new image"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallStatement
                                                                        text: "fDraw.SetImageData2D frmMain.PicMain, iWidth, iHeight, imageData()\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: fDraw
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: SetImageData2D
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: frmMain
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: PicMain
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: iWidth
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: iHeight
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: imageData
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'Draw the new histogram"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CallStatement
                                                                        text: "frmHistogram.GenerateHistogram\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: frmHistogram
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: GenerateHistogram
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'All routines below this point are used to convert pixels between the RGB color space"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "' and an HSL color space.  An explanation of these functions is beyond the scope of"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "' this project - so I'm afraid you'll just have to take them on faith for now.  :)"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: DimStatement
                                                                        text: "Private Sub tRGBToHSL(r As Long, g As Long, b As Long, h As Single, s As Single, L As Single)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: PrivateKeyword
                                                                            text: Private
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubKeyword
                                                                            text: Sub
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: tRGBToHSL
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: r
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: g
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: b
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: h
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: s
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: L
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim Max As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Max
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim Min As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Min
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim delta As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: delta
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim rR As Single, rG As Single, rB As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rR
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rG
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rB
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "   "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: rR = r / 255
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: rR
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: rR
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: r / 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: r
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: r
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: Unknown
                                                                        text: ":"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: rG = g / 255
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: rG
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: rG
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: g / 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: g
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: g
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: Unknown
                                                                        text: ":"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "rB = b / 255\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: rB
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: rB
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: b / 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: b
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: b
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "Max = Maximum(rR, rG, rB)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: Max
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Max
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "Maximum(rR, rG, rB)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Maximum
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "rR, rG, rB"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: rR
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rR
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rR
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: rG
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rG
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rG
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: rB
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rB
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rB
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "Min = Minimum(rR, rG, rB)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: Min
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Min
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: "Minimum(rR, rG, rB)"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Minimum
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: "rR, rG, rB"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: rR
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rR
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rR
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: rG
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rG
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rG
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Comma
                                                                                    text: ","
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Argument
                                                                                    text: rB
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: rB
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: rB
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "L = (Max + Min) / 2\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: L
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: L
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: (Max + Min) / 2
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ParenthesizedExpression
                                                                                text: (Max + Min)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: Max + Min
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: Max
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: Max
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AdditionOperator
                                                                                        text: +
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: Min
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: Min
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DivisionOperator
                                                                                text: /
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "2"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "2"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If Max = Min Then\r\n            s = 0\r\n            h = 0\r\n        Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      End If\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: Max = Min
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: Max
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: Max
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: Min
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: Min
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "            s = 0\r\n            h = 0\r\n        "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "s = 0\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: s
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: s
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "0"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "0"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "h = 0\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: h
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: h
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "0"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "0"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: ElseClause
                                                                            text: "Else\r\n           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ElseKeyword
                                                                                text: Else
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "           If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n            delta = Max - Min\r\n           If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n        \r\n      "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "           "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If L <= 0.5 Then\r\n               s = (Max - Min) / (Max + Min)\r\n           Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: L <= 0.5
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: L
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: L
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOrEqualOperator
                                                                                            text: "<="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "0.5"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: SingleLiteral
                                                                                                text: "0.5"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "               s = (Max - Min) / (Max + Min)\r\n           "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "               "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "s = (Max - Min) / (Max + Min)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: s
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: s
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: (Max - Min) / (Max + Min)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (Max - Min)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: Max - Min
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Max
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Max
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Min
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DivisionOperator
                                                                                                    text: /
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (Max + Min)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: Max + Min
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Max
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Max
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AdditionOperator
                                                                                                            text: +
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Min
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "           "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n               s = (Max - Min) / (2 - Max - Min)\r\n            "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "               s = (Max - Min) / (2 - Max - Min)\r\n            "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "               "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "s = (Max - Min) / (2 - Max - Min)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: s
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: s
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: (Max - Min) / (2 - Max - Min)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (Max - Min)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: Max - Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Max
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Max
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Min
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Min
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: DivisionOperator
                                                                                                        text: /
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: (2 - Max - Min)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: 2 - Max - Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: BinaryExpression
                                                                                                                text: 2 - Max
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: NumericLiteralExpression
                                                                                                                    text: "2"
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IntegerLiteral
                                                                                                                        text: "2"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: SubtractionOperator
                                                                                                                    text: "-"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: Max
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: Max
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Min
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Min
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "            "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "delta = Max - Min\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: delta
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: delta
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: Max - Min
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: Max
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Max
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: SubtractionOperator
                                                                                            text: "-"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: Min
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Min
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "           "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If rR = Max Then\r\n                h = (rG - rB) / delta\r\n           ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: rR = Max
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: rR
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rR
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: Max
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Max
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "                h = (rG - rB) / delta\r\n           "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "                "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "h = (rG - rB) / delta\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: h
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: h
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: (rG - rB) / delta
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (rG - rB)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: rG - rB
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rG
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rG
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rB
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rB
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: DivisionOperator
                                                                                                    text: /
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: delta
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: delta
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "           "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseIfClause
                                                                                        text: "ElseIf rG = Max Then\r\n                h = 2 + (rB - rR) / delta\r\n           "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseIfKeyword
                                                                                            text: ElseIf
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: rG = Max
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: rG
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rG
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: Max
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Max
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ThenKeyword
                                                                                            text: Then
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "                h = 2 + (rB - rR) / delta\r\n           "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "                "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "h = 2 + (rB - rR) / delta\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: h
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: h
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: 2 + (rB - rR) / delta
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "2"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "2"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: (rB - rR) / delta
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: (rB - rR)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: rB - rR
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rB
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rB
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: SubtractionOperator
                                                                                                                    text: "-"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rR
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rR
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: DivisionOperator
                                                                                                            text: /
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: delta
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: delta
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "           "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: ElseIfClause
                                                                                        text: "ElseIf rB = Max Then\r\n                h = 4 + (rR - rG) / delta\r\n           "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseIfKeyword
                                                                                            text: ElseIf
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: rB = Max
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: Max
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Max
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ThenKeyword
                                                                                            text: Then
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "                h = 4 + (rR - rG) / delta\r\n           "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "                "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "h = 4 + (rR - rG) / delta\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: h
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: h
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: 4 + (rR - rG) / delta
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "4"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "4"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AdditionOperator
                                                                                                        text: +
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: (rR - rG) / delta
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: (rR - rG)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: rR - rG
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rR
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rR
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: SubtractionOperator
                                                                                                                    text: "-"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rG
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rG
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: DivisionOperator
                                                                                                            text: /
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: delta
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: delta
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "           "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: EndKeyword
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "L = Int(L * 255)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: L
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: L
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: Int(L * 255)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Int
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: L * 255
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: L * 255
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: BinaryExpression
                                                                                        text: L * 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: L
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: L
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: MultiplicationOperator
                                                                                            text: "*"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "    "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: DimStatement
                                                                        text: "Public Sub tHSLToRGB(h As Single, s As Single, L As Single, r As Long, g As Long, b As Long)\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: PublicKeyword
                                                                            text: Public
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubKeyword
                                                                            text: Sub
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: tHSLToRGB
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: h
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: s
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: L
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: r
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: g
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: b
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LongKeyword
                                                                            text: Long
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim rR As Single, rG As Single, rB As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rR
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rG
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rB
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: DimStatement
                                                                        text: "Dim Min As Single, Max As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: DimKeyword
                                                                            text: Dim
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Min
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Max
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: "   "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If s = 0 Then\r\n      rR = L: rG = L: rB = L\r\n   Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   End If\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: s = 0
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: s
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: s
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "      rR = L: rG = L: rB = L\r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "      "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: rR = L
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: rR
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rR
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: L
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: L
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Unknown
                                                                                text: ":"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: rG = L
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: rG
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rG
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: L
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: L
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Unknown
                                                                                text: ":"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "rB = L\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: rB
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rB
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: L
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: L
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "   "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: ElseClause
                                                                            text: "Else\r\n      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ElseKeyword
                                                                                text: Else
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "      If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n      Max = 2 * L - Min\r\n      \r\n      If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n            \r\n   "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If L <= 0.5 Then\r\n         Min = L * (1 - s)\r\n      Else\r\n         Min = L - s * (1 - L)\r\n      End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: L <= 0.5
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: L
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: L
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOrEqualOperator
                                                                                            text: "<="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "0.5"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: SingleLiteral
                                                                                                text: "0.5"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         Min = L * (1 - s)\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Min = L * (1 - s)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Min
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Min
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: L * (1 - s)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: L
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: L
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: MultiplicationOperator
                                                                                                    text: "*"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (1 - s)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: 1 - s
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: s
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: s
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n         Min = L - s * (1 - L)\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "         Min = L - s * (1 - L)\r\n      "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "Min = L - s * (1 - L)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Min
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Min
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: L - s * (1 - L)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: L
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: L
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: SubtractionOperator
                                                                                                        text: "-"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: s * (1 - L)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: s
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: s
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: MultiplicationOperator
                                                                                                            text: "*"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: (1 - L)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: 1 - L
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: NumericLiteralExpression
                                                                                                                    text: "1"
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IntegerLiteral
                                                                                                                        text: "1"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: SubtractionOperator
                                                                                                                    text: "-"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: L
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: L
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "      "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "Max = 2 * L - Min\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: Max
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: Max
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: 2 * L - Min
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: 2 * L
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "2"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "2"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: MultiplicationOperator
                                                                                                text: "*"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: L
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: L
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: SubtractionOperator
                                                                                            text: "-"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: Min
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Min
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If (h < 1) Then\r\n         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (h < 1)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: h < 1
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: h
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: h
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LessThanOperator
                                                                                                text: "<"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "1"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "1"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         rR = Max\r\n         If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "rR = Max\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: rR
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rR
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: Max
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Max
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IfStatement
                                                                                            text: "If (h < 0) Then\r\n            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         End If\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IfKeyword
                                                                                                text: If
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ParenthesizedExpression
                                                                                                text: (h < 0)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: h < 0
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: h
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: h
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LessThanOperator
                                                                                                        text: "<"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "0"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "0"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ThenKeyword
                                                                                                text: Then
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CodeBlock
                                                                                                text: "            rG = Min\r\n            rB = rG - h * (Max - Min)\r\n         "
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Whitespace
                                                                                                    text: "            "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AssignmentStatement
                                                                                                    text: "rG = Min\r\n"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: rG
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: rG
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EqualityOperator
                                                                                                        text: "="
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: Min
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: Min
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: "            "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AssignmentStatement
                                                                                                    text: "rB = rG - h * (Max - Min)\r\n"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: rB
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: rB
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EqualityOperator
                                                                                                        text: "="
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: rG - h * (Max - Min)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rG
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rG
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: h * (Max - Min)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: h
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: h
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: MultiplicationOperator
                                                                                                                text: "*"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: ParenthesizedExpression
                                                                                                                text: (Max - Min)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: LeftParenthesis
                                                                                                                    text: (
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: Max - Min
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: Max
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: Max
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: SubtractionOperator
                                                                                                                        text: "-"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: IdentifierExpression
                                                                                                                        text: Min
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: Identifier
                                                                                                                            text: Min
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: RightParenthesis
                                                                                                                    text: )
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: "         "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: ElseClause
                                                                                                text: "Else\r\n            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         "
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: ElseKeyword
                                                                                                    text: Else
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "            rB = Min\r\n            rG = h * (Max - Min) + rB\r\n         "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rB = Min\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rB
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rB
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Min
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rG = h * (Max - Min) + rB\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rG
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rG
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: h * (Max - Min) + rB
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: BinaryExpression
                                                                                                                text: h * (Max - Min)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: h
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: h
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (Max - Min)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: Max - Min
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Max
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Max
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Min
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Min
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: AdditionOperator
                                                                                                                text: +
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rB
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rB
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "         "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: EndKeyword
                                                                                                text: End
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfKeyword
                                                                                                text: If
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseIfClause
                                                                                        text: "ElseIf (h < 3) Then\r\n         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseIfKeyword
                                                                                            text: ElseIf
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ParenthesizedExpression
                                                                                            text: (h < 3)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: h < 3
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: h
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: h
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LessThanOperator
                                                                                                    text: "<"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "3"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "3"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ThenKeyword
                                                                                            text: Then
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "         rG = Max\r\n         If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n      "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "rG = Max\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: rG
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: rG
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Max
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Max
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If (h < 2) Then\r\n            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         End If\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (h < 2)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: h < 2
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: h
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: h
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LessThanOperator
                                                                                                            text: "<"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "2"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "2"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "            rB = Min\r\n            rR = rB - (h - 2) * (Max - Min)\r\n         "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rB = Min\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rB
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rB
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Min
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rR = rB - (h - 2) * (Max - Min)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rR
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rR
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: rB - (h - 2) * (Max - Min)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rB
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rB
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: (h - 2) * (Max - Min)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (h - 2)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: h - 2
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: h
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: h
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: NumericLiteralExpression
                                                                                                                            text: "2"
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IntegerLiteral
                                                                                                                                text: "2"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (Max - Min)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: Max - Min
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Max
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Max
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Min
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Min
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "         "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: ElseClause
                                                                                                    text: "Else\r\n            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ElseKeyword
                                                                                                        text: Else
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CodeBlock
                                                                                                        text: "            rR = Min\r\n            rB = (h - 2) * (Max - Min) + rR\r\n         "
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Whitespace
                                                                                                            text: "            "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AssignmentStatement
                                                                                                            text: "rR = Min\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rR
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rR
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Min
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Min
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "            "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AssignmentStatement
                                                                                                            text: "rB = (h - 2) * (Max - Min) + rR\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rB
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rB
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: (h - 2) * (Max - Min) + rR
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: (h - 2) * (Max - Min)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: ParenthesizedExpression
                                                                                                                        text: (h - 2)
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: LeftParenthesis
                                                                                                                            text: (
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: h - 2
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: h
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: h
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: SubtractionOperator
                                                                                                                                text: "-"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: NumericLiteralExpression
                                                                                                                                text: "2"
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: IntegerLiteral
                                                                                                                                    text: "2"
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: RightParenthesis
                                                                                                                            text: )
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: MultiplicationOperator
                                                                                                                        text: "*"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: ParenthesizedExpression
                                                                                                                        text: (Max - Min)
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: LeftParenthesis
                                                                                                                            text: (
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: Max - Min
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: Max
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: Max
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: SubtractionOperator
                                                                                                                                text: "-"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: Min
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: Min
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: RightParenthesis
                                                                                                                            text: )
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: AdditionOperator
                                                                                                                    text: +
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rR
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rR
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "         "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: EndKeyword
                                                                                                    text: End
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "      "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "         rB = Max\r\n         If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n         \r\n      "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "rB = Max\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: rB
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: rB
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Max
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Max
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IfStatement
                                                                                                text: "If (h < 4) Then\r\n            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         End If\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (h < 4)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: h < 4
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: h
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: h
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: LessThanOperator
                                                                                                            text: "<"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "4"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "4"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ThenKeyword
                                                                                                    text: Then
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CodeBlock
                                                                                                    text: "            rR = Min\r\n            rG = rR - (h - 4) * (Max - Min)\r\n         "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rR = Min\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rR
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rR
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Min
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Min
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "            "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: AssignmentStatement
                                                                                                        text: "rG = rR - (h - 4) * (Max - Min)\r\n"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: rG
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: rG
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: EqualityOperator
                                                                                                            text: "="
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: rR - (h - 4) * (Max - Min)
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rR
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rR
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: (h - 4) * (Max - Min)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (h - 4)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: h - 4
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: h
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: h
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: NumericLiteralExpression
                                                                                                                            text: "4"
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IntegerLiteral
                                                                                                                                text: "4"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: MultiplicationOperator
                                                                                                                    text: "*"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (Max - Min)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: Max - Min
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Max
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Max
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: Min
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: Min
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                          - kind: Newline
                                                                                                            text: "\r\n"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: "         "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: ElseClause
                                                                                                    text: "Else\r\n            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         "
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: ElseKeyword
                                                                                                        text: Else
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: CodeBlock
                                                                                                        text: "            rG = Min\r\n            rR = (h - 4) * (Max - Min) + rG\r\n         "
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Whitespace
                                                                                                            text: "            "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AssignmentStatement
                                                                                                            text: "rG = Min\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rG
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rG
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: Min
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: Min
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "            "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: AssignmentStatement
                                                                                                            text: "rR = (h - 4) * (Max - Min) + rG\r\n"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: rR
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: rR
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: EqualityOperator
                                                                                                                text: "="
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: (h - 4) * (Max - Min) + rG
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: (h - 4) * (Max - Min)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: ParenthesizedExpression
                                                                                                                        text: (h - 4)
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: LeftParenthesis
                                                                                                                            text: (
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: h - 4
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: h
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: h
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: SubtractionOperator
                                                                                                                                text: "-"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: NumericLiteralExpression
                                                                                                                                text: "4"
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: IntegerLiteral
                                                                                                                                    text: "4"
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: RightParenthesis
                                                                                                                            text: )
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: MultiplicationOperator
                                                                                                                        text: "*"
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: ParenthesizedExpression
                                                                                                                        text: (Max - Min)
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: LeftParenthesis
                                                                                                                            text: (
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: Max - Min
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: Max
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: Max
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: SubtractionOperator
                                                                                                                                text: "-"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: IdentifierExpression
                                                                                                                                text: Min
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Identifier
                                                                                                                                    text: Min
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: RightParenthesis
                                                                                                                            text: )
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: AdditionOperator
                                                                                                                    text: +
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: IdentifierExpression
                                                                                                                    text: rG
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: Identifier
                                                                                                                        text: rG
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: Newline
                                                                                                                text: "\r\n"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: "         "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: EndKeyword
                                                                                                    text: End
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IfKeyword
                                                                                                    text: If
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: "      "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "   "
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: EndKeyword
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "   "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: r = rR * 255
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: r
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: r
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: rR * 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: rR
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: rR
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: Unknown
                                                                        text: ":"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: g = rG * 255
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: g
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: g
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: rG * 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: rG
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: rG
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: Unknown
                                                                        text: ":"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "b = rB * 255\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: b
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: b
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: rB * 255
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: rB
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: rB
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Unknown
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: DimStatement
                                                                        text: "Private Function Maximum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: PrivateKeyword
                                                                            text: Private
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: FunctionKeyword
                                                                            text: Function
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Maximum
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rR
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rG
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rB
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "   "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If (rR > rG) Then\r\n      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   End If\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ParenthesizedExpression
                                                                            text: (rR > rG)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: rR > rG
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: rR
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rR
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: GreaterThanOperator
                                                                                    text: ">"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: rG
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rG
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "      If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "      "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If (rR > rB) Then\r\n         Maximum = rR\r\n      Else\r\n         Maximum = rB\r\n      End If\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ParenthesizedExpression
                                                                                    text: (rR > rB)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: rR > rB
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: rR
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rR
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: GreaterThanOperator
                                                                                            text: ">"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: rB
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rB
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ThenKeyword
                                                                                    text: Then
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CodeBlock
                                                                                    text: "         Maximum = rR\r\n      "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Whitespace
                                                                                        text: "         "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "Maximum = rR\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: Maximum
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Maximum
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: rR
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rR
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "      "
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: ElseClause
                                                                                    text: "Else\r\n         Maximum = rB\r\n      "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ElseKeyword
                                                                                        text: Else
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         Maximum = rB\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Maximum = rB\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Maximum
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Maximum
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: EndKeyword
                                                                                    text: End
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "   "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: ElseClause
                                                                            text: "Else\r\n      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ElseKeyword
                                                                                text: Else
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "      If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n   "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If (rB > rG) Then\r\n         Maximum = rB\r\n      Else\r\n         Maximum = rG\r\n      End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (rB > rG)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: rB > rG
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: GreaterThanOperator
                                                                                                text: ">"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rG
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rG
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         Maximum = rB\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Maximum = rB\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Maximum
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Maximum
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n         Maximum = rG\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "         Maximum = rG\r\n      "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "Maximum = rG\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Maximum
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Maximum
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: rG
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: rG
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "      "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "   "
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: EndKeyword
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Unknown
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: Function
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: DimStatement
                                                                        text: "Private Function Minimum(ByVal rR As Single, ByVal rG As Single, ByVal rB As Single) As Single\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: PrivateKeyword
                                                                            text: Private
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: FunctionKeyword
                                                                            text: Function
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: Minimum
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rR
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rG
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Comma
                                                                            text: ","
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ByValKeyword
                                                                            text: ByVal
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: rB
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AsKeyword
                                                                            text: As
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SingleKeyword
                                                                            text: Single
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "   "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfStatement
                                                                        text: "If (rR < rG) Then\r\n      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   End If\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ParenthesizedExpression
                                                                            text: (rR < rG)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: rR < rG
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: rR
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rR
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LessThanOperator
                                                                                    text: "<"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: rG
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: rG
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ThenKeyword
                                                                            text: Then
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CodeBlock
                                                                            text: "      If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Whitespace
                                                                                text: "      "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If (rR < rB) Then\r\n         Minimum = rR\r\n      Else\r\n         Minimum = rB\r\n      End If\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ParenthesizedExpression
                                                                                    text: (rR < rB)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: rR < rB
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: rR
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rR
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOperator
                                                                                            text: "<"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: rB
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rB
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ThenKeyword
                                                                                    text: Then
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CodeBlock
                                                                                    text: "         Minimum = rR\r\n      "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Whitespace
                                                                                        text: "         "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "Minimum = rR\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: Minimum
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Minimum
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: rR
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: rR
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "      "
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: ElseClause
                                                                                    text: "Else\r\n         Minimum = rB\r\n      "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ElseKeyword
                                                                                        text: Else
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         Minimum = rB\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Minimum = rB\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Minimum
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Minimum
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: EndKeyword
                                                                                    text: End
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "   "
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: ElseClause
                                                                            text: "Else\r\n      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   "
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ElseKeyword
                                                                                text: Else
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "      If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n   "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "      "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If (rB < rG) Then\r\n         Minimum = rB\r\n      Else\r\n         Minimum = rG\r\n      End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (rB < rG)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: rB < rG
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LessThanOperator
                                                                                                text: "<"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rG
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rG
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "         Minimum = rB\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "         "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Minimum = rB\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Minimum
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Minimum
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: rB
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: rB
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "      "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n         Minimum = rG\r\n      "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "         Minimum = rG\r\n      "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "         "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "Minimum = rG\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Minimum
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Minimum
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: rG
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: rG
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "      "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "   "
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: EndKeyword
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfKeyword
                                                                            text: If
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Unknown
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Unknown
                                                                        text: Function
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
