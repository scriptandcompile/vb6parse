---
source: tests/class.rs
expression: class2
---
header:
  version:
    major: 1
    minor: 0
  properties:
    multi_use: MultiUse
    persistable: NotPersistable
    data_binding_behavior: None
    data_source_behavior: None
    mts_transaction_mode: NotAnMTSObject
  attributes:
    name: pdOpenSaveDialog
    global_name_space: Local
    creatable: "True"
    predeclared_id: "False"
    exposed: "False"
    description: ~
    ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'PhotoDemon Unicode-Aware System Open/Save Dialog\r\n'Copyright 2015-2018 by Tanner Helland\r\n'Created: 05/August/15\r\n'Last updated: 15/August/15\r\n'Last update: finish work on GetSaveFileName()\r\n'\r\n'Common dialogs appear in multiple places throughout PD.  In the beginning, PD relied on a convenient common dialog wrapper\r\n' from vbAccelerator (http://www.vbaccelerator.com/home/VB/Code/Libraries/Common_Dialogs/Code_Only_Common_Dialogs/article.asp),\r\n' but besides being unwieldy and somewhat error-prone, Steve's implementation was ANSI-only.  Due to some major differences in\r\n' string handling (including multifile delimiters), it was non-trivial to overhaul his control, so in 2015, I wrote a new\r\n' common dialog interface, specific to PD.\r\n'\r\n'The eventual goal is to add parallel support for Vista's IFileOpen/SaveDialogs, which would actually allow me to customize\r\n' the program's main dialogs, but that's a ways off.  For now, everything simply wraps the traditional common dialog controls.\r\n'\r\n'For convenience against existing code, the function calls are roughly identical to Steve's old control.\r\n'\r\n'All source code in this file is licensed under a modified BSD license.  This means you may use the code in your own\r\n' projects IF you provide attribution.  For more information, please visit https://photodemon.org/license/\r\n'\r\n'***************************************************************************\r\n\r\n\r\nOption Explicit\r\n\r\n'Unicode interface.  Note that the only thing we pass it is a pointer to the master OPENFILENAME struct; it does the rest.\r\nPrivate Declare Function GetOpenFileNameW Lib \"comdlg32\" (ByVal ptrToOFN As Long) As Long\r\nPrivate Declare Function GetSaveFileNameW Lib \"comdlg32\" (ByVal ptrToOFN As Long) As Long\r\nPrivate Declare Function CommDlgExtendedError Lib \"comdlg32\" () As Long\r\nPrivate Declare Function lstrlenW Lib \"kernel32\" (ByVal lpString As Long) As Long\r\n\r\n'MSDN struct breakdown: https://msdn.microsoft.com/en-us/library/ms646839%28v=vs.85%29.aspx\r\n' Note that some parameter behavior (e.g. lpstrInitialDir) varies under Win 7 and later.\r\nPrivate Type OPENFILENAME\r\n    lStructSize          As Long\r\n    hWndOwner            As Long\r\n    hInstance            As Long\r\n    lpstrFilter          As String\r\n    lpstrCustomFilter    As String\r\n    nMaxCustFilter       As Long\r\n    nFilterIndex         As Long\r\n    lpstrFile            As String\r\n    nMaxFile             As Long\r\n    lpstrFileTitle       As String\r\n    nMaxFileTitle        As Long\r\n    lpstrInitialDir      As String\r\n    lpstrTitle           As String\r\n    Flags                As Long\r\n    nFileOffset          As Integer\r\n    nFileExtension       As Integer\r\n    lpstrDefExt          As String\r\n    lCustData            As Long\r\n    lpfnHook             As Long\r\n    lpTemplateName       As Long\r\n    pvReserved           As Long\r\n    dwReserved           As Long\r\n    FlagsEx              As Long\r\nEnd Type\r\n\r\nPrivate Enum EOpenFile\r\n    OFN_READONLY = &H1\r\n    OFN_OVERWRITEPROMPT = &H2\r\n    OFN_HIDEREADONLY = &H4\r\n    OFN_NOCHANGEDIR = &H8\r\n    OFN_SHOWHELP = &H10\r\n    OFN_ENABLEHOOK = &H20\r\n    OFN_ENABLETEMPLATE = &H40\r\n    OFN_ENABLETEMPLATEHANDLE = &H80\r\n    OFN_NOVALIDATE = &H100\r\n    OFN_ALLOWMULTISELECT = &H200\r\n    OFN_EXTENSIONDIFFERENT = &H400\r\n    OFN_PATHMUSTEXIST = &H800\r\n    OFN_FILEMUSTEXIST = &H1000\r\n    OFN_CREATEPROMPT = &H2000\r\n    OFN_SHAREAWARE = &H4000\r\n    OFN_NOREADONLYRETURN = &H8000&\r\n    OFN_NOTESTFILECREATE = &H10000\r\n    OFN_NONETWORKBUTTON = &H20000\r\n    OFN_NOLONGNAMES = &H40000\r\n    OFN_EXPLORER = &H80000\r\n    OFN_NODEREFERENCELINKS = &H100000\r\n    OFN_LONGNAMES = &H200000\r\nEnd Enum\r\n\r\n#If False Then\r\n    Private Const OFN_READONLY = &H1, OFN_OVERWRITEPROMPT = &H2, OFN_HIDEREADONLY = &H4, OFN_NOCHANGEDIR = &H8, OFN_SHOWHELP = &H10\r\n    Private Const OFN_ENABLEHOOK = &H20, OFN_ENABLETEMPLATE = &H40, OFN_ENABLETEMPLATEHANDLE = &H80, OFN_NOVALIDATE = &H100\r\n    Private Const OFN_ALLOWMULTISELECT = &H200, OFN_EXTENSIONDIFFERENT = &H400, OFN_PATHMUSTEXIST = &H800, OFN_FILEMUSTEXIST = &H1000\r\n    Private Const OFN_CREATEPROMPT = &H2000, OFN_SHAREAWARE = &H4000, OFN_NOREADONLYRETURN = &H8000&, OFN_NOTESTFILECREATE = &H10000\r\n    Private Const OFN_NONETWORKBUTTON = &H20000, OFN_NOLONGNAMES = &H40000, OFN_EXPLORER = &H80000, OFN_NODEREFERENCELINKS = &H100000\r\n    Private Const OFN_LONGNAMES = &H200000\r\n#End If\r\n\r\n'MSDN explanation of potential CD errors: https://msdn.microsoft.com/en-us/library/ms646916%28v=vs.85%29.aspx\r\nPublic Enum CommonDialogErrorsEnum\r\n    CDERR_DIALOGFAILURE = &HFFFF&\r\n    CDERR_FINDRESFAILURE = &H6\r\n    CDERR_LOADRESFAILURE = &H7\r\n    CDERR_INITIALIZATION = &H2\r\n    CDERR_LOADSTRFAILURE = &H5\r\n    CDERR_LOCKRESFAILURE = &H8\r\n    CDERR_MEMALLOCFAILURE = &H9\r\n    CDERR_MEMLOCKFAILURE = &HA\r\n    CDERR_NOHINSTANCE = &H4\r\n    CDERR_NOHOOK = &H8\r\n    CDERR_NOTEMPLATE = &H3\r\n    CDERR_REGISTERMSGFAIL = &HC\r\n    CDERR_STRUCTSIZE = &H1\r\n    FNERR_BUFFERTOOSMALL = &H3003&\r\n    FNERR_INVALIDFILENAME = &H3002&\r\n    FNERR_SUBCLASSFAILURE = &H3001&\r\n    CDERR_CANCELED = vbObjectError\r\nEnd Enum\r\n\r\n'Arbitrary-length return strings are possible, but because we have to re-raise the dialog upon failure (ugh), it's not\r\n' really practical to implement a \"try again with larger buffer\" feature.  Fortunately, post-XP operatings systems have\r\n' no upper limit, so we can start with an arbitrarily large string.\r\nPrivate Const MAX_PATH_LOAD_XP As Long = 16384\r\nPrivate Const MAX_PATH_LOAD As Long = 262144\r\nPrivate Const MAX_PATH_SAVE As Long = 1024\r\nPrivate Const MAX_FILE As Long = 260\r\n\r\n'Display a system-specific Open File dialog.\r\n' RETURNS: TRUE if one or more files was selected; FALSE if canceled.\r\nFriend Function GetOpenFileName(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal FileMustExist As Boolean = True, _\r\n                           Optional ByVal MultiSelect As Boolean = False, _\r\n                           Optional ByVal Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = 0&) As Boolean\r\n    \r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST\r\n        ' is used to prevent the user from entering invalid filenames.\r\n        .Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n        \r\n        'Various other obvious flags\r\n        .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim Ch As String, i As Integer, s As String\r\n        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,\r\n        ' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch.\r\n        lInitPathSize = MAX_PATH_LOAD_XP\r\n        \r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetOpenFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Before proceeding, add debug info in the special case of a buffer underrun.  This case is problematic, as we can't simply\r\n    ' \"try again\" without re-raising a modal dialog, so I'm hoping my current default buffer size is always sufficient.\r\n    If (lReturn = 0) And (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL) Then\r\n        MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n    End If\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 16K buffer as a limit,\r\n    '  since PD won't do well with that many loaded images anyway.)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant strings.\r\n        \r\n        Dim lLen As Long\r\n        \r\n        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n        \r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetOpenFileName = True\r\n        \r\n    Else\r\n        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    End If\r\n                    \r\nEnd Function\r\n\r\n'Display a system-specific Save File dialog.\r\n' RETURNS: TRUE if a valid save target was selected/created; FALSE if canceled.\r\nFriend Function GetSaveFileName(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal OverWritePrompt As Boolean = True, _\r\n                           Optional ByRef Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = -1) As Boolean\r\n\r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD.\r\n        .Flags = OFN_HIDEREADONLY\r\n        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n        \r\n        'Various other obvious flags\r\n        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim s As String\r\n        s = Filter\r\n        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call\r\n        ' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer).\r\n        lInitPathSize = MAX_PATH_SAVE\r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetSaveFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 1K buffer as a limit,\r\n    '  which should allow for saving to just about anywhere!)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant filename string.\r\n        Dim lLen As Long\r\n        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n        \r\n        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n        'As a convenience, return the file title too (which is just the filename + extension, with no path data)\r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetSaveFileName = True\r\n        \r\n    Else\r\n        GetSaveFileName = False\r\n    End If\r\n    \r\nEnd Function\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'PhotoDemon Unicode-Aware System Open/Save Dialog"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2015-2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Created: 05/August/15"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Last updated: 15/August/15"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Last update: finish work on GetSaveFileName()"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Common dialogs appear in multiple places throughout PD.  In the beginning, PD relied on a convenient common dialog wrapper"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' from vbAccelerator (http://www.vbaccelerator.com/home/VB/Code/Libraries/Common_Dialogs/Code_Only_Common_Dialogs/article.asp),"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' but besides being unwieldy and somewhat error-prone, Steve's implementation was ANSI-only.  Due to some major differences in"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' string handling (including multifile delimiters), it was non-trivial to overhaul his control, so in 2015, I wrote a new"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' common dialog interface, specific to PD."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The eventual goal is to add parallel support for Vista's IFileOpen/SaveDialogs, which would actually allow me to customize"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' the program's main dialogs, but that's a ways off.  For now, everything simply wraps the traditional common dialog controls."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'For convenience against existing code, the function calls are roughly identical to Steve's old control."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'All source code in this file is licensed under a modified BSD license.  This means you may use the code in your own"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' projects IF you provide attribution.  For more information, please visit https://photodemon.org/license/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Unicode interface.  Note that the only thing we pass it is a pointer to the master OPENFILENAME struct; it does the rest."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function GetOpenFileNameW Lib \"comdlg32\" (ByVal ptrToOFN As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetOpenFileNameW
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"comdlg32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal ptrToOFN As Long)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ptrToOFN
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function GetSaveFileNameW Lib \"comdlg32\" (ByVal ptrToOFN As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetSaveFileNameW
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"comdlg32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal ptrToOFN As Long)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ptrToOFN
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function CommDlgExtendedError Lib \"comdlg32\" () As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: CommDlgExtendedError
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"comdlg32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function lstrlenW Lib \"kernel32\" (ByVal lpString As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: lstrlenW
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"kernel32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByVal lpString As Long)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpString
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'MSDN struct breakdown: https://msdn.microsoft.com/en-us/library/ms646839%28v=vs.85%29.aspx"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Note that some parameter behavior (e.g. lpstrInitialDir) varies under Win 7 and later."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: TypeStatement
        text: "Private Type OPENFILENAME\r\n    lStructSize          As Long\r\n    hWndOwner            As Long\r\n    hInstance            As Long\r\n    lpstrFilter          As String\r\n    lpstrCustomFilter    As String\r\n    nMaxCustFilter       As Long\r\n    nFilterIndex         As Long\r\n    lpstrFile            As String\r\n    nMaxFile             As Long\r\n    lpstrFileTitle       As String\r\n    nMaxFileTitle        As Long\r\n    lpstrInitialDir      As String\r\n    lpstrTitle           As String\r\n    Flags                As Long\r\n    nFileOffset          As Integer\r\n    nFileExtension       As Integer\r\n    lpstrDefExt          As String\r\n    lCustData            As Long\r\n    lpfnHook             As Long\r\n    lpTemplateName       As Long\r\n    pvReserved           As Long\r\n    dwReserved           As Long\r\n    FlagsEx              As Long\r\nEnd Type\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: OPENFILENAME
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lStructSize
            is_token: true
            children: []
          - kind: Whitespace
            text: "          "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: hWndOwner
            is_token: true
            children: []
          - kind: Whitespace
            text: "            "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: hInstance
            is_token: true
            children: []
          - kind: Whitespace
            text: "            "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrFilter
            is_token: true
            children: []
          - kind: Whitespace
            text: "          "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrCustomFilter
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nMaxCustFilter
            is_token: true
            children: []
          - kind: Whitespace
            text: "       "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nFilterIndex
            is_token: true
            children: []
          - kind: Whitespace
            text: "         "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrFile
            is_token: true
            children: []
          - kind: Whitespace
            text: "            "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nMaxFile
            is_token: true
            children: []
          - kind: Whitespace
            text: "             "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrFileTitle
            is_token: true
            children: []
          - kind: Whitespace
            text: "       "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nMaxFileTitle
            is_token: true
            children: []
          - kind: Whitespace
            text: "        "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrInitialDir
            is_token: true
            children: []
          - kind: Whitespace
            text: "      "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrTitle
            is_token: true
            children: []
          - kind: Whitespace
            text: "           "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: Flags
            is_token: true
            children: []
          - kind: Whitespace
            text: "                "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nFileOffset
            is_token: true
            children: []
          - kind: Whitespace
            text: "          "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: nFileExtension
            is_token: true
            children: []
          - kind: Whitespace
            text: "       "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpstrDefExt
            is_token: true
            children: []
          - kind: Whitespace
            text: "          "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringKeyword
            text: String
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lCustData
            is_token: true
            children: []
          - kind: Whitespace
            text: "            "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpfnHook
            is_token: true
            children: []
          - kind: Whitespace
            text: "             "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: lpTemplateName
            is_token: true
            children: []
          - kind: Whitespace
            text: "       "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: pvReserved
            is_token: true
            children: []
          - kind: Whitespace
            text: "           "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: dwReserved
            is_token: true
            children: []
          - kind: Whitespace
            text: "           "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: FlagsEx
            is_token: true
            children: []
          - kind: Whitespace
            text: "              "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EnumStatement
        text: "Private Enum EOpenFile\r\n    OFN_READONLY = &H1\r\n    OFN_OVERWRITEPROMPT = &H2\r\n    OFN_HIDEREADONLY = &H4\r\n    OFN_NOCHANGEDIR = &H8\r\n    OFN_SHOWHELP = &H10\r\n    OFN_ENABLEHOOK = &H20\r\n    OFN_ENABLETEMPLATE = &H40\r\n    OFN_ENABLETEMPLATEHANDLE = &H80\r\n    OFN_NOVALIDATE = &H100\r\n    OFN_ALLOWMULTISELECT = &H200\r\n    OFN_EXTENSIONDIFFERENT = &H400\r\n    OFN_PATHMUSTEXIST = &H800\r\n    OFN_FILEMUSTEXIST = &H1000\r\n    OFN_CREATEPROMPT = &H2000\r\n    OFN_SHAREAWARE = &H4000\r\n    OFN_NOREADONLYRETURN = &H8000&\r\n    OFN_NOTESTFILECREATE = &H10000\r\n    OFN_NONETWORKBUTTON = &H20000\r\n    OFN_NOLONGNAMES = &H40000\r\n    OFN_EXPLORER = &H80000\r\n    OFN_NODEREFERENCELINKS = &H100000\r\n    OFN_LONGNAMES = &H200000\r\nEnd Enum\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EnumKeyword
            text: Enum
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: EOpenFile
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_READONLY
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H1
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_OVERWRITEPROMPT
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H2
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_HIDEREADONLY
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H4
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NOCHANGEDIR
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H8
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_SHOWHELP
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H10
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_ENABLEHOOK
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H20
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_ENABLETEMPLATE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H40
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_ENABLETEMPLATEHANDLE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H80
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NOVALIDATE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H100
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_ALLOWMULTISELECT
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H200
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_EXTENSIONDIFFERENT
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H400
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_PATHMUSTEXIST
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H800
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_FILEMUSTEXIST
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H1000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_CREATEPROMPT
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H2000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_SHAREAWARE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H4000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NOREADONLYRETURN
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H8000
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NOTESTFILECREATE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H10000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NONETWORKBUTTON
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H20000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NOLONGNAMES
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H40000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_EXPLORER
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H80000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_NODEREFERENCELINKS
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H100000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: OFN_LONGNAMES
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H200000
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EnumKeyword
            text: Enum
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Unknown
        text: "#"
        is_token: true
        children: []
      - kind: IfStatement
        text: "If False Then\r\n    Private Const OFN_READONLY = &H1, OFN_OVERWRITEPROMPT = &H2, OFN_HIDEREADONLY = &H4, OFN_NOCHANGEDIR = &H8, OFN_SHOWHELP = &H10\r\n    Private Const OFN_ENABLEHOOK = &H20, OFN_ENABLETEMPLATE = &H40, OFN_ENABLETEMPLATEHANDLE = &H80, OFN_NOVALIDATE = &H100\r\n    Private Const OFN_ALLOWMULTISELECT = &H200, OFN_EXTENSIONDIFFERENT = &H400, OFN_PATHMUSTEXIST = &H800, OFN_FILEMUSTEXIST = &H1000\r\n    Private Const OFN_CREATEPROMPT = &H2000, OFN_SHAREAWARE = &H4000, OFN_NOREADONLYRETURN = &H8000&, OFN_NOTESTFILECREATE = &H10000\r\n    Private Const OFN_NONETWORKBUTTON = &H20000, OFN_NOLONGNAMES = &H40000, OFN_EXPLORER = &H80000, OFN_NODEREFERENCELINKS = &H100000\r\n    Private Const OFN_LONGNAMES = &H200000\r\n#End If\r\n"
        is_token: false
        children:
          - kind: IfKeyword
            text: If
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanLiteralExpression
            text: "False"
            is_token: false
            children:
              - kind: FalseKeyword
                text: "False"
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ThenKeyword
            text: Then
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    Private Const OFN_READONLY = &H1, OFN_OVERWRITEPROMPT = &H2, OFN_HIDEREADONLY = &H4, OFN_NOCHANGEDIR = &H8, OFN_SHOWHELP = &H10\r\n    Private Const OFN_ENABLEHOOK = &H20, OFN_ENABLETEMPLATE = &H40, OFN_ENABLETEMPLATEHANDLE = &H80, OFN_NOVALIDATE = &H100\r\n    Private Const OFN_ALLOWMULTISELECT = &H200, OFN_EXTENSIONDIFFERENT = &H400, OFN_PATHMUSTEXIST = &H800, OFN_FILEMUSTEXIST = &H1000\r\n    Private Const OFN_CREATEPROMPT = &H2000, OFN_SHAREAWARE = &H4000, OFN_NOREADONLYRETURN = &H8000&, OFN_NOTESTFILECREATE = &H10000\r\n    Private Const OFN_NONETWORKBUTTON = &H20000, OFN_NOLONGNAMES = &H40000, OFN_EXPLORER = &H80000, OFN_NODEREFERENCELINKS = &H100000\r\n    Private Const OFN_LONGNAMES = &H200000\r\n#"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_READONLY = &H1, OFN_OVERWRITEPROMPT = &H2, OFN_HIDEREADONLY = &H4, OFN_NOCHANGEDIR = &H8, OFN_SHOWHELP = &H10\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_READONLY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H1
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_OVERWRITEPROMPT
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: "&"
                    is_token: false
                    children:
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                  - kind: Identifier
                    text: H2
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_HIDEREADONLY
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H4
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NOCHANGEDIR
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H8
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_SHOWHELP
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H10
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_ENABLEHOOK = &H20, OFN_ENABLETEMPLATE = &H40, OFN_ENABLETEMPLATEHANDLE = &H80, OFN_NOVALIDATE = &H100\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_ENABLEHOOK
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H20
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_ENABLETEMPLATE
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: "&"
                    is_token: false
                    children:
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                  - kind: Identifier
                    text: H40
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_ENABLETEMPLATEHANDLE
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H80
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NOVALIDATE
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H100
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_ALLOWMULTISELECT = &H200, OFN_EXTENSIONDIFFERENT = &H400, OFN_PATHMUSTEXIST = &H800, OFN_FILEMUSTEXIST = &H1000\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_ALLOWMULTISELECT
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H200
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_EXTENSIONDIFFERENT
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: "&"
                    is_token: false
                    children:
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                  - kind: Identifier
                    text: H400
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_PATHMUSTEXIST
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H800
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_FILEMUSTEXIST
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H1000
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_CREATEPROMPT = &H2000, OFN_SHAREAWARE = &H4000, OFN_NOREADONLYRETURN = &H8000&, OFN_NOTESTFILECREATE = &H10000\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_CREATEPROMPT
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H2000
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_SHAREAWARE
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: "&"
                    is_token: false
                    children:
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                  - kind: Identifier
                    text: H4000
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NOREADONLYRETURN
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H8000
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NOTESTFILECREATE
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H10000
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_NONETWORKBUTTON = &H20000, OFN_NOLONGNAMES = &H40000, OFN_EXPLORER = &H80000, OFN_NODEREFERENCELINKS = &H100000\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NONETWORKBUTTON
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H20000
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NOLONGNAMES
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: "&"
                    is_token: false
                    children:
                      - kind: Ampersand
                        text: "&"
                        is_token: true
                        children: []
                  - kind: Identifier
                    text: H40000
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_EXPLORER
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H80000
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_NODEREFERENCELINKS
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H100000
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Private Const OFN_LONGNAMES = &H200000\r\n"
                is_token: false
                children:
                  - kind: PrivateKeyword
                    text: Private
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ConstKeyword
                    text: Const
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OFN_LONGNAMES
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Ampersand
                    text: "&"
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: H200000
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Unknown
                text: "#"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IfKeyword
            text: If
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'MSDN explanation of potential CD errors: https://msdn.microsoft.com/en-us/library/ms646916%28v=vs.85%29.aspx"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EnumStatement
        text: "Public Enum CommonDialogErrorsEnum\r\n    CDERR_DIALOGFAILURE = &HFFFF&\r\n    CDERR_FINDRESFAILURE = &H6\r\n    CDERR_LOADRESFAILURE = &H7\r\n    CDERR_INITIALIZATION = &H2\r\n    CDERR_LOADSTRFAILURE = &H5\r\n    CDERR_LOCKRESFAILURE = &H8\r\n    CDERR_MEMALLOCFAILURE = &H9\r\n    CDERR_MEMLOCKFAILURE = &HA\r\n    CDERR_NOHINSTANCE = &H4\r\n    CDERR_NOHOOK = &H8\r\n    CDERR_NOTEMPLATE = &H3\r\n    CDERR_REGISTERMSGFAIL = &HC\r\n    CDERR_STRUCTSIZE = &H1\r\n    FNERR_BUFFERTOOSMALL = &H3003&\r\n    FNERR_INVALIDFILENAME = &H3002&\r\n    FNERR_SUBCLASSFAILURE = &H3001&\r\n    CDERR_CANCELED = vbObjectError\r\nEnd Enum\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EnumKeyword
            text: Enum
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: CommonDialogErrorsEnum
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_DIALOGFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: HFFFF
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_FINDRESFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H6
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_LOADRESFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H7
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_INITIALIZATION
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H2
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_LOADSTRFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H5
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_LOCKRESFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H8
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_MEMALLOCFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H9
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_MEMLOCKFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: HA
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_NOHINSTANCE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H4
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_NOHOOK
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H8
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_NOTEMPLATE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H3
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_REGISTERMSGFAIL
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: HC
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_STRUCTSIZE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H1
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: FNERR_BUFFERTOOSMALL
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H3003
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: FNERR_INVALIDFILENAME
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H3002
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: FNERR_SUBCLASSFAILURE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Identifier
            text: H3001
            is_token: true
            children: []
          - kind: Ampersand
            text: "&"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: CDERR_CANCELED
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: vbObjectError
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EnumKeyword
            text: Enum
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Arbitrary-length return strings are possible, but because we have to re-raise the dialog upon failure (ugh), it's not"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' really practical to implement a \"try again with larger buffer\" feature.  Fortunately, post-XP operatings systems have"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' no upper limit, so we can start with an arbitrarily large string."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private Const MAX_PATH_LOAD_XP As Long = 16384\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: MAX_PATH_LOAD_XP
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "16384"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private Const MAX_PATH_LOAD As Long = 262144\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: MAX_PATH_LOAD
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "262144"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private Const MAX_PATH_SAVE As Long = 1024\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: MAX_PATH_SAVE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "1024"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private Const MAX_FILE As Long = 260\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: MAX_FILE
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "260"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Display a system-specific Open File dialog."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' RETURNS: TRUE if one or more files was selected; FALSE if canceled."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: FunctionStatement
        text: "Friend Function GetOpenFileName(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal FileMustExist As Boolean = True, _\r\n                           Optional ByVal MultiSelect As Boolean = False, _\r\n                           Optional ByVal Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = 0&) As Boolean\r\n    \r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST\r\n        ' is used to prevent the user from entering invalid filenames.\r\n        .Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n        \r\n        'Various other obvious flags\r\n        .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim Ch As String, i As Integer, s As String\r\n        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,\r\n        ' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch.\r\n        lInitPathSize = MAX_PATH_LOAD_XP\r\n        \r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetOpenFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Before proceeding, add debug info in the special case of a buffer underrun.  This case is problematic, as we can't simply\r\n    ' \"try again\" without re-raising a modal dialog, so I'm hoping my current default buffer size is always sufficient.\r\n    If (lReturn = 0) And (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL) Then\r\n        MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n    End If\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 16K buffer as a limit,\r\n    '  since PD won't do well with that many loaded images anyway.)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant strings.\r\n        \r\n        Dim lLen As Long\r\n        \r\n        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n        \r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetOpenFileName = True\r\n        \r\n    Else\r\n        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    End If\r\n                    \r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: FriendKeyword
            text: Friend
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetOpenFileName
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal FileMustExist As Boolean = True, _\r\n                           Optional ByVal MultiSelect As Boolean = False, _\r\n                           Optional ByVal Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = 0&)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FileName
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FileTitle
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FileMustExist
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "True"
                is_token: false
                children:
                  - kind: TrueKeyword
                    text: "True"
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: MultiSelect
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "False"
                is_token: false
                children:
                  - kind: FalseKeyword
                    text: "False"
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Filter
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringLiteralExpression
                text: "\"All (*.*)|*.*\""
                is_token: false
                children:
                  - kind: StringLiteral
                    text: "\"All (*.*)|*.*\""
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FilterIndex
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: NumericLiteralExpression
                text: "1"
                is_token: false
                children:
                  - kind: IntegerLiteral
                    text: "1"
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: InitDir
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: DlgTitle
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: DefaultExt
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Owner
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: NumericLiteralExpression
                text: 0&
                is_token: false
                children:
                  - kind: LongLiteral
                    text: 0&
                    is_token: true
                    children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    \r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST\r\n        ' is used to prevent the user from entering invalid filenames.\r\n        .Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n        \r\n        'Various other obvious flags\r\n        .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim Ch As String, i As Integer, s As String\r\n        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,\r\n        ' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch.\r\n        lInitPathSize = MAX_PATH_LOAD_XP\r\n        \r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetOpenFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Before proceeding, add debug info in the special case of a buffer underrun.  This case is problematic, as we can't simply\r\n    ' \"try again\" without re-raising a modal dialog, so I'm hoping my current default buffer size is always sufficient.\r\n    If (lReturn = 0) And (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL) Then\r\n        MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n    End If\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 16K buffer as a limit,\r\n    '  since PD won't do well with that many loaded images anyway.)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant strings.\r\n        \r\n        Dim lLen As Long\r\n        \r\n        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n        \r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetOpenFileName = True\r\n        \r\n    Else\r\n        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    End If\r\n                    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim lReturn As Long, lInitPathSize As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: lReturn
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: lInitPathSize
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Prep a relevant OFN struct"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tmpOFN As OPENFILENAME\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpOFN
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OPENFILENAME
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: WithStatement
                text: "    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST\r\n        ' is used to prevent the user from entering invalid filenames.\r\n        .Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n        \r\n        'Various other obvious flags\r\n        .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim Ch As String, i As Integer, s As String\r\n        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,\r\n        ' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch.\r\n        lInitPathSize = MAX_PATH_LOAD_XP\r\n        \r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpOFN
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        .lStructSize = Len(tmpOFN)\r\n        \r\n        'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST\r\n        ' is used to prevent the user from entering invalid filenames.\r\n        .Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n        \r\n        'Various other obvious flags\r\n        .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim Ch As String, i As Integer, s As String\r\n        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,\r\n        ' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch.\r\n        lInitPathSize = MAX_PATH_LOAD_XP\r\n        \r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lStructSize = Len(tmpOFN)\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lStructSize = Len(tmpOFN)
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lStructSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lStructSize
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: Len(tmpOFN)
                                is_token: false
                                children:
                                  - kind: LenKeyword
                                    text: Len
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: tmpOFN
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpOFN
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'OFN_EXPLORER is explicitly flagged to force Explorer mode even when allowing multiselect, and OFN_PATHMUSTEXIST"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' is used to prevent the user from entering invalid filenames."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES Or OFN_HIDEREADONLY
                            is_token: false
                            children:
                              - kind: BinaryExpression
                                text: Flags = OFN_PATHMUSTEXIST Or OFN_LONGNAMES
                                is_token: false
                                children:
                                  - kind: BinaryExpression
                                    text: Flags = OFN_PATHMUSTEXIST
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: Flags
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: Flags
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: OFN_PATHMUSTEXIST
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: OFN_PATHMUSTEXIST
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: OrKeyword
                                    text: Or
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: OFN_LONGNAMES
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: OFN_LONGNAMES
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: OrKeyword
                                text: Or
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: OFN_HIDEREADONLY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: OFN_HIDEREADONLY
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If FileMustExist Then .Flags = .Flags Or OFN_FILEMUSTEXIST\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: FileMustExist
                            is_token: false
                            children:
                              - kind: Identifier
                                text: FileMustExist
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".Flags = ."
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: Flags = .
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: Flags
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: "."
                                    is_token: false
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                          - kind: Identifier
                            text: Flags
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: OFN_FILEMUSTEXIST
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If MultiSelect Then .Flags = .Flags Or OFN_ALLOWMULTISELECT Or OFN_EXPLORER\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: MultiSelect
                            is_token: false
                            children:
                              - kind: Identifier
                                text: MultiSelect
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".Flags = ."
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: Flags = .
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: Flags
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: "."
                                    is_token: false
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                          - kind: Identifier
                            text: Flags
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: OFN_ALLOWMULTISELECT
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: OFN_EXPLORER
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Various other obvious flags"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".hWndOwner = Owner\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: hWndOwner = Owner
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: hWndOwner
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: hWndOwner
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Owner
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Owner
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrInitialDir = InitDir\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrInitialDir = InitDir
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrInitialDir
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrInitialDir
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: InitDir
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: InitDir
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrDefExt = DefaultExt\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrDefExt = DefaultExt
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrDefExt
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrDefExt
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: DefaultExt
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: DefaultExt
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrTitle = DlgTitle\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrTitle = DlgTitle
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: DlgTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: DlgTitle
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' pipe and colon separators, which are forcibly converted now."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim Ch As String, i As Integer, s As String\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Ch
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringKeyword
                            text: String
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerKeyword
                            text: Integer
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: s
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringKeyword
                            text: String
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: ForStatement
                        text: "        For i = 1 To Len(Filter)\r\n            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        Next\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: i
                            is_token: false
                            children:
                              - kind: Identifier
                                text: i
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "1"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "1"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: Len(Filter)
                            is_token: false
                            children:
                              - kind: LenKeyword
                                text: Len
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: Filter
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: Filter
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: Filter
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: Filter
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: StatementList
                            text: "            Ch = Mid$(Filter, i, 1)\r\n            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "Ch = Mid$(Filter, i, 1)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: Ch
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Ch
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "Mid$(Filter, i, 1)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Mid$
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "Filter, i, 1"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: Filter
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: Filter
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: Filter
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: i
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: i
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: IfStatement
                                text: "            If Ch = \"|\" Or Ch = \":\" Then\r\n                s = s & vbNullChar\r\n            Else\r\n                s = s & Ch\r\n            End If\r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "Ch = \"|\" Or Ch = \":\""
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: "Ch = \"|\""
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Ch
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Ch
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: StringLiteralExpression
                                            text: "\"|\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\"|\""
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: OrKeyword
                                        text: Or
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: "Ch = \":\""
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Ch
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Ch
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: StringLiteralExpression
                                            text: "\":\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\":\""
                                                is_token: true
                                                children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: StatementList
                                    text: "                s = s & vbNullChar\r\n            "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "                "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "s = s & vbNullChar\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: s
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: s
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: s & vbNullChar
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: s
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Ampersand
                                                text: "&"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: vbNullChar
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: vbNullChar
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                  - kind: ElseClause
                                    text: "Else\r\n                s = s & Ch\r\n            "
                                    is_token: false
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: StatementList
                                        text: "                s = s & Ch\r\n            "
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "s = s & Ch\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: s
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: s & Ch
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: s
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: s
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Ampersand
                                                    text: "&"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IdentifierExpression
                                                    text: Ch
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: Ch
                                                        is_token: true
                                                        children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                  - kind: EndKeyword
                                    text: End
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Double-nulls mark final termination"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "s = s & vbNullChar & vbNullChar\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: s & vbNullChar & vbNullChar
                            is_token: false
                            children:
                              - kind: BinaryExpression
                                text: s & vbNullChar
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: s
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: s
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Ampersand
                                    text: "&"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: vbNullChar
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: vbNullChar
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: vbNullChar
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullChar
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFilter = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFilter = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFilter
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFilter
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nFilterIndex = FilterIndex\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nFilterIndex = FilterIndex
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nFilterIndex
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nFilterIndex
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: FilterIndex
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FilterIndex
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small,"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' the call to GetOpenFilename will fail, and we can't retry without re-raising the dialog from scratch."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "lInitPathSize = MAX_PATH_LOAD_XP\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lInitPathSize
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lInitPathSize
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: MAX_PATH_LOAD_XP
                            is_token: false
                            children:
                              - kind: Identifier
                                text: MAX_PATH_LOAD_XP
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: s = FileName & String
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: FileName & String
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: String
                                is_token: false
                                children:
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                      - kind: Unknown
                        text: $
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: (
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "lInitPathSize - Len(FileName), 0)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: lInitPathSize
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LenKeyword
                            text: Len
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: FileName
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFile = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFile = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFile
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFile
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nMaxFile = lInitPathSize\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nMaxFile = lInitPathSize
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nMaxFile
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nMaxFile
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: lInitPathSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lInitPathSize
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: s = FileTitle & String
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: FileTitle & String
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: String
                                is_token: false
                                children:
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                      - kind: Unknown
                        text: $
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: (
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "MAX_FILE - Len(FileTitle), 0)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: MAX_FILE
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LenKeyword
                            text: Len
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: FileTitle
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFileTitle = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFileTitle = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nMaxFileTitle = MAX_FILE\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nMaxFileTitle = MAX_FILE
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nMaxFileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nMaxFileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: MAX_FILE
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: MAX_FILE
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'All other fields are fine as-is"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Turn control over to the common dialog function"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lReturn = GetOpenFileNameW(VarPtr(tmpOFN))\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: lReturn
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lReturn
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: GetOpenFileNameW(VarPtr(tmpOFN))
                    is_token: false
                    children:
                      - kind: Identifier
                        text: GetOpenFileNameW
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: VarPtr(tmpOFN)
                        is_token: false
                        children:
                          - kind: Argument
                            text: VarPtr(tmpOFN)
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: VarPtr(tmpOFN)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: VarPtr
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: tmpOFN
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpOFN
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Before proceeding, add debug info in the special case of a buffer underrun.  This case is problematic, as we can't simply"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' \"try again\" without re-raising a modal dialog, so I'm hoping my current default buffer size is always sufficient."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (lReturn = 0) And (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL) Then\r\n        MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (lReturn = 0) And (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL)
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: (lReturn = 0)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: lReturn = 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lReturn
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lReturn
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AndKeyword
                        text: And
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ParenthesizedExpression
                        text: (CommDlgExtendedError() = FNERR_BUFFERTOOSMALL)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: CommDlgExtendedError() = FNERR_BUFFERTOOSMALL
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: CommDlgExtendedError()
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: CommDlgExtendedError
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: ""
                                    is_token: false
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: FNERR_BUFFERTOOSMALL
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FNERR_BUFFERTOOSMALL
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "MsgBox \"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\", vbExclamation Or vbOKOnly, \"Error: too many images\"\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: MsgBox
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteral
                            text: "\"Unfortunately, the number of images you selected exceeds what WindowsÂ® allows for a single load operation.  Please try again with a smaller set of selected images.\""
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbExclamation
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbOKOnly
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringLiteral
                            text: "\"Error: too many images\""
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 16K buffer as a limit,"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'  since PD won't do well with that many loaded images anyway.)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant strings.\r\n        \r\n        Dim lLen As Long\r\n        \r\n        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n        \r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetOpenFileName = True\r\n        \r\n    Else\r\n        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ParenthesizedExpression
                    text: (lReturn <> 0)
                    is_token: false
                    children:
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: lReturn <> 0
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lReturn
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lReturn
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: InequalityOperator
                            text: "<>"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        \r\n        'Success!  Parse out the relevant strings.\r\n        \r\n        Dim lLen As Long\r\n        \r\n        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n        \r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetOpenFileName = True\r\n        \r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Success!  Parse out the relevant strings."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim lLen As Long\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: lLen
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "        If (Not MultiSelect) Then\r\n        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        Else\r\n            FileName = tmpOFN.lpstrFile\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ParenthesizedExpression
                            text: (Not MultiSelect)
                            is_token: false
                            children:
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: UnaryExpression
                                text: Not MultiSelect
                                is_token: false
                                children:
                                  - kind: NotKeyword
                                    text: Not
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: MultiSelect
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: MultiSelect
                                        is_token: true
                                        children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: StatementList
                            text: "        \r\n            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n            \r\n            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "            If (tmpOFN.nFileOffset <> 0) Then\r\n                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            End If\r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ParenthesizedExpression
                                    text: (tmpOFN.nFileOffset <> 0)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: tmpOFN.nFileOffset <> 0
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: tmpOFN.nFileOffset
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: nFileOffset
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: InequalityOperator
                                            text: "<>"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: StatementList
                                    text: "                lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "                "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: lLen
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: "InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1"
                                            is_token: false
                                            children:
                                              - kind: CallExpression
                                                text: "InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar)"
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: InStr
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: "tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar"
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: tmpOFN.nFileOffset
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: tmpOFN.nFileOffset
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: nFileOffset
                                                                is_token: true
                                                                children: []
                                                      - kind: Comma
                                                        text: ","
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Argument
                                                        text: tmpOFN.lpstrFile
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: tmpOFN.lpstrFile
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: lpstrFile
                                                                is_token: true
                                                                children: []
                                                      - kind: Comma
                                                        text: ","
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: Argument
                                                        text: vbNullChar
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: vbNullChar
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: vbNullChar
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: IfStatement
                                        text: "                If (lLen < 1) Then lLen = Len(tmpOFN.lpstrFile)\r\n            "
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                            is_token: true
                                            children: []
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ParenthesizedExpression
                                            text: (lLen < 1)
                                            is_token: false
                                            children:
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: lLen < 1
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: lLen
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: lLen
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LessThanOperator
                                                    text: "<"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "1"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "1"
                                                        is_token: true
                                                        children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "lLen = Len(tmpOFN.lpstrFile)\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: lLen
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: lLen
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: Len(tmpOFN.lpstrFile)
                                                is_token: false
                                                children:
                                                  - kind: LenKeyword
                                                    text: Len
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: tmpOFN.lpstrFile
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: tmpOFN.lpstrFile
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: tmpOFN.lpstrFile
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: tmpOFN
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: lpstrFile
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                  - kind: ElseClause
                                    text: "Else\r\n                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            "
                                    is_token: false
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: StatementList
                                        text: "                lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n            "
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "                "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n"
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: lLen
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: lLen
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: lstrlenW(StrPtr(tmpOFN.lpstrFile))
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: lstrlenW
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: StrPtr(tmpOFN.lpstrFile)
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: StrPtr(tmpOFN.lpstrFile)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: StrPtr(tmpOFN.lpstrFile)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: StrPtr
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: tmpOFN.lpstrFile
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: tmpOFN.lpstrFile
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: tmpOFN.lpstrFile
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: tmpOFN
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: lpstrFile
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                  - kind: EndKeyword
                                    text: End
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "            If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n            \r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: lLen
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: lLen
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: FileName
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: FileName
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: CallExpression
                                        text: "Left$(tmpOFN.lpstrFile, lLen)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: Left$
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "tmpOFN.lpstrFile, lLen"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: tmpOFN.lpstrFile
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.lpstrFile
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: lpstrFile
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: lLen
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: lLen
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: lLen
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: ElseClause
                            text: "Else\r\n            FileName = tmpOFN.lpstrFile\r\n        "
                            is_token: false
                            children:
                              - kind: ElseKeyword
                                text: Else
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: StatementList
                                text: "            FileName = tmpOFN.lpstrFile\r\n        "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "FileName = tmpOFN.lpstrFile\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: FileName
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: FileName
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MemberAccessExpression
                                        text: tmpOFN.lpstrFile
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: tmpOFN
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: lpstrFile
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lLen
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lLen
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lstrlenW
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: StrPtr(tmpOFN.lpstrFileTitle)
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: StrPtr(tmpOFN.lpstrFileTitle)
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: StrPtr(tmpOFN.lpstrFileTitle)
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: StrPtr
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: tmpOFN.lpstrFileTitle
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: tmpOFN.lpstrFileTitle
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.lpstrFileTitle
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: lpstrFileTitle
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: lLen
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lLen
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "Left$(tmpOFN.lpstrFileTitle, lLen)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Left$
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "tmpOFN.lpstrFileTitle, lLen"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN.lpstrFileTitle
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: tmpOFN.lpstrFileTitle
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: lpstrFileTitle
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: lLen
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: lLen
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Return the filter index, so the caller can store it to preferences as desired"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "FilterIndex = tmpOFN.nFilterIndex\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: FilterIndex
                            is_token: false
                            children:
                              - kind: Identifier
                                text: FilterIndex
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MemberAccessExpression
                            text: tmpOFN.nFilterIndex
                            is_token: false
                            children:
                              - kind: Identifier
                                text: tmpOFN
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: nFilterIndex
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "GetOpenFileName = True\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: GetOpenFileName
                            is_token: false
                            children:
                              - kind: Identifier
                                text: GetOpenFileName
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BooleanLiteralExpression
                            text: "True"
                            is_token: false
                            children:
                              - kind: TrueKeyword
                                text: "True"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        \r\n        GetOpenFileName = False\r\n        FileName = vbNullString\r\n        FileTitle = vbNullString\r\n        \r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "GetOpenFileName = False\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: GetOpenFileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: GetOpenFileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BooleanLiteralExpression
                                text: "False"
                                is_token: false
                                children:
                                  - kind: FalseKeyword
                                    text: "False"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "FileName = vbNullString\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: vbNullString
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "FileTitle = vbNullString\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: vbNullString
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "                    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Display a system-specific Save File dialog."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' RETURNS: TRUE if a valid save target was selected/created; FALSE if canceled."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: FunctionStatement
        text: "Friend Function GetSaveFileName(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal OverWritePrompt As Boolean = True, _\r\n                           Optional ByRef Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = -1) As Boolean\r\n\r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD.\r\n        .Flags = OFN_HIDEREADONLY\r\n        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n        \r\n        'Various other obvious flags\r\n        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim s As String\r\n        s = Filter\r\n        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call\r\n        ' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer).\r\n        lInitPathSize = MAX_PATH_SAVE\r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetSaveFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 1K buffer as a limit,\r\n    '  which should allow for saving to just about anywhere!)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant filename string.\r\n        Dim lLen As Long\r\n        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n        \r\n        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n        'As a convenience, return the file title too (which is just the filename + extension, with no path data)\r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetSaveFileName = True\r\n        \r\n    Else\r\n        GetSaveFileName = False\r\n    End If\r\n    \r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: FriendKeyword
            text: Friend
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetSaveFileName
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByRef FileName As String, _\r\n                           Optional ByRef FileTitle As String, _\r\n                           Optional ByVal OverWritePrompt As Boolean = True, _\r\n                           Optional ByRef Filter As String = \"All (*.*)|*.*\", _\r\n                           Optional ByRef FilterIndex As Long = 1, _\r\n                           Optional ByRef InitDir As String, _\r\n                           Optional ByRef DlgTitle As String, _\r\n                           Optional ByRef DefaultExt As String, _\r\n                           Optional ByVal Owner As Long = -1)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FileName
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FileTitle
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: OverWritePrompt
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "True"
                is_token: false
                children:
                  - kind: TrueKeyword
                    text: "True"
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Filter
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringLiteralExpression
                text: "\"All (*.*)|*.*\""
                is_token: false
                children:
                  - kind: StringLiteral
                    text: "\"All (*.*)|*.*\""
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: FilterIndex
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: NumericLiteralExpression
                text: "1"
                is_token: false
                children:
                  - kind: IntegerLiteral
                    text: "1"
                    is_token: true
                    children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: InitDir
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: DlgTitle
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: DefaultExt
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: StringKeyword
                text: String
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Underscore
                text: _
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "                           "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Owner
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: UnaryExpression
                text: "-1"
                is_token: false
                children:
                  - kind: SubtractionOperator
                    text: "-"
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "1"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "\r\n    Dim lReturn As Long, lInitPathSize As Long\r\n    \r\n    'Prep a relevant OFN struct\r\n    Dim tmpOFN As OPENFILENAME\r\n    \r\n    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD.\r\n        .Flags = OFN_HIDEREADONLY\r\n        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n        \r\n        'Various other obvious flags\r\n        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim s As String\r\n        s = Filter\r\n        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call\r\n        ' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer).\r\n        lInitPathSize = MAX_PATH_SAVE\r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n    \r\n    'Turn control over to the common dialog function\r\n    lReturn = GetSaveFileNameW(VarPtr(tmpOFN))\r\n    \r\n    'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer.\r\n    ' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that\r\n    '  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 1K buffer as a limit,\r\n    '  which should allow for saving to just about anywhere!)\r\n    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant filename string.\r\n        Dim lLen As Long\r\n        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n        \r\n        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n        'As a convenience, return the file title too (which is just the filename + extension, with no path data)\r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetSaveFileName = True\r\n        \r\n    Else\r\n        GetSaveFileName = False\r\n    End If\r\n    \r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim lReturn As Long, lInitPathSize As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: lReturn
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: lInitPathSize
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Prep a relevant OFN struct"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim tmpOFN As OPENFILENAME\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpOFN
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: OPENFILENAME
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: WithStatement
                text: "    With tmpOFN\r\n        .lStructSize = Len(tmpOFN)\r\n        \r\n        'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD.\r\n        .Flags = OFN_HIDEREADONLY\r\n        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n        \r\n        'Various other obvious flags\r\n        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim s As String\r\n        s = Filter\r\n        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call\r\n        ' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer).\r\n        lInitPathSize = MAX_PATH_SAVE\r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    End With\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: tmpOFN
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        .lStructSize = Len(tmpOFN)\r\n        \r\n        'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD.\r\n        .Flags = OFN_HIDEREADONLY\r\n        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n        \r\n        'Various other obvious flags\r\n        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n        'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style\r\n        ' pipe and colon separators, which are forcibly converted now.\r\n        Dim s As String\r\n        s = Filter\r\n        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n        s = s & vbNullChar & vbNullChar\r\n        .lpstrFilter = s\r\n        .nFilterIndex = FilterIndex\r\n        \r\n        'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call\r\n        ' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer).\r\n        lInitPathSize = MAX_PATH_SAVE\r\n        s = FileName & String$(lInitPathSize - Len(FileName), 0)\r\n        .lpstrFile = s\r\n        .nMaxFile = lInitPathSize\r\n        \r\n        s = FileTitle & String$(MAX_FILE - Len(FileTitle), 0)\r\n        .lpstrFileTitle = s\r\n        .nMaxFileTitle = MAX_FILE\r\n        \r\n        'All other fields are fine as-is\r\n        \r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lStructSize = Len(tmpOFN)\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lStructSize = Len(tmpOFN)
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lStructSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lStructSize
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: Len(tmpOFN)
                                is_token: false
                                children:
                                  - kind: LenKeyword
                                    text: Len
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: tmpOFN
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpOFN
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'We forcefully hide the \"Open as Read Only\" checkbox, as it makes little sense for PD."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".Flags = OFN_HIDEREADONLY\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: Flags = OFN_HIDEREADONLY
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: Flags
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Flags
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: OFN_HIDEREADONLY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: OFN_HIDEREADONLY
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If OverWritePrompt Then .Flags = .Flags Or OFN_OVERWRITEPROMPT\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: OverWritePrompt
                            is_token: false
                            children:
                              - kind: Identifier
                                text: OverWritePrompt
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".Flags = ."
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: Flags = .
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: Flags
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Flags
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: "."
                                    is_token: false
                                    children:
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                          - kind: Identifier
                            text: Flags
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: OFN_OVERWRITEPROMPT
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Various other obvious flags"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "        If (Owner <> -1) Then .hWndOwner = Owner\r\n        .lpstrInitialDir = InitDir\r\n        .lpstrDefExt = DefaultExt\r\n        .lpstrTitle = DlgTitle\r\n        \r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ParenthesizedExpression
                            text: (Owner <> -1)
                            is_token: false
                            children:
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: Owner <> -1
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: Owner
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Owner
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: InequalityOperator
                                    text: "<>"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".hWndOwner = Owner\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: hWndOwner = Owner
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: hWndOwner
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: hWndOwner
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: Owner
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Owner
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".lpstrInitialDir = InitDir\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: lpstrInitialDir = InitDir
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: lpstrInitialDir
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: lpstrInitialDir
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: InitDir
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: InitDir
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".lpstrDefExt = DefaultExt\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: lpstrDefExt = DefaultExt
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: lpstrDefExt
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: lpstrDefExt
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: DefaultExt
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: DefaultExt
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".lpstrTitle = DlgTitle\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: lpstrTitle = DlgTitle
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: lpstrTitle
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: lpstrTitle
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: DlgTitle
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: DlgTitle
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'The filter string is actually null-delimited, which isn't easy for the caller to do, so we allow the old-style"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' pipe and colon separators, which are forcibly converted now."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim s As String\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: s
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: StringKeyword
                            text: String
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "s = Filter\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: Filter
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Filter
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If InStr(1, s, \"|\", vbBinaryCompare) Then s = Replace$(s, \"|\", vbNullChar)\r\n        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n        'Double-nulls mark final termination\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: "InStr(1, s, \"|\", vbBinaryCompare)"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: InStr
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: "1, s, \"|\", vbBinaryCompare"
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Argument
                                    text: s
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: s
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: s
                                            is_token: true
                                            children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Argument
                                    text: "\"|\""
                                    is_token: false
                                    children:
                                      - kind: StringLiteralExpression
                                        text: "\"|\""
                                        is_token: false
                                        children:
                                          - kind: StringLiteral
                                            text: "\"|\""
                                            is_token: true
                                            children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Argument
                                    text: vbBinaryCompare
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: vbBinaryCompare
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: vbBinaryCompare
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "s = Replace$(s, \"|\", vbNullChar)\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "Replace$(s, \"|\", vbNullChar)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Replace
                                    is_token: true
                                    children: []
                                  - kind: DollarSign
                                    text: $
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "s, \"|\", vbNullChar"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: s
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: s
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: s
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "\"|\""
                                        is_token: false
                                        children:
                                          - kind: StringLiteralExpression
                                            text: "\"|\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\"|\""
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: vbNullChar
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: vbNullChar
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: vbNullChar
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: IfStatement
                            text: "        If InStr(1, s, \":\", vbBinaryCompare) Then s = Replace$(s, \":\", vbNullChar)\r\n        \r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: IfKeyword
                                text: If
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "InStr(1, s, \":\", vbBinaryCompare)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: InStr
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "1, s, \":\", vbBinaryCompare"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: s
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: s
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: s
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: "\":\""
                                        is_token: false
                                        children:
                                          - kind: StringLiteralExpression
                                            text: "\":\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\":\""
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: vbBinaryCompare
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: vbBinaryCompare
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: vbBinaryCompare
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: ThenKeyword
                                text: Then
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "s = Replace$(s, \":\", vbNullChar)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: s
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: s
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "Replace$(s, \":\", vbNullChar)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Replace
                                        is_token: true
                                        children: []
                                      - kind: DollarSign
                                        text: $
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "s, \":\", vbNullChar"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: s
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: s
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: s
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "\":\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteralExpression
                                                text: "\":\""
                                                is_token: false
                                                children:
                                                  - kind: StringLiteral
                                                    text: "\":\""
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: vbNullChar
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: vbNullChar
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: vbNullChar
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: EndOfLineComment
                            text: "'Double-nulls mark final termination"
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "s = s & vbNullChar & vbNullChar\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: s & vbNullChar & vbNullChar
                            is_token: false
                            children:
                              - kind: BinaryExpression
                                text: s & vbNullChar
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: s
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: s
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Ampersand
                                    text: "&"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: vbNullChar
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: vbNullChar
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: vbNullChar
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullChar
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFilter = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFilter = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFilter
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFilter
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nFilterIndex = FilterIndex\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nFilterIndex = FilterIndex
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nFilterIndex
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nFilterIndex
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: FilterIndex
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FilterIndex
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'We have to start with a prepared buffer of some arbitrary size.  If the size proves too small, we could technically call"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "' the function again with a larger buffer (not implemented, as PD uses a comically huge buffer)."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "lInitPathSize = MAX_PATH_SAVE\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lInitPathSize
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lInitPathSize
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: MAX_PATH_SAVE
                            is_token: false
                            children:
                              - kind: Identifier
                                text: MAX_PATH_SAVE
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: s = FileName & String
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: FileName & String
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: String
                                is_token: false
                                children:
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                      - kind: Unknown
                        text: $
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: (
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "lInitPathSize - Len(FileName), 0)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: lInitPathSize
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LenKeyword
                            text: Len
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: FileName
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFile = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFile = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFile
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFile
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nMaxFile = lInitPathSize\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nMaxFile = lInitPathSize
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nMaxFile
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nMaxFile
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: lInitPathSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lInitPathSize
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: s = FileTitle & String
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: s
                            is_token: false
                            children:
                              - kind: Identifier
                                text: s
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: FileTitle & String
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Ampersand
                                text: "&"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: String
                                is_token: false
                                children:
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                      - kind: Unknown
                        text: $
                        is_token: true
                        children: []
                      - kind: Unknown
                        text: (
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "MAX_FILE - Len(FileTitle), 0)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: MAX_FILE
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LenKeyword
                            text: Len
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: FileTitle
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".lpstrFileTitle = s\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: lpstrFileTitle = s
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: lpstrFileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: lpstrFileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: s
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: s
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".nMaxFileTitle = MAX_FILE\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: nMaxFileTitle = MAX_FILE
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: nMaxFileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: nMaxFileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: MAX_FILE
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: MAX_FILE
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'All other fields are fine as-is"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Turn control over to the common dialog function"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "lReturn = GetSaveFileNameW(VarPtr(tmpOFN))\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: lReturn
                    is_token: false
                    children:
                      - kind: Identifier
                        text: lReturn
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: GetSaveFileNameW(VarPtr(tmpOFN))
                    is_token: false
                    children:
                      - kind: Identifier
                        text: GetSaveFileNameW
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: VarPtr(tmpOFN)
                        is_token: false
                        children:
                          - kind: Argument
                            text: VarPtr(tmpOFN)
                            is_token: false
                            children:
                              - kind: CallExpression
                                text: VarPtr(tmpOFN)
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: VarPtr
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: tmpOFN
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: tmpOFN
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Non-zero returns are considered successful, but note that a failure state may have occurred due to a too-small buffer."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' (We could technically handle buffer overflows by retrying with a larger buffer, but I don't know how to do that"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'  without re-displaying the entire effing common dialog; to that end, I've hard-coded a 1K buffer as a limit,"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'  which should allow for saving to just about anywhere!)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (lReturn <> 0) Then\r\n        \r\n        'Success!  Parse out the relevant filename string.\r\n        Dim lLen As Long\r\n        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n        \r\n        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n        'As a convenience, return the file title too (which is just the filename + extension, with no path data)\r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetSaveFileName = True\r\n        \r\n    Else\r\n        GetSaveFileName = False\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ParenthesizedExpression
                    text: (lReturn <> 0)
                    is_token: false
                    children:
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: lReturn <> 0
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lReturn
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lReturn
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: InequalityOperator
                            text: "<>"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        \r\n        'Success!  Parse out the relevant filename string.\r\n        Dim lLen As Long\r\n        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n        \r\n        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n        'As a convenience, return the file title too (which is just the filename + extension, with no path data)\r\n        lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n        'Return the filter index, so the caller can store it to preferences as desired\r\n        FilterIndex = tmpOFN.nFilterIndex\r\n        \r\n        GetSaveFileName = True\r\n        \r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Success!  Parse out the relevant filename string."
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: DimStatement
                        text: "Dim lLen As Long\r\n"
                        is_token: false
                        children:
                          - kind: DimKeyword
                            text: Dim
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: lLen
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AsKeyword
                            text: As
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LongKeyword
                            text: Long
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If (tmpOFN.nFileOffset <> 0) Then\r\n            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ParenthesizedExpression
                            text: (tmpOFN.nFileOffset <> 0)
                            is_token: false
                            children:
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: tmpOFN.nFileOffset <> 0
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: tmpOFN.nFileOffset
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: tmpOFN
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: nFileOffset
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: InequalityOperator
                                    text: "<>"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: StatementList
                            text: "            lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "lLen = InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: lLen
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: lLen
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar) - 1&"
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: "InStr(tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar)"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: InStr
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: "tmpOFN.nFileOffset, tmpOFN.lpstrFile, vbNullChar"
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: tmpOFN.nFileOffset
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.nFileOffset
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: nFileOffset
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: tmpOFN.lpstrFile
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.lpstrFile
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: lpstrFile
                                                        is_token: true
                                                        children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Argument
                                                text: vbNullChar
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: vbNullChar
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: vbNullChar
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: 1&
                                        is_token: false
                                        children:
                                          - kind: LongLiteral
                                            text: 1&
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: IfStatement
                                text: "            If (lLen < 1&) Then lLen = Len(tmpOFN.lpstrFile)\r\n        "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ParenthesizedExpression
                                    text: (lLen < 1&)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: lLen < 1&
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: lLen
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LessThanOperator
                                            text: "<"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: 1&
                                            is_token: false
                                            children:
                                              - kind: LongLiteral
                                                text: 1&
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "lLen = Len(tmpOFN.lpstrFile)\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: lLen
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: lLen
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: CallExpression
                                        text: Len(tmpOFN.lpstrFile)
                                        is_token: false
                                        children:
                                          - kind: LenKeyword
                                            text: Len
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: tmpOFN.lpstrFile
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: tmpOFN.lpstrFile
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.lpstrFile
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: lpstrFile
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                          - kind: ElseClause
                            text: "Else\r\n            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        "
                            is_token: false
                            children:
                              - kind: ElseKeyword
                                text: Else
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: StatementList
                                text: "            lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n        "
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "lLen = lstrlenW(StrPtr(tmpOFN.lpstrFile))\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: lLen
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: lLen
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: CallExpression
                                        text: lstrlenW(StrPtr(tmpOFN.lpstrFile))
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: lstrlenW
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: StrPtr(tmpOFN.lpstrFile)
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: StrPtr(tmpOFN.lpstrFile)
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: StrPtr(tmpOFN.lpstrFile)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: StrPtr
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: tmpOFN.lpstrFile
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: tmpOFN.lpstrFile
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: tmpOFN.lpstrFile
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: tmpOFN
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: lpstrFile
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "        If lLen Then FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n        \r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: lLen
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lLen
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "FileName = Left$(tmpOFN.lpstrFile, lLen)\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "Left$(tmpOFN.lpstrFile, lLen)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Left$
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "tmpOFN.lpstrFile, lLen"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN.lpstrFile
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: tmpOFN.lpstrFile
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: lpstrFile
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: lLen
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: lLen
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'As a convenience, return the file title too (which is just the filename + extension, with no path data)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "lLen = lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: lLen
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lLen
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: lstrlenW(StrPtr(tmpOFN.lpstrFileTitle))
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lstrlenW
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: StrPtr(tmpOFN.lpstrFileTitle)
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: StrPtr(tmpOFN.lpstrFileTitle)
                                    is_token: false
                                    children:
                                      - kind: CallExpression
                                        text: StrPtr(tmpOFN.lpstrFileTitle)
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: StrPtr
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: tmpOFN.lpstrFileTitle
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: tmpOFN.lpstrFileTitle
                                                is_token: false
                                                children:
                                                  - kind: MemberAccessExpression
                                                    text: tmpOFN.lpstrFileTitle
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: tmpOFN
                                                        is_token: true
                                                        children: []
                                                      - kind: PeriodOperator
                                                        text: "."
                                                        is_token: true
                                                        children: []
                                                      - kind: Identifier
                                                        text: lpstrFileTitle
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: IfStatement
                        text: "        If lLen Then FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n        \r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: lLen
                            is_token: false
                            children:
                              - kind: Identifier
                                text: lLen
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "FileTitle = Left$(tmpOFN.lpstrFileTitle, lLen)\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: FileTitle
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: FileTitle
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: CallExpression
                                text: "Left$(tmpOFN.lpstrFileTitle, lLen)"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Left$
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ArgumentList
                                    text: "tmpOFN.lpstrFileTitle, lLen"
                                    is_token: false
                                    children:
                                      - kind: Argument
                                        text: tmpOFN.lpstrFileTitle
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: tmpOFN.lpstrFileTitle
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: tmpOFN
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: lpstrFileTitle
                                                is_token: true
                                                children: []
                                      - kind: Comma
                                        text: ","
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Argument
                                        text: lLen
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: lLen
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: lLen
                                                is_token: true
                                                children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Return the filter index, so the caller can store it to preferences as desired"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "FilterIndex = tmpOFN.nFilterIndex\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: FilterIndex
                            is_token: false
                            children:
                              - kind: Identifier
                                text: FilterIndex
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MemberAccessExpression
                            text: tmpOFN.nFilterIndex
                            is_token: false
                            children:
                              - kind: Identifier
                                text: tmpOFN
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: nFilterIndex
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "GetSaveFileName = True\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: GetSaveFileName
                            is_token: false
                            children:
                              - kind: Identifier
                                text: GetSaveFileName
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BooleanLiteralExpression
                            text: "True"
                            is_token: false
                            children:
                              - kind: TrueKeyword
                                text: "True"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        GetSaveFileName = False\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        GetSaveFileName = False\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "GetSaveFileName = False\r\n"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: GetSaveFileName
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: GetSaveFileName
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BooleanLiteralExpression
                                text: "False"
                                is_token: false
                                children:
                                  - kind: FalseKeyword
                                    text: "False"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
