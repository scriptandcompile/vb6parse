---
source: tests/class.rs
expression: class1
---
header:
  version:
    major: 1
    minor: 0
  properties:
    multi_use: MultiUse
    persistable: NotPersistable
    data_binding_behavior: None
    data_source_behavior: None
    mts_transaction_mode: NotAnMTSObject
  attributes:
    name: FastDrawing
    global_name_space: Local
    creatable: "True"
    pre_declared_id: "False"
    exposed: "False"
    description: ~
    ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Real-time drawing class for VB6\r\n'Published in 2011 by Tanner Helland\r\n'\r\n'This class was built to simplify per-pixel access in VB6.  The attached project demonstrates how to use it.\r\n' Note that its simplified design is primarily based around modifying 24-bpp RGB data.  Alpha channels are\r\n' not currently supported (although the code could be easily modified for this).\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\nOption Explicit\r\n\r\n'Stripped down bitmap information\r\nPrivate Type GDI_Bitmap\r\n    bmType As Long\r\n    bmWidth As Long\r\n    bmHeight As Long\r\n    bmWidthBytes As Long\r\n    bmPlanes As Integer\r\n    bmBitsPixel As Integer\r\n    bmBits As Long\r\nEnd Type\r\n\r\n'Retrieve object properties directly from Windows; this lets us bypass some VB-specific annoyances\r\nPrivate Declare Function GetObject Lib \"gdi32\" Alias \"GetObjectA\" (ByVal hObject As Long, ByVal nCount As Long, ByRef lpObject As Any) As Long\r\n\r\n'Standard pixel data (Windows BGRA order)\r\nPrivate Type GDI_RGBQuad\r\n    rgbBlue As Byte\r\n    rgbGreen As Byte\r\n    rgbRed As Byte\r\n    rgbAlpha As Byte\r\nEnd Type\r\n\r\n'Full-size bitmap header\r\nPrivate Type GDI_BitmapInfoHeader\r\n    bmSize As Long\r\n    bmWidth As Long\r\n    bmHeight As Long\r\n    bmPlanes As Integer\r\n    bmBitCount As Integer\r\n    bmCompression As Long\r\n    bmSizeImage As Long\r\n    bmXPelsPerMeter As Long\r\n    bmYPelsPerMeter As Long\r\n    bmClrUsed As Long\r\n    bmClrImportant As Long\r\nEnd Type\r\n\r\n'Extended header for 8-bit images\r\nPrivate Type GDI_BitmapInfo\r\n    bmHeader As GDI_BitmapInfoHeader\r\n    bmColors(0 To 255) As GDI_RGBQuad\r\nEnd Type\r\n\r\n'Higher-quality image stretching must be activated manually\r\nPrivate Declare Function SetStretchBltMode Lib \"gdi32\" (ByVal hDC As Long, ByVal nStretchMode As Long) As Long\r\n\r\n'DIB section interfaces\r\nPrivate Declare Function GetDIBits Lib \"gdi32\" (ByVal hDC As Long, ByVal hBitmap As Long, ByVal nStartScan As Long, ByVal nNumScans As Long, ByRef lpBits As Any, ByRef lpBI As GDI_BitmapInfo, ByVal wUsage As Long) As Long\r\nPrivate Declare Function StretchDIBits Lib \"gdi32\" (ByVal hDC As Long, ByVal dstX As Long, ByVal dstY As Long, ByVal dstWidth As Long, ByVal dstHeight As Long, ByVal srcX As Long, ByVal srcY As Long, ByVal srcWidth As Long, ByVal srcHeight As Long, ByRef lpBits As Any, ByRef lpBitsInfo As GDI_BitmapInfo, ByVal wUsage As Long, ByVal dwRop As Long) As Long\r\n\r\n'Return an image's width, in pixels\r\nPublic Function GetImageWidth(ByRef srcPictureBox As PictureBox) As Long\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageWidth = bm.bmWidth\r\nEnd Function\r\n\r\n'Return an image's height, in pixels\r\nPublic Function GetImageHeight(ByRef srcPictureBox As PictureBox) As Long\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageHeight = Abs(bm.bmHeight)\r\nEnd Function\r\n\r\n'Copy an 24-bpp image's pixel information into an array dimensioned (x * 3 , y).  Each row of the array represents\r\n' Blue, Green, Red pixel values - e.g. BGRBGRBGR...\r\n'\r\n'Also, because Windows DIBs are stored upside-down (last line first), you can ask this function to reverse\r\n' line-order for you.  This can make position-specific calculations more intuitive.\r\nPublic Sub GetImageData2D(ByRef srcPictureBox As PictureBox, ByRef dstPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)\r\n    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    \r\n    'Calculate a size for the destination array.  For performance reasons, Windows requires\r\n    ' 24-bpp DIB scanlines to be aligned on 4-byte boundaries - this means that the destination\r\n    ' array's width may not be a multiple of (imageWidth * 3), by design.\r\n    Dim imgStride As Long\r\n    imgStride = (bm.bmWidth * 3) - 1 + (bm.bmWidth Mod 4)\r\n    ReDim dstPixelData(0 To imgStride, 0 To bm.bmHeight - 1) As Byte\r\n    \r\n    'Create a temporary header to pass to the GetDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = bm.bmWidth\r\n        .bmHeight = bm.bmHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'Copy the pixel data into our array\r\n    GetDIBits srcPictureBox.hDC, srcPictureBox.Image, 0, bm.bmHeight, dstPixelData(0, 0), bmi, 0\r\n    \r\nEnd Sub\r\n\r\n'Set an image's pixel information from a raw byte array.  The byte array *must* have been created\r\n' according to the rules defined in GetImageData2D(), above.  Similarly, if you reversed scanline\r\n' order at retrieval time, you should also pass TRUE for fixOrientation when calling this function.\r\n'\r\n'The image will be stretched to fit the destination picture box (without regard to aspect ratio).\r\n' You can manually modify this by changing the destination parameters of the StretchDIBits call.\r\nPublic Sub SetImageData2D(ByRef dstPictureBox As PictureBox, ByVal imgWidth As Long, ByVal imgHeight As Long, ByRef srcPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)\r\n    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject dstPictureBox.Image, Len(bm), bm\r\n    \r\n    'Create a temporary header to pass to the StretchDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = imgWidth\r\n        .bmHeight = imgHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'If stretching will be involved, request high-quality stretching from GDI\r\n    SetStretchBltMode dstPictureBox.hDC, 3&\r\n    \r\n    'Paint the pixel data into the destination picture box.  By using bm.bmWidth and bm.bmHeight as\r\n    ' the destination width/height, the pixel data will be automatically resized to fit the picture box.\r\n    StretchDIBits dstPictureBox.hDC, 0, 0, bm.bmWidth, bm.bmHeight, 0, 0, imgWidth, imgHeight, srcPixelData(0, 0), bmi, 0, vbSrcCopy\r\n    \r\n    'VB's built-in backbuffer system (\"AutoRedraw\") won't detect changes made by WAPI functions,\r\n    ' so we need to manually notify it of the need to redraw.\r\n    If dstPictureBox.AutoRedraw Then\r\n        dstPictureBox.Picture = dstPictureBox.Image\r\n        dstPictureBox.Refresh\r\n    End If\r\n    \r\nEnd Sub\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Real-time drawing class for VB6"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Published in 2011 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This class was built to simplify per-pixel access in VB6.  The attached project demonstrates how to use it."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Note that its simplified design is primarily based around modifying 24-bpp RGB data.  Alpha channels are"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' not currently supported (although the code could be easily modified for this)."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Stripped down bitmap information"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: TypeStatement
        text: "Private Type GDI_Bitmap\r\n    bmType As Long\r\n    bmWidth As Long\r\n    bmHeight As Long\r\n    bmWidthBytes As Long\r\n    bmPlanes As Integer\r\n    bmBitsPixel As Integer\r\n    bmBits As Long\r\nEnd Type\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_Bitmap
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmType
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmWidth
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmHeight
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmWidthBytes
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmPlanes
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmBitsPixel
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmBits
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Retrieve object properties directly from Windows; this lets us bypass some VB-specific annoyances"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function GetObject Lib \"gdi32\" Alias \"GetObjectA\" (ByVal hObject As Long, ByVal nCount As Long, ByRef lpObject As Any) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetObject
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AliasKeyword
            text: Alias
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"GetObjectA\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hObject As Long, ByVal nCount As Long, ByRef lpObject As Any)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hObject
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nCount
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpObject
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Any
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Standard pixel data (Windows BGRA order)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: TypeStatement
        text: "Private Type GDI_RGBQuad\r\n    rgbBlue As Byte\r\n    rgbGreen As Byte\r\n    rgbRed As Byte\r\n    rgbAlpha As Byte\r\nEnd Type\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_RGBQuad
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: rgbBlue
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: rgbGreen
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: rgbRed
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: rgbAlpha
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Full-size bitmap header"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: TypeStatement
        text: "Private Type GDI_BitmapInfoHeader\r\n    bmSize As Long\r\n    bmWidth As Long\r\n    bmHeight As Long\r\n    bmPlanes As Integer\r\n    bmBitCount As Integer\r\n    bmCompression As Long\r\n    bmSizeImage As Long\r\n    bmXPelsPerMeter As Long\r\n    bmYPelsPerMeter As Long\r\n    bmClrUsed As Long\r\n    bmClrImportant As Long\r\nEnd Type\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_BitmapInfoHeader
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmSize
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmWidth
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmHeight
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmPlanes
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmBitCount
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmCompression
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmSizeImage
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmXPelsPerMeter
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmYPelsPerMeter
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmClrUsed
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmClrImportant
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Extended header for 8-bit images"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: TypeStatement
        text: "Private Type GDI_BitmapInfo\r\n    bmHeader As GDI_BitmapInfoHeader\r\n    bmColors(0 To 255) As GDI_RGBQuad\r\nEnd Type\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_BitmapInfo
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmHeader
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_BitmapInfoHeader
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: Identifier
            text: bmColors
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "0"
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ToKeyword
            text: To
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "255"
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GDI_RGBQuad
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: TypeKeyword
            text: Type
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Higher-quality image stretching must be activated manually"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function SetStretchBltMode Lib \"gdi32\" (ByVal hDC As Long, ByVal nStretchMode As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: SetStretchBltMode
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal nStretchMode As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nStretchMode
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'DIB section interfaces"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DeclareStatement
        text: "Private Declare Function GetDIBits Lib \"gdi32\" (ByVal hDC As Long, ByVal hBitmap As Long, ByVal nStartScan As Long, ByVal nNumScans As Long, ByRef lpBits As Any, ByRef lpBI As GDI_BitmapInfo, ByVal wUsage As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetDIBits
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal hBitmap As Long, ByVal nStartScan As Long, ByVal nNumScans As Long, ByRef lpBits As Any, ByRef lpBI As GDI_BitmapInfo, ByVal wUsage As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hBitmap
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nStartScan
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: nNumScans
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpBits
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Any
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpBI
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: GDI_BitmapInfo
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: wUsage
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DeclareStatement
        text: "Private Declare Function StretchDIBits Lib \"gdi32\" (ByVal hDC As Long, ByVal dstX As Long, ByVal dstY As Long, ByVal dstWidth As Long, ByVal dstHeight As Long, ByVal srcX As Long, ByVal srcY As Long, ByVal srcWidth As Long, ByVal srcHeight As Long, ByRef lpBits As Any, ByRef lpBitsInfo As GDI_BitmapInfo, ByVal wUsage As Long, ByVal dwRop As Long) As Long\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: DeclareKeyword
            text: Declare
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: StretchDIBits
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LibKeyword
            text: Lib
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: StringLiteral
            text: "\"gdi32\""
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal hDC As Long, ByVal dstX As Long, ByVal dstY As Long, ByVal dstWidth As Long, ByVal dstHeight As Long, ByVal srcX As Long, ByVal srcY As Long, ByVal srcWidth As Long, ByVal srcHeight As Long, ByRef lpBits As Any, ByRef lpBitsInfo As GDI_BitmapInfo, ByVal wUsage As Long, ByVal dwRop As Long)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: hDC
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstX
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstY
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcX
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcY
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpBits
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Any
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: lpBitsInfo
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: GDI_BitmapInfo
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: wUsage
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dwRop
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Return an image's width, in pixels"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: FunctionStatement
        text: "Public Function GetImageWidth(ByRef srcPictureBox As PictureBox) As Long\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageWidth = bm.bmWidth\r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetImageWidth
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByRef srcPictureBox As PictureBox)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcPictureBox
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageWidth = bm.bmWidth\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bm As GDI_Bitmap\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_Bitmap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GetObject srcPictureBox.Image, Len(bm), bm\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GetObject
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Image
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LenKeyword
                    text: Len
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "GetImageWidth = bm.bmWidth\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: GetImageWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: GetImageWidth
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: bm.bmWidth
                    is_token: false
                    children:
                      - kind: Identifier
                        text: bm
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: bmWidth
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Return an image's height, in pixels"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: FunctionStatement
        text: "Public Function GetImageHeight(ByRef srcPictureBox As PictureBox) As Long\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageHeight = Abs(bm.bmHeight)\r\nEnd Function\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetImageHeight
            is_token: true
            children: []
          - kind: ParameterList
            text: (ByRef srcPictureBox As PictureBox)
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcPictureBox
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    GetImageHeight = Abs(bm.bmHeight)\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bm As GDI_Bitmap\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_Bitmap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GetObject srcPictureBox.Image, Len(bm), bm\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GetObject
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Image
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LenKeyword
                    text: Len
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "GetImageHeight = Abs(bm.bmHeight)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: GetImageHeight
                    is_token: false
                    children:
                      - kind: Identifier
                        text: GetImageHeight
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Abs(bm.bmHeight)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Abs
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: bm.bmHeight
                        is_token: false
                        children:
                          - kind: Argument
                            text: bm.bmHeight
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: bm.bmHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bm
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: bmHeight
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copy an 24-bpp image's pixel information into an array dimensioned (x * 3 , y).  Each row of the array represents"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Blue, Green, Red pixel values - e.g. BGRBGRBGR..."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Also, because Windows DIBs are stored upside-down (last line first), you can ask this function to reverse"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' line-order for you.  This can make position-specific calculations more intuitive."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub GetImageData2D(ByRef srcPictureBox As PictureBox, ByRef dstPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)\r\n    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    \r\n    'Calculate a size for the destination array.  For performance reasons, Windows requires\r\n    ' 24-bpp DIB scanlines to be aligned on 4-byte boundaries - this means that the destination\r\n    ' array's width may not be a multiple of (imageWidth * 3), by design.\r\n    Dim imgStride As Long\r\n    imgStride = (bm.bmWidth * 3) - 1 + (bm.bmWidth Mod 4)\r\n    ReDim dstPixelData(0 To imgStride, 0 To bm.bmHeight - 1) As Byte\r\n    \r\n    'Create a temporary header to pass to the GetDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = bm.bmWidth\r\n        .bmHeight = bm.bmHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'Copy the pixel data into our array\r\n    GetDIBits srcPictureBox.hDC, srcPictureBox.Image, 0, bm.bmHeight, dstPixelData(0, 0), bmi, 0\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: GetImageData2D
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByRef srcPictureBox As PictureBox, ByRef dstPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcPictureBox
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstPixelData
                is_token: true
                children: []
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByteKeyword
                text: Byte
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: fixOrientation
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "False"
                is_token: false
                children:
                  - kind: FalseKeyword
                    text: "False"
                    is_token: true
                    children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject srcPictureBox.Image, Len(bm), bm\r\n    \r\n    'Calculate a size for the destination array.  For performance reasons, Windows requires\r\n    ' 24-bpp DIB scanlines to be aligned on 4-byte boundaries - this means that the destination\r\n    ' array's width may not be a multiple of (imageWidth * 3), by design.\r\n    Dim imgStride As Long\r\n    imgStride = (bm.bmWidth * 3) - 1 + (bm.bmWidth Mod 4)\r\n    ReDim dstPixelData(0 To imgStride, 0 To bm.bmHeight - 1) As Byte\r\n    \r\n    'Create a temporary header to pass to the GetDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = bm.bmWidth\r\n        .bmHeight = bm.bmHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'Copy the pixel data into our array\r\n    GetDIBits srcPictureBox.hDC, srcPictureBox.Image, 0, bm.bmHeight, dstPixelData(0, 0), bmi, 0\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bm As GDI_Bitmap\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_Bitmap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GetObject srcPictureBox.Image, Len(bm), bm\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GetObject
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Image
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LenKeyword
                    text: Len
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Calculate a size for the destination array.  For performance reasons, Windows requires"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' 24-bpp DIB scanlines to be aligned on 4-byte boundaries - this means that the destination"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' array's width may not be a multiple of (imageWidth * 3), by design."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim imgStride As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imgStride
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "imgStride = (bm.bmWidth * 3) - 1 + (bm.bmWidth Mod 4)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: imgStride
                    is_token: false
                    children:
                      - kind: Identifier
                        text: imgStride
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (bm.bmWidth * 3) - 1 + (bm.bmWidth Mod 4)
                    is_token: false
                    children:
                      - kind: BinaryExpression
                        text: (bm.bmWidth * 3) - 1
                        is_token: false
                        children:
                          - kind: ParenthesizedExpression
                            text: (bm.bmWidth * 3)
                            is_token: false
                            children:
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: bm.bmWidth * 3
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: bm.bmWidth
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: bm
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: bmWidth
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MultiplicationOperator
                                    text: "*"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "3"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "3"
                                        is_token: true
                                        children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "1"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "1"
                                is_token: true
                                children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ParenthesizedExpression
                        text: (bm.bmWidth Mod 4)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: bm.bmWidth Mod 4
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: bm.bmWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bm
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: bmWidth
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: ModKeyword
                                text: Mod
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "4"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "4"
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ReDimStatement
                text: "ReDim dstPixelData(0 To imgStride, 0 To bm.bmHeight - 1) As Byte\r\n"
                is_token: false
                children:
                  - kind: ReDimKeyword
                    text: ReDim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstPixelData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: imgStride
                    is_token: false
                    children:
                      - kind: Identifier
                        text: imgStride
                        is_token: true
                        children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: bm.bmHeight - 1
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: bm.bmHeight
                        is_token: false
                        children:
                          - kind: Identifier
                            text: bm
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: bmHeight
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Create a temporary header to pass to the GetDIBits call"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bmi As GDI_BitmapInfo\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_BitmapInfo
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: WithStatement
                text: "With bmi.bmHeader\r\n        .bmWidth = bm.bmWidth\r\n        .bmHeight = bm.bmHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n"
                is_token: false
                children:
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmHeader
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        .bmWidth = bm.bmWidth\r\n        .bmHeight = bm.bmHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmWidth = bm.bmWidth\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmWidth = bm.bmWidth
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmWidth
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MemberAccessExpression
                                text: bm.bmWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bm
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: bmWidth
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmHeight = bm.bmHeight\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmHeight = bm.bmHeight
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmHeight
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MemberAccessExpression
                                text: bm.bmHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bm
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: bmHeight
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: fixOrientation
                            is_token: false
                            children:
                              - kind: Identifier
                                text: fixOrientation
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".bmHeight = -1 * ."
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: bmHeight = -1 * .
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: bmHeight
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: bmHeight
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "-1 * ."
                                    is_token: false
                                    children:
                                      - kind: UnaryExpression
                                        text: "-1"
                                        is_token: false
                                        children:
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MultiplicationOperator
                                        text: "*"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: "."
                                        is_token: false
                                        children:
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                          - kind: Identifier
                            text: bmHeight
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmSize = 40"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmSize = 40
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmSize
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "40"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "40"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "                "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Size, in bytes, of the header"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmPlanes = 1"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmPlanes = 1
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmPlanes
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmPlanes
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "               "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Number of planes (always one for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmBitCount = 24"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmBitCount = 24
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmBitCount
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmBitCount
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "24"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "24"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "            "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Bits per pixel (always 24 for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmCompression = 0"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmCompression = 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmCompression
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmCompression
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "          "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Compression (always none for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Copy the pixel data into our array"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GetDIBits srcPictureBox.hDC, srcPictureBox.Image, 0, bm.bmHeight, dstPixelData(0, 0), bmi, 0\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GetDIBits
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hDC
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Image
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmHeight
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstPixelData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Set an image's pixel information from a raw byte array.  The byte array *must* have been created"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' according to the rules defined in GetImageData2D(), above.  Similarly, if you reversed scanline"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' order at retrieval time, you should also pass TRUE for fixOrientation when calling this function."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The image will be stretched to fit the destination picture box (without regard to aspect ratio)."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' You can manually modify this by changing the destination parameters of the StretchDIBits call."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub SetImageData2D(ByRef dstPictureBox As PictureBox, ByVal imgWidth As Long, ByVal imgHeight As Long, ByRef srcPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)\r\n    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject dstPictureBox.Image, Len(bm), bm\r\n    \r\n    'Create a temporary header to pass to the StretchDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = imgWidth\r\n        .bmHeight = imgHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'If stretching will be involved, request high-quality stretching from GDI\r\n    SetStretchBltMode dstPictureBox.hDC, 3&\r\n    \r\n    'Paint the pixel data into the destination picture box.  By using bm.bmWidth and bm.bmHeight as\r\n    ' the destination width/height, the pixel data will be automatically resized to fit the picture box.\r\n    StretchDIBits dstPictureBox.hDC, 0, 0, bm.bmWidth, bm.bmHeight, 0, 0, imgWidth, imgHeight, srcPixelData(0, 0), bmi, 0, vbSrcCopy\r\n    \r\n    'VB's built-in backbuffer system (\"AutoRedraw\") won't detect changes made by WAPI functions,\r\n    ' so we need to manually notify it of the need to redraw.\r\n    If dstPictureBox.AutoRedraw Then\r\n        dstPictureBox.Picture = dstPictureBox.Image\r\n        dstPictureBox.Refresh\r\n    End If\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: SetImageData2D
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByRef dstPictureBox As PictureBox, ByVal imgWidth As Long, ByVal imgHeight As Long, ByRef srcPixelData() As Byte, Optional ByVal fixOrientation As Boolean = False)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: dstPictureBox
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: PictureBox
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: imgWidth
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: imgHeight
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: LongKeyword
                text: Long
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByRefKeyword
                text: ByRef
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: srcPixelData
                is_token: true
                children: []
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByteKeyword
                text: Byte
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: OptionalKeyword
                text: Optional
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: fixOrientation
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanKeyword
                text: Boolean
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: EqualityOperator
                text: "="
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: BooleanLiteralExpression
                text: "False"
                is_token: false
                children:
                  - kind: FalseKeyword
                    text: "False"
                    is_token: true
                    children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI\r\n    Dim bm As GDI_Bitmap\r\n    GetObject dstPictureBox.Image, Len(bm), bm\r\n    \r\n    'Create a temporary header to pass to the StretchDIBits call\r\n    Dim bmi As GDI_BitmapInfo\r\n    \r\n    With bmi.bmHeader\r\n        .bmWidth = imgWidth\r\n        .bmHeight = imgHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n    \r\n    'If stretching will be involved, request high-quality stretching from GDI\r\n    SetStretchBltMode dstPictureBox.hDC, 3&\r\n    \r\n    'Paint the pixel data into the destination picture box.  By using bm.bmWidth and bm.bmHeight as\r\n    ' the destination width/height, the pixel data will be automatically resized to fit the picture box.\r\n    StretchDIBits dstPictureBox.hDC, 0, 0, bm.bmWidth, bm.bmHeight, 0, 0, imgWidth, imgHeight, srcPixelData(0, 0), bmi, 0, vbSrcCopy\r\n    \r\n    'VB's built-in backbuffer system (\"AutoRedraw\") won't detect changes made by WAPI functions,\r\n    ' so we need to manually notify it of the need to redraw.\r\n    If dstPictureBox.AutoRedraw Then\r\n        dstPictureBox.Picture = dstPictureBox.Image\r\n        dstPictureBox.Refresh\r\n    End If\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'To avoid dealing with .ScaleMode issues, retrieve the underlying image dimensions via WAPI"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bm As GDI_Bitmap\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_Bitmap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "GetObject dstPictureBox.Image, Len(bm), bm\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: GetObject
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Image
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LenKeyword
                    text: Len
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Create a temporary header to pass to the StretchDIBits call"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim bmi As GDI_BitmapInfo\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: GDI_BitmapInfo
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: WithStatement
                text: "With bmi.bmHeader\r\n        .bmWidth = imgWidth\r\n        .bmHeight = imgHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    End With\r\n"
                is_token: false
                children:
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmHeader
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        .bmWidth = imgWidth\r\n        .bmHeight = imgHeight\r\n        If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n        .bmSize = 40                'Size, in bytes, of the header\r\n        .bmPlanes = 1               'Number of planes (always one for this instance)\r\n        .bmBitCount = 24            'Bits per pixel (always 24 for this instance)\r\n        .bmCompression = 0          'Compression (always none for this instance)\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmWidth = imgWidth\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmWidth = imgWidth
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmWidth
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: imgWidth
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: imgWidth
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmHeight = imgHeight\r\n"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmHeight = imgHeight
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmHeight
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: imgHeight
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: imgHeight
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If fixOrientation Then .bmHeight = -1 * .bmHeight\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: fixOrientation
                            is_token: false
                            children:
                              - kind: Identifier
                                text: fixOrientation
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: ".bmHeight = -1 * ."
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: "."
                                is_token: false
                                children:
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                              - kind: BinaryExpression
                                text: bmHeight = -1 * .
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: bmHeight
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: bmHeight
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "-1 * ."
                                    is_token: false
                                    children:
                                      - kind: UnaryExpression
                                        text: "-1"
                                        is_token: false
                                        children:
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MultiplicationOperator
                                        text: "*"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: "."
                                        is_token: false
                                        children:
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                          - kind: Identifier
                            text: bmHeight
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmSize = 40"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmSize = 40
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmSize
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmSize
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "40"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "40"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "                "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Size, in bytes, of the header"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmPlanes = 1"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmPlanes = 1
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmPlanes
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmPlanes
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "               "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Number of planes (always one for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmBitCount = 24"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmBitCount = 24
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmBitCount
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmBitCount
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "24"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "24"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "            "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Bits per pixel (always 24 for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: ".bmCompression = 0"
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: "."
                            is_token: false
                            children:
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                          - kind: BinaryExpression
                            text: bmCompression = 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: bmCompression
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: bmCompression
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: "          "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'Compression (always none for this instance)"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: WithKeyword
                    text: With
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If stretching will be involved, request high-quality stretching from GDI"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "SetStretchBltMode dstPictureBox.hDC, 3&\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: SetStretchBltMode
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hDC
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongLiteral
                    text: 3&
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Paint the pixel data into the destination picture box.  By using bm.bmWidth and bm.bmHeight as"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' the destination width/height, the pixel data will be automatically resized to fit the picture box."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "StretchDIBits dstPictureBox.hDC, 0, 0, bm.bmWidth, bm.bmHeight, 0, 0, imgWidth, imgHeight, srcPixelData(0, 0), bmi, 0, vbSrcCopy\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: StretchDIBits
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: dstPictureBox
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: hDC
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmWidth
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bm
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmHeight
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imgWidth
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: imgHeight
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: srcPixelData
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: bmi
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: vbSrcCopy
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'VB's built-in backbuffer system (\"AutoRedraw\") won't detect changes made by WAPI functions,"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "' so we need to manually notify it of the need to redraw."
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: IfStatement
                text: "If dstPictureBox.AutoRedraw Then\r\n        dstPictureBox.Picture = dstPictureBox.Image\r\n        dstPictureBox.Refresh\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: dstPictureBox.AutoRedraw
                    is_token: false
                    children:
                      - kind: Identifier
                        text: dstPictureBox
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: AutoRedraw
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        dstPictureBox.Picture = dstPictureBox.Image\r\n        dstPictureBox.Refresh\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "dstPictureBox.Picture = dstPictureBox.Image\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: dstPictureBox.Picture
                            is_token: false
                            children:
                              - kind: Identifier
                                text: dstPictureBox
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MemberAccessExpression
                            text: dstPictureBox.Image
                            is_token: false
                            children:
                              - kind: Identifier
                                text: dstPictureBox
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Image
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "dstPictureBox.Refresh\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: dstPictureBox
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Refresh
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
