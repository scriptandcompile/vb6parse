---
source: tests/form.rs
expression: form_file
---
form:
  name: frmCurves
  tag: ""
  index: 0
  kind:
    Form:
      properties:
        appearance: ThreeD
        auto_redraw: Manual
        back_color:
          System:
            index: 5
        border_style: Sizable
        caption: Image Curves - tannerhelland.com
        client_height: 8835
        client_left: 45
        client_top: 630
        client_width: 8145
        clip_controls: Clipped
        control_box: Included
        draw_mode: CopyPen
        draw_style: Solid
        draw_width: 1
        enabled: Enabled
        fill_color:
          System:
            index: 0
        fill_style: Transparent
        font_transparent: Transparent
        fore_color:
          System:
            index: 18
        has_dc: HasContext
        height: 240
        help_context_id: 0
        icon: ~
        key_preview: false
        left: 0
        link_mode: None
        link_topic: Form1
        max_button: Included
        mdi_child: false
        min_button: Included
        mouse_icon: ~
        mouse_pointer: Default
        moveable: Moveable
        negotiate_menus: true
        ole_drop_mode: None
        palette: ~
        palette_mode: HalfTone
        picture: ~
        right_to_left: LeftToRight
        scale_height: 589
        scale_left: 0
        scale_mode: Twip
        scale_top: 0
        scale_width: 543
        show_in_taskbar: Show
        start_up_position: WindowsDefault
        top: 0
        visible: Visible
        whats_this_button: Excluded
        whats_this_help: F1Help
        width: 240
        window_state: Normal
      controls:
        - name: txtExplanation
          tag: ""
          index: 0
          kind:
            TextBox:
              properties:
                alignment: LeftJustify
                appearance: ThreeD
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                enabled: Enabled
                fore_color:
                  System:
                    index: 8
                height: 3855
                help_context_id: 0
                hide_selection: true
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                locked: false
                max_length: 0
                mouse_icon: ~
                mouse_pointer: Default
                multi_line: SingleLine
                ole_drag_mode: Manual
                ole_drop_mode: None
                password_char: ~
                right_to_left: LeftToRight
                scroll_bars: None
                tab_index: 3
                tab_stop: Included
                text: ""
                tool_tip_text: ""
                top: 120
                visible: Visible
                whats_this_help_id: 0
                width: 3735
        - name: picMain
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 4530
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 300
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 400
                tab_index: 1
                tab_stop: Included
                tool_tip_text: ""
                top: 4200
                visible: Visible
                whats_this_help_id: 0
                width: 6030
              controls: []
        - name: picBack
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  System:
                    index: 5
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 4530
                help_context_id: 0
                left: 120
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 300
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 400
                tab_index: 2
                tab_stop: Included
                tool_tip_text: ""
                top: 4200
                visible: Visible
                whats_this_help_id: 0
                width: 6030
              controls: []
        - name: picCurve
          tag: ""
          index: 0
          kind:
            PictureBox:
              properties:
                align: None
                appearance: ThreeD
                auto_redraw: Manual
                auto_size: Fixed
                back_color:
                  RGB:
                    red: 255
                    green: 255
                    blue: 255
                border_style: FixedSingle
                causes_validation: "Yes"
                clip_controls: Clipped
                data_field: ""
                data_format: ""
                data_member: ""
                data_source: ""
                drag_icon: ~
                drag_mode: Manual
                draw_mode: CopyPen
                draw_style: Solid
                draw_width: 1
                enabled: Enabled
                fill_color:
                  System:
                    index: 0
                fill_style: Transparent
                font_transparent: Transparent
                fore_color:
                  System:
                    index: 8
                has_dc: HasContext
                height: 3855
                help_context_id: 0
                left: 4080
                link_item: ""
                link_mode: None
                link_timeout: 50
                link_topic: ""
                mouse_icon: ~
                mouse_pointer: Default
                negotiate: false
                ole_drag_mode: Manual
                ole_drop_mode: None
                picture: ~
                right_to_left: LeftToRight
                scale_height: 255
                scale_left: 0
                scale_mode: Twip
                scale_top: 0
                scale_width: 255
                tab_index: 0
                tab_stop: Included
                tool_tip_text: ""
                top: 120
                visible: Visible
                whats_this_help_id: 0
                width: 3855
              controls: []
      menus:
        - name: mnuFile
          tag: ""
          index: 0
          properties:
            caption: "&File"
            checked: false
            enabled: Enabled
            help_context_id: 0
            negotiate_position: None
            shortcut: ~
            visible: Visible
            window_list: false
          sub_menus:
            - name: mnuOpenImage
              tag: ""
              index: 0
              properties:
                caption: "&Open image..."
                checked: false
                enabled: Enabled
                help_context_id: 0
                negotiate_position: None
                shortcut: ~
                visible: Visible
                window_list: false
              sub_menus: []
objects: []
version:
  major: 5
  minor: 0
attributes:
  name: frmCurves
  global_name_space: Local
  creatable: "False"
  predeclared_id: "True"
  exposed: "False"
  description: ~
  ext_key: {}
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'Description:\r\n'\r\n'This project demonstrates how to use a cubic spline to adjust image levels\r\n' (nearly identical to Photoshop's method).  The code is well-commented, but there are\r\n' some fairly involved math sections.  Don't feel bad if you don't understand all the details!\r\n'\r\n'Despite the complexity, however, the main routine is a (fairly simple) complete sub that\r\n' could be dropped into any VB project after a few minor adjustments.\r\n'\r\n'Because a large portion of this project relies on DIB sections, I would recommend\r\n' that you first read \"From PSet to DIB Sections - your comprehensive guide to VB\r\n' Graphics Programming.\"  This article can be downloaded from several places, most\r\n' notably http://www.tannerhelland.com/42/vb-graphics-programming-3/\r\n'\r\n'Also, I owe GREAT thanks to the original author of the cubic spline routine I've used\r\n' (Jason Bullen).\r\n' His original cubic spline code can be downloaded from:\r\n' http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=11488&lngWId=1\r\n'\r\n'**************************************************************************************\r\n' JASON'S ORIGINAL CUBIC SPLINE CODE COMMENTS:\r\n' Here is an absolute minimum Cubic Spline routine.\r\n' It's a VB rewrite from a Java applet I found by by Anthony Alto 4/25/99\r\n' Computes coefficients based on equations mathematically derived from the curve\r\n' constraints.   i.e. :\r\n'    curves meet at knots (predefined points)  - These must be sorted by X\r\n'    first derivatives must be equal at knots\r\n'    second derivatives must be equal at knots\r\n'**************************************************************************************\r\n\r\n\r\nOption Explicit\r\n\r\n'Modified cubic spline variables:\r\nPrivate Const maxNPoints As Byte = 32\r\nDim nPoints As Byte\r\nPrivate iX() As Single\r\nPrivate iY() As Single\r\nPrivate p() As Single\r\nPrivate u() As Single\r\n\r\n'Tanner's new variables:\r\nPrivate isMouseDown As Boolean  'Track mouse status between MouseDown and MouseMove events\r\nPrivate selPoint As Long        'Currently selected knot in the spline\r\nPrivate results(-1 To 256) As Integer   'Stores the y-values for each x-value in the final spline\r\nPrivate minX As Integer, maxX As Integer    'Used for calculating leading and trailing values\r\nPrivate Const MOUSE_ACCURACY As Byte = 6 'How close to a knot the user must click to select that knot\r\n\r\n'This routine draws gridlines, knots, and the spline on the picture box\r\nPrivate Function DrawCubicSpline()\r\n    \r\n    'Tanner's inserted code: draw the background grid\r\n    picCurve.Cls\r\n    Dim i As Long\r\n    picCurve.ForeColor = RGB(128, 128, 128)\r\n    For i = 0 To 255 Step 64\r\n        picCurve.Line (i, 0)-(i, 255)\r\n        picCurve.Line (0, i)-(255, i)\r\n    Next i\r\n    'Now draw the knots\r\n    picCurve.ForeColor = RGB(255, 0, 0)\r\n    For i = 1 To nPoints\r\n        'If this is the currently selected knot, fill it in with red\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n        picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n    Next i\r\n    picCurve.ForeColor = RGB(0, 0, 0)\r\n    'Clear the results array and reset the max/min variables\r\n    For i = -1 To 256\r\n        results(i) = -1\r\n    Next i\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Now run a loop through the knots, calculating spline values as we go\r\n    Call SetPandU\r\n    Dim xPos As Long, yPos As Single\r\n    For i = 1 To nPoints - 1\r\n        For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Description:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This project demonstrates how to use a cubic spline to adjust image levels"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' (nearly identical to Photoshop's method).  The code is well-commented, but there are"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' some fairly involved math sections.  Don't feel bad if you don't understand all the details!"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Despite the complexity, however, the main routine is a (fairly simple) complete sub that"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' could be dropped into any VB project after a few minor adjustments."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Because a large portion of this project relies on DIB sections, I would recommend"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' that you first read \"From PSet to DIB Sections - your comprehensive guide to VB"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Graphics Programming.\"  This article can be downloaded from several places, most"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' notably http://www.tannerhelland.com/42/vb-graphics-programming-3/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Also, I owe GREAT thanks to the original author of the cubic spline routine I've used"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' (Jason Bullen)."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' His original cubic spline code can be downloaded from:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=11488&lngWId=1"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'**************************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' JASON'S ORIGINAL CUBIC SPLINE CODE COMMENTS:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Here is an absolute minimum Cubic Spline routine."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' It's a VB rewrite from a Java applet I found by by Anthony Alto 4/25/99"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' Computes coefficients based on equations mathematically derived from the curve"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' constraints.   i.e. :"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'    curves meet at knots (predefined points)  - These must be sorted by X"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'    first derivatives must be equal at knots"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'    second derivatives must be equal at knots"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'**************************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: OptionStatement
        text: "Option Explicit\r\n"
        is_token: false
        children:
          - kind: OptionKeyword
            text: Option
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ExplicitKeyword
            text: Explicit
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Modified cubic spline variables:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private Const maxNPoints As Byte = 32\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: maxNPoints
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "32"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Dim nPoints As Byte\r\n"
        is_token: false
        children:
          - kind: DimKeyword
            text: Dim
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: nPoints
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private iX() As Single\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iX
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private iY() As Single\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: iY
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private p() As Single\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: p
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private u() As Single\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: u
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SingleKeyword
            text: Single
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Tanner's new variables:"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: DimStatement
        text: "Private isMouseDown As Boolean  'Track mouse status between MouseDown and MouseMove events\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: isMouseDown
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: BooleanKeyword
            text: Boolean
            is_token: true
            children: []
          - kind: Whitespace
            text: "  "
            is_token: true
            children: []
          - kind: EndOfLineComment
            text: "'Track mouse status between MouseDown and MouseMove events"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private selPoint As Long        'Currently selected knot in the spline\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: selPoint
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: LongKeyword
            text: Long
            is_token: true
            children: []
          - kind: Whitespace
            text: "        "
            is_token: true
            children: []
          - kind: EndOfLineComment
            text: "'Currently selected knot in the spline"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private results(-1 To 256) As Integer   'Stores the y-values for each x-value in the final spline\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: results
            is_token: true
            children: []
          - kind: LeftParenthesis
            text: (
            is_token: true
            children: []
          - kind: UnaryExpression
            text: "-1"
            is_token: false
            children:
              - kind: SubtractionOperator
                text: "-"
                is_token: true
                children: []
              - kind: NumericLiteralExpression
                text: "1"
                is_token: false
                children:
                  - kind: IntegerLiteral
                    text: "1"
                    is_token: true
                    children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ToKeyword
            text: To
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: NumericLiteralExpression
            text: "256"
            is_token: false
            children:
              - kind: IntegerLiteral
                text: "256"
                is_token: true
                children: []
          - kind: RightParenthesis
            text: )
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Whitespace
            text: "   "
            is_token: true
            children: []
          - kind: EndOfLineComment
            text: "'Stores the y-values for each x-value in the final spline"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private minX As Integer, maxX As Integer    'Used for calculating leading and trailing values\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: minX
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Comma
            text: ","
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: maxX
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerKeyword
            text: Integer
            is_token: true
            children: []
          - kind: Whitespace
            text: "    "
            is_token: true
            children: []
          - kind: EndOfLineComment
            text: "'Used for calculating leading and trailing values"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: DimStatement
        text: "Private Const MOUSE_ACCURACY As Byte = 6 'How close to a knot the user must click to select that knot\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ConstKeyword
            text: Const
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: MOUSE_ACCURACY
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: AsKeyword
            text: As
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: ByteKeyword
            text: Byte
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EqualityOperator
            text: "="
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: IntegerLiteral
            text: "6"
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: EndOfLineComment
            text: "'How close to a knot the user must click to select that knot"
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This routine draws gridlines, knots, and the spline on the picture box"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: FunctionStatement
        text: "Private Function DrawCubicSpline()\r\n    \r\n    'Tanner's inserted code: draw the background grid\r\n    picCurve.Cls\r\n    Dim i As Long\r\n    picCurve.ForeColor = RGB(128, 128, 128)\r\n    For i = 0 To 255 Step 64\r\n        picCurve.Line (i, 0)-(i, 255)\r\n        picCurve.Line (0, i)-(255, i)\r\n    Next i\r\n    'Now draw the knots\r\n    picCurve.ForeColor = RGB(255, 0, 0)\r\n    For i = 1 To nPoints\r\n        'If this is the currently selected knot, fill it in with red\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n        picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n    Next i\r\n    picCurve.ForeColor = RGB(0, 0, 0)\r\n    'Clear the results array and reset the max/min variables\r\n    For i = -1 To 256\r\n        results(i) = -1\r\n    Next i\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Now run a loop through the knots, calculating spline values as we go\r\n    Call SetPandU\r\n    Dim xPos As Long, yPos As Single\r\n    For i = 1 To nPoints - 1\r\n        For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PrivateKeyword
            text: Private
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: FunctionKeyword
            text: Function
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawCubicSpline
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: CodeBlock
            text: "    \r\n    'Tanner's inserted code: draw the background grid\r\n    picCurve.Cls\r\n    Dim i As Long\r\n    picCurve.ForeColor = RGB(128, 128, 128)\r\n    For i = 0 To 255 Step 64\r\n        picCurve.Line (i, 0)-(i, 255)\r\n        picCurve.Line (0, i)-(255, i)\r\n    Next i\r\n    'Now draw the knots\r\n    picCurve.ForeColor = RGB(255, 0, 0)\r\n    For i = 1 To nPoints\r\n        'If this is the currently selected knot, fill it in with red\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n        picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n    Next i\r\n    picCurve.ForeColor = RGB(0, 0, 0)\r\n    'Clear the results array and reset the max/min variables\r\n    For i = -1 To 256\r\n        results(i) = -1\r\n    Next i\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Now run a loop through the knots, calculating spline values as we go\r\n    Call SetPandU\r\n    Dim xPos As Long, yPos As Single\r\n    For i = 1 To nPoints - 1\r\n        For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Tanner's inserted code: draw the background grid"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "picCurve.Cls\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: picCurve
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Cls
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim i As Long\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: i
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picCurve.ForeColor = RGB(128, 128, 128)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picCurve.ForeColor
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picCurve
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ForeColor
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "RGB(128, 128, 128)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: RGB
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "128, 128, 128"
                        is_token: false
                        children:
                          - kind: Argument
                            text: "128"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "128"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "128"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "128"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "128"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "128"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "128"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "128"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "128"
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For i = 0 To 255 Step 64\r\n        picCurve.Line (i, 0)-(i, 255)\r\n        picCurve.Line (0, i)-(255, i)\r\n    Next i\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: i
                    is_token: false
                    children:
                      - kind: Identifier
                        text: i
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "255"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "255"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: StepKeyword
                    text: Step
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "64"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "64"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        picCurve.Line (i, 0)-(i, 255)\r\n        picCurve.Line (0, i)-(255, i)\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "picCurve.Line (i, 0)-(i, 255)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: picCurve
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: LineKeyword
                            text: Line
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "255"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "picCurve.Line (0, i)-(255, i)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: picCurve
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: LineKeyword
                            text: Line
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "255"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: i
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Now draw the knots"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picCurve.ForeColor = RGB(255, 0, 0)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picCurve.ForeColor
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picCurve
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ForeColor
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "RGB(255, 0, 0)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: RGB
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "255, 0, 0"
                        is_token: false
                        children:
                          - kind: Argument
                            text: "255"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "255"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "255"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "0"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "0"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For i = 1 To nPoints\r\n        'If this is the currently selected knot, fill it in with red\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n        picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n    Next i\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: i
                    is_token: false
                    children:
                      - kind: Identifier
                        text: i
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "1"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: nPoints
                    is_token: false
                    children:
                      - kind: Identifier
                        text: nPoints
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        'If this is the currently selected knot, fill it in with red\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n        picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n        If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: EndOfLineComment
                        text: "'If this is the currently selected knot, fill it in with red"
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If i = selPoint Then\r\n            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: i = selPoint
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: i
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: selPoint
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: selPoint
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            picCurve.FillStyle = 0\r\n            picCurve.FillColor = RGB(255, 0, 0)\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picCurve.FillStyle = 0\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picCurve.FillStyle
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picCurve
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: FillStyle
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picCurve.FillColor = RGB(255, 0, 0)\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picCurve.FillColor
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picCurve
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: FillColor
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "RGB(255, 0, 0)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: RGB
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "255, 0, 0"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "255"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "255"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "255"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "picCurve.Circle (iX(i), iY(i)), 4, RGB(255, 0, 0)\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: picCurve
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Circle
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: iX
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: iY
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: i
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "4"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: RGB
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "255"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: IfStatement
                        text: "If i = selPoint Then\r\n            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        End If\r\n"
                        is_token: false
                        children:
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: i = selPoint
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: i
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: selPoint
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: selPoint
                                    is_token: true
                                    children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ThenKeyword
                            text: Then
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            picCurve.FillStyle = 1\r\n            picCurve.FillColor = RGB(0, 0, 0)\r\n        "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picCurve.FillStyle = 1\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picCurve.FillStyle
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picCurve
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: FillStyle
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "1"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "picCurve.FillColor = RGB(0, 0, 0)\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: picCurve.FillColor
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: picCurve
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: FillColor
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "RGB(0, 0, 0)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: RGB
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "0, 0, 0"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                          - kind: EndKeyword
                            text: End
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IfKeyword
                            text: If
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: i
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "picCurve.ForeColor = RGB(0, 0, 0)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: picCurve.ForeColor
                    is_token: false
                    children:
                      - kind: Identifier
                        text: picCurve
                        is_token: true
                        children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: ForeColor
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "RGB(0, 0, 0)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: RGB
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "0, 0, 0"
                        is_token: false
                        children:
                          - kind: Argument
                            text: "0"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "0"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: "0"
                            is_token: false
                            children:
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Clear the results array and reset the max/min variables"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For i = -1 To 256\r\n        results(i) = -1\r\n    Next i\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: i
                    is_token: false
                    children:
                      - kind: Identifier
                        text: i
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "256"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "256"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        results(i) = -1\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "results(i) = -1\r\n"
                        is_token: false
                        children:
                          - kind: CallExpression
                            text: results(i)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: results
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: i
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: i
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: UnaryExpression
                            text: "-1"
                            is_token: false
                            children:
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "1"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "1"
                                    is_token: true
                                    children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: i
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "minX = 256\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: minX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: minX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "256"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "256"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "maxX = -1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: maxX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: maxX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: UnaryExpression
                    text: "-1"
                    is_token: false
                    children:
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Now run a loop through the knots, calculating spline values as we go"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Call SetPandU\r\n"
                is_token: false
                children:
                  - kind: CallKeyword
                    text: Call
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: SetPandU
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: DimStatement
                text: "Dim xPos As Long, yPos As Single\r\n"
                is_token: false
                children:
                  - kind: DimKeyword
                    text: Dim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: xPos
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: LongKeyword
                    text: Long
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: yPos
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: SingleKeyword
                    text: Single
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: ForStatement
                text: "For i = 1 To nPoints - 1\r\n        For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                is_token: false
                children:
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: i
                    is_token: false
                    children:
                      - kind: Identifier
                        text: i
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "1"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: nPoints - 1
                    is_token: false
                    children:
                      - kind: IdentifierExpression
                        text: nPoints
                        is_token: false
                        children:
                          - kind: Identifier
                            text: nPoints
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "1"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "1"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: CodeBlock
                    text: "        For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: ForStatement
                        text: "For xPos = iX(i) To iX(i + 1)\r\n            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                        is_token: false
                        children:
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: xPos
                            is_token: false
                            children:
                              - kind: Identifier
                                text: xPos
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: iX(i)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iX
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: i
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: i
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: CallExpression
                            text: iX(i + 1)
                            is_token: false
                            children:
                              - kind: Identifier
                                text: iX
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: ArgumentList
                                text: i + 1
                                is_token: false
                                children:
                                  - kind: Argument
                                    text: i + 1
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: i + 1
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: i
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: i
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AdditionOperator
                                            text: +
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: CodeBlock
                            text: "            yPos = GetCurvePoint(i, xPos)\r\n            If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n    \r\n    'Based on the maximum and minimum, calculate preceding and trailing y-values\r\n    For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n    For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n    \r\n    'Draw the finished spline\r\n    For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n    picCurve.Refresh\r\n    \r\n    'Last, but certainly not least, draw the curves-adjusted image\r\n    DrawCurves picBack, picMain\r\n    \r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n    Dim t As Single\r\n    'derived curve equation (which uses p's and u's for coefficients)\r\n    t = (v - iX(i)) / u(i)\r\n    GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Function F(x As Single) As Single\r\n    F = x * x * x - x\r\nEnd Function\r\n\r\n'Original required spline function:\r\nPrivate Sub SetPandU()\r\n    Dim i As Integer\r\n    Dim d() As Single\r\n    Dim w() As Single\r\n    ReDim d(nPoints) As Single\r\n    ReDim w(nPoints) As Single\r\n'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts...\r\n'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives\r\n'at knots they share.  General algorithm taken from a book which has long since been lost.\r\n\r\n'The math that derived this stuff is pretty messy...  expressions are isolated and put into\r\n'arrays.  we're essentially trying to find the values of the second derivative of each polynomial\r\n'at each knot within the curve.  That's why theres only N-2 p's (where N is # points).\r\n'later, we use the p's and u's to calculate curve points...\r\n\r\n    For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n    For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n    For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n    For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n    p(1) = 0#\r\n    For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n    p(nPoints) = 0#\r\nEnd Sub\r\n\r\n'********************FORM LOADING********************\r\nPrivate Sub Form_Load()\r\n    \r\n    txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n    txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n    \r\n    'Set form-wide variables to their default values\r\n    isMouseDown = False\r\n    selPoint = -1\r\n    minX = 256\r\n    maxX = -1\r\n    \r\n    'Create 3 default points in a straight line (a good starting point for working with curves)\r\n    nPoints = 3\r\n    ReDim iX(nPoints) As Single\r\n    ReDim iY(nPoints) As Single\r\n    ReDim p(nPoints) As Single\r\n    ReDim u(nPoints) As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n    \r\n    'Draw the initial effect, then update the image\r\n    If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n    DrawCubicSpline\r\n    Me.Show\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub MnuOpenImage_Click()\r\n\r\n    'Windows common dialog interface\r\n    Dim cDialog As pdOpenSaveDialog\r\n    Set cDialog = New pdOpenSaveDialog\r\n    \r\n    'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a\r\n    ' subset of modern image file types.\r\n    Dim cdfStr As String\r\n    cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n    cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n    \r\n    Dim sFile As String\r\n    If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n        \r\n        'Load the image and refresh the effect\r\n        LoadImageAutosized sFile\r\n        DrawCurves picBack, picMain\r\n        \r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "yPos = GetCurvePoint(i, xPos)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: yPos
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: yPos
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "GetCurvePoint(i, xPos)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: GetCurvePoint
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "i, xPos"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: i
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: i
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: xPos
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: xPos
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: xPos
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "            "
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "If xPos < minX Then minX = xPos\r\n            If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n    Next i\r\n"
                                is_token: false
                                children:
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: xPos < minX
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: xPos
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: xPos
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: LessThanOperator
                                        text: "<"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: minX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: minX
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "minX = xPos\r\n"
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: minX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: minX
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: xPos
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: xPos
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "            "
                                    is_token: true
                                    children: []
                                  - kind: IfStatement
                                    text: "If xPos > maxX Then maxX = xPos\r\n            If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n            If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n            results(xPos) = yPos\r\n        Next xPos\r\n"
                                    is_token: false
                                    children:
                                      - kind: IfKeyword
                                        text: If
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: xPos > maxX
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: xPos
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: xPos
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: GreaterThanOperator
                                            text: ">"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: maxX
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: maxX
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: ThenKeyword
                                        text: Then
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "maxX = xPos\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: maxX
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: maxX
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: xPos
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: xPos
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If yPos > 255 Then yPos = 254       'Force values to be in the 1-254 range (0-255 also\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: yPos > 255
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: yPos
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: yPos
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: GreaterThanOperator
                                                text: ">"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "255"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "255"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: yPos = 254
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: yPos
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: yPos
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "254"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "254"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: "       "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "'Force values to be in the 1-254 range (0-255 also"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If yPos < 0 Then yPos = 1           ' works, but is harder to see on the picture box)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: yPos < 0
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: yPos
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: yPos
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LessThanOperator
                                                text: "<"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "0"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "0"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: yPos = 1
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: yPos
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: yPos
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: "           "
                                            is_token: true
                                            children: []
                                          - kind: EndOfLineComment
                                            text: "' works, but is harder to see on the picture box)"
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "results(xPos) = yPos\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: results(xPos)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: results
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: xPos
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: xPos
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: xPos
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: xPos
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: yPos
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: yPos
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: NextKeyword
                                        text: Next
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: xPos
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "    "
                                    is_token: true
                                    children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Based on the maximum and minimum, calculate preceding and trailing y-values"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = -1 To minX - 1\r\n        results(i) = results(minX)\r\n    Next i\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: minX - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: minX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: minX
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        results(i) = results(minX)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "results(i) = results(minX)\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: results(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: results
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: results(minX)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: results
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: minX
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: minX
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: minX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: minX
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 256 To maxX + 1 Step -1\r\n        results(i) = results(maxX)\r\n    Next i\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "256"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "256"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: maxX + 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: maxX
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: maxX
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StepKeyword
                                    text: Step
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        results(i) = results(maxX)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "results(i) = results(maxX)\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: results(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: results
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: results(maxX)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: results
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: maxX
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: maxX
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: maxX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: maxX
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Draw the finished spline"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 0 To 255\r\n        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    Next i\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "255"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "255"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "picCurve.Line (i, results(i))-(i - 1, results(i - 1))\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: picCurve
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: LineKeyword
                                            text: Line
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: results
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: results
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: i
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "picCurve.Refresh\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: picCurve
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Refresh
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Last, but certainly not least, draw the curves-adjusted image"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "DrawCurves picBack, picMain\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: DrawCurves
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: picBack
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: picMain
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: Function
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Original required spline function:"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Private Function GetCurvePoint(ByVal i As Long, ByVal v As Single) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: PrivateKeyword
                                    text: Private
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: FunctionKeyword
                                    text: Function
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: GetCurvePoint
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: ByValKeyword
                                    text: ByVal
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: LongKeyword
                                    text: Long
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ByValKeyword
                                    text: ByVal
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: v
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim t As Single\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: t
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'derived curve equation (which uses p's and u's for coefficients)"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "t = (v - iX(i)) / u(i)\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: t
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: t
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: (v - iX(i)) / u(i)
                                    is_token: false
                                    children:
                                      - kind: ParenthesizedExpression
                                        text: (v - iX(i))
                                        is_token: false
                                        children:
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: v - iX(i)
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: v
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: v
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: iX(i)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iX
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: DivisionOperator
                                        text: /
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: CallExpression
                                        text: u(i)
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: u
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: ArgumentList
                                            text: i
                                            is_token: false
                                            children:
                                              - kind: Argument
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: i
                                                        is_token: true
                                                        children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "GetCurvePoint = t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: GetCurvePoint
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: GetCurvePoint
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "t * iY(i + 1) + (1 - t) * iY(i) + u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#"
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: t * iY(i + 1) + (1 - t) * iY(i)
                                        is_token: false
                                        children:
                                          - kind: BinaryExpression
                                            text: t * iY(i + 1)
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: t
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: t
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: iY(i + 1)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iY
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i + 1
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i + 1
                                                        is_token: false
                                                        children:
                                                          - kind: BinaryExpression
                                                            text: i + 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: i
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AdditionOperator
                                            text: +
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: (1 - t) * iY(i)
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: (1 - t)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: 1 - t
                                                    is_token: false
                                                    children:
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: t
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: t
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: iY(i)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iY
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AdditionOperator
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: "u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i)) / 6#"
                                        is_token: false
                                        children:
                                          - kind: BinaryExpression
                                            text: u(i) * u(i) * (F(t) * p(i + 1) + F(1 - t) * p(i))
                                            is_token: false
                                            children:
                                              - kind: BinaryExpression
                                                text: u(i) * u(i)
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: u(i)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: u
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: i
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: MultiplicationOperator
                                                    text: "*"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: CallExpression
                                                    text: u(i)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: u
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: i
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: (F(t) * p(i + 1) + F(1 - t) * p(i))
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: F(t) * p(i + 1) + F(1 - t) * p(i)
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: F(t) * p(i + 1)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: F(t)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: F
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: t
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: t
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: t
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: t
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: p(i + 1)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: p
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i + 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: i + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: i
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: i
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AdditionOperator
                                                        text: +
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: F(1 - t) * p(i)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: F(1 - t)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: F
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: 1 - t
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: 1 - t
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: 1 - t
                                                                        is_token: false
                                                                        children:
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubtractionOperator
                                                                            text: "-"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: t
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: t
                                                                                is_token: true
                                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: p(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: p
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: DivisionOperator
                                            text: /
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "6#"
                                            is_token: false
                                            children:
                                              - kind: DoubleLiteral
                                                text: "6#"
                                                is_token: true
                                                children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: Function
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Original required spline function:"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Private Function F(x As Single) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: PrivateKeyword
                                    text: Private
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: FunctionKeyword
                                    text: Function
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: F
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: x
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "F = x * x * x - x\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: F
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: F
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: x * x * x - x
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: x * x * x
                                        is_token: false
                                        children:
                                          - kind: BinaryExpression
                                            text: x * x
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: x
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IdentifierExpression
                                                text: x
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: x
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: Function
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Original required spline function:"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Private Sub SetPandU()\r\n"
                                is_token: false
                                children:
                                  - kind: PrivateKeyword
                                    text: Private
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SubKeyword
                                    text: Sub
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: SetPandU
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim i As Integer\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IntegerKeyword
                                    text: Integer
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim d() As Single\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: d
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim w() As Single\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: w
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim d(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: d
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim w(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: w
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: EndOfLineComment
                                text: "'Routine to compute the parameters of our cubic spline.  Based on equations derived from some basic facts..."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Each segment must be a cubic polynomial.  Curve segments must have equal first and second derivatives"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'at knots they share.  General algorithm taken from a book which has long since been lost."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'The math that derived this stuff is pretty messy...  expressions are isolated and put into"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'arrays.  we're essentially trying to find the values of the second derivative of each polynomial"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'at each knot within the curve.  That's why theres only N-2 p's (where N is # points)."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'later, we use the p's and u's to calculate curve points..."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 2 To nPoints - 1\r\n        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    Next\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "2"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: nPoints - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: nPoints
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "d(i) = 2 * (iX(i + 1) - iX(i - 1))\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: d(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: d
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: 2 * (iX(i + 1) - iX(i - 1))
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "2"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "2"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: (iX(i + 1) - iX(i - 1))
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: iX(i + 1) - iX(i - 1)
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: iX(i + 1)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iX
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: i + 1
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: i + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: BinaryExpression
                                                                    text: i + 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AdditionOperator
                                                                        text: +
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallExpression
                                                        text: iX(i - 1)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: iX
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: i - 1
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: i - 1
                                                                is_token: false
                                                                children:
                                                                  - kind: BinaryExpression
                                                                    text: i - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubtractionOperator
                                                                        text: "-"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 1 To nPoints - 1\r\n        u(i) = iX(i + 1) - iX(i)\r\n    Next\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "1"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: nPoints - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: nPoints
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        u(i) = iX(i + 1) - iX(i)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "u(i) = iX(i + 1) - iX(i)\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: u(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: u
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: iX(i + 1) - iX(i)
                                            is_token: false
                                            children:
                                              - kind: CallExpression
                                                text: iX(i + 1)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iX
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i + 1
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i + 1
                                                        is_token: false
                                                        children:
                                                          - kind: BinaryExpression
                                                            text: i + 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: i
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: iX(i)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iX
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 2 To nPoints - 1\r\n        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    Next\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "2"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: nPoints - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: nPoints
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "w(i) = 6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: w(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: w
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: "6# * ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "6#"
                                                is_token: false
                                                children:
                                                  - kind: DoubleLiteral
                                                    text: "6#"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: ((iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1))
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: (iY(i + 1) - iY(i)) / u(i) - (iY(i) - iY(i - 1)) / u(i - 1)
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: (iY(i + 1) - iY(i)) / u(i)
                                                        is_token: false
                                                        children:
                                                          - kind: ParenthesizedExpression
                                                            text: (iY(i + 1) - iY(i))
                                                            is_token: false
                                                            children:
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: iY(i + 1) - iY(i)
                                                                is_token: false
                                                                children:
                                                                  - kind: CallExpression
                                                                    text: iY(i + 1)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iY
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: i + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: i + 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: BinaryExpression
                                                                                text: i + 1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: i
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: i
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AdditionOperator
                                                                                    text: +
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "1"
                                                                                        is_token: true
                                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubtractionOperator
                                                                    text: "-"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallExpression
                                                                    text: iY(i)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iY
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: i
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: i
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: i
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: DivisionOperator
                                                            text: /
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: u(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: (iY(i) - iY(i - 1)) / u(i - 1)
                                                        is_token: false
                                                        children:
                                                          - kind: ParenthesizedExpression
                                                            text: (iY(i) - iY(i - 1))
                                                            is_token: false
                                                            children:
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: iY(i) - iY(i - 1)
                                                                is_token: false
                                                                children:
                                                                  - kind: CallExpression
                                                                    text: iY(i)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iY
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: i
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: i
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: i
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: SubtractionOperator
                                                                    text: "-"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallExpression
                                                                    text: iY(i - 1)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: iY
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ArgumentList
                                                                        text: i - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Argument
                                                                            text: i - 1
                                                                            is_token: false
                                                                            children:
                                                                              - kind: BinaryExpression
                                                                                text: i - 1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: i
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: i
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: SubtractionOperator
                                                                                    text: "-"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "1"
                                                                                        is_token: true
                                                                                        children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: DivisionOperator
                                                            text: /
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: u(i - 1)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i - 1
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i - 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: i - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: i
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: i
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubtractionOperator
                                                                            text: "-"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 2 To nPoints - 2\r\n        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    Next\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "2"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: nPoints - 2
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: nPoints
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "2"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "2"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        w(i + 1) = w(i + 1) - w(i) * u(i) / d(i)\r\n        d(i + 1) = d(i + 1) - u(i) * u(i) / d(i)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: w
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: i
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "1) = w(i + 1) - w(i) * u(i) / d(i)\r\n"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                          - kind: BinaryExpression
                                            text: ) = w(i + 1) - w(i) * u(i) / d(i)
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: )
                                                is_token: false
                                                children:
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: w(i + 1) - w(i) * u(i) / d(i)
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: w(i + 1)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: w
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: i + 1
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: i + 1
                                                            is_token: false
                                                            children:
                                                              - kind: BinaryExpression
                                                                text: i + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SubtractionOperator
                                                    text: "-"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: w(i) * u(i) / d(i)
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: w(i) * u(i)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: w(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: w
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: u(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: DivisionOperator
                                                        text: /
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallExpression
                                                        text: d(i)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: d
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: d
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: i
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: +
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "1) = d(i + 1) - u(i) * u(i) / d(i)\r\n"
                                        is_token: false
                                        children:
                                          - kind: NumericLiteralExpression
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "1"
                                                is_token: true
                                                children: []
                                          - kind: BinaryExpression
                                            text: ) = d(i + 1) - u(i) * u(i) / d(i)
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: )
                                                is_token: false
                                                children:
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: d(i + 1) - u(i) * u(i) / d(i)
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: d(i + 1)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: d
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: i + 1
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: i + 1
                                                            is_token: false
                                                            children:
                                                              - kind: BinaryExpression
                                                                text: i + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "1"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "1"
                                                                        is_token: true
                                                                        children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SubtractionOperator
                                                    text: "-"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: u(i) * u(i) / d(i)
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: u(i) * u(i)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: u(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: u(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: DivisionOperator
                                                        text: /
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: CallExpression
                                                        text: d(i)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: d
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "p(1) = 0#\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: p(1)
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: p
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: "1"
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "1"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "1"
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0#"
                                    is_token: false
                                    children:
                                      - kind: DoubleLiteral
                                        text: "0#"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = nPoints - 1 To 2 Step -1\r\n        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    Next\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: nPoints - 1
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: nPoints
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "2"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "2"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StepKeyword
                                    text: Step
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "p(i) = (w(i) - u(i) * p(i + 1)) / d(i)\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: p(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: p
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: (w(i) - u(i) * p(i + 1)) / d(i)
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: (w(i) - u(i) * p(i + 1))
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: w(i) - u(i) * p(i + 1)
                                                    is_token: false
                                                    children:
                                                      - kind: CallExpression
                                                        text: w(i)
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: w
                                                            is_token: true
                                                            children: []
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: ArgumentList
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Argument
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: u(i) * p(i + 1)
                                                        is_token: false
                                                        children:
                                                          - kind: CallExpression
                                                            text: u(i)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: u
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MultiplicationOperator
                                                            text: "*"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: CallExpression
                                                            text: p(i + 1)
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: p
                                                                is_token: true
                                                                children: []
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: ArgumentList
                                                                text: i + 1
                                                                is_token: false
                                                                children:
                                                                  - kind: Argument
                                                                    text: i + 1
                                                                    is_token: false
                                                                    children:
                                                                      - kind: BinaryExpression
                                                                        text: i + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: i
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: i
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: DivisionOperator
                                                text: /
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: d(i)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: d
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "p(nPoints) = 0#\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: p(nPoints)
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: p
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: nPoints
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: nPoints
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: nPoints
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: nPoints
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0#"
                                    is_token: false
                                    children:
                                      - kind: DoubleLiteral
                                        text: "0#"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: Sub
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'********************FORM LOADING********************"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Private Sub Form_Load()\r\n"
                                is_token: false
                                children:
                                  - kind: PrivateKeyword
                                    text: Private
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SubKeyword
                                    text: Sub
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Form_Load
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "txtExplanation.Text = \"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: txtExplanation.Text
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: txtExplanation
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: TextKeyword
                                        text: Text
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "\"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf & vbCrLf"
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: "\"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\" & vbCrLf"
                                        is_token: false
                                        children:
                                          - kind: StringLiteralExpression
                                            text: "\"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\"If you've never used Photoshop's Curves dialog, here's a quick primer: select the red dots (or click to create your own) and drag them around to adjust the cubic spline.\""
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Ampersand
                                            text: "&"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: vbCrLf
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: vbCrLf
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Ampersand
                                        text: "&"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: vbCrLf
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: vbCrLf
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "txtExplanation.Text = txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: txtExplanation.Text
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: txtExplanation
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: TextKeyword
                                        text: Text
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf & vbCrLf"
                                    is_token: false
                                    children:
                                      - kind: BinaryExpression
                                        text: "txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\" & vbCrLf"
                                        is_token: false
                                        children:
                                          - kind: BinaryExpression
                                            text: "txtExplanation.Text & \"The resulting curve is used to adjust the gamma of the image.\""
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: txtExplanation.Text
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: txtExplanation
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: TextKeyword
                                                    text: Text
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Ampersand
                                                text: "&"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: StringLiteralExpression
                                                text: "\"The resulting curve is used to adjust the gamma of the image.\""
                                                is_token: false
                                                children:
                                                  - kind: StringLiteral
                                                    text: "\"The resulting curve is used to adjust the gamma of the image.\""
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Ampersand
                                            text: "&"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: vbCrLf
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: vbCrLf
                                                is_token: true
                                                children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Ampersand
                                        text: "&"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: IdentifierExpression
                                        text: vbCrLf
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: vbCrLf
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "txtExplanation.Text = txtExplanation.Text & \"(X coords = input level, Y coords = output level)\"\r\n"
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: txtExplanation.Text
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: txtExplanation
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: TextKeyword
                                        text: Text
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "txtExplanation.Text & \"(X coords = input level, Y coords = output level)\""
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: txtExplanation.Text
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: txtExplanation
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: TextKeyword
                                            text: Text
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Ampersand
                                        text: "&"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: StringLiteralExpression
                                        text: "\"(X coords = input level, Y coords = output level)\""
                                        is_token: false
                                        children:
                                          - kind: StringLiteral
                                            text: "\"(X coords = input level, Y coords = output level)\""
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Set form-wide variables to their default values"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "isMouseDown = False\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: isMouseDown
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: isMouseDown
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BooleanLiteralExpression
                                    text: "False"
                                    is_token: false
                                    children:
                                      - kind: FalseKeyword
                                        text: "False"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "selPoint = -1\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: selPoint
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: selPoint
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "minX = 256\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: minX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: minX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "256"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "256"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "maxX = -1\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: maxX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: maxX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: UnaryExpression
                                    text: "-1"
                                    is_token: false
                                    children:
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: NumericLiteralExpression
                                        text: "1"
                                        is_token: false
                                        children:
                                          - kind: IntegerLiteral
                                            text: "1"
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Create 3 default points in a straight line (a good starting point for working with curves)"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "nPoints = 3\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "3"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "3"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim iX(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: iX
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim iY(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: iY
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim p(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: p
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ReDimStatement
                                text: "ReDim u(nPoints) As Single\r\n"
                                is_token: false
                                children:
                                  - kind: ReDimKeyword
                                    text: ReDim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: u
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SingleKeyword
                                    text: Single
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim i As Long\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: LongKeyword
                                    text: Long
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: ForStatement
                                text: "For i = 1 To nPoints\r\n        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    Next i\r\n"
                                is_token: false
                                children:
                                  - kind: ForKeyword
                                    text: For
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: i
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: i
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "1"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "1"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ToKeyword
                                    text: To
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: nPoints
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: nPoints
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "        iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n        iY(i) = 255 - iX(i)\r\n    "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "iX(i) = (i - 1) * (256 / (nPoints - 1))\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: iX(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: iX
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: (i - 1) * (256 / (nPoints - 1))
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: (i - 1)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: i - 1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: ParenthesizedExpression
                                                text: (256 / (nPoints - 1))
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: 256 / (nPoints - 1)
                                                    is_token: false
                                                    children:
                                                      - kind: NumericLiteralExpression
                                                        text: "256"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "256"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: DivisionOperator
                                                        text: /
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: ParenthesizedExpression
                                                        text: (nPoints - 1)
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: nPoints - 1
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: nPoints
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: nPoints
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "iY(i) = 255 - iX(i)\r\n"
                                        is_token: false
                                        children:
                                          - kind: CallExpression
                                            text: iY(i)
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: iY
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: i
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: i
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: 255 - iX(i)
                                            is_token: false
                                            children:
                                              - kind: NumericLiteralExpression
                                                text: "255"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "255"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: iX(i)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: iX
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: i
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: i
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: i
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                  - kind: NextKeyword
                                    text: Next
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: i
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Draw the initial effect, then update the image"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "If (App.LogMode = 0) Then Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n    LoadImageAutosized App.Path & \"\\sample.jpg\"\r\n"
                                is_token: false
                                children:
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ParenthesizedExpression
                                    text: (App.LogMode = 0)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: App.LogMode = 0
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: App.LogMode
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: App
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: LogMode
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "0"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AssignmentStatement
                                    text: "Me.Caption = Me.Caption & \" - compile for significantly better performance!\"\r\n"
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: Me.Caption
                                        is_token: false
                                        children:
                                          - kind: MeKeyword
                                            text: Me
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Caption
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: EqualityOperator
                                        text: "="
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: "Me.Caption & \" - compile for significantly better performance!\""
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: Me.Caption
                                            is_token: false
                                            children:
                                              - kind: MeKeyword
                                                text: Me
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Caption
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Ampersand
                                            text: "&"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: StringLiteralExpression
                                            text: "\" - compile for significantly better performance!\""
                                            is_token: false
                                            children:
                                              - kind: StringLiteral
                                                text: "\" - compile for significantly better performance!\""
                                                is_token: true
                                                children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "    "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: LoadImageAutosized
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: App
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Path
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Ampersand
                                    text: "&"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringLiteral
                                    text: "\"\\sample.jpg\""
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "DrawCubicSpline\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: DrawCubicSpline
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "Me.Show\r\n"
                                is_token: false
                                children:
                                  - kind: MeKeyword
                                    text: Me
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Show
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: Sub
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Private Sub MnuOpenImage_Click()\r\n"
                                is_token: false
                                children:
                                  - kind: PrivateKeyword
                                    text: Private
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SubKeyword
                                    text: Sub
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: MnuOpenImage_Click
                                    is_token: true
                                    children: []
                                  - kind: LeftParenthesis
                                    text: (
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Windows common dialog interface"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim cDialog As pdOpenSaveDialog\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: cDialog
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: pdOpenSaveDialog
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: SetStatement
                                text: "Set cDialog = New pdOpenSaveDialog\r\n"
                                is_token: false
                                children:
                                  - kind: SetKeyword
                                    text: Set
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: cDialog
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NewKeyword
                                    text: New
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: pdOpenSaveDialog
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'VB6's built-in image loader (which wraps an ancient OLE loader) only supports a"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "' subset of modern image file types."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim cdfStr As String\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: cdfStr
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "cdfStr = \"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\"\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: cdfStr
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: cdfStr
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringLiteralExpression
                                    text: "\"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\""
                                    is_token: false
                                    children:
                                      - kind: StringLiteral
                                        text: "\"All Compatible Graphics|*.bmp;*.jpg;*.jpeg;*.gif;*.wmf;*.emf|\""
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "cdfStr = cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\"\r\n"
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: cdfStr
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: cdfStr
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: BinaryExpression
                                    text: "cdfStr & \"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                    is_token: false
                                    children:
                                      - kind: IdentifierExpression
                                        text: cdfStr
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: cdfStr
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Ampersand
                                        text: "&"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: StringLiteralExpression
                                        text: "\"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                        is_token: false
                                        children:
                                          - kind: StringLiteral
                                            text: "\"BMP - Windows Bitmap|*.bmp|EMF - Enhanced Metafile|*.emf|GIF - Compuserve|*.gif|JPG/JPEG - JFIF Compliant|*.jpg;*.jpeg|WMF - Windows Meta File|*.wmf|All files|*.*\""
                                            is_token: true
                                            children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: DimStatement
                                text: "Dim sFile As String\r\n"
                                is_token: false
                                children:
                                  - kind: DimKeyword
                                    text: Dim
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: sFile
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: AsKeyword
                                    text: As
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringKeyword
                                    text: String
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "If cDialog.GetOpenFileName(sFile, , True, False, cdfStr, , , \"Select image\", , Me.hWnd) Then\r\n"
                                is_token: false
                                children:
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: CallExpression
                                    text: "cDialog.GetOpenFileName(sFile, , "
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: cDialog.GetOpenFileName
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: cDialog
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: GetOpenFileName
                                            is_token: true
                                            children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "sFile, , "
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: sFile
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: sFile
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: sFile
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: ","
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: ","
                                                is_token: false
                                                children:
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                  - kind: TrueKeyword
                                    text: "True"
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: FalseKeyword
                                    text: "False"
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: cdfStr
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: StringLiteral
                                    text: "\"Select image\""
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MeKeyword
                                    text: Me
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: hWnd
                                    is_token: true
                                    children: []
                                  - kind: RightParenthesis
                                    text: )
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'Load the image and refresh the effect"
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "LoadImageAutosized sFile\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: LoadImageAutosized
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: sFile
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: CallStatement
                                text: "DrawCurves picBack, picMain\r\n"
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: DrawCurves
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: picBack
                                    is_token: true
                                    children: []
                                  - kind: Comma
                                    text: ","
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: picMain
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                              - kind: Unknown
                                text: End
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "If\r\n    \r\nEnd Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                is_token: false
                                children:
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: "\r\n"
                                    is_token: false
                                    children:
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: "    "
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: CodeBlock
                                    text: "End Sub\r\n\r\n'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer\r\nPrivate Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n\r\n    If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n    'Copy the image, automatically resized, from the background picture box to the foreground one\r\n    Dim fDraw As FastDrawing\r\n    Set fDraw = New FastDrawing\r\n    \r\n    Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n    imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n    imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n    fDraw.GetImageData2D Me.picBack, ImageData()\r\n    \r\n    Me.picMain.Width = imgWidth + 2\r\n    Me.picMain.Height = imgHeight + 2\r\n    fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n    \r\n    'Resize the form to automatically contain the new picture box dimensions.\r\n    ' (This performs some sloppy checks to keep the form from resizing larger than the primary display,\r\n    '  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)\r\n    Dim newWidth As Long, minWidth As Long\r\n    minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n    If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                    is_token: false
                                    children:
                                      - kind: Unknown
                                        text: End
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: Unknown
                                        text: Sub
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'If a null string is passed, simply paint an unmodified copy of the backbuffer into the foreground buffer"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Private Sub LoadImageAutosized(Optional ByVal srcFilePath As String = vbNullString)\r\n"
                                        is_token: false
                                        children:
                                          - kind: PrivateKeyword
                                            text: Private
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubKeyword
                                            text: Sub
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: LoadImageAutosized
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: OptionalKeyword
                                            text: Optional
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ByValKeyword
                                            text: ByVal
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: srcFilePath
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: StringKeyword
                                            text: String
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: vbNullString
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If (LenB(srcFilePath) <> 0) Then picBack.Picture = LoadPicture(srcFilePath)\r\n        \r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ParenthesizedExpression
                                            text: (LenB(srcFilePath) <> 0)
                                            is_token: false
                                            children:
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: LenB(srcFilePath) <> 0
                                                is_token: false
                                                children:
                                                  - kind: CallExpression
                                                    text: LenB(srcFilePath)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: LenB
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: srcFilePath
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: srcFilePath
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: srcFilePath
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: srcFilePath
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: InequalityOperator
                                                    text: "<>"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: NumericLiteralExpression
                                                    text: "0"
                                                    is_token: false
                                                    children:
                                                      - kind: IntegerLiteral
                                                        text: "0"
                                                        is_token: true
                                                        children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AssignmentStatement
                                            text: "picBack.Picture = LoadPicture(srcFilePath)\r\n"
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: picBack.Picture
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: picBack
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Picture
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: EqualityOperator
                                                text: "="
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: CallExpression
                                                text: LoadPicture(srcFilePath)
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: LoadPicture
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ArgumentList
                                                    text: srcFilePath
                                                    is_token: false
                                                    children:
                                                      - kind: Argument
                                                        text: srcFilePath
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: srcFilePath
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: srcFilePath
                                                                is_token: true
                                                                children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "        "
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Copy the image, automatically resized, from the background picture box to the foreground one"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim fDraw As FastDrawing\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: FastDrawing
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: SetStatement
                                        text: "Set fDraw = New FastDrawing\r\n"
                                        is_token: false
                                        children:
                                          - kind: SetKeyword
                                            text: Set
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NewKeyword
                                            text: New
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: FastDrawing
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim ImageData() As Byte, imgWidth As Long, imgHeight As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ImageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ByteKeyword
                                            text: Byte
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imgWidth
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imgHeight
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "imgWidth = fDraw.GetImageWidth(Me.picBack)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: imgWidth
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: imgWidth
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: fDraw.GetImageWidth(Me.picBack)
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: fDraw.GetImageWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: fDraw
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: GetImageWidth
                                                    is_token: true
                                                    children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: Me.picBack
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: Me.picBack
                                                    is_token: false
                                                    children:
                                                      - kind: MemberAccessExpression
                                                        text: Me.picBack
                                                        is_token: false
                                                        children:
                                                          - kind: MeKeyword
                                                            text: Me
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: picBack
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "imgHeight = fDraw.GetImageHeight(Me.picBack)\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: imgHeight
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: imgHeight
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: CallExpression
                                            text: fDraw.GetImageHeight(Me.picBack)
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: fDraw.GetImageHeight
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: fDraw
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: GetImageHeight
                                                    is_token: true
                                                    children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: ArgumentList
                                                text: Me.picBack
                                                is_token: false
                                                children:
                                                  - kind: Argument
                                                    text: Me.picBack
                                                    is_token: false
                                                    children:
                                                      - kind: MemberAccessExpression
                                                        text: Me.picBack
                                                        is_token: false
                                                        children:
                                                          - kind: MeKeyword
                                                            text: Me
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: picBack
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "fDraw.GetImageData2D Me.picBack, ImageData()\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: GetImageData2D
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MeKeyword
                                            text: Me
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: picBack
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ImageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "Me.picMain.Width = imgWidth + 2\r\n"
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: Me.picMain.Width
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: Me.picMain
                                                is_token: false
                                                children:
                                                  - kind: MeKeyword
                                                    text: Me
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: picMain
                                                    is_token: true
                                                    children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: WidthKeyword
                                                text: Width
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: imgWidth + 2
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: imgWidth
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: imgWidth
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AdditionOperator
                                                text: +
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "2"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "2"
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "Me.picMain.Height = imgHeight + 2\r\n"
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: Me.picMain.Height
                                            is_token: false
                                            children:
                                              - kind: MemberAccessExpression
                                                text: Me.picMain
                                                is_token: false
                                                children:
                                                  - kind: MeKeyword
                                                    text: Me
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: picMain
                                                    is_token: true
                                                    children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Height
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: imgHeight + 2
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: imgHeight
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: imgHeight
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: AdditionOperator
                                                text: +
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: NumericLiteralExpression
                                                text: "2"
                                                is_token: false
                                                children:
                                                  - kind: IntegerLiteral
                                                    text: "2"
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "fDraw.SetImageData2D Me.picMain, imgWidth, imgHeight, ImageData()\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: fDraw
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: SetImageData2D
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MeKeyword
                                            text: Me
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: picMain
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imgWidth
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: imgHeight
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ImageData
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'Resize the form to automatically contain the new picture box dimensions."
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "' (This performs some sloppy checks to keep the form from resizing larger than the primary display,"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: EndOfLineComment
                                        text: "'  but it is *not* good code - a proper solution would involve the AdjustWindowRect() API or similar!)"
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: DimStatement
                                        text: "Dim newWidth As Long, minWidth As Long\r\n"
                                        is_token: false
                                        children:
                                          - kind: DimKeyword
                                            text: Dim
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: newWidth
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: minWidth
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: AsKeyword
                                            text: As
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LongKeyword
                                            text: Long
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: AssignmentStatement
                                        text: "minWidth = (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX\r\n"
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: minWidth
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: minWidth
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: EqualityOperator
                                            text: "="
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: BinaryExpression
                                            text: (picCurve.Left + picCurve.Width + 20) * Screen.TwipsPerPixelX
                                            is_token: false
                                            children:
                                              - kind: ParenthesizedExpression
                                                text: (picCurve.Left + picCurve.Width + 20)
                                                is_token: false
                                                children:
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: picCurve.Left + picCurve.Width + 20
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: picCurve.Left + picCurve.Width
                                                        is_token: false
                                                        children:
                                                          - kind: MemberAccessExpression
                                                            text: picCurve.Left
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: picCurve
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: Left
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AdditionOperator
                                                            text: +
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: MemberAccessExpression
                                                            text: picCurve.Width
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: picCurve
                                                                is_token: true
                                                                children: []
                                                              - kind: PeriodOperator
                                                                text: "."
                                                                is_token: true
                                                                children: []
                                                              - kind: WidthKeyword
                                                                text: Width
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AdditionOperator
                                                        text: +
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "20"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "20"
                                                            is_token: true
                                                            children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MemberAccessExpression
                                                text: Screen.TwipsPerPixelX
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: Screen
                                                    is_token: true
                                                    children: []
                                                  - kind: PeriodOperator
                                                    text: "."
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: TwipsPerPixelX
                                                    is_token: true
                                                    children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "    "
                                        is_token: true
                                        children: []
                                      - kind: IfStatement
                                        text: "If (imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50) Then\r\n        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                        is_token: false
                                        children:
                                          - kind: IfKeyword
                                            text: If
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ParenthesizedExpression
                                            text: "(imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50)"
                                            is_token: false
                                            children:
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: BinaryExpression
                                                text: "imgWidth < (Screen.Width \\ Screen.TwipsPerPixelX) - 50"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: imgWidth
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: imgWidth
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LessThanOperator
                                                    text: "<"
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: "(Screen.Width \\ Screen.TwipsPerPixelX) - 50"
                                                    is_token: false
                                                    children:
                                                      - kind: ParenthesizedExpression
                                                        text: "(Screen.Width \\ Screen.TwipsPerPixelX)"
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: "Screen.Width \\ Screen.TwipsPerPixelX"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: Screen.Width
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Screen
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: WidthKeyword
                                                                    text: Width
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BackwardSlashOperator
                                                                text: "\\"
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: MemberAccessExpression
                                                                text: Screen.TwipsPerPixelX
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Screen
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: TwipsPerPixelX
                                                                    is_token: true
                                                                    children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "50"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "50"
                                                            is_token: true
                                                            children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: ThenKeyword
                                            text: Then
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                          - kind: CodeBlock
                                            text: "        newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n        If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n'When the user clicks on the picture box, see if they've selected a control point or not\r\nPrivate Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    'No point selected yet\r\n    selPoint = -1\r\n    \r\n    'Search to see if the user has clicked on (or very near) an existing point\r\n    Dim found As Long\r\n    found = CheckClick(x, Y)\r\n    \r\n    'If the user has selected an existing point, mark it\r\n    If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n    \r\n    'We mark the mouse state here for use in the MouseMove sub\r\n    isMouseDown = True\r\nEnd Sub\r\n\r\n'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot\r\nPrivate Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n    pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\nEnd Function\r\n\r\n'MouseMove allows the user to interactively adjust existing knots and add new knots\r\nPrivate Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    \r\n    'Button down AND a point is current selected\r\n    If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                            is_token: false
                                            children:
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "newWidth = (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: newWidth
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: newWidth
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: (imgWidth + picMain.Left * 4) * Screen.TwipsPerPixelX
                                                    is_token: false
                                                    children:
                                                      - kind: ParenthesizedExpression
                                                        text: (imgWidth + picMain.Left * 4)
                                                        is_token: false
                                                        children:
                                                          - kind: LeftParenthesis
                                                            text: (
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: imgWidth + picMain.Left * 4
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: imgWidth
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: imgWidth
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AdditionOperator
                                                                text: +
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: picMain.Left * 4
                                                                is_token: false
                                                                children:
                                                                  - kind: MemberAccessExpression
                                                                    text: picMain.Left
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: picMain
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: Left
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: MultiplicationOperator
                                                                    text: "*"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: NumericLiteralExpression
                                                                    text: "4"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IntegerLiteral
                                                                        text: "4"
                                                                        is_token: true
                                                                        children: []
                                                          - kind: RightParenthesis
                                                            text: )
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MultiplicationOperator
                                                        text: "*"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: MemberAccessExpression
                                                        text: Screen.TwipsPerPixelX
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: Screen
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: Identifier
                                                            text: TwipsPerPixelX
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "        "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If (newWidth < minWidth) Then newWidth = minWidth\r\n        Me.Width = newWidth\r\n    End If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ParenthesizedExpression
                                                    text: (newWidth < minWidth)
                                                    is_token: false
                                                    children:
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: newWidth < minWidth
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: newWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: newWidth
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: LessThanOperator
                                                            text: "<"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: minWidth
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: minWidth
                                                                is_token: true
                                                                children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "newWidth = minWidth\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: newWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: newWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: minWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: minWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "        "
                                                    is_token: true
                                                    children: []
                                                  - kind: AssignmentStatement
                                                    text: "Me.Width = newWidth\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: MemberAccessExpression
                                                        text: Me.Width
                                                        is_token: false
                                                        children:
                                                          - kind: MeKeyword
                                                            text: Me
                                                            is_token: true
                                                            children: []
                                                          - kind: PeriodOperator
                                                            text: "."
                                                            is_token: true
                                                            children: []
                                                          - kind: WidthKeyword
                                                            text: Width
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: EqualityOperator
                                                        text: "="
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: newWidth
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: newWidth
                                                            is_token: true
                                                            children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: "    "
                                                    is_token: true
                                                    children: []
                                                  - kind: EndKeyword
                                                    text: End
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfStatement
                                                    text: "If\r\n    If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\nEnd Sub\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: IfKeyword
                                                        text: If
                                                        is_token: true
                                                        children: []
                                                      - kind: IdentifierExpression
                                                        text: "\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: "If (imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50) Then Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n    \r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ParenthesizedExpression
                                                            text: "(imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50)"
                                                            is_token: false
                                                            children:
                                                              - kind: LeftParenthesis
                                                                text: (
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: "imgHeight < (Screen.Height \\ Screen.TwipsPerPixelY) - 50"
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: imgHeight
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: imgHeight
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LessThanOperator
                                                                    text: "<"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: "(Screen.Height \\ Screen.TwipsPerPixelY) - 50"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ParenthesizedExpression
                                                                        text: "(Screen.Height \\ Screen.TwipsPerPixelY)"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: "Screen.Height \\ Screen.TwipsPerPixelY"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: Screen.Height
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: Screen
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: Height
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BackwardSlashOperator
                                                                                text: "\\"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MemberAccessExpression
                                                                                text: Screen.TwipsPerPixelY
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: Screen
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: TwipsPerPixelY
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubtractionOperator
                                                                        text: "-"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "50"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "50"
                                                                            is_token: true
                                                                            children: []
                                                              - kind: RightParenthesis
                                                                text: )
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: AssignmentStatement
                                                            text: "Me.Height = (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: MemberAccessExpression
                                                                text: Me.Height
                                                                is_token: false
                                                                children:
                                                                  - kind: MeKeyword
                                                                    text: Me
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: PeriodOperator
                                                                    text: "."
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Identifier
                                                                    text: Height
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: (imgHeight + picMain.TOp * 1.2) * Screen.TwipsPerPixelX
                                                                is_token: false
                                                                children:
                                                                  - kind: ParenthesizedExpression
                                                                    text: (imgHeight + picMain.TOp * 1.2)
                                                                    is_token: false
                                                                    children:
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: imgHeight + picMain.TOp * 1.2
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: imgHeight
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: imgHeight
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: picMain.TOp * 1.2
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: picMain.TOp
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: picMain
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: TOp
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: MultiplicationOperator
                                                                                text: "*"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1.2"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: SingleLiteral
                                                                                    text: "1.2"
                                                                                    is_token: true
                                                                                    children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: MultiplicationOperator
                                                                    text: "*"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: MemberAccessExpression
                                                                    text: Screen.TwipsPerPixelX
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: Screen
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PeriodOperator
                                                                        text: "."
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: TwipsPerPixelX
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: EndKeyword
                                                        text: End
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: SubKeyword
                                                        text: Sub
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: EndOfLineComment
                                                text: "'When the user clicks on the picture box, see if they've selected a control point or not"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: DimStatement
                                                text: "Private Sub picCurve_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n"
                                                is_token: false
                                                children:
                                                  - kind: PrivateKeyword
                                                    text: Private
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SubKeyword
                                                    text: Sub
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: picCurve_MouseDown
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Button
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IntegerKeyword
                                                    text: Integer
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Shift
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IntegerKeyword
                                                    text: Integer
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SingleKeyword
                                                    text: Single
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Y
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SingleKeyword
                                                    text: Single
                                                    is_token: true
                                                    children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'No point selected yet"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "selPoint = -1\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: selPoint
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: selPoint
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: UnaryExpression
                                                    text: "-1"
                                                    is_token: false
                                                    children:
                                                      - kind: SubtractionOperator
                                                        text: "-"
                                                        is_token: true
                                                        children: []
                                                      - kind: NumericLiteralExpression
                                                        text: "1"
                                                        is_token: false
                                                        children:
                                                          - kind: IntegerLiteral
                                                            text: "1"
                                                            is_token: true
                                                            children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'Search to see if the user has clicked on (or very near) an existing point"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: DimStatement
                                                text: "Dim found As Long\r\n"
                                                is_token: false
                                                children:
                                                  - kind: DimKeyword
                                                    text: Dim
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: found
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LongKeyword
                                                    text: Long
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "found = CheckClick(x, Y)\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: found
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: found
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: CallExpression
                                                    text: "CheckClick(x, Y)"
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: CheckClick
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: "x, Y"
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: x
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: x
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: x
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Comma
                                                            text: ","
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: Argument
                                                            text: Y
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: Y
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: Y
                                                                    is_token: true
                                                                    children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'If the user has selected an existing point, mark it"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If found > -1 Then\r\n        selPoint = found\r\n    Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    End If\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: found > -1
                                                    is_token: false
                                                    children:
                                                      - kind: IdentifierExpression
                                                        text: found
                                                        is_token: false
                                                        children:
                                                          - kind: Identifier
                                                            text: found
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: GreaterThanOperator
                                                        text: ">"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: UnaryExpression
                                                        text: "-1"
                                                        is_token: false
                                                        children:
                                                          - kind: SubtractionOperator
                                                            text: "-"
                                                            is_token: true
                                                            children: []
                                                          - kind: NumericLiteralExpression
                                                            text: "1"
                                                            is_token: false
                                                            children:
                                                              - kind: IntegerLiteral
                                                                text: "1"
                                                                is_token: true
                                                                children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        selPoint = found\r\n    "
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: AssignmentStatement
                                                        text: "selPoint = found\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: selPoint
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: selPoint
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: IdentifierExpression
                                                            text: found
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: found
                                                                is_token: true
                                                                children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                      - kind: Whitespace
                                                        text: "    "
                                                        is_token: true
                                                        children: []
                                                  - kind: ElseClause
                                                    text: "Else\r\n        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    "
                                                    is_token: false
                                                    children:
                                                      - kind: ElseKeyword
                                                        text: Else
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: CodeBlock
                                                        text: "        'No match was found, so create a new point here if:\r\n        '  1) This x-coordinate isn't already occupied\r\n        Dim i As Long\r\n        For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n        \r\n        '  2) We haven't reached the maximum allowed limit yet\r\n        If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n    "
                                                        is_token: false
                                                        children:
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'No match was found, so create a new point here if:"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'  1) This x-coordinate isn't already occupied"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: DimStatement
                                                            text: "Dim i As Long\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: DimKeyword
                                                                text: Dim
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: AsKeyword
                                                                text: As
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: LongKeyword
                                                                text: Long
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: ForStatement
                                                            text: "For i = 1 To nPoints\r\n            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        Next i\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: ForKeyword
                                                                text: For
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: i
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: i
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ToKeyword
                                                                text: To
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IdentifierExpression
                                                                text: nPoints
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: nPoints
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: CodeBlock
                                                                text: "            'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't\r\n            'allow two knots to have the same x-value, so instead of creating a new knot just\r\n            'select the knot already occupying this coordinate\r\n            If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n        "
                                                                is_token: false
                                                                children:
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'The user has clicked on an already occupied x-coordinate. Our spline formula doesn't"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'allow two knots to have the same x-value, so instead of creating a new knot just"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'select the knot already occupying this coordinate"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IfStatement
                                                                    text: "If x = iX(i) Then\r\n                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            End If\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: x = iX(i)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: x
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallExpression
                                                                            text: iX(i)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: iX
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: i
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: i
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: i
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: i
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ThenKeyword
                                                                        text: Then
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CodeBlock
                                                                        text: "                selPoint = i\r\n                picCurve.MousePointer = 5\r\n                isMouseDown = True\r\n                Exit Sub\r\n            "
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "selPoint = i\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: selPoint
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: selPoint
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: i
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: i
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "picCurve.MousePointer = 5\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: picCurve.MousePointer
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: picCurve
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: MousePointer
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "5"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "5"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "isMouseDown = True\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: isMouseDown
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: isMouseDown
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BooleanLiteralExpression
                                                                                text: "True"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: TrueKeyword
                                                                                    text: "True"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ExitStatement
                                                                            text: "Exit Sub\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ExitKeyword
                                                                                text: Exit
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubKeyword
                                                                                text: Sub
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "            "
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: EndKeyword
                                                                        text: End
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                              - kind: NextKeyword
                                                                text: Next
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: Identifier
                                                                text: i
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: EndOfLineComment
                                                            text: "'  2) We haven't reached the maximum allowed limit yet"
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: "        "
                                                            is_token: true
                                                            children: []
                                                          - kind: IfStatement
                                                            text: "If nPoints < maxNPoints Then\r\n            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        End If\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: BinaryExpression
                                                                text: nPoints < maxNPoints
                                                                is_token: false
                                                                children:
                                                                  - kind: IdentifierExpression
                                                                    text: nPoints
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: nPoints
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: LessThanOperator
                                                                    text: "<"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IdentifierExpression
                                                                    text: maxNPoints
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: maxNPoints
                                                                        is_token: true
                                                                        children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: ThenKeyword
                                                                text: Then
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                              - kind: CodeBlock
                                                                text: "            'Increase the total number of points and fix all our arrays\r\n            nPoints = nPoints + 1\r\n            ReDim Preserve iX(nPoints) As Single\r\n            ReDim Preserve iY(nPoints) As Single\r\n            ReDim Preserve p(nPoints) As Single\r\n            ReDim Preserve u(nPoints) As Single\r\n            'Figure out which points surround this location\r\n            Dim nextX As Long\r\n            nextX = nPoints\r\n            For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n                        \r\n            'Shift all points after this to the right\r\n            For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n            iX(nextX) = x\r\n            iY(nextX) = Y\r\n            \r\n            'Draw the new spline, change the mousepointer to the move pointer, select this point\r\n            DrawCubicSpline\r\n            picCurve.MousePointer = 5\r\n            selPoint = nextX\r\n            \r\n        "
                                                                is_token: false
                                                                children:
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Increase the total number of points and fix all our arrays"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "nPoints = nPoints + 1\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: nPoints + 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: nPoints
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: nPoints
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AdditionOperator
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ReDimStatement
                                                                    text: "ReDim Preserve iX(nPoints) As Single\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ReDimKeyword
                                                                        text: ReDim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PreserveKeyword
                                                                        text: Preserve
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: iX
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SingleKeyword
                                                                        text: Single
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ReDimStatement
                                                                    text: "ReDim Preserve iY(nPoints) As Single\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ReDimKeyword
                                                                        text: ReDim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PreserveKeyword
                                                                        text: Preserve
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: iY
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SingleKeyword
                                                                        text: Single
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ReDimStatement
                                                                    text: "ReDim Preserve p(nPoints) As Single\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ReDimKeyword
                                                                        text: ReDim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PreserveKeyword
                                                                        text: Preserve
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: p
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SingleKeyword
                                                                        text: Single
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ReDimStatement
                                                                    text: "ReDim Preserve u(nPoints) As Single\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ReDimKeyword
                                                                        text: ReDim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: PreserveKeyword
                                                                        text: Preserve
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: u
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LeftParenthesis
                                                                        text: (
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: RightParenthesis
                                                                        text: )
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SingleKeyword
                                                                        text: Single
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Figure out which points surround this location"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: DimStatement
                                                                    text: "Dim nextX As Long\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: DimKeyword
                                                                        text: Dim
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: nextX
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AsKeyword
                                                                        text: As
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: LongKeyword
                                                                        text: Long
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "nextX = nPoints\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: nextX
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nextX
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ForStatement
                                                                    text: "For i = 1 To nPoints\r\n                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            Next i\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ForKeyword
                                                                        text: For
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "1"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ToKeyword
                                                                        text: To
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nPoints
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CodeBlock
                                                                        text: "                If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n            "
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfStatement
                                                                            text: "If iX(i) > x Then\r\n                    nextX = i\r\n                    Exit For\r\n                End If\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IfKeyword
                                                                                text: If
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: iX(i) > x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: CallExpression
                                                                                    text: iX(i)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: iX
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: i
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: i
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: i
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: i
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: GreaterThanOperator
                                                                                    text: ">"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ThenKeyword
                                                                                text: Then
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "                    nextX = i\r\n                    Exit For\r\n                "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "                    "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "nextX = i\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: nextX
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: nextX
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: i
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: i
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "                    "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ExitStatement
                                                                                    text: "Exit For\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ExitKeyword
                                                                                        text: Exit
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ForKeyword
                                                                                        text: For
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "                "
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: EndKeyword
                                                                                text: End
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfKeyword
                                                                                text: If
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "            "
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: NextKeyword
                                                                        text: Next
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "                        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Shift all points after this to the right"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ForStatement
                                                                    text: "For i = nPoints - 1 To nextX Step -1\r\n                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            Next i\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ForKeyword
                                                                        text: For
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: i
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: nPoints - 1
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: nPoints
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: nPoints
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: SubtractionOperator
                                                                            text: "-"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ToKeyword
                                                                        text: To
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nextX
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nextX
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: StepKeyword
                                                                        text: Step
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: UnaryExpression
                                                                        text: "-1"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: SubtractionOperator
                                                                            text: "-"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: NumericLiteralExpression
                                                                            text: "1"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IntegerLiteral
                                                                                text: "1"
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CodeBlock
                                                                        text: "                iX(i + 1) = iX(i)\r\n                iY(i + 1) = iY(i)\r\n            "
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: iX
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "1) = iX(i)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: BinaryExpression
                                                                                text: ) = iX(i)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: )
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CallExpression
                                                                                    text: iX(i)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: iX
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: i
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: i
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: i
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: i
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "                "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: iY
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: i
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: +
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "1) = iY(i)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: BinaryExpression
                                                                                text: ) = iY(i)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: )
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CallExpression
                                                                                    text: iY(i)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: iY
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: i
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: i
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: i
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: i
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "            "
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: NextKeyword
                                                                        text: Next
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: i
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "iX(nextX) = x\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: iX(nextX)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: iX
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: nextX
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: nextX
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: nextX
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: nextX
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "iY(nextX) = Y\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: iY(nextX)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: iY
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: nextX
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: nextX
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: nextX
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: nextX
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: Y
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: Y
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndOfLineComment
                                                                    text: "'Draw the new spline, change the mousepointer to the move pointer, select this point"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: CallStatement
                                                                    text: "DrawCubicSpline\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: Identifier
                                                                        text: DrawCubicSpline
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "picCurve.MousePointer = 5\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: MemberAccessExpression
                                                                        text: picCurve.MousePointer
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: picCurve
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: PeriodOperator
                                                                            text: "."
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Identifier
                                                                            text: MousePointer
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "5"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "5"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "selPoint = nextX\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IdentifierExpression
                                                                        text: selPoint
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: selPoint
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: nextX
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: nextX
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Newline
                                                                    text: "\r\n"
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                              - kind: EndKeyword
                                                                text: End
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfKeyword
                                                                text: If
                                                                is_token: true
                                                                children: []
                                                              - kind: Newline
                                                                text: "\r\n"
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: "    "
                                                            is_token: true
                                                            children: []
                                                  - kind: EndKeyword
                                                    text: End
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'We mark the mouse state here for use in the MouseMove sub"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "isMouseDown = True\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: isMouseDown
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: isMouseDown
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BooleanLiteralExpression
                                                    text: "True"
                                                    is_token: false
                                                    children:
                                                      - kind: TrueKeyword
                                                        text: "True"
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Unknown
                                                text: End
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Unknown
                                                text: Sub
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'Simple distance formula here - we use this to calculate if the user has clicked on (or near) a knot"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: DimStatement
                                                text: "Private Function pDistance(ByVal x1 As Long, ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Single\r\n"
                                                is_token: false
                                                children:
                                                  - kind: PrivateKeyword
                                                    text: Private
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: FunctionKeyword
                                                    text: Function
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: pDistance
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: ByValKeyword
                                                    text: ByVal
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x1
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LongKeyword
                                                    text: Long
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ByValKeyword
                                                    text: ByVal
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: y1
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LongKeyword
                                                    text: Long
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ByValKeyword
                                                    text: ByVal
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x2
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LongKeyword
                                                    text: Long
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ByValKeyword
                                                    text: ByVal
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: y2
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: LongKeyword
                                                    text: Long
                                                    is_token: true
                                                    children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SingleKeyword
                                                    text: Single
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: AssignmentStatement
                                                text: "pDistance = Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IdentifierExpression
                                                    text: pDistance
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: pDistance
                                                        is_token: true
                                                        children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: EqualityOperator
                                                    text: "="
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: CallExpression
                                                    text: Sqr((x1 - x2) ^ 2 + (y1 - y2) ^ 2)
                                                    is_token: false
                                                    children:
                                                      - kind: Identifier
                                                        text: Sqr
                                                        is_token: true
                                                        children: []
                                                      - kind: LeftParenthesis
                                                        text: (
                                                        is_token: true
                                                        children: []
                                                      - kind: ArgumentList
                                                        text: (x1 - x2) ^ 2 + (y1 - y2) ^ 2
                                                        is_token: false
                                                        children:
                                                          - kind: Argument
                                                            text: (x1 - x2) ^ 2 + (y1 - y2) ^ 2
                                                            is_token: false
                                                            children:
                                                              - kind: BinaryExpression
                                                                text: (x1 - x2) ^ 2 + (y1 - y2) ^ 2
                                                                is_token: false
                                                                children:
                                                                  - kind: BinaryExpression
                                                                    text: (x1 - x2) ^ 2
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ParenthesizedExpression
                                                                        text: (x1 - x2)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: x1 - x2
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x1
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: x2
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x2
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ExponentiationOperator
                                                                        text: ^
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "2"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "2"
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AdditionOperator
                                                                    text: +
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: (y1 - y2) ^ 2
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ParenthesizedExpression
                                                                        text: (y1 - y2)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: y1 - y2
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: y1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: y1
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubtractionOperator
                                                                                text: "-"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: y2
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: y2
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ExponentiationOperator
                                                                        text: ^
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: NumericLiteralExpression
                                                                        text: "2"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IntegerLiteral
                                                                            text: "2"
                                                                            is_token: true
                                                                            children: []
                                                      - kind: RightParenthesis
                                                        text: )
                                                        is_token: true
                                                        children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Unknown
                                                text: End
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Unknown
                                                text: Function
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'MouseMove allows the user to interactively adjust existing knots and add new knots"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: DimStatement
                                                text: "Private Sub picCurve_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n"
                                                is_token: false
                                                children:
                                                  - kind: PrivateKeyword
                                                    text: Private
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SubKeyword
                                                    text: Sub
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: picCurve_MouseMove
                                                    is_token: true
                                                    children: []
                                                  - kind: LeftParenthesis
                                                    text: (
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Button
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IntegerKeyword
                                                    text: Integer
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Shift
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: IntegerKeyword
                                                    text: Integer
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SingleKeyword
                                                    text: Single
                                                    is_token: true
                                                    children: []
                                                  - kind: Comma
                                                    text: ","
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: Identifier
                                                    text: Y
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: AsKeyword
                                                    text: As
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: SingleKeyword
                                                    text: Single
                                                    is_token: true
                                                    children: []
                                                  - kind: RightParenthesis
                                                    text: )
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: EndOfLineComment
                                                text: "'Button down AND a point is current selected"
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: "    "
                                                is_token: true
                                                children: []
                                              - kind: IfStatement
                                                text: "If isMouseDown = True And selPoint > -1 Then\r\n        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                is_token: false
                                                children:
                                                  - kind: IfKeyword
                                                    text: If
                                                    is_token: true
                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: BinaryExpression
                                                    text: isMouseDown = True And selPoint > -1
                                                    is_token: false
                                                    children:
                                                      - kind: BinaryExpression
                                                        text: isMouseDown = True
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: isMouseDown
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: isMouseDown
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: EqualityOperator
                                                            text: "="
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BooleanLiteralExpression
                                                            text: "True"
                                                            is_token: false
                                                            children:
                                                              - kind: TrueKeyword
                                                                text: "True"
                                                                is_token: true
                                                                children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: AndKeyword
                                                        text: And
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: " "
                                                        is_token: true
                                                        children: []
                                                      - kind: BinaryExpression
                                                        text: selPoint > -1
                                                        is_token: false
                                                        children:
                                                          - kind: IdentifierExpression
                                                            text: selPoint
                                                            is_token: false
                                                            children:
                                                              - kind: Identifier
                                                                text: selPoint
                                                                is_token: true
                                                                children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: GreaterThanOperator
                                                            text: ">"
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: UnaryExpression
                                                            text: "-1"
                                                            is_token: false
                                                            children:
                                                              - kind: SubtractionOperator
                                                                text: "-"
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "1"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "1"
                                                                    is_token: true
                                                                    children: []
                                                  - kind: Whitespace
                                                    text: " "
                                                    is_token: true
                                                    children: []
                                                  - kind: ThenKeyword
                                                    text: Then
                                                    is_token: true
                                                    children: []
                                                  - kind: Newline
                                                    text: "\r\n"
                                                    is_token: true
                                                    children: []
                                                  - kind: CodeBlock
                                                    text: "        'The first knot has to be checked specially (no point before it)\r\n        If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                    is_token: false
                                                    children:
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: EndOfLineComment
                                                        text: "'The first knot has to be checked specially (no point before it)"
                                                        is_token: true
                                                        children: []
                                                      - kind: Newline
                                                        text: "\r\n"
                                                        is_token: true
                                                        children: []
                                                      - kind: Whitespace
                                                        text: "        "
                                                        is_token: true
                                                        children: []
                                                      - kind: IfStatement
                                                        text: "If selPoint = 0 Then\r\n            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                        is_token: false
                                                        children:
                                                          - kind: IfKeyword
                                                            text: If
                                                            is_token: true
                                                            children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: BinaryExpression
                                                            text: selPoint = 0
                                                            is_token: false
                                                            children:
                                                              - kind: IdentifierExpression
                                                                text: selPoint
                                                                is_token: false
                                                                children:
                                                                  - kind: Identifier
                                                                    text: selPoint
                                                                    is_token: true
                                                                    children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: EqualityOperator
                                                                text: "="
                                                                is_token: true
                                                                children: []
                                                              - kind: Whitespace
                                                                text: " "
                                                                is_token: true
                                                                children: []
                                                              - kind: NumericLiteralExpression
                                                                text: "0"
                                                                is_token: false
                                                                children:
                                                                  - kind: IntegerLiteral
                                                                    text: "0"
                                                                    is_token: true
                                                                    children: []
                                                          - kind: Whitespace
                                                            text: " "
                                                            is_token: true
                                                            children: []
                                                          - kind: ThenKeyword
                                                            text: Then
                                                            is_token: true
                                                            children: []
                                                          - kind: Newline
                                                            text: "\r\n"
                                                            is_token: true
                                                            children: []
                                                          - kind: CodeBlock
                                                            text: "            If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                            is_token: false
                                                            children:
                                                              - kind: Whitespace
                                                                text: "            "
                                                                is_token: true
                                                                children: []
                                                              - kind: IfStatement
                                                                text: "If (x >= 0) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'The last knot also has to be checked specially (no point after it)\r\n        If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                                is_token: false
                                                                children:
                                                                  - kind: IfKeyword
                                                                    text: If
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: BinaryExpression
                                                                    text: (x >= 0) And (x < iX(selPoint + 1))
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ParenthesizedExpression
                                                                        text: (x >= 0)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: x >= 0
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: GreaterThanOrEqualOperator
                                                                                text: ">="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AndKeyword
                                                                        text: And
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ParenthesizedExpression
                                                                        text: (x < iX(selPoint + 1))
                                                                        is_token: false
                                                                        children:
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: BinaryExpression
                                                                            text: x < iX(selPoint + 1)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LessThanOperator
                                                                                text: "<"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: iX(selPoint + 1)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iX
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: selPoint + 1
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: selPoint + 1
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: BinaryExpression
                                                                                            text: selPoint + 1
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: selPoint
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: selPoint
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AdditionOperator
                                                                                                text: +
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "1"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "1"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ThenKeyword
                                                                    text: Then
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: AssignmentStatement
                                                                    text: "iX(selPoint) = x\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: CallExpression
                                                                        text: iX(selPoint)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: iX
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: LeftParenthesis
                                                                            text: (
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ArgumentList
                                                                            text: selPoint
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Argument
                                                                                text: selPoint
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: selPoint
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: selPoint
                                                                                        is_token: true
                                                                                        children: []
                                                                          - kind: RightParenthesis
                                                                            text: )
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EqualityOperator
                                                                        text: "="
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: x
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Identifier
                                                                            text: x
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IfStatement
                                                                    text: "If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: (Y >= 0) And (Y <= 255)
                                                                        is_token: false
                                                                        children:
                                                                          - kind: ParenthesizedExpression
                                                                            text: (Y >= 0)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: Y >= 0
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: Y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: Y
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: GreaterThanOrEqualOperator
                                                                                    text: ">="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "0"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "0"
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AndKeyword
                                                                            text: And
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ParenthesizedExpression
                                                                            text: (Y <= 255)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: Y <= 255
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: Y
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: Y
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: LessThanOrEqualOperator
                                                                                    text: "<="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "255"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "255"
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ThenKeyword
                                                                        text: Then
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: AssignmentStatement
                                                                        text: "iY(selPoint) = Y\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: CallExpression
                                                                            text: iY(selPoint)
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: iY
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ArgumentList
                                                                                text: selPoint
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Argument
                                                                                    text: selPoint
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: selPoint
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: selPoint
                                                                                            is_token: true
                                                                                            children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: Y
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: Y
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "            "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Identifier
                                                                        text: DrawCubicSpline
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "            "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: ExitStatement
                                                                    text: "Exit Sub\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: ExitKeyword
                                                                        text: Exit
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: SubKeyword
                                                                        text: Sub
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: EndKeyword
                                                                    text: End
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: Whitespace
                                                                    text: " "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IfStatement
                                                                    text: "If\r\n        'The last knot also has to be checked specially (no point after it)\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: IdentifierExpression
                                                                        text: "\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                      - kind: Whitespace
                                                                        text: "        "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: EndOfLineComment
                                                                        text: "'The last knot also has to be checked specially (no point after it)"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                  - kind: Whitespace
                                                                    text: "        "
                                                                    is_token: true
                                                                    children: []
                                                                  - kind: IfStatement
                                                                    text: "If selPoint = nPoints Then\r\n            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                                    is_token: false
                                                                    children:
                                                                      - kind: IfKeyword
                                                                        text: If
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: BinaryExpression
                                                                        text: selPoint = nPoints
                                                                        is_token: false
                                                                        children:
                                                                          - kind: IdentifierExpression
                                                                            text: selPoint
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: selPoint
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EqualityOperator
                                                                            text: "="
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IdentifierExpression
                                                                            text: nPoints
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: nPoints
                                                                                is_token: true
                                                                                children: []
                                                                      - kind: Whitespace
                                                                        text: " "
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: ThenKeyword
                                                                        text: Then
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: Newline
                                                                        text: "\r\n"
                                                                        is_token: true
                                                                        children: []
                                                                      - kind: CodeBlock
                                                                        text: "            If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n'When the mouse is lifted, reset the mousestate boolean and the mouse pointer\r\nPrivate Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n    isMouseDown = False\r\n    picCurve.MousePointer = 0\r\nEnd Sub\r\n\r\n'Simple distance routine to see if a location on the picture box is near an existing knot\r\nPrivate Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n    Dim dist As Single\r\n    Dim i As Long\r\n    For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n    'Returning -1 says we're not close to an existing point (so try to create a new one!)\r\n    CheckClick = -1\r\nEnd Function\r\n\r\nPublic Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n\r\n    'This array will hold the image's pixel data\r\n    Dim ImageData() As Byte\r\n    \r\n    'Coordinate variables\r\n    Dim x As Long, Y As Long\r\n    \r\n    'Image dimensions\r\n    Dim iWidth As Long, iHeight As Long\r\n    \r\n    'Instantiate a FastDrawing class and gather the image's data (into ImageData())\r\n    Dim fDraw As New FastDrawing\r\n    iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n    iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n    fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n    \r\n    'These variables will hold temporary pixel color values\r\n    Dim R As Long, G As Long, B As Long, L As Long\r\n\r\n    'Look-up table calculation for new gamma values\r\n    Dim newGamma(0 To 255) As Byte\r\n    Dim tmpGamma As Double\r\n    For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n    \r\n    'Now run a quick loop through the image, adjusting pixel values with the look-up tables\r\n    Dim QuickX As Long\r\n    For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n    \r\n    'Draw the new image data to the screen\r\n    fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n\r\n\r\nEnd Sub\r\n"
                                                                        is_token: false
                                                                        children:
                                                                          - kind: Whitespace
                                                                            text: "            "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: IfStatement
                                                                            text: "If (x > iX(selPoint - 1)) And (x <= 255) Then iX(selPoint) = x\r\n            If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n            Exit Sub\r\n        End If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n        If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n    If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n    \r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IfKeyword
                                                                                text: If
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: (x > iX(selPoint - 1)) And (x <= 255)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: ParenthesizedExpression
                                                                                    text: (x > iX(selPoint - 1))
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: x > iX(selPoint - 1)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: GreaterThanOperator
                                                                                            text: ">"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CallExpression
                                                                                            text: iX(selPoint - 1)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: iX
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: selPoint - 1
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: selPoint - 1
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: BinaryExpression
                                                                                                        text: selPoint - 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: selPoint
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: selPoint
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: SubtractionOperator
                                                                                                            text: "-"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AndKeyword
                                                                                    text: And
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ParenthesizedExpression
                                                                                    text: (x <= 255)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: x <= 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOrEqualOperator
                                                                                            text: "<="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ThenKeyword
                                                                                text: Then
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AssignmentStatement
                                                                                text: "iX(selPoint) = x\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: CallExpression
                                                                                    text: iX(selPoint)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: iX
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: LeftParenthesis
                                                                                        text: (
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ArgumentList
                                                                                        text: selPoint
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Argument
                                                                                            text: selPoint
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: selPoint
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: selPoint
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                      - kind: RightParenthesis
                                                                                        text: )
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EqualityOperator
                                                                                    text: "="
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: x
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: x
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n            DrawCubicSpline\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: (Y >= 0) And (Y <= 255)
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (Y >= 0)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: Y >= 0
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: GreaterThanOrEqualOperator
                                                                                                text: ">="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "0"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "0"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AndKeyword
                                                                                        text: And
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (Y <= 255)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: Y <= 255
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LessThanOrEqualOperator
                                                                                                text: "<="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "255"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "255"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ThenKeyword
                                                                                    text: Then
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "iY(selPoint) = Y\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: iY(selPoint)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: iY
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: selPoint
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: selPoint
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: selPoint
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: selPoint
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: Y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: Y
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "            "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: DrawCubicSpline
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "            "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ExitStatement
                                                                                text: "Exit Sub\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: ExitKeyword
                                                                                    text: Exit
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: SubKeyword
                                                                                    text: Sub
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EndKeyword
                                                                                text: End
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If\r\n        'For all middle knots, don't allow them to be moved past neighboring knots\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IdentifierExpression
                                                                                    text: "\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "'For all middle knots, don't allow them to be moved past neighboring knots"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "        "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If (x > iX(selPoint - 1)) And (x < iX(selPoint + 1)) Then iX(selPoint) = x\r\n        If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n    'Button up\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: (x > iX(selPoint - 1)) And (x < iX(selPoint + 1))
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (x > iX(selPoint - 1))
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: x > iX(selPoint - 1)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: GreaterThanOperator
                                                                                                text: ">"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: iX(selPoint - 1)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: selPoint - 1
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: selPoint - 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: BinaryExpression
                                                                                                            text: selPoint - 1
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: selPoint
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: selPoint
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: SubtractionOperator
                                                                                                                text: "-"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "1"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IntegerLiteral
                                                                                                                    text: "1"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AndKeyword
                                                                                        text: And
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ParenthesizedExpression
                                                                                        text: (x < iX(selPoint + 1))
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: x < iX(selPoint + 1)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: x
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LessThanOperator
                                                                                                text: "<"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: iX(selPoint + 1)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: iX
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: selPoint + 1
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: selPoint + 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: BinaryExpression
                                                                                                            text: selPoint + 1
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: selPoint
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: selPoint
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: AdditionOperator
                                                                                                                text: +
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "1"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IntegerLiteral
                                                                                                                    text: "1"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ThenKeyword
                                                                                    text: Then
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "iX(selPoint) = x\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: iX(selPoint)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: iX
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: selPoint
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: selPoint
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: selPoint
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: selPoint
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: x
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: x
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If (Y >= 0) And (Y <= 255) Then iY(selPoint) = Y\r\n    End If\r\n    DrawCubicSpline\r\n    \r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: (Y >= 0) And (Y <= 255)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ParenthesizedExpression
                                                                                            text: (Y >= 0)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: Y >= 0
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: GreaterThanOrEqualOperator
                                                                                                    text: ">="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "0"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "0"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AndKeyword
                                                                                            text: And
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ParenthesizedExpression
                                                                                            text: (Y <= 255)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: Y <= 255
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LessThanOrEqualOperator
                                                                                                    text: "<="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "255"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "255"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "iY(selPoint) = Y\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: iY(selPoint)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: iY
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: selPoint
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: selPoint
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: selPoint
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: selPoint
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: Y
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: Y
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "    "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfStatement
                                                                                        text: "If\r\n    DrawCubicSpline\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IfKeyword
                                                                                            text: If
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: "\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "    "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: DrawCubicSpline
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "    "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "    "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "'Button up"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "    "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IfStatement
                                                                                text: "If isMouseDown = False Then\r\n        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    End If\r\n"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: BinaryExpression
                                                                                    text: isMouseDown = False
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: isMouseDown
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: isMouseDown
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BooleanLiteralExpression
                                                                                        text: "False"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: FalseKeyword
                                                                                            text: "False"
                                                                                            is_token: true
                                                                                            children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ThenKeyword
                                                                                    text: Then
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: CodeBlock
                                                                                    text: "        'If the user is close to a knot, change the mousepointer to 'move'\r\n        Dim found As Long\r\n        found = CheckClick(x, Y)\r\n        If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n    "
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EndOfLineComment
                                                                                        text: "'If the user is close to a knot, change the mousepointer to 'move'"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: DimStatement
                                                                                        text: "Dim found As Long\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: DimKeyword
                                                                                            text: Dim
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Identifier
                                                                                            text: found
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AsKeyword
                                                                                            text: As
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LongKeyword
                                                                                            text: Long
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: AssignmentStatement
                                                                                        text: "found = CheckClick(x, Y)\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: found
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: found
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EqualityOperator
                                                                                            text: "="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CallExpression
                                                                                            text: "CheckClick(x, Y)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: CheckClick
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: "x, Y"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: x
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Argument
                                                                                                    text: Y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: Y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: Y
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "        "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfStatement
                                                                                        text: "If found > -1 Then\r\n            picCurve.MousePointer = 5\r\n        Else\r\n            picCurve.MousePointer = 0\r\n        End If\r\n"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IfKeyword
                                                                                            text: If
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: found > -1
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: found
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: found
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: GreaterThanOperator
                                                                                                text: ">"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: UnaryExpression
                                                                                                text: "-1"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "1"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "1"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ThenKeyword
                                                                                            text: Then
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "            picCurve.MousePointer = 5\r\n        "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "            "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "picCurve.MousePointer = 5\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: MemberAccessExpression
                                                                                                    text: picCurve.MousePointer
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: picCurve
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: PeriodOperator
                                                                                                        text: "."
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Identifier
                                                                                                        text: MousePointer
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "5"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "5"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: ElseClause
                                                                                            text: "Else\r\n            picCurve.MousePointer = 0\r\n        "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: ElseKeyword
                                                                                                text: Else
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CodeBlock
                                                                                                text: "            picCurve.MousePointer = 0\r\n        "
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Whitespace
                                                                                                    text: "            "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: AssignmentStatement
                                                                                                    text: "picCurve.MousePointer = 0\r\n"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: MemberAccessExpression
                                                                                                        text: picCurve.MousePointer
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: picCurve
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: PeriodOperator
                                                                                                            text: "."
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Identifier
                                                                                                            text: MousePointer
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: EqualityOperator
                                                                                                        text: "="
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: NumericLiteralExpression
                                                                                                        text: "0"
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IntegerLiteral
                                                                                                            text: "0"
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Newline
                                                                                                        text: "\r\n"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: "        "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: EndKeyword
                                                                                            text: End
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IfKeyword
                                                                                            text: If
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: "    "
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: EndKeyword
                                                                                    text: End
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfKeyword
                                                                                    text: If
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: "    "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Unknown
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: Sub
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'When the mouse is lifted, reset the mousestate boolean and the mouse pointer"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Private Sub picCurve_MouseUp(Button As Integer, Shift As Integer, x As Single, Y As Single)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: PrivateKeyword
                                                                                text: Private
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubKeyword
                                                                                text: Sub
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: picCurve_MouseUp
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Button
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IntegerKeyword
                                                                                text: Integer
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Shift
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IntegerKeyword
                                                                                text: Integer
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SingleKeyword
                                                                                text: Single
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Y
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SingleKeyword
                                                                                text: Single
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "isMouseDown = False\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: isMouseDown
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: isMouseDown
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BooleanLiteralExpression
                                                                                text: "False"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: FalseKeyword
                                                                                    text: "False"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "picCurve.MousePointer = 0\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: MemberAccessExpression
                                                                                text: picCurve.MousePointer
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: picCurve
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: PeriodOperator
                                                                                    text: "."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Identifier
                                                                                    text: MousePointer
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Unknown
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: Sub
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Simple distance routine to see if a location on the picture box is near an existing knot"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Private Function CheckClick(ByVal x As Long, ByVal Y As Long) As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: PrivateKeyword
                                                                                text: Private
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: FunctionKeyword
                                                                                text: Function
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: CheckClick
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ByValKeyword
                                                                                text: ByVal
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ByValKeyword
                                                                                text: ByVal
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Y
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim dist As Single\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: dist
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SingleKeyword
                                                                                text: Single
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim i As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: i
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ForStatement
                                                                            text: "For i = 1 To nPoints\r\n        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    Next i\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ForKeyword
                                                                                text: For
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: i
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: i
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "1"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ToKeyword
                                                                                text: To
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: nPoints
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: nPoints
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "        dist = pDistance(x, Y, iX(i), iY(i))\r\n        'If we're close to an existing point, return the index of that point\r\n        If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n    "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "dist = pDistance(x, Y, iX(i), iY(i))\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: dist
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: dist
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CallExpression
                                                                                        text: "pDistance(x, Y, iX(i), iY(i))"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: pDistance
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: "x, Y, iX(i), iY(i)"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Argument
                                                                                                text: Y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: Y
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: Y
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Argument
                                                                                                text: iX(i)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: CallExpression
                                                                                                    text: iX(i)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iX
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ArgumentList
                                                                                                        text: i
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Argument
                                                                                                            text: i
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: i
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: i
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Comma
                                                                                                text: ","
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Argument
                                                                                                text: iY(i)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: CallExpression
                                                                                                    text: iY(i)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: iY
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ArgumentList
                                                                                                        text: i
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Argument
                                                                                                            text: i
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: i
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: i
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "'If we're close to an existing point, return the index of that point"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If dist < MOUSE_ACCURACY Then\r\n            CheckClick = i\r\n            Exit Function\r\n        End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: dist < MOUSE_ACCURACY
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: dist
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: dist
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOperator
                                                                                            text: "<"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: IdentifierExpression
                                                                                            text: MOUSE_ACCURACY
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: MOUSE_ACCURACY
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "            CheckClick = i\r\n            Exit Function\r\n        "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "            "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "CheckClick = i\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: CheckClick
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: CheckClick
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: i
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: i
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "            "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ExitStatement
                                                                                            text: "Exit Function\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: ExitKeyword
                                                                                                text: Exit
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: FunctionKeyword
                                                                                                text: Function
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "    "
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: NextKeyword
                                                                                text: Next
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: i
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Returning -1 says we're not close to an existing point (so try to create a new one!)"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "CheckClick = -1\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: CheckClick
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: CheckClick
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: UnaryExpression
                                                                                text: "-1"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: SubtractionOperator
                                                                                    text: "-"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "1"
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Unknown
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: Function
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Public Sub DrawCurves(srcPic As PictureBox, dstPic As PictureBox)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: PublicKeyword
                                                                                text: Public
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: SubKeyword
                                                                                text: Sub
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: DrawCurves
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: srcPic
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: PictureBox
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: dstPic
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: PictureBox
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'This array will hold the image's pixel data"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim ImageData() As Byte\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: ImageData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ByteKeyword
                                                                                text: Byte
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Coordinate variables"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim x As Long, Y As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: Y
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Image dimensions"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim iWidth As Long, iHeight As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: iWidth
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: iHeight
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Instantiate a FastDrawing class and gather the image's data (into ImageData())"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim fDraw As New FastDrawing\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: fDraw
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NewKeyword
                                                                                text: New
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: FastDrawing
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "iWidth = fDraw.GetImageWidth(frmCurves.picBack)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: iWidth
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iWidth
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: fDraw.GetImageWidth(frmCurves.picBack)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: MemberAccessExpression
                                                                                    text: fDraw.GetImageWidth
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: fDraw
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: PeriodOperator
                                                                                        text: "."
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: GetImageWidth
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: frmCurves.picBack
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: frmCurves.picBack
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: MemberAccessExpression
                                                                                            text: frmCurves.picBack
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: frmCurves
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: PeriodOperator
                                                                                                text: "."
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Identifier
                                                                                                text: picBack
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: AssignmentStatement
                                                                            text: "iHeight = fDraw.GetImageHeight(frmCurves.picBack)\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: IdentifierExpression
                                                                                text: iHeight
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: iHeight
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CallExpression
                                                                                text: fDraw.GetImageHeight(frmCurves.picBack)
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: MemberAccessExpression
                                                                                    text: fDraw.GetImageHeight
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: fDraw
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: PeriodOperator
                                                                                        text: "."
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: GetImageHeight
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: LeftParenthesis
                                                                                    text: (
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ArgumentList
                                                                                    text: frmCurves.picBack
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Argument
                                                                                        text: frmCurves.picBack
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: MemberAccessExpression
                                                                                            text: frmCurves.picBack
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: frmCurves
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: PeriodOperator
                                                                                                text: "."
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Identifier
                                                                                                text: picBack
                                                                                                is_token: true
                                                                                                children: []
                                                                                  - kind: RightParenthesis
                                                                                    text: )
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallStatement
                                                                            text: "fDraw.GetImageData2D frmCurves.picBack, ImageData()\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: fDraw
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: GetImageData2D
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: frmCurves
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: picBack
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: ImageData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'These variables will hold temporary pixel color values"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim R As Long, G As Long, B As Long, L As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: R
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: G
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: B
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: L
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Look-up table calculation for new gamma values"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim newGamma(0 To 255) As Byte\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: newGamma
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ToKeyword
                                                                                text: To
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ByteKeyword
                                                                                text: Byte
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim tmpGamma As Double\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: tmpGamma
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: DoubleKeyword
                                                                                text: Double
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ForStatement
                                                                            text: "For x = 0 To 255\r\n        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    Next x\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ForKeyword
                                                                                text: For
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ToKeyword
                                                                                text: To
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "255"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "255"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "        tmpGamma = CDbl(x) / 255\r\n        'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -\r\n        ' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is\r\n        ' good for emphasizing subtle dark shades that the human eye doesn't normally pick up...\r\n        ' I think.  If this 'if' statement is removed, the top statement will yield more mathematically\r\n        ' consistent results, but this version ends up yielding results closer to what Photoshop's\r\n        ' Curves dialog does.  Go figure!\r\n        If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n        tmpGamma = tmpGamma * 255\r\n        If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n        newGamma(x) = tmpGamma\r\n    "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "tmpGamma = CDbl(x) / 255\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: tmpGamma
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: tmpGamma
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: CDbl(x) / 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: CDbl(x)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: CDbl
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: x
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: DivisionOperator
                                                                                            text: /
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "'This 'if' statement is necessary to match a weird trend with Photoshop's Curves dialog -"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "' for darker gamma values, Photoshop increases the force of the gamma conversion.  This is"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "' good for emphasizing subtle dark shades that the human eye doesn't normally pick up..."
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "' I think.  If this 'if' statement is removed, the top statement will yield more mathematically"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "' consistent results, but this version ends up yielding results closer to what Photoshop's"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: EndOfLineComment
                                                                                    text: "' Curves dialog does.  Go figure!"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Newline
                                                                                    text: "\r\n"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If results(x) <= (256 - x) Then\r\n            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: results(x) <= (256 - x)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: CallExpression
                                                                                            text: results(x)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: results
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: ArgumentList
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Argument
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: x
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: x
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LessThanOrEqualOperator
                                                                                            text: "<="
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ParenthesizedExpression
                                                                                            text: (256 - x)
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: LeftParenthesis
                                                                                                text: (
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: 256 - x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "256"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "256"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: SubtractionOperator
                                                                                                    text: "-"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: RightParenthesis
                                                                                                text: )
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "            tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n        "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "            "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "tmpGamma = tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: tmpGamma
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: tmpGamma
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: tmpGamma ^ (1 / ((256 - x) / (results(x) + 1)))
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tmpGamma
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tmpGamma
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ExponentiationOperator
                                                                                                    text: ^
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ParenthesizedExpression
                                                                                                    text: (1 / ((256 - x) / (results(x) + 1)))
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: BinaryExpression
                                                                                                        text: 1 / ((256 - x) / (results(x) + 1))
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: NumericLiteralExpression
                                                                                                            text: "1"
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IntegerLiteral
                                                                                                                text: "1"
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: DivisionOperator
                                                                                                            text: /
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: Whitespace
                                                                                                            text: " "
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: ParenthesizedExpression
                                                                                                            text: ((256 - x) / (results(x) + 1))
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: LeftParenthesis
                                                                                                                text: (
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: BinaryExpression
                                                                                                                text: (256 - x) / (results(x) + 1)
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (256 - x)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: 256 - x
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: NumericLiteralExpression
                                                                                                                            text: "256"
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IntegerLiteral
                                                                                                                                text: "256"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: SubtractionOperator
                                                                                                                            text: "-"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: IdentifierExpression
                                                                                                                            text: x
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: x
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: DivisionOperator
                                                                                                                    text: /
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: Whitespace
                                                                                                                    text: " "
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: ParenthesizedExpression
                                                                                                                    text: (results(x) + 1)
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: LeftParenthesis
                                                                                                                        text: (
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: BinaryExpression
                                                                                                                        text: results(x) + 1
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: CallExpression
                                                                                                                            text: results(x)
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: Identifier
                                                                                                                                text: results
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: LeftParenthesis
                                                                                                                                text: (
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: ArgumentList
                                                                                                                                text: x
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: Argument
                                                                                                                                    text: x
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: x
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: x
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                              - kind: RightParenthesis
                                                                                                                                text: )
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: AdditionOperator
                                                                                                                            text: +
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: Whitespace
                                                                                                                            text: " "
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: NumericLiteralExpression
                                                                                                                            text: "1"
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: IntegerLiteral
                                                                                                                                text: "1"
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                      - kind: RightParenthesis
                                                                                                                        text: )
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                              - kind: RightParenthesis
                                                                                                                text: )
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseClause
                                                                                        text: "Else\r\n            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseKeyword
                                                                                            text: Else
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "            tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n        "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "            "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tmpGamma = tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tmpGamma
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tmpGamma
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: BinaryExpression
                                                                                                    text: tmpGamma ^ ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IdentifierExpression
                                                                                                        text: tmpGamma
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Identifier
                                                                                                            text: tmpGamma
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ExponentiationOperator
                                                                                                        text: ^
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ParenthesizedExpression
                                                                                                        text: ((1 / ((256 - x) / (results(x) + 1))) ^ 1.5)
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: LeftParenthesis
                                                                                                            text: (
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                          - kind: BinaryExpression
                                                                                                            text: (1 / ((256 - x) / (results(x) + 1))) ^ 1.5
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: ParenthesizedExpression
                                                                                                                text: (1 / ((256 - x) / (results(x) + 1)))
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: LeftParenthesis
                                                                                                                    text: (
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                                  - kind: BinaryExpression
                                                                                                                    text: 1 / ((256 - x) / (results(x) + 1))
                                                                                                                    is_token: false
                                                                                                                    children:
                                                                                                                      - kind: NumericLiteralExpression
                                                                                                                        text: "1"
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: IntegerLiteral
                                                                                                                            text: "1"
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: DivisionOperator
                                                                                                                        text: /
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: Whitespace
                                                                                                                        text: " "
                                                                                                                        is_token: true
                                                                                                                        children: []
                                                                                                                      - kind: ParenthesizedExpression
                                                                                                                        text: ((256 - x) / (results(x) + 1))
                                                                                                                        is_token: false
                                                                                                                        children:
                                                                                                                          - kind: LeftParenthesis
                                                                                                                            text: (
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                          - kind: BinaryExpression
                                                                                                                            text: (256 - x) / (results(x) + 1)
                                                                                                                            is_token: false
                                                                                                                            children:
                                                                                                                              - kind: ParenthesizedExpression
                                                                                                                                text: (256 - x)
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: LeftParenthesis
                                                                                                                                    text: (
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: BinaryExpression
                                                                                                                                    text: 256 - x
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: NumericLiteralExpression
                                                                                                                                        text: "256"
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: IntegerLiteral
                                                                                                                                            text: "256"
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                      - kind: Whitespace
                                                                                                                                        text: " "
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: SubtractionOperator
                                                                                                                                        text: "-"
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: Whitespace
                                                                                                                                        text: " "
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: IdentifierExpression
                                                                                                                                        text: x
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: x
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: RightParenthesis
                                                                                                                                    text: )
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: DivisionOperator
                                                                                                                                text: /
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: Whitespace
                                                                                                                                text: " "
                                                                                                                                is_token: true
                                                                                                                                children: []
                                                                                                                              - kind: ParenthesizedExpression
                                                                                                                                text: (results(x) + 1)
                                                                                                                                is_token: false
                                                                                                                                children:
                                                                                                                                  - kind: LeftParenthesis
                                                                                                                                    text: (
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                                  - kind: BinaryExpression
                                                                                                                                    text: results(x) + 1
                                                                                                                                    is_token: false
                                                                                                                                    children:
                                                                                                                                      - kind: CallExpression
                                                                                                                                        text: results(x)
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: Identifier
                                                                                                                                            text: results
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                          - kind: LeftParenthesis
                                                                                                                                            text: (
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                          - kind: ArgumentList
                                                                                                                                            text: x
                                                                                                                                            is_token: false
                                                                                                                                            children:
                                                                                                                                              - kind: Argument
                                                                                                                                                text: x
                                                                                                                                                is_token: false
                                                                                                                                                children:
                                                                                                                                                  - kind: IdentifierExpression
                                                                                                                                                    text: x
                                                                                                                                                    is_token: false
                                                                                                                                                    children:
                                                                                                                                                      - kind: Identifier
                                                                                                                                                        text: x
                                                                                                                                                        is_token: true
                                                                                                                                                        children: []
                                                                                                                                          - kind: RightParenthesis
                                                                                                                                            text: )
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                      - kind: Whitespace
                                                                                                                                        text: " "
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: AdditionOperator
                                                                                                                                        text: +
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: Whitespace
                                                                                                                                        text: " "
                                                                                                                                        is_token: true
                                                                                                                                        children: []
                                                                                                                                      - kind: NumericLiteralExpression
                                                                                                                                        text: "1"
                                                                                                                                        is_token: false
                                                                                                                                        children:
                                                                                                                                          - kind: IntegerLiteral
                                                                                                                                            text: "1"
                                                                                                                                            is_token: true
                                                                                                                                            children: []
                                                                                                                                  - kind: RightParenthesis
                                                                                                                                    text: )
                                                                                                                                    is_token: true
                                                                                                                                    children: []
                                                                                                                          - kind: RightParenthesis
                                                                                                                            text: )
                                                                                                                            is_token: true
                                                                                                                            children: []
                                                                                                                  - kind: RightParenthesis
                                                                                                                    text: )
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: ExponentiationOperator
                                                                                                                text: ^
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "1.5"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: SingleLiteral
                                                                                                                    text: "1.5"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                          - kind: RightParenthesis
                                                                                                            text: )
                                                                                                            is_token: true
                                                                                                            children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "tmpGamma = tmpGamma * 255\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: tmpGamma
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: tmpGamma
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: tmpGamma * 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: tmpGamma
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: tmpGamma
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: MultiplicationOperator
                                                                                            text: "*"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: IfStatement
                                                                                    text: "If tmpGamma > 255 Then\r\n            tmpGamma = 255\r\n        ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        End If\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: tmpGamma > 255
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: tmpGamma
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: tmpGamma
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: GreaterThanOperator
                                                                                            text: ">"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "255"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "255"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ThenKeyword
                                                                                        text: Then
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "            tmpGamma = 255\r\n        "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "            "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "tmpGamma = 255\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: tmpGamma
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: tmpGamma
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "255"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "255"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: ElseIfClause
                                                                                        text: "ElseIf tmpGamma < 0 Then\r\n            tmpGamma = 0\r\n        "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: ElseIfKeyword
                                                                                            text: ElseIf
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: BinaryExpression
                                                                                            text: tmpGamma < 0
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: tmpGamma
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: tmpGamma
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: LessThanOperator
                                                                                                text: "<"
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "0"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "0"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ThenKeyword
                                                                                            text: Then
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: CodeBlock
                                                                                            text: "            tmpGamma = 0\r\n        "
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Whitespace
                                                                                                text: "            "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: AssignmentStatement
                                                                                                text: "tmpGamma = 0\r\n"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: tmpGamma
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: tmpGamma
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: NumericLiteralExpression
                                                                                                    text: "0"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: IntegerLiteral
                                                                                                        text: "0"
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Newline
                                                                                                    text: "\r\n"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: "        "
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: EndKeyword
                                                                                        text: End
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IfKeyword
                                                                                        text: If
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "newGamma(x) = tmpGamma\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: CallExpression
                                                                                        text: newGamma(x)
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: newGamma
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: LeftParenthesis
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: ArgumentList
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Argument
                                                                                                text: x
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: x
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: x
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                          - kind: RightParenthesis
                                                                                            text: )
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: tmpGamma
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: tmpGamma
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "    "
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: NextKeyword
                                                                                text: Next
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Now run a quick loop through the image, adjusting pixel values with the look-up tables"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: DimStatement
                                                                            text: "Dim QuickX As Long\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: DimKeyword
                                                                                text: Dim
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: QuickX
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: AsKeyword
                                                                                text: As
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LongKeyword
                                                                                text: Long
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: ForStatement
                                                                            text: "For x = 0 To iWidth - 1\r\n        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    Next x\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: ForKeyword
                                                                                text: For
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: IdentifierExpression
                                                                                text: x
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Identifier
                                                                                    text: x
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: EqualityOperator
                                                                                text: "="
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: NumericLiteralExpression
                                                                                text: "0"
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IntegerLiteral
                                                                                    text: "0"
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: ToKeyword
                                                                                text: To
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: BinaryExpression
                                                                                text: iWidth - 1
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: IdentifierExpression
                                                                                    text: iWidth
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: Identifier
                                                                                        text: iWidth
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: SubtractionOperator
                                                                                    text: "-"
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: Whitespace
                                                                                    text: " "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: NumericLiteralExpression
                                                                                    text: "1"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IntegerLiteral
                                                                                        text: "1"
                                                                                        is_token: true
                                                                                        children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: CodeBlock
                                                                                text: "        QuickX = x * 3\r\n    For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n    "
                                                                                is_token: false
                                                                                children:
                                                                                  - kind: Whitespace
                                                                                    text: "        "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: AssignmentStatement
                                                                                    text: "QuickX = x * 3\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: IdentifierExpression
                                                                                        text: QuickX
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: QuickX
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: x * 3
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: x
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: x
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: MultiplicationOperator
                                                                                            text: "*"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "3"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "3"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "    "
                                                                                    is_token: true
                                                                                    children: []
                                                                                  - kind: ForStatement
                                                                                    text: "For Y = 0 To iHeight - 1\r\n        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    Next Y\r\n"
                                                                                    is_token: false
                                                                                    children:
                                                                                      - kind: ForKeyword
                                                                                        text: For
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: IdentifierExpression
                                                                                        text: Y
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Identifier
                                                                                            text: Y
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: EqualityOperator
                                                                                        text: "="
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: NumericLiteralExpression
                                                                                        text: "0"
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IntegerLiteral
                                                                                            text: "0"
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: ToKeyword
                                                                                        text: To
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: BinaryExpression
                                                                                        text: iHeight - 1
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: IdentifierExpression
                                                                                            text: iHeight
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: Identifier
                                                                                                text: iHeight
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: SubtractionOperator
                                                                                            text: "-"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: NumericLiteralExpression
                                                                                            text: "1"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IntegerLiteral
                                                                                                text: "1"
                                                                                                is_token: true
                                                                                                children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: CodeBlock
                                                                                        text: "        'Grab red, green, and blue\r\n        R = ImageData(QuickX + 2, Y)\r\n        G = ImageData(QuickX + 1, Y)\r\n        B = ImageData(QuickX, Y)\r\n        'Correct them all\r\n        ImageData(QuickX + 2, Y) = newGamma(R)\r\n        ImageData(QuickX + 1, Y) = newGamma(G)\r\n        ImageData(QuickX, Y) = newGamma(B)\r\n    "
                                                                                        is_token: false
                                                                                        children:
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EndOfLineComment
                                                                                            text: "'Grab red, green, and blue"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "R = ImageData(QuickX + 2, Y)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: R
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: R
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: "ImageData(QuickX + 2, Y)"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: ImageData
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: "QuickX + 2, Y"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: QuickX + 2
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: BinaryExpression
                                                                                                            text: QuickX + 2
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: QuickX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: QuickX
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: AdditionOperator
                                                                                                                text: +
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "2"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IntegerLiteral
                                                                                                                    text: "2"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: Comma
                                                                                                        text: ","
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Argument
                                                                                                        text: Y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Y
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Y
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "G = ImageData(QuickX + 1, Y)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: G
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: G
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: "ImageData(QuickX + 1, Y)"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: ImageData
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: "QuickX + 1, Y"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: QuickX + 1
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: BinaryExpression
                                                                                                            text: QuickX + 1
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: QuickX
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: QuickX
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: AdditionOperator
                                                                                                                text: +
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: Whitespace
                                                                                                                text: " "
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                              - kind: NumericLiteralExpression
                                                                                                                text: "1"
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: IntegerLiteral
                                                                                                                    text: "1"
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: Comma
                                                                                                        text: ","
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Argument
                                                                                                        text: Y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Y
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Y
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "B = ImageData(QuickX, Y)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: B
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: B
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: "ImageData(QuickX, Y)"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: ImageData
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: "QuickX, Y"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: QuickX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: QuickX
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: QuickX
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: Comma
                                                                                                        text: ","
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Argument
                                                                                                        text: Y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Y
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Y
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: EndOfLineComment
                                                                                            text: "'Correct them all"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Newline
                                                                                            text: "\r\n"
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: ImageData
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: QuickX
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: +
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "2,"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "2"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "2"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: ","
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Y) = newGamma(R)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: ) = newGamma(R)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: )
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CallExpression
                                                                                                    text: newGamma(R)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: newGamma
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ArgumentList
                                                                                                        text: R
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Argument
                                                                                                            text: R
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: R
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: R
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: ImageData
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: (
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: QuickX
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Unknown
                                                                                            text: +
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "1,"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: NumericLiteralExpression
                                                                                                text: "1"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IntegerLiteral
                                                                                                    text: "1"
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: IdentifierExpression
                                                                                                text: ","
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Comma
                                                                                                    text: ","
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                          - kind: Whitespace
                                                                                            text: " "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "Y) = newGamma(G)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: IdentifierExpression
                                                                                                text: Y
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: Y
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: BinaryExpression
                                                                                                text: ) = newGamma(G)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: IdentifierExpression
                                                                                                    text: )
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: EqualityOperator
                                                                                                    text: "="
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: Whitespace
                                                                                                    text: " "
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: CallExpression
                                                                                                    text: newGamma(G)
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Identifier
                                                                                                        text: newGamma
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: LeftParenthesis
                                                                                                        text: (
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: ArgumentList
                                                                                                        text: G
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: Argument
                                                                                                            text: G
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: IdentifierExpression
                                                                                                                text: G
                                                                                                                is_token: false
                                                                                                                children:
                                                                                                                  - kind: Identifier
                                                                                                                    text: G
                                                                                                                    is_token: true
                                                                                                                    children: []
                                                                                                      - kind: RightParenthesis
                                                                                                        text: )
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "        "
                                                                                            is_token: true
                                                                                            children: []
                                                                                          - kind: AssignmentStatement
                                                                                            text: "ImageData(QuickX, Y) = newGamma(B)\r\n"
                                                                                            is_token: false
                                                                                            children:
                                                                                              - kind: CallExpression
                                                                                                text: "ImageData(QuickX, Y)"
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: ImageData
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: "QuickX, Y"
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: QuickX
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: QuickX
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: QuickX
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                      - kind: Comma
                                                                                                        text: ","
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Whitespace
                                                                                                        text: " "
                                                                                                        is_token: true
                                                                                                        children: []
                                                                                                      - kind: Argument
                                                                                                        text: Y
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: Y
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: Y
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: EqualityOperator
                                                                                                text: "="
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: Whitespace
                                                                                                text: " "
                                                                                                is_token: true
                                                                                                children: []
                                                                                              - kind: CallExpression
                                                                                                text: newGamma(B)
                                                                                                is_token: false
                                                                                                children:
                                                                                                  - kind: Identifier
                                                                                                    text: newGamma
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: LeftParenthesis
                                                                                                    text: (
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                                  - kind: ArgumentList
                                                                                                    text: B
                                                                                                    is_token: false
                                                                                                    children:
                                                                                                      - kind: Argument
                                                                                                        text: B
                                                                                                        is_token: false
                                                                                                        children:
                                                                                                          - kind: IdentifierExpression
                                                                                                            text: B
                                                                                                            is_token: false
                                                                                                            children:
                                                                                                              - kind: Identifier
                                                                                                                text: B
                                                                                                                is_token: true
                                                                                                                children: []
                                                                                                  - kind: RightParenthesis
                                                                                                    text: )
                                                                                                    is_token: true
                                                                                                    children: []
                                                                                              - kind: Newline
                                                                                                text: "\r\n"
                                                                                                is_token: true
                                                                                                children: []
                                                                                          - kind: Whitespace
                                                                                            text: "    "
                                                                                            is_token: true
                                                                                            children: []
                                                                                      - kind: NextKeyword
                                                                                        text: Next
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Whitespace
                                                                                        text: " "
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Identifier
                                                                                        text: Y
                                                                                        is_token: true
                                                                                        children: []
                                                                                      - kind: Newline
                                                                                        text: "\r\n"
                                                                                        is_token: true
                                                                                        children: []
                                                                                  - kind: Whitespace
                                                                                    text: "    "
                                                                                    is_token: true
                                                                                    children: []
                                                                              - kind: NextKeyword
                                                                                text: Next
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: x
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: EndOfLineComment
                                                                            text: "'Draw the new image data to the screen"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: "    "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: CallStatement
                                                                            text: "fDraw.SetImageData2D picMain, iWidth, iHeight, ImageData()\r\n"
                                                                            is_token: false
                                                                            children:
                                                                              - kind: Identifier
                                                                                text: fDraw
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: PeriodOperator
                                                                                text: "."
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: SetImageData2D
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: picMain
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: iWidth
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: iHeight
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Comma
                                                                                text: ","
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Whitespace
                                                                                text: " "
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Identifier
                                                                                text: ImageData
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: LeftParenthesis
                                                                                text: (
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: RightParenthesis
                                                                                text: )
                                                                                is_token: true
                                                                                children: []
                                                                              - kind: Newline
                                                                                text: "\r\n"
                                                                                is_token: true
                                                                                children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: End
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Whitespace
                                                                            text: " "
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Unknown
                                                                            text: Sub
                                                                            is_token: true
                                                                            children: []
                                                                          - kind: Newline
                                                                            text: "\r\n"
                                                                            is_token: true
                                                                            children: []
