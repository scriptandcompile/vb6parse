---
source: tests/module.rs
expression: declaration_module_file
---
name: Sub_Module
cst:
  root:
    kind: Root
    text: "'***************************************************************************\r\n'Copyright 2018 by Tanner Helland\r\n' www.tannerhelland.com\r\n'\r\n'Documentation for this project can be found at https://tannerhelland.com/code/\r\n'\r\n'The source code in this project is licensed under a Simplified BSD license.\r\n' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/\r\n'\r\n'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland\r\n'\r\n'***************************************************************************\r\n\r\n'This routine is run when the program starts up\r\nPublic Sub InitializeEditor()\r\n    'Default tiles are nasty brown school carpet on the left, water (?) on the right\r\n    CurPicIndex = 0\r\n    CurPicIndex2 = 1\r\n    \r\n    'Our default map size is 20 tiles by 20 tiles\r\n    SizeX = 20\r\n    SizeY = 20\r\n    ReDim MapArray(0 To SizeX, 0 To SizeY) As Byte\r\n    \r\n    'Set the default zoom to 100% (64, or the size of our tiles)\r\n    Zoom = 64\r\n    \r\n    'Set appropriate values for the main scroll bars\r\n    Main.HSTileBar.Max = Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth) / 64\r\n    Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    \r\n    'Initialize the map array\r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n    Next x\r\n    \r\n    'Show the form and draw everything to it\r\n    Main.Show\r\n    RefreshAll\r\n    \r\nEnd Sub\r\n\r\n'Render the current map data to the main picture box\r\nPublic Sub DrawMap()\r\n    \r\n    'Clear out the current map\r\n    Main.MainPic.Picture = LoadPicture(vbNullString)\r\n    \r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n    Next x\r\n    \r\n    'Because AutoRedraw is set to true for our main map, update the .Picture property and force a refresh\r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\nEnd Sub\r\n\r\n'When scrollbars are used, set the new viewport and redraw the map\r\nPublic Sub ScrollMap()\r\n    ViewX = Main.HSMain.Value\r\n    ViewY = Main.VSMain.Value\r\n    DrawMap\r\nEnd Sub\r\n\r\n'This routine copies the correct tileset from the invisible buffer to the visible bar\r\nPublic Sub DrawTileBar()\r\n    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    Else\r\n        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n\r\nEnd Sub\r\n\r\n'Draw a tile of type \"ArrayIndex\" at location (x, y)\r\nPublic Sub DrawTile(ByVal x As Integer, ByVal Y As Integer, ByVal ArrayIndex As Byte)\r\n    \r\n    'Calculate the actual x and y values (accounting for zoom and scrolling)\r\n    CurX = (x \\ Zoom) + (ViewX \\ Zoom)\r\n    CurY = (Y \\ Zoom) + (ViewY \\ Zoom)\r\n    \r\n    'If the user moved the mouse outside of the map dimensions, cancel this routine\r\n    If CurX > SizeX Or CurY > SizeY Or CurX < 0 Or CurY < 0 Then Exit Sub\r\n    \r\n    'Store this tile value in MapArray\r\n    MapArray(CurX, CurY) = ArrayIndex\r\n    \r\n    'Draw the new tile\r\n    If UseStretchBlt Then\r\n        StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\nEnd Sub\r\n\r\n'If the zoom is changed, update all scrollbars and draw the new, properly zoomed map\r\nPublic Sub ChangeZoom()\r\n\r\n    'Get a new zoom value from the user\r\n    Zoom = InputBox(\"Enter the percent zoom (100 is default)\")\r\n    Zoom = Int((Zoom / 100) * 64)\r\n    \r\n    'Change the scroll bars depending on the new zoom value\r\n    If (SizeX * Zoom) < Main.MainPic.ScaleWidth Then\r\n        Main.HSMain.Value = 0\r\n        Main.HSMain.Enabled = False\r\n    Else\r\n        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    End If\r\n    \r\n    If (SizeY * Zoom) < Main.MainPic.ScaleHeight Then\r\n        Main.VSMain.Value = 0\r\n        Main.VSMain.Enabled = False\r\n    Else\r\n        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    End If\r\n    \r\n    'Draw the new map image\r\n    DrawMap\r\n    \r\nEnd Sub\r\n\r\n'As you may have guessed, this routine refreshes everything on the screen\r\nPublic Sub RefreshAll()\r\n    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    DrawTileBar\r\n    DrawMap\r\n    \r\nEnd Sub\r\n"
    is_token: false
    children:
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Copyright 2018 by Tanner Helland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' www.tannerhelland.com"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Documentation for this project can be found at https://tannerhelland.com/code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'The source code in this project is licensed under a Simplified BSD license."
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "' For more information, please review LICENSE.md at https://github.com/tannerhelland/thdc-code/"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If you find this code useful, please consider a small donation to https://www.paypal.me/TannerHelland"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'***************************************************************************"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This routine is run when the program starts up"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub InitializeEditor()\r\n    'Default tiles are nasty brown school carpet on the left, water (?) on the right\r\n    CurPicIndex = 0\r\n    CurPicIndex2 = 1\r\n    \r\n    'Our default map size is 20 tiles by 20 tiles\r\n    SizeX = 20\r\n    SizeY = 20\r\n    ReDim MapArray(0 To SizeX, 0 To SizeY) As Byte\r\n    \r\n    'Set the default zoom to 100% (64, or the size of our tiles)\r\n    Zoom = 64\r\n    \r\n    'Set appropriate values for the main scroll bars\r\n    Main.HSTileBar.Max = Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth) / 64\r\n    Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    \r\n    'Initialize the map array\r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n    Next x\r\n    \r\n    'Show the form and draw everything to it\r\n    Main.Show\r\n    RefreshAll\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: InitializeEditor
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    'Default tiles are nasty brown school carpet on the left, water (?) on the right\r\n    CurPicIndex = 0\r\n    CurPicIndex2 = 1\r\n    \r\n    'Our default map size is 20 tiles by 20 tiles\r\n    SizeX = 20\r\n    SizeY = 20\r\n    ReDim MapArray(0 To SizeX, 0 To SizeY) As Byte\r\n    \r\n    'Set the default zoom to 100% (64, or the size of our tiles)\r\n    Zoom = 64\r\n    \r\n    'Set appropriate values for the main scroll bars\r\n    Main.HSTileBar.Max = Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth) / 64\r\n    Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    \r\n    'Initialize the map array\r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n    Next x\r\n    \r\n    'Show the form and draw everything to it\r\n    Main.Show\r\n    RefreshAll\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Default tiles are nasty brown school carpet on the left, water (?) on the right"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "CurPicIndex = 0\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: CurPicIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: CurPicIndex
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "CurPicIndex2 = 1\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: CurPicIndex2
                    is_token: false
                    children:
                      - kind: Identifier
                        text: CurPicIndex2
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "1"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "1"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Our default map size is 20 tiles by 20 tiles"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "SizeX = 20\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: SizeX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: SizeX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "20"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "20"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "SizeY = 20\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: SizeY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: SizeY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "20"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "20"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: ReDimStatement
                text: "    ReDim MapArray(0 To SizeX, 0 To SizeY) As Byte\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ReDimKeyword
                    text: ReDim
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: MapArray
                    is_token: true
                    children: []
                  - kind: LeftParenthesis
                    text: (
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: SizeX
                    is_token: true
                    children: []
                  - kind: Comma
                    text: ","
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IntegerLiteral
                    text: "0"
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: SizeY
                    is_token: true
                    children: []
                  - kind: RightParenthesis
                    text: )
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: AsKeyword
                    text: As
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ByteKeyword
                    text: Byte
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set the default zoom to 100% (64, or the size of our tiles)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Zoom = 64\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Zoom
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Zoom
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "64"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "64"
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Set appropriate values for the main scroll bars"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.HSTileBar.Max = Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth) / 64\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.HSTileBar.Max
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.HSTileBar
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: HSTileBar
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Max
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth) / 64
                    is_token: false
                    children:
                      - kind: CallExpression
                        text: Abs(Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth)
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Abs
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: ArgumentList
                            text: Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth
                            is_token: false
                            children:
                              - kind: Argument
                                text: Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth
                                is_token: false
                                children:
                                  - kind: BinaryExpression
                                    text: Main.PicTiles.ScaleWidth - Main.PicTilesBuffer.ScaleWidth
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: Main.PicTiles.ScaleWidth
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: Main.PicTiles
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Main
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: PicTiles
                                                is_token: true
                                                children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ScaleWidth
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: SubtractionOperator
                                        text: "-"
                                        is_token: true
                                        children: []
                                      - kind: Whitespace
                                        text: " "
                                        is_token: true
                                        children: []
                                      - kind: MemberAccessExpression
                                        text: Main.PicTilesBuffer.ScaleWidth
                                        is_token: false
                                        children:
                                          - kind: MemberAccessExpression
                                            text: Main.PicTilesBuffer
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Main
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: PicTilesBuffer
                                                is_token: true
                                                children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ScaleWidth
                                            is_token: true
                                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: DivisionOperator
                        text: /
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: NumericLiteralExpression
                        text: "64"
                        is_token: false
                        children:
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.HSMain.Max
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.HSMain
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: HSMain
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Max
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (SizeX * Zoom) - Main.MainPic.ScaleWidth
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: (SizeX * Zoom)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: SizeX * Zoom
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: SizeX
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: SizeX
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: MemberAccessExpression
                        text: Main.MainPic.ScaleWidth
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.MainPic
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: MainPic
                                is_token: true
                                children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleWidth
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.VSMain.Max
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.VSMain
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: VSMain
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Max
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (SizeY * Zoom) - Main.MainPic.ScaleHeight
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: (SizeY * Zoom)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: SizeY * Zoom
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: SizeY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: SizeY
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubtractionOperator
                        text: "-"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: MemberAccessExpression
                        text: Main.MainPic.ScaleHeight
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.MainPic
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: MainPic
                                is_token: true
                                children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleHeight
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Initialize the map array"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: ForStatement
                text: "    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: SizeX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: SizeX
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n    "
                    is_token: false
                    children:
                      - kind: ForStatement
                        text: "    For Y = 0 To SizeY\r\n        MapArray(x, Y) = 0\r\n    Next Y\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: Y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: SizeY
                            is_token: false
                            children:
                              - kind: Identifier
                                text: SizeY
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: StatementList
                            text: "        MapArray(x, Y) = 0\r\n    "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: AssignmentStatement
                                text: "MapArray(x, Y) = 0\r\n"
                                is_token: false
                                children:
                                  - kind: CallExpression
                                    text: "MapArray(x, Y)"
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: MapArray
                                        is_token: true
                                        children: []
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: ArgumentList
                                        text: "x, Y"
                                        is_token: false
                                        children:
                                          - kind: Argument
                                            text: x
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: x
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: x
                                                    is_token: true
                                                    children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Argument
                                            text: Y
                                            is_token: false
                                            children:
                                              - kind: IdentifierExpression
                                                text: Y
                                                is_token: false
                                                children:
                                                  - kind: Identifier
                                                    text: Y
                                                    is_token: true
                                                    children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: EqualityOperator
                                    text: "="
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "0"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "0"
                                        is_token: true
                                        children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Y
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Show the form and draw everything to it"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Main.Show\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: Main
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Show
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "RefreshAll\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: RefreshAll
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Render the current map data to the main picture box"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub DrawMap()\r\n    \r\n    'Clear out the current map\r\n    Main.MainPic.Picture = LoadPicture(vbNullString)\r\n    \r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n    Next x\r\n    \r\n    'Because AutoRedraw is set to true for our main map, update the .Picture property and force a refresh\r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawMap
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    \r\n    'Clear out the current map\r\n    Main.MainPic.Picture = LoadPicture(vbNullString)\r\n    \r\n    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n    Next x\r\n    \r\n    'Because AutoRedraw is set to true for our main map, update the .Picture property and force a refresh\r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Clear out the current map"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.MainPic.Picture = LoadPicture(vbNullString)\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Picture
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Picture
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: LoadPicture(vbNullString)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: LoadPicture
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: vbNullString
                        is_token: false
                        children:
                          - kind: Argument
                            text: vbNullString
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: vbNullString
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: vbNullString
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: ForStatement
                text: "    For x = 0 To SizeX\r\n    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n    Next x\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: ForKeyword
                    text: For
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: x
                    is_token: false
                    children:
                      - kind: Identifier
                        text: x
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: NumericLiteralExpression
                    text: "0"
                    is_token: false
                    children:
                      - kind: IntegerLiteral
                        text: "0"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ToKeyword
                    text: To
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: SizeX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: SizeX
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n    "
                    is_token: false
                    children:
                      - kind: ForStatement
                        text: "    For Y = 0 To SizeY\r\n        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    Next Y\r\n"
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                          - kind: ForKeyword
                            text: For
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: Y
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Y
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: ToKeyword
                            text: To
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IdentifierExpression
                            text: SizeY
                            is_token: false
                            children:
                              - kind: Identifier
                                text: SizeY
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                          - kind: StatementList
                            text: "        'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop.\r\n        'However, in an editor environment this is somewhat unimportant.\r\n        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n    "
                            is_token: false
                            children:
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'For speed purposes, it would be better to remove this \"If/Then\" statement to be outside the loop."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: "        "
                                is_token: true
                                children: []
                              - kind: EndOfLineComment
                                text: "'However, in an editor environment this is somewhat unimportant."
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                              - kind: IfStatement
                                text: "        If UseStretchBlt Then\r\n            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        End If\r\n"
                                is_token: false
                                children:
                                  - kind: Whitespace
                                    text: "        "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: UseStretchBlt
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: UseStretchBlt
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: ThenKeyword
                                    text: Then
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                                  - kind: StatementList
                                    text: "            StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        "
                                    is_token: false
                                    children:
                                      - kind: Whitespace
                                        text: "            "
                                        is_token: true
                                        children: []
                                      - kind: CallStatement
                                        text: "StretchBlt Main.MainPic.hdc, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n"
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: StretchBlt
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Main
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: MainPic
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: hdc
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Zoom
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ViewX
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Y
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Zoom
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: SubtractionOperator
                                            text: "-"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: ViewY
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Zoom
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Zoom
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Main
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: PicTilesBuffer
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: hdc
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: MapArray
                                            is_token: true
                                            children: []
                                          - kind: LeftParenthesis
                                            text: (
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: x
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: Y
                                            is_token: true
                                            children: []
                                          - kind: RightParenthesis
                                            text: )
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "64"
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "0"
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "64"
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IntegerLiteral
                                            text: "64"
                                            is_token: true
                                            children: []
                                          - kind: Comma
                                            text: ","
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: vbSrcCopy
                                            is_token: true
                                            children: []
                                          - kind: Newline
                                            text: "\r\n"
                                            is_token: true
                                            children: []
                                      - kind: Whitespace
                                        text: "        "
                                        is_token: true
                                        children: []
                                  - kind: ElseClause
                                    text: "Else\r\n            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        "
                                    is_token: false
                                    children:
                                      - kind: ElseKeyword
                                        text: Else
                                        is_token: true
                                        children: []
                                      - kind: Newline
                                        text: "\r\n"
                                        is_token: true
                                        children: []
                                      - kind: StatementList
                                        text: "            Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n        "
                                        is_token: false
                                        children:
                                          - kind: Whitespace
                                            text: "            "
                                            is_token: true
                                            children: []
                                          - kind: CallStatement
                                            text: "Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (x * Zoom) - ViewX, (Y * Zoom) - ViewY, Zoom, Zoom, MapArray(x, Y) * 64, 0, 64, 64, vbSrcCopy\r\n"
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Main
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: MainPic
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: PaintPicture
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Main
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: PicTilesBuffer
                                                is_token: true
                                                children: []
                                              - kind: PeriodOperator
                                                text: "."
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Picture
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: ViewX
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Y
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: SubtractionOperator
                                                text: "-"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: ViewY
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: MapArray
                                                is_token: true
                                                children: []
                                              - kind: LeftParenthesis
                                                text: (
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: x
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: Y
                                                is_token: true
                                                children: []
                                              - kind: RightParenthesis
                                                text: )
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: MultiplicationOperator
                                                text: "*"
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IntegerLiteral
                                                text: "64"
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IntegerLiteral
                                                text: "0"
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IntegerLiteral
                                                text: "64"
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: IntegerLiteral
                                                text: "64"
                                                is_token: true
                                                children: []
                                              - kind: Comma
                                                text: ","
                                                is_token: true
                                                children: []
                                              - kind: Whitespace
                                                text: " "
                                                is_token: true
                                                children: []
                                              - kind: Identifier
                                                text: vbSrcCopy
                                                is_token: true
                                                children: []
                                              - kind: Newline
                                                text: "\r\n"
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: "        "
                                            is_token: true
                                            children: []
                                  - kind: EndKeyword
                                    text: End
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IfKeyword
                                    text: If
                                    is_token: true
                                    children: []
                                  - kind: Newline
                                    text: "\r\n"
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: "    "
                                is_token: true
                                children: []
                          - kind: NextKeyword
                            text: Next
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Y
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: NextKeyword
                    text: Next
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: x
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Because AutoRedraw is set to true for our main map, update the .Picture property and force a refresh"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.MainPic.Picture = Main.MainPic.Image\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Picture
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Picture
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Image
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Image
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Main.MainPic.Refresh\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: Main
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: MainPic
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Refresh
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'When scrollbars are used, set the new viewport and redraw the map"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub ScrollMap()\r\n    ViewX = Main.HSMain.Value\r\n    ViewY = Main.VSMain.Value\r\n    DrawMap\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: ScrollMap
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    ViewX = Main.HSMain.Value\r\n    ViewY = Main.VSMain.Value\r\n    DrawMap\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ViewX = Main.HSMain.Value\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ViewX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ViewX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: Main.HSMain.Value
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.HSMain
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: HSMain
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Value
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "ViewY = Main.VSMain.Value\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: ViewY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ViewY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: Main.VSMain.Value
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.VSMain
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: VSMain
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Value
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawMap\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawMap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'This routine copies the correct tileset from the invisible buffer to the visible bar"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub DrawTileBar()\r\n    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    Else\r\n        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n\r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawTileBar
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    Else\r\n        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n\r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If UseStretchBlt Then\r\n        StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    Else\r\n        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: UseStretchBlt
                    is_token: false
                    children:
                      - kind: Identifier
                        text: UseStretchBlt
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "StretchBlt Main.PicTiles.hdc, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.PicTilesBuffer.hdc, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: StretchBlt
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTiles
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTiles
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleWidth
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTilesBuffer
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: HSTileBar
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Value
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTiles
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleWidth
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbSrcCopy
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "Main.PicTiles.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, Main.PicTiles.ScaleWidth, 64, Main.HSTileBar.Value * 64, 0, Main.PicTiles.ScaleWidth, 64, vbSrcCopy\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTiles
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PaintPicture
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTilesBuffer
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTiles
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ScaleWidth
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: HSTileBar
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Value
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTiles
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ScaleWidth
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbSrcCopy
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.MainPic.Picture = Main.MainPic.Image\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Picture
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Picture
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Image
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Image
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Main.MainPic.Refresh\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: Main
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: MainPic
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Refresh
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'Draw a tile of type \"ArrayIndex\" at location (x, y)"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub DrawTile(ByVal x As Integer, ByVal Y As Integer, ByVal ArrayIndex As Byte)\r\n    \r\n    'Calculate the actual x and y values (accounting for zoom and scrolling)\r\n    CurX = (x \\ Zoom) + (ViewX \\ Zoom)\r\n    CurY = (Y \\ Zoom) + (ViewY \\ Zoom)\r\n    \r\n    'If the user moved the mouse outside of the map dimensions, cancel this routine\r\n    If CurX > SizeX Or CurY > SizeY Or CurX < 0 Or CurY < 0 Then Exit Sub\r\n    \r\n    'Store this tile value in MapArray\r\n    MapArray(CurX, CurY) = ArrayIndex\r\n    \r\n    'Draw the new tile\r\n    If UseStretchBlt Then\r\n        StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: DrawTile
            is_token: true
            children: []
          - kind: ParameterList
            text: "(ByVal x As Integer, ByVal Y As Integer, ByVal ArrayIndex As Byte)"
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: x
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: IntegerKeyword
                text: Integer
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: Y
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: IntegerKeyword
                text: Integer
                is_token: true
                children: []
              - kind: Comma
                text: ","
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByValKeyword
                text: ByVal
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: Identifier
                text: ArrayIndex
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: AsKeyword
                text: As
                is_token: true
                children: []
              - kind: Whitespace
                text: " "
                is_token: true
                children: []
              - kind: ByteKeyword
                text: Byte
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    \r\n    'Calculate the actual x and y values (accounting for zoom and scrolling)\r\n    CurX = (x \\ Zoom) + (ViewX \\ Zoom)\r\n    CurY = (Y \\ Zoom) + (ViewY \\ Zoom)\r\n    \r\n    'If the user moved the mouse outside of the map dimensions, cancel this routine\r\n    If CurX > SizeX Or CurY > SizeY Or CurX < 0 Or CurY < 0 Then Exit Sub\r\n    \r\n    'Store this tile value in MapArray\r\n    MapArray(CurX, CurY) = ArrayIndex\r\n    \r\n    'Draw the new tile\r\n    If UseStretchBlt Then\r\n        StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    \r\n    Main.MainPic.Picture = Main.MainPic.Image\r\n    Main.MainPic.Refresh\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Calculate the actual x and y values (accounting for zoom and scrolling)"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "CurX = (x \\ Zoom) + (ViewX \\ Zoom)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: CurX
                    is_token: false
                    children:
                      - kind: Identifier
                        text: CurX
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "(x \\ Zoom) + (ViewX \\ Zoom)"
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: "(x \\ Zoom)"
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "x \\ Zoom"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: x
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: x
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BackwardSlashOperator
                                text: "\\"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ParenthesizedExpression
                        text: "(ViewX \\ Zoom)"
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "ViewX \\ Zoom"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: ViewX
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: ViewX
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BackwardSlashOperator
                                text: "\\"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "CurY = (Y \\ Zoom) + (ViewY \\ Zoom)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: CurY
                    is_token: false
                    children:
                      - kind: Identifier
                        text: CurY
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: "(Y \\ Zoom) + (ViewY \\ Zoom)"
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: "(Y \\ Zoom)"
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "Y \\ Zoom"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: Y
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Y
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BackwardSlashOperator
                                text: "\\"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: AdditionOperator
                        text: +
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: ParenthesizedExpression
                        text: "(ViewY \\ Zoom)"
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: "ViewY \\ Zoom"
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: ViewY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: ViewY
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BackwardSlashOperator
                                text: "\\"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'If the user moved the mouse outside of the map dimensions, cancel this routine"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If CurX > SizeX Or CurY > SizeY Or CurX < 0 Or CurY < 0 Then Exit Sub\r\n    \r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: CurX > SizeX Or CurY > SizeY Or CurX < 0 Or CurY < 0
                    is_token: false
                    children:
                      - kind: BinaryExpression
                        text: CurX > SizeX Or CurY > SizeY Or CurX < 0
                        is_token: false
                        children:
                          - kind: BinaryExpression
                            text: CurX > SizeX Or CurY > SizeY
                            is_token: false
                            children:
                              - kind: BinaryExpression
                                text: CurX > SizeX
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: CurX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: CurX
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: GreaterThanOperator
                                    text: ">"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: SizeX
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: SizeX
                                        is_token: true
                                        children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: OrKeyword
                                text: Or
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: CurY > SizeY
                                is_token: false
                                children:
                                  - kind: IdentifierExpression
                                    text: CurY
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: CurY
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: GreaterThanOperator
                                    text: ">"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: IdentifierExpression
                                    text: SizeY
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: SizeY
                                        is_token: true
                                        children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: OrKeyword
                            text: Or
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: CurX < 0
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: CurX
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: CurX
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: LessThanOperator
                                text: "<"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: NumericLiteralExpression
                                text: "0"
                                is_token: false
                                children:
                                  - kind: IntegerLiteral
                                    text: "0"
                                    is_token: true
                                    children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: OrKeyword
                        text: Or
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: BinaryExpression
                        text: CurY < 0
                        is_token: false
                        children:
                          - kind: IdentifierExpression
                            text: CurY
                            is_token: false
                            children:
                              - kind: Identifier
                                text: CurY
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LessThanOperator
                            text: "<"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ExitStatement
                    text: "Exit Sub\r\n"
                    is_token: false
                    children:
                      - kind: ExitKeyword
                        text: Exit
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: SubKeyword
                        text: Sub
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Store this tile value in MapArray"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "MapArray(CurX, CurY) = ArrayIndex\r\n"
                is_token: false
                children:
                  - kind: CallExpression
                    text: "MapArray(CurX, CurY)"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: MapArray
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "CurX, CurY"
                        is_token: false
                        children:
                          - kind: Argument
                            text: CurX
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: CurX
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: CurX
                                    is_token: true
                                    children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Argument
                            text: CurY
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: CurY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: CurY
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: ArrayIndex
                    is_token: false
                    children:
                      - kind: Identifier
                        text: ArrayIndex
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Draw the new tile"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If UseStretchBlt Then\r\n        StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: UseStretchBlt
                    is_token: false
                    children:
                      - kind: Identifier
                        text: UseStretchBlt
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "StretchBlt Main.MainPic.hdc, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, Main.PicTilesBuffer.hdc, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: StretchBlt
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: CurX
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Zoom
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ViewX
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: CurY
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Zoom
                            is_token: true
                            children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: SubtractionOperator
                            text: "-"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ViewY
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Zoom
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Zoom
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTilesBuffer
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ArrayIndex
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbSrcCopy
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "Main.MainPic.PaintPicture Main.PicTilesBuffer.Picture, (CurX * Zoom) - ViewX, (CurY * Zoom) - ViewY, Zoom, Zoom, ArrayIndex * 64, 0, 64, 64, vbSrcCopy\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: MainPic
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PaintPicture
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTilesBuffer
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: CurX
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Zoom
                                is_token: true
                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ViewX
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: LeftParenthesis
                                text: (
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: CurY
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Zoom
                                is_token: true
                                children: []
                              - kind: RightParenthesis
                                text: )
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: SubtractionOperator
                                text: "-"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ViewY
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Zoom
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Zoom
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: ArrayIndex
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbSrcCopy
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Main.MainPic.Picture = Main.MainPic.Image\r\n"
                is_token: false
                children:
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Picture
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Picture
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: MemberAccessExpression
                    text: Main.MainPic.Image
                    is_token: false
                    children:
                      - kind: MemberAccessExpression
                        text: Main.MainPic
                        is_token: false
                        children:
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: MainPic
                            is_token: true
                            children: []
                      - kind: PeriodOperator
                        text: "."
                        is_token: true
                        children: []
                      - kind: Identifier
                        text: Image
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "Main.MainPic.Refresh\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: Main
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: MainPic
                    is_token: true
                    children: []
                  - kind: PeriodOperator
                    text: "."
                    is_token: true
                    children: []
                  - kind: Identifier
                    text: Refresh
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'If the zoom is changed, update all scrollbars and draw the new, properly zoomed map"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub ChangeZoom()\r\n\r\n    'Get a new zoom value from the user\r\n    Zoom = InputBox(\"Enter the percent zoom (100 is default)\")\r\n    Zoom = Int((Zoom / 100) * 64)\r\n    \r\n    'Change the scroll bars depending on the new zoom value\r\n    If (SizeX * Zoom) < Main.MainPic.ScaleWidth Then\r\n        Main.HSMain.Value = 0\r\n        Main.HSMain.Enabled = False\r\n    Else\r\n        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    End If\r\n    \r\n    If (SizeY * Zoom) < Main.MainPic.ScaleHeight Then\r\n        Main.VSMain.Value = 0\r\n        Main.VSMain.Enabled = False\r\n    Else\r\n        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    End If\r\n    \r\n    'Draw the new map image\r\n    DrawMap\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: ChangeZoom
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "\r\n    'Get a new zoom value from the user\r\n    Zoom = InputBox(\"Enter the percent zoom (100 is default)\")\r\n    Zoom = Int((Zoom / 100) * 64)\r\n    \r\n    'Change the scroll bars depending on the new zoom value\r\n    If (SizeX * Zoom) < Main.MainPic.ScaleWidth Then\r\n        Main.HSMain.Value = 0\r\n        Main.HSMain.Enabled = False\r\n    Else\r\n        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    End If\r\n    \r\n    If (SizeY * Zoom) < Main.MainPic.ScaleHeight Then\r\n        Main.VSMain.Value = 0\r\n        Main.VSMain.Enabled = False\r\n    Else\r\n        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    End If\r\n    \r\n    'Draw the new map image\r\n    DrawMap\r\n    \r\n"
            is_token: false
            children:
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Get a new zoom value from the user"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Zoom = InputBox(\"Enter the percent zoom (100 is default)\")\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Zoom
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Zoom
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: "InputBox(\"Enter the percent zoom (100 is default)\")"
                    is_token: false
                    children:
                      - kind: Identifier
                        text: InputBox
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: "\"Enter the percent zoom (100 is default)\""
                        is_token: false
                        children:
                          - kind: Argument
                            text: "\"Enter the percent zoom (100 is default)\""
                            is_token: false
                            children:
                              - kind: StringLiteralExpression
                                text: "\"Enter the percent zoom (100 is default)\""
                                is_token: false
                                children:
                                  - kind: StringLiteral
                                    text: "\"Enter the percent zoom (100 is default)\""
                                    is_token: true
                                    children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: AssignmentStatement
                text: "Zoom = Int((Zoom / 100) * 64)\r\n"
                is_token: false
                children:
                  - kind: IdentifierExpression
                    text: Zoom
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Zoom
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: EqualityOperator
                    text: "="
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: CallExpression
                    text: Int((Zoom / 100) * 64)
                    is_token: false
                    children:
                      - kind: Identifier
                        text: Int
                        is_token: true
                        children: []
                      - kind: LeftParenthesis
                        text: (
                        is_token: true
                        children: []
                      - kind: ArgumentList
                        text: (Zoom / 100) * 64
                        is_token: false
                        children:
                          - kind: Argument
                            text: (Zoom / 100) * 64
                            is_token: false
                            children:
                              - kind: BinaryExpression
                                text: (Zoom / 100) * 64
                                is_token: false
                                children:
                                  - kind: ParenthesizedExpression
                                    text: (Zoom / 100)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: Zoom / 100
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: Zoom
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: DivisionOperator
                                            text: /
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: NumericLiteralExpression
                                            text: "100"
                                            is_token: false
                                            children:
                                              - kind: IntegerLiteral
                                                text: "100"
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MultiplicationOperator
                                    text: "*"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: NumericLiteralExpression
                                    text: "64"
                                    is_token: false
                                    children:
                                      - kind: IntegerLiteral
                                        text: "64"
                                        is_token: true
                                        children: []
                      - kind: RightParenthesis
                        text: )
                        is_token: true
                        children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Change the scroll bars depending on the new zoom value"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (SizeX * Zoom) < Main.MainPic.ScaleWidth Then\r\n        Main.HSMain.Value = 0\r\n        Main.HSMain.Enabled = False\r\n    Else\r\n        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (SizeX * Zoom) < Main.MainPic.ScaleWidth
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: (SizeX * Zoom)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: SizeX * Zoom
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: SizeX
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: SizeX
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LessThanOperator
                        text: "<"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: MemberAccessExpression
                        text: Main.MainPic.ScaleWidth
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.MainPic
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: MainPic
                                is_token: true
                                children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleWidth
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        Main.HSMain.Value = 0\r\n        Main.HSMain.Enabled = False\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Main.HSMain.Value = 0\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.HSMain.Value
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.HSMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Main
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: HSMain
                                    is_token: true
                                    children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Value
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Main.HSMain.Enabled = False\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.HSMain.Enabled
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.HSMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Main
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: HSMain
                                    is_token: true
                                    children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Enabled
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BooleanLiteralExpression
                            text: "False"
                            is_token: false
                            children:
                              - kind: FalseKeyword
                                text: "False"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        Main.HSMain.Enabled = True\r\n        Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "Main.HSMain.Enabled = True\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.HSMain.Enabled
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: Main.HSMain
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Main
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: HSMain
                                        is_token: true
                                        children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Enabled
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BooleanLiteralExpression
                                text: "True"
                                is_token: false
                                children:
                                  - kind: TrueKeyword
                                    text: "True"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "Main.HSMain.Max = (SizeX * Zoom) - Main.MainPic.ScaleWidth\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.HSMain.Max
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: Main.HSMain
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Main
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: HSMain
                                        is_token: true
                                        children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Max
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: (SizeX * Zoom) - Main.MainPic.ScaleWidth
                                is_token: false
                                children:
                                  - kind: ParenthesizedExpression
                                    text: (SizeX * Zoom)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: SizeX * Zoom
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: SizeX
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: SizeX
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: Zoom
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SubtractionOperator
                                    text: "-"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MemberAccessExpression
                                    text: Main.MainPic.ScaleWidth
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: Main.MainPic
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: Main
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: MainPic
                                            is_token: true
                                            children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleWidth
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If (SizeY * Zoom) < Main.MainPic.ScaleHeight Then\r\n        Main.VSMain.Value = 0\r\n        Main.VSMain.Enabled = False\r\n    Else\r\n        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: BinaryExpression
                    text: (SizeY * Zoom) < Main.MainPic.ScaleHeight
                    is_token: false
                    children:
                      - kind: ParenthesizedExpression
                        text: (SizeY * Zoom)
                        is_token: false
                        children:
                          - kind: LeftParenthesis
                            text: (
                            is_token: true
                            children: []
                          - kind: BinaryExpression
                            text: SizeY * Zoom
                            is_token: false
                            children:
                              - kind: IdentifierExpression
                                text: SizeY
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: SizeY
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IdentifierExpression
                                text: Zoom
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Zoom
                                    is_token: true
                                    children: []
                          - kind: RightParenthesis
                            text: )
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: LessThanOperator
                        text: "<"
                        is_token: true
                        children: []
                      - kind: Whitespace
                        text: " "
                        is_token: true
                        children: []
                      - kind: MemberAccessExpression
                        text: Main.MainPic.ScaleHeight
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.MainPic
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: MainPic
                                is_token: true
                                children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: ScaleHeight
                            is_token: true
                            children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        Main.VSMain.Value = 0\r\n        Main.VSMain.Enabled = False\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Main.VSMain.Value = 0\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.VSMain.Value
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.VSMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Main
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: VSMain
                                    is_token: true
                                    children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Value
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: NumericLiteralExpression
                            text: "0"
                            is_token: false
                            children:
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: AssignmentStatement
                        text: "Main.VSMain.Enabled = False\r\n"
                        is_token: false
                        children:
                          - kind: MemberAccessExpression
                            text: Main.VSMain.Enabled
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.VSMain
                                is_token: false
                                children:
                                  - kind: Identifier
                                    text: Main
                                    is_token: true
                                    children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: VSMain
                                    is_token: true
                                    children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Enabled
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: EqualityOperator
                            text: "="
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: BooleanLiteralExpression
                            text: "False"
                            is_token: false
                            children:
                              - kind: FalseKeyword
                                text: "False"
                                is_token: true
                                children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        Main.VSMain.Enabled = True\r\n        Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "Main.VSMain.Enabled = True\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.VSMain.Enabled
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: Main.VSMain
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Main
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: VSMain
                                        is_token: true
                                        children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Enabled
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BooleanLiteralExpression
                                text: "True"
                                is_token: false
                                children:
                                  - kind: TrueKeyword
                                    text: "True"
                                    is_token: true
                                    children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: AssignmentStatement
                            text: "Main.VSMain.Max = (SizeY * Zoom) - Main.MainPic.ScaleHeight\r\n"
                            is_token: false
                            children:
                              - kind: MemberAccessExpression
                                text: Main.VSMain.Max
                                is_token: false
                                children:
                                  - kind: MemberAccessExpression
                                    text: Main.VSMain
                                    is_token: false
                                    children:
                                      - kind: Identifier
                                        text: Main
                                        is_token: true
                                        children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: VSMain
                                        is_token: true
                                        children: []
                                  - kind: PeriodOperator
                                    text: "."
                                    is_token: true
                                    children: []
                                  - kind: Identifier
                                    text: Max
                                    is_token: true
                                    children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: EqualityOperator
                                text: "="
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: BinaryExpression
                                text: (SizeY * Zoom) - Main.MainPic.ScaleHeight
                                is_token: false
                                children:
                                  - kind: ParenthesizedExpression
                                    text: (SizeY * Zoom)
                                    is_token: false
                                    children:
                                      - kind: LeftParenthesis
                                        text: (
                                        is_token: true
                                        children: []
                                      - kind: BinaryExpression
                                        text: SizeY * Zoom
                                        is_token: false
                                        children:
                                          - kind: IdentifierExpression
                                            text: SizeY
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: SizeY
                                                is_token: true
                                                children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: MultiplicationOperator
                                            text: "*"
                                            is_token: true
                                            children: []
                                          - kind: Whitespace
                                            text: " "
                                            is_token: true
                                            children: []
                                          - kind: IdentifierExpression
                                            text: Zoom
                                            is_token: false
                                            children:
                                              - kind: Identifier
                                                text: Zoom
                                                is_token: true
                                                children: []
                                      - kind: RightParenthesis
                                        text: )
                                        is_token: true
                                        children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: SubtractionOperator
                                    text: "-"
                                    is_token: true
                                    children: []
                                  - kind: Whitespace
                                    text: " "
                                    is_token: true
                                    children: []
                                  - kind: MemberAccessExpression
                                    text: Main.MainPic.ScaleHeight
                                    is_token: false
                                    children:
                                      - kind: MemberAccessExpression
                                        text: Main.MainPic
                                        is_token: false
                                        children:
                                          - kind: Identifier
                                            text: Main
                                            is_token: true
                                            children: []
                                          - kind: PeriodOperator
                                            text: "."
                                            is_token: true
                                            children: []
                                          - kind: Identifier
                                            text: MainPic
                                            is_token: true
                                            children: []
                                      - kind: PeriodOperator
                                        text: "."
                                        is_token: true
                                        children: []
                                      - kind: Identifier
                                        text: ScaleHeight
                                        is_token: true
                                        children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: EndOfLineComment
                text: "'Draw the new map image"
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawMap\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawMap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: EndOfLineComment
        text: "'As you may have guessed, this routine refreshes everything on the screen"
        is_token: true
        children: []
      - kind: Newline
        text: "\r\n"
        is_token: true
        children: []
      - kind: SubStatement
        text: "Public Sub RefreshAll()\r\n    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    DrawTileBar\r\n    DrawMap\r\n    \r\nEnd Sub\r\n"
        is_token: false
        children:
          - kind: PublicKeyword
            text: Public
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: Identifier
            text: RefreshAll
            is_token: true
            children: []
          - kind: ParameterList
            text: ()
            is_token: false
            children:
              - kind: LeftParenthesis
                text: (
                is_token: true
                children: []
              - kind: RightParenthesis
                text: )
                is_token: true
                children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
          - kind: StatementList
            text: "    \r\n    If UseStretchBlt Then\r\n        StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n    DrawTileBar\r\n    DrawMap\r\n    \r\n"
            is_token: false
            children:
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
              - kind: IfStatement
                text: "    If UseStretchBlt Then\r\n        StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    Else\r\n        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    End If\r\n"
                is_token: false
                children:
                  - kind: Whitespace
                    text: "    "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IdentifierExpression
                    text: UseStretchBlt
                    is_token: false
                    children:
                      - kind: Identifier
                        text: UseStretchBlt
                        is_token: true
                        children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: ThenKeyword
                    text: Then
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
                  - kind: StatementList
                    text: "        StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "StretchBlt Main.Pic1.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: StretchBlt
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Pic1
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTilesBuffer
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: CurPicIndex
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbSrcCopy
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "        "
                        is_token: true
                        children: []
                      - kind: CallStatement
                        text: "StretchBlt Main.Pic2.hdc, 0, 0, 64, 64, Main.PicTilesBuffer.hdc, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n"
                        is_token: false
                        children:
                          - kind: Identifier
                            text: StretchBlt
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Pic2
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: Main
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: PicTilesBuffer
                            is_token: true
                            children: []
                          - kind: PeriodOperator
                            text: "."
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: hdc
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: CurPicIndex2
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: MultiplicationOperator
                            text: "*"
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "0"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: IntegerLiteral
                            text: "64"
                            is_token: true
                            children: []
                          - kind: Comma
                            text: ","
                            is_token: true
                            children: []
                          - kind: Whitespace
                            text: " "
                            is_token: true
                            children: []
                          - kind: Identifier
                            text: vbSrcCopy
                            is_token: true
                            children: []
                          - kind: Newline
                            text: "\r\n"
                            is_token: true
                            children: []
                      - kind: Whitespace
                        text: "    "
                        is_token: true
                        children: []
                  - kind: ElseClause
                    text: "Else\r\n        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    "
                    is_token: false
                    children:
                      - kind: ElseKeyword
                        text: Else
                        is_token: true
                        children: []
                      - kind: Newline
                        text: "\r\n"
                        is_token: true
                        children: []
                      - kind: StatementList
                        text: "        Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n        Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n    "
                        is_token: false
                        children:
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "Main.Pic1.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex * 64, 0, 64, 64, vbSrcCopy\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Pic1
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PaintPicture
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTilesBuffer
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: CurPicIndex
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbSrcCopy
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "        "
                            is_token: true
                            children: []
                          - kind: CallStatement
                            text: "Main.Pic2.PaintPicture Main.PicTilesBuffer.Picture, 0, 0, 64, 64, CurPicIndex2 * 64, 0, 64, 64, vbSrcCopy\r\n"
                            is_token: false
                            children:
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Pic2
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PaintPicture
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Main
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: PicTilesBuffer
                                is_token: true
                                children: []
                              - kind: PeriodOperator
                                text: "."
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: Picture
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: CurPicIndex2
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: MultiplicationOperator
                                text: "*"
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "0"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: IntegerLiteral
                                text: "64"
                                is_token: true
                                children: []
                              - kind: Comma
                                text: ","
                                is_token: true
                                children: []
                              - kind: Whitespace
                                text: " "
                                is_token: true
                                children: []
                              - kind: Identifier
                                text: vbSrcCopy
                                is_token: true
                                children: []
                              - kind: Newline
                                text: "\r\n"
                                is_token: true
                                children: []
                          - kind: Whitespace
                            text: "    "
                            is_token: true
                            children: []
                  - kind: EndKeyword
                    text: End
                    is_token: true
                    children: []
                  - kind: Whitespace
                    text: " "
                    is_token: true
                    children: []
                  - kind: IfKeyword
                    text: If
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawTileBar\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawTileBar
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: CallStatement
                text: "DrawMap\r\n"
                is_token: false
                children:
                  - kind: Identifier
                    text: DrawMap
                    is_token: true
                    children: []
                  - kind: Newline
                    text: "\r\n"
                    is_token: true
                    children: []
              - kind: Whitespace
                text: "    "
                is_token: true
                children: []
              - kind: Newline
                text: "\r\n"
                is_token: true
                children: []
          - kind: EndKeyword
            text: End
            is_token: true
            children: []
          - kind: Whitespace
            text: " "
            is_token: true
            children: []
          - kind: SubKeyword
            text: Sub
            is_token: true
            children: []
          - kind: Newline
            text: "\r\n"
            is_token: true
            children: []
