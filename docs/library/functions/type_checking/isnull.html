<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VB6Parse Library Reference - isnull - Type Checking">
    <title>isnull - Type Checking - VB6Parse Library Reference</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <link rel="stylesheet" href="../../../assets/css/docs-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="../../../assets/js/theme-switcher.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/vbnet.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
    <header class="docs-header">
        <div class="container">
            <h1><a href="../../../index.html">VB6Parse</a> / <a href="../../../library/index.html">Library</a> / <a href="../../../library/functions/type_checking/index.html">Type Checking</a> / isnull</h1>
            <p class="tagline">VB6 Library Reference</p>
        </div>
    </header>

    <nav class="docs-nav">
        <div class="container">
            <a href="../../../index.html">Home</a>
            <a href="../../../library/index.html">Library Reference</a>
            <a href="../../../documentation.html">Documentation</a>
            <a href="https://docs.rs/vb6parse" target="_blank">API Docs</a>
            <a href="https://github.com/scriptandcompile/vb6parse" target="_blank">GitHub</a>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon">üåô</span>
            </button>
        </div>
    </nav>

    <main class="container">
        
        <article class="library-item">
            <h1 id="isnull-function"><code>IsNull</code> Function</h1>
<p>Returns a <code>Boolean</code> value indicating whether an expression contains no valid data (<code>Null</code>).</p>
<h2 id="syntax">Syntax</h2>
<pre><code class="language-vbnet">IsNull(expression)</code></pre>
<h2 id="parameters">Parameters</h2>
<ul>
<li><code>expression</code> (Required): Variant expression to test</li>
</ul>
<h2 id="return-value">Return Value</h2>
<p>Returns a Boolean:
- <code>True</code> if the expression is <code>Null</code>
- <code>False</code> if the expression contains valid data
- <code>Null</code> is different from <code>Empty</code> (uninitialized)
- <code>Null</code> is different from zero-length string ("")
- <code>Null</code> is different from zero (0)
- <code>Null</code> propagates through expressions ```(Null + 5 = Null)</p>
<pre><code>- Used to detect database `NULL` values

## Remarks

The `IsNull` function is used to determine whether an expression evaluates to `Null`:

- `Null` represents &quot;no valid data&quot; or &quot;unknown value&quot;
- Common in database operations (`NULL` field values)
- `Null` is different from `Empty`, zero, or empty string
- `Null` propagates: any operation involving `Null` yields `Null`
- Use `Null` for missing or unknown data
- Cannot compare `Null` with = operator (use `IsNull` instead)
- `var = Null` is always `Null` (not `True` or `False`)
- Only `IsNull` can reliably test for `Null`
- `Null` can be explicitly assigned: `myVar = Null`
- Only `Variant` variables can contain `Null`
- Common pattern: check `IsNull` before using database field values
- ```VarType(expr) = vbNull``` provides same functionality
- `Null` is tri-state: `True`, `False`, `Null` (for database three-valued logic)

## Typical Uses

1. **Database `NULL` Handling**: Check if database field contains `NULL`
2. **Data Validation**: Detect missing or unknown values
3. **Error Prevention**: Avoid errors from `Null` propagation
4. **Optional Values**: Represent &quot;not applicable&quot; or &quot;unknown&quot;
5. **Recordset Processing**: Handle `NULL` fields safely
6. **Form Input**: Detect unselected combo boxes or list boxes
7. **API Results**: Check for invalid return values
8. **`Null` Coalescing**: Provide defaults for `Null` values

## Basic Usage Examples
</code></pre>
<p>vb
' Example 1: Basic Null detection
Dim value As Variant</p>
<p>value = Null</p>
<p>If IsNull(value) Then
Debug.Print "Value is Null"  ' This prints
End If</p>
<p>' Example 2: Distinguish Null from other values
Dim testVar As Variant</p>
<p>testVar = Null
Debug.Print IsNull(testVar)        ' True - Null value
testVar = Empty
Debug.Print IsNull(testVar)        ' False - Empty is not Null
testVar = 0
Debug.Print IsNull(testVar)        ' False - Zero is not Null
testVar = ""
Debug.Print IsNull(testVar)        ' False - Empty string is not Null
testVar = False
Debug.Print IsNull(testVar)        ' False - False is not Null</p>
<p>' Example 3: Database field handling
Sub ProcessRecord(rs As Recordset)
Dim email As String</p>
<p>If IsNull(rs!Email) Then
email = "No email provided"
Else
email = rs!Email
End If</p>
<p>Debug.Print "Email: " &amp; email
End Sub</p>
<p>' Example 4: Null propagation demonstration
Dim result As Variant
Dim value As Variant</p>
<p>value = Null
result = value + 10        ' result is Null (Null propagates)
result = value &amp; "text"    ' result is Null (Null propagates)
result = value * 2         ' result is Null (Null propagates)</p>
<p>If IsNull(result) Then
Debug.Print "Result is Null due to propagation"  ' This prints
End If</p>
<p>' Cannot use = to test for Null
If result = Null Then      ' This condition is always Null (not True!)
Debug.Print "Never prints"
End If</p>
<p>If IsNull(result) Then     ' Correct way to test
Debug.Print "This prints"
End If</p>
<pre><code>
## Common Patterns
</code></pre>
<p>vb
' Pattern 1: Null coalescing - provide default value
Function Coalesce(value As Variant, defaultValue As Variant) As Variant
If IsNull(value) Then
Coalesce = defaultValue
Else
Coalesce = value
End If
End Function</p>
<p>' Usage
displayValue = Coalesce(rs!Phone, "N/A")</p>
<p>' Pattern 2: Safe database field retrieval
Function GetFieldValue(rs As Recordset, fieldName As String, _
Optional defaultValue As Variant = "") As Variant
If IsNull(rs.Fields(fieldName).Value) Then
GetFieldValue = defaultValue
Else
GetFieldValue = rs.Fields(fieldName).Value
End If
End Function</p>
<p>' Pattern 3: Null-safe string concatenation
Function NullSafeConcat(ParamArray values() As Variant) As String
Dim result As String
Dim i As Long</p>
<p>result = ""
For i = LBound(values) To UBound(values)
If Not IsNull(values(i)) Then
result = result &amp; values(i)
End If
Next i</p>
<p>NullSafeConcat = result
End Function</p>
<p>' Pattern 4: Check multiple values for Null
Function AnyNull(ParamArray values() As Variant) As Boolean
Dim i As Long</p>
<p>For i = LBound(values) To UBound(values)
If IsNull(values(i)) Then
AnyNull = True
Exit Function
End If
Next i</p>
<p>AnyNull = False
End Function</p>
<p>' Pattern 5: All values non-Null validation
Function AllNonNull(ParamArray values() As Variant) As Boolean
Dim i As Long</p>
<p>For i = LBound(values) To UBound(values)
If IsNull(values(i)) Or IsEmpty(values(i)) Then
AllNonNull = False
Exit Function
End If
Next i</p>
<p>AllNonNull = True
End Function</p>
<p>' Pattern 6: Null-safe numeric conversion
Function NullToZero(value As Variant) As Double
If IsNull(value) Then
NullToZero = 0
Else
NullToZero = CDbl(value)
End If
End Function</p>
<p>' Pattern 7: Null-safe comparison
Function NullSafeCompare(val1 As Variant, val2 As Variant) As Integer
' Returns: -1 (less), 0 (equal), 1 (greater), -999 (Null involved)
If IsNull(val1) Or IsNull(val2) Then
NullSafeCompare = -999  ' Indicate Null
Exit Function
End If</p>
<p>If val1 &lt; val2 Then
NullSafeCompare = -1
ElseIf val1 &gt; val2 Then
NullSafeCompare = 1
Else
NullSafeCompare = 0
End If
End Function</p>
<p>' Pattern 8: Count non-Null values
Function CountNonNull(arr As Variant) As Long
Dim count As Long
Dim i As Long</p>
<p>If Not IsArray(arr) Then
CountNonNull = 0
Exit Function
End If</p>
<p>count = 0
For i = LBound(arr) To UBound(arr)
If Not IsNull(arr(i)) And Not IsEmpty(arr(i)) Then
count = count + 1
End If
Next i</p>
<p>CountNonNull = count
End Function</p>
<p>' Pattern 9: Database insert with Null handling
Function BuildInsertSQL(table As String, values As Variant) As String
Dim sql As String
Dim i As Long
Dim valueStr As String</p>
<p>sql = "INSERT INTO " &amp; table &amp; " VALUES ("</p>
<p>For i = LBound(values) To UBound(values)
If i &gt; LBound(values) Then sql = sql &amp; ", "</p>
<p>If IsNull(values(i)) Then
valueStr = "NULL"
ElseIf VarType(values(i)) = vbString Then
valueStr = "'" &amp; Replace(values(i), "'", "''") &amp; "'"
Else
valueStr = CStr(values(i))
End If</p>
<p>sql = sql &amp; valueStr
Next i</p>
<p>BuildInsertSQL = sql &amp; ")"
End Function</p>
<p>' Pattern 10: Form field validation with Null check
Function ValidateRequiredField(field As Variant, fieldName As String) As Boolean
If IsNull(field) Then
MsgBox fieldName &amp; " is required", vbExclamation
ValidateRequiredField = False
ElseIf VarType(field) = vbString Then
If Trim$(field) = "" Then
MsgBox fieldName &amp; " cannot be empty", vbExclamation
ValidateRequiredField = False
Else
ValidateRequiredField = True
End If
Else
ValidateRequiredField = True
End If
End Function</p>
<pre><code>
## Advanced Usage Examples
</code></pre>
<p>vb
' Example 1: Database record processor with Null handling
Public Class RecordProcessor
Public Function ProcessRecordset(rs As Recordset) As Collection
Dim results As New Collection
Dim record As Dictionary
Dim fld As Field</p>
<p>Do While Not rs.EOF
Set record = CreateObject("Scripting.Dictionary")</p>
<p>For Each fld In rs.Fields
If IsNull(fld.Value) Then
record(fld.Name) = Empty  ' Convert Null to Empty
Else
record(fld.Name) = fld.Value
End If
Next fld</p>
<p>results.Add record
rs.MoveNext
Loop</p>
<p>Set ProcessRecordset = results
End Function</p>
<p>Public Function GetNonNullFields(rs As Recordset) As Collection
Dim fields As New Collection
Dim fld As Field</p>
<p>For Each fld In rs.Fields
If Not IsNull(fld.Value) Then
fields.Add fld.Name
End If
Next fld</p>
<p>Set GetNonNullFields = fields
End Function
End Class</p>
<p>' Example 2: Null-aware data aggregator
Public Class DataAggregator
Public Function Sum(values As Variant) As Variant
' Sum non-Null values, return Null if all Null
Dim total As Double
Dim count As Long
Dim i As Long</p>
<p>If Not IsArray(values) Then
Sum = Null
Exit Function
End If</p>
<p>total = 0
count = 0</p>
<p>For i = LBound(values) To UBound(values)
If Not IsNull(values(i)) Then
total = total + values(i)
count = count + 1
End If
Next i</p>
<p>If count = 0 Then
Sum = Null  ' All values were Null
Else
Sum = total
End If
End Function</p>
<p>Public Function Average(values As Variant) As Variant
Dim total As Double
Dim count As Long
Dim i As Long</p>
<p>If Not IsArray(values) Then
Average = Null
Exit Function
End If</p>
<p>total = 0
count = 0</p>
<p>For i = LBound(values) To UBound(values)
If Not IsNull(values(i)) And Not IsEmpty(values(i)) Then
total = total + values(i)
count = count + 1
End If
Next i</p>
<p>If count = 0 Then
Average = Null
Else
Average = total / count
End If
End Function
End Class</p>
<p>' Example 3: Form data validator
Public Class FormValidator
Private m_errors As Collection</p>
<p>Private Sub Class_Initialize()
Set m_errors = New Collection
End Sub</p>
<p>Public Function ValidateForm(form As Form) As Boolean
Dim ctrl As Control</p>
<p>m_errors.Clear</p>
<p>For Each ctrl In form.Controls
If TypeOf ctrl Is TextBox Then
ValidateTextBox ctrl
ElseIf TypeOf ctrl Is ComboBox Then
ValidateComboBox ctrl
End If
Next ctrl</p>
<p>ValidateForm = (m_errors.Count = 0)
End Function</p>
<p>Private Sub ValidateTextBox(txt As TextBox)
If txt.Tag = "required" Then
If IsNull(txt.Value) Or Trim$(txt.Value &amp; "") = "" Then
m_errors.Add "Field '" &amp; txt.Name &amp; "' is required"
End If
End If
End Sub</p>
<p>Private Sub ValidateComboBox(cmb As ComboBox)
If cmb.Tag = "required" Then
If IsNull(cmb.Value) Then
m_errors.Add "Please select a value for '" &amp; cmb.Name &amp; "'"
End If
End If
End Sub</p>
<p>Public Function GetErrors() As Collection
Set GetErrors = m_errors
End Function
End Class</p>
<p>' Example 4: SQL query builder with Null-safe WHERE clause
Public Class QueryBuilder
Public Function BuildWhereClause(conditions As Dictionary) As String
Dim sql As String
Dim key As Variant
Dim value As Variant
Dim first As Boolean</p>
<p>first = True
sql = ""</p>
<p>For Each key In conditions.Keys
value = conditions(key)</p>
<p>If Not first Then
sql = sql &amp; " AND "
Else
first = False
End If</p>
<p>If IsNull(value) Then
sql = sql &amp; key &amp; " IS NULL"
ElseIf VarType(value) = vbString Then
sql = sql &amp; key &amp; " = '" &amp; Replace(value, "'", "''") &amp; "'"
Else
sql = sql &amp; key &amp; " = " &amp; value
End If
Next key</p>
<p>If sql &lt;&gt; "" Then
BuildWhereClause = "WHERE " &amp; sql
Else
BuildWhereClause = ""
End If
End Function
End Class</p>
<pre><code>
## Error Handling

The `IsNull` function itself does not raise errors:
</code></pre>
<p>vb
' IsNull is safe to call on any value
Debug.Print IsNull(123)           ' False
Debug.Print IsNull("text")        ' False
Debug.Print IsNull(Null)          ' True
Debug.Print IsNull(Empty)         ' False
Debug.Print IsNull(rs!Field)      ' True or False depending on field</p>
<p>' Common mistake: using = to test for Null
Dim value As Variant
value = Null</p>
<p>' WRONG - this doesn't work!
If value = Null Then              ' Condition is Null (not True!)
Debug.Print "Never prints"
End If</p>
<p>' CORRECT - use IsNull
If IsNull(value) Then
Debug.Print "This prints"
End If</p>
<pre><code>
## Performance Considerations

- **Fast Operation**: `IsNull` is a very fast type check
- **Database Overhead**: `Null` checking is critical for database operations
- **Propagation**: Be aware of `Null` propagation in calculations
- **Early Check**: Check `IsNull` early to avoid `Null` propagation issues

## Best Practices

1. **Always Check Database Fields**: Use `IsNull` for all database field access
2. **Never Use = Null**: Always use `IsNull`, never `var = Null`
3. **Provide Defaults**: Use `Null` coalescing pattern for display values
4. **Document Null Behavior**: Clearly document when functions can return `Null`
5. **Combine Checks**: Often check both `IsNull` and `IsEmpty` for complete validation
6. **Handle Propagation**: Be aware that `Null` propagates through expressions
7. **Database Inserts**: Convert `Null` to SQL `NULL` in INSERT/UPDATE statements
8. **Form Validation**: Check for `Null` in combo boxes and optional fields

## Comparison with Related Functions

| Function | Purpose | Returns | Use Case |
|----------|---------|---------|----------|
| `IsNull` | Check if `Null` | `Boolean` | Detect `Null` values |
| `IsEmpty` | Check if uninitialized | `Boolean` | Detect `Empty` `Variants` |
| `IsError` | Check if error value | `Boolean` | Detect `CVErr` error values |
| `IsMissing` | Check if parameter omitted | `Boolean` | Detect missing Optional `Variant` |
| `VarType` | Get variant type | `Integer` | Detailed type information |
| `TypeName` | Get type name | `String` | Type name as `String` |
| `Nz` (Access) | `Null` to zero/string | `Variant` | MS Access `Null` coalescing |

## `Null` vs `Empty` vs `Zero` vs `Empty` `String`
</code></pre>
<p>vb
Dim v As Variant</p>
<p>' Null (no valid data)
v = Null
Debug.Print IsNull(v)          ' True
Debug.Print IsEmpty(v)         ' False
Debug.Print v = 0              ' Null (not True or False!)
Debug.Print v &amp; ""             ' "" (Null coalesces to empty in string context)</p>
<p>' Empty (uninitialized)
Dim v2 As Variant
Debug.Print IsNull(v2)         ' False
Debug.Print IsEmpty(v2)        ' True
Debug.Print v2 = 0             ' True (Empty coerces to 0)</p>
<p>' Zero
v = 0
Debug.Print IsNull(v)          ' False
Debug.Print v = 0              ' True</p>
<p>' Empty String
v = ""
Debug.Print IsNull(v)          ' False
Debug.Print v = ""             ' True</p>
<pre><code>
## Null Propagation
</code></pre>
<p>vb
Dim value As Variant
Dim result As Variant</p>
<p>value = Null</p>
<p>' All arithmetic operations propagate Null
result = value + 5             ' result = Null
result = value * 2             ' result = Null
result = value / 10            ' result = Null
result = value ^ 2             ' result = Null</p>
<p>' String concatenation with &amp; doesn't propagate Null
result = value &amp; "text"        ' result = "text" (Null becomes "")</p>
<p>' String concatenation with + propagates Null
result = value + "text"        ' result = Null</p>
<p>' Logical operations propagate Null
result = value And True        ' result = Null
result = value Or False        ' result = Null</p>
<p>' Comparison operations return Null
result = (value = 5)           ' result = Null (not True or False!)
result = (value &gt; 0)           ' result = Null
```</p>
<h2 id="platform-and-version-notes">Platform and Version Notes</h2>
<ul>
<li>Available in all VB6 versions</li>
<li>Part of VBA core functions</li>
<li>Returns <code>Boolean</code> type</li>
<li>Only <code>Variant</code> variables can contain <code>Null</code></li>
<li>Critical for database programming</li>
<li>MS Access has additional <code>Nz()</code> function for <code>Null</code> coalescing</li>
</ul>
<h2 id="limitations">Limitations</h2>
<ul>
<li>Cannot use = operator to test for <code>Null</code> (must use <code>IsNull</code>)</li>
<li>Only <code>Variant</code> type can contain <code>Null</code></li>
<li><code>Null</code> propagates through expressions (can be surprising)</li>
<li>No built-in <code>Null</code> coalescing operator (must use <code>IIf</code> or custom function)</li>
<li><code>Null</code> in <code>If</code> statement is treated as <code>False</code> (can be confusing)</li>
<li>No way to distinguish "<code>Null</code> from database" vs "assigned <code>Null</code>"</li>
</ul>
<h2 id="related-functions">Related Functions</h2>
<ul>
<li><code>IsEmpty</code>: Check if <code>Variant</code> is uninitialized (<code>Empty</code>)</li>
<li><code>VarType</code>: Get detailed <code>Variant</code> type information (vbNull = 1)</li>
<li><code>TypeName</code>: Get type name as string ("Null" for <code>Null</code> values)</li>
<li><code>IIf</code>: Can be used for simple <code>Null</code> coalescing: <code>IIf(IsNull(v), default, v)</code></li>
<li><code>Nz</code> (Access only): <code>Null</code> to zero/string conversion</li>
</ul>
        </article>
        
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
            <p>
                <a href="index.html">‚Üê Back to Type Checking</a> |
                <a href="../index.html">View all functions</a>
            </p>
        </div>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024-2026 VB6Parse Contributors. Licensed under the MIT License.</p>
        </div>
    </footer>
</body>
</html>
