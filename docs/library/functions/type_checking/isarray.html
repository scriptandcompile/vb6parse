<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VB6Parse Library Reference - isarray - Type Checking">
    <title>isarray - Type Checking - VB6Parse Library Reference</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <link rel="stylesheet" href="../../../assets/css/docs-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="../../../assets/js/theme-switcher.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/vbnet.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
    <header class="docs-header">
        <div class="container">
            <h1><a href="../../../index.html">VB6Parse</a> / <a href="../../../library/index.html">Library</a> / <a href="../../../library/functions/type_checking/index.html">Type Checking</a> / isarray</h1>
            <p class="tagline">VB6 Library Reference</p>
        </div>
    </header>

    <nav class="docs-nav">
        <div class="container">
            <a href="../../../index.html">Home</a>
            <a href="../../../library/index.html">Library Reference</a>
            <a href="../../../documentation.html">Documentation</a>
            <a href="https://docs.rs/vb6parse" target="_blank">API Docs</a>
            <a href="https://github.com/scriptandcompile/vb6parse" target="_blank">GitHub</a>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon">üåô</span>
            </button>
        </div>
    </nav>

    <main class="container">
        
        <article class="library-item">
            <h1 id="isarray-function"><code>IsArray</code> Function</h1>
<p>Returns a <code>Boolean</code> value indicating whether a variable is an array.</p>
<h2 id="syntax">Syntax</h2>
<pre><code class="language-vbnet">IsArray(varname)</code></pre>
<h2 id="parameters">Parameters</h2>
<p><code>varname</code> (Required): Variable name to test</p>
<h2 id="return-value">Return Value</h2>
<p>Returns a <code>Boolean</code>:
- <code>True</code> if the variable is an array
- <code>False</code> if the variable is not an array
- <code>True</code> for both fixed-size and dynamic arrays
- <code>True</code> even for unallocated dynamic arrays (dimensioned but not <code>ReDim</code>-med)</p>
<h2 id="remarks">Remarks</h2>
<p>The <code>IsArray</code> function is used to determine whether a variable is an array:
- Returns <code>True</code> for any array variable, regardless of dimensions
- Returns <code>True</code> for dynamic arrays even before they're allocated with <code>ReDim</code>
- Returns <code>False</code> for all non-array variables
- Useful when working with <code>Variant</code> variables that might contain arrays
- Often used with <code>ParamArray</code> parameters to validate input
- Can be used with the <code>Array</code> function result
- Returns <code>True</code> for arrays passed as <code>Variant</code> parameters
- Returns <code>True</code> for arrays stored in <code>Variant</code> variables
- Commonly used in procedures that accept flexible data types
- Important for validating function arguments</p>
<h2 id="typical-uses">Typical Uses</h2>
<p><strong>Parameter Validation</strong>: Verify that a <code>Variant</code> parameter contains an array
<strong>Data Type Detection</strong>: Determine if a <code>Variant</code> holds array data
<strong><code>ParamArray</code> Handling</strong>: Check individual elements of <code>ParamArray</code>
<strong>Dynamic Programming</strong>: Handle different data types in generic routines
<strong>Array Processing</strong>: Validate data before array operations
<strong>Error Prevention</strong>: Avoid runtime errors by checking array status
<strong>Flexible Functions</strong>: Create functions that accept both single values and arrays
<strong>Type Checking</strong>: Part of comprehensive type validation routines</p>
<h2 id="basic-usage-examples">Basic Usage Examples</h2>
<pre><code class="language-vbnet">&#x27; Example 1: Simple array check
Dim myArray(1 To 10) As Integer
Dim myValue As Integer

If IsArray(myArray) Then
Debug.Print &quot;myArray is an array&quot;  &#x27; This prints
End If

If IsArray(myValue) Then
Debug.Print &quot;myValue is an array&quot;
Else
Debug.Print &quot;myValue is not an array&quot;  &#x27; This prints
End If</code></pre>
<pre><code class="language-vbnet">&#x27; Example 2: Checking Variant contents
Dim myVariant As Variant

myVariant = Array(1, 2, 3, 4, 5)
If IsArray(myVariant) Then
Debug.Print &quot;Variant contains an array&quot;  &#x27; This prints
End If

myVariant = 42
If IsArray(myVariant) Then
Debug.Print &quot;Variant contains an array&quot;
Else
Debug.Print &quot;Variant does not contain an array&quot;  &#x27; This prints
End If</code></pre>
<pre><code class="language-vbnet">&#x27; Example 3: Dynamic array before ReDim
Dim dynamicArray() As String

If IsArray(dynamicArray) Then
Debug.Print &quot;Dynamic array variable is an array&quot;  &#x27; This prints even before ReDim
End If</code></pre>
<pre><code class="language-vbnet">&#x27; Example 4: Validating function parameters
Function ProcessData(data As Variant) As Long
If IsArray(data) Then
ProcessData = UBound(data) - LBound(data) + 1
Debug.Print &quot;Processing array with &quot; &amp; ProcessData &amp; &quot; elements&quot;
Else
ProcessData = 1
Debug.Print &quot;Processing single value&quot;
End If
End Function

&#x27; Usage
Dim result As Long
result = ProcessData(Array(1, 2, 3, 4, 5))  &#x27; Prints: Processing array with 5 elements
result = ProcessData(100)                    &#x27; Prints: Processing single value</code></pre>
<h2 id="common-patterns">Common Patterns</h2>
<pre><code class="language-vbnet">&#x27; Pattern 1: Validate array parameter
Function SumValues(values As Variant) As Double
Dim i As Long
Dim total As Double

If Not IsArray(values) Then
Err.Raise 5, , &quot;Parameter must be an array&quot;
End If

For i = LBound(values) To UBound(values)
total = total + values(i)
Next i

SumValues = total
End Function</code></pre>
<pre><code class="language-vbnet">&#x27; Pattern 2: Handle single value or array
Sub DisplayData(data As Variant)
Dim i As Long

If IsArray(data) Then
For i = LBound(data) To UBound(data)
Debug.Print &quot;Item &quot; &amp; i &amp; &quot;: &quot; &amp; data(i)
Next i
Else
Debug.Print &quot;Single value: &quot; &amp; data
End If
End Sub</code></pre>
<pre><code class="language-vbnet">&#x27; Pattern 3: Convert single value to array if needed
Function EnsureArray(value As Variant) As Variant
If IsArray(value) Then
EnsureArray = value
Else
EnsureArray = Array(value)
End If
End Function
</code></pre>
<p>vb
' Pattern 4: Count array elements safely
Function GetElementCount(data As Variant) As Long
If IsArray(data) Then
GetElementCount = UBound(data) - LBound(data) + 1
Else
GetElementCount = 1
End If
End Function</p>
<pre><code></code></pre>
<p>vb
' Pattern 5: Validate before array operation
Function GetFirstElement(arr As Variant) As Variant
If Not IsArray(arr) Then
GetFirstElement = arr
Exit Function
End If</p>
<p>If UBound(arr) &gt;= LBound(arr) Then
GetFirstElement = arr(LBound(arr))
Else
GetFirstElement = Null
End If
End Function</p>
<pre><code></code></pre>
<p>vb
' Pattern 6: Type checking with IsArray
Function DescribeVariable(v As Variant) As String
If IsArray(v) Then
DescribeVariable = "Array with " &amp; (UBound(v) - LBound(v) + 1) &amp; " elements"
ElseIf IsNumeric(v) Then
DescribeVariable = "Numeric value: " &amp; v
ElseIf IsDate(v) Then
DescribeVariable = "Date value: " &amp; v
ElseIf IsNull(v) Then
DescribeVariable = "Null value"
ElseIf IsEmpty(v) Then
DescribeVariable = "Empty variant"
Else
DescribeVariable = "String or object: " &amp; v
End If
End Function</p>
<pre><code></code></pre>
<p>vb
' Pattern 7: ParamArray validation
Sub ProcessItems(ParamArray items() As Variant)
Dim i As Long</p>
<p>For i = LBound(items) To UBound(items)
If IsArray(items(i)) Then
Debug.Print "Item " &amp; i &amp; " is an array"
Else
Debug.Print "Item " &amp; i &amp; ": " &amp; items(i)
End If
Next i
End Sub</p>
<pre><code></code></pre>
<p>vb
' Pattern 8: Safely iterate over data
Sub SafeIterate(data As Variant)
Dim i As Long</p>
<p>If IsArray(data) Then
For i = LBound(data) To UBound(data)
ProcessValue data(i)
Next i
Else
ProcessValue data
End If
End Sub</p>
<pre><code></code></pre>
<p>vb
' Pattern 9: Flatten nested arrays
Function FlattenArray(arr As Variant) As Variant
Dim result() As Variant
Dim i As Long
Dim count As Long</p>
<p>If Not IsArray(arr) Then
ReDim result(0 To 0)
result(0) = arr
FlattenArray = result
Exit Function
End If</p>
<p>count = 0
ReDim result(0 To 100)  ' Initial size</p>
<p>For i = LBound(arr) To UBound(arr)
If IsArray(arr(i)) Then
' Handle nested array (recursive)
Dim flattened As Variant
flattened = FlattenArray(arr(i))
' Add flattened elements to result...
Else
result(count) = arr(i)
count = count + 1
End If
Next i</p>
<p>ReDim Preserve result(0 To count - 1)
FlattenArray = result
End Function</p>
<pre><code></code></pre>
<p>vb
' Pattern 10: Conditional array processing
Function ApplyOperation(data As Variant, operation As String) As Variant
Dim i As Long
Dim result As Variant</p>
<p>If IsArray(data) Then
ReDim result(LBound(data) To UBound(data))
For i = LBound(data) To UBound(data)
result(i) = PerformOperation(data(i), operation)
Next i
ApplyOperation = result
Else
ApplyOperation = PerformOperation(data, operation)
End If
End Function</p>
<pre><code>
## Advanced Usage Examples
</code></pre>
<p>vb
' Example 1: Flexible data processor class
Public Class DataProcessor
Private m_data As Variant</p>
<p>Public Sub SetData(data As Variant)
m_data = data
End Sub</p>
<p>Public Function GetCount() As Long
If IsArray(m_data) Then
GetCount = UBound(m_data) - LBound(m_data) + 1
ElseIf IsEmpty(m_data) Then
GetCount = 0
Else
GetCount = 1
End If
End Function</p>
<p>Public Function GetSum() As Double
Dim i As Long
Dim total As Double</p>
<p>If IsArray(m_data) Then
For i = LBound(m_data) To UBound(m_data)
If IsNumeric(m_data(i)) Then
total = total + m_data(i)
End If
Next i
ElseIf IsNumeric(m_data) Then
total = m_data
End If</p>
<p>GetSum = total
End Function</p>
<p>Public Function GetAverage() As Double
Dim count As Long
count = GetCount()</p>
<p>If count &gt; 0 Then
GetAverage = GetSum() / count
End If
End Function</p>
<p>Public Sub DisplayData()
Dim i As Long</p>
<p>If IsArray(m_data) Then
Debug.Print "Array with " &amp; GetCount() &amp; " elements:"
For i = LBound(m_data) To UBound(m_data)
Debug.Print "  [" &amp; i &amp; "] = " &amp; m_data(i)
Next i
ElseIf IsEmpty(m_data) Then
Debug.Print "No data"
Else
Debug.Print "Single value: " &amp; m_data
End If
End Sub
End Class</p>
<pre><code></code></pre>
<p>vb
' Example 2: Generic collection converter
Public Class CollectionConverter
Public Function ToArray(source As Variant) As Variant
Dim result() As Variant
Dim i As Long</p>
<p>If IsArray(source) Then
' Already an array, just return it
ToArray = source
ElseIf TypeName(source) = "Collection" Then
' Convert collection to array
ReDim result(1 To source.Count)
For i = 1 To source.Count
result(i) = source(i)
Next i
ToArray = result
Else
' Single value, wrap in array
ReDim result(0 To 0)
result(0) = source
ToArray = result
End If
End Function</p>
<p>Public Function ToCollection(source As Variant) As Collection
Dim result As Collection
Dim i As Long</p>
<p>Set result = New Collection</p>
<p>If IsArray(source) Then
For i = LBound(source) To UBound(source)
result.Add source(i)
Next i
Else
result.Add source
End If</p>
<p>Set ToCollection = result
End Function
End Class</p>
<pre><code></code></pre>
<p>vb
' Example 3: Safe array utilities module
Public Module ArrayUtils
Public Function SafeUBound(arr As Variant, Optional dimension As Integer = 1) As Long
On Error Resume Next
If IsArray(arr) Then
SafeUBound = UBound(arr, dimension)
If Err.Number &lt;&gt; 0 Then SafeUBound = -1
Else
SafeUBound = -1
End If
On Error GoTo 0
End Function</p>
<p>Public Function SafeLBound(arr As Variant, Optional dimension As Integer = 1) As Long
On Error Resume Next
If IsArray(arr) Then
SafeLBound = LBound(arr, dimension)
If Err.Number &lt;&gt; 0 Then SafeLBound = 0
Else
SafeLBound = 0
End If
On Error GoTo 0
End Function</p>
<p>Public Function IsAllocatedArray(arr As Variant) As Boolean
On Error Resume Next
If IsArray(arr) Then
Dim ub As Long
ub = UBound(arr)
IsAllocatedArray = (Err.Number = 0)
Else
IsAllocatedArray = False
End If
On Error GoTo 0
End Function</p>
<p>Public Function CombineArrays(arr1 As Variant, arr2 As Variant) As Variant
Dim result() As Variant
Dim i As Long, count As Long</p>
<p>count = 0</p>
<p>' Count total elements
If IsArray(arr1) Then
count = count + (UBound(arr1) - LBound(arr1) + 1)
Else
count = count + 1
End If</p>
<p>If IsArray(arr2) Then
count = count + (UBound(arr2) - LBound(arr2) + 1)
Else
count = count + 1
End If</p>
<p>ReDim result(0 To count - 1)</p>
<p>' Copy elements
count = 0
If IsArray(arr1) Then
For i = LBound(arr1) To UBound(arr1)
result(count) = arr1(i)
count = count + 1
Next i
Else
result(count) = arr1
count = count + 1
End If</p>
<p>If IsArray(arr2) Then
For i = LBound(arr2) To UBound(arr2)
result(count) = arr2(i)
count = count + 1
Next i
Else
result(count) = arr2
count = count + 1
End If</p>
<p>CombineArrays = result
End Function
End Module</p>
<pre><code></code></pre>
<p>vb
' Example 4: Flexible function that handles multiple input types
Function CalculateTotal(values As Variant, Optional taxRate As Double = 0) As Double
Dim i As Long
Dim subtotal As Double
Dim tax As Double</p>
<p>subtotal = 0</p>
<p>If IsArray(values) Then
' Process array of values
For i = LBound(values) To UBound(values)
If IsNumeric(values(i)) Then
subtotal = subtotal + values(i)
ElseIf IsArray(values(i)) Then
' Handle nested array (recursive call)
subtotal = subtotal + CalculateTotal(values(i), 0)
End If
Next i
ElseIf IsNumeric(values) Then
' Process single value
subtotal = values
Else
Err.Raise 13, , "Type mismatch: values must be numeric or array"
End If</p>
<p>' Apply tax
If taxRate &gt; 0 Then
tax = subtotal * taxRate
CalculateTotal = subtotal + tax
Else
CalculateTotal = subtotal
End If
End Function</p>
<pre><code>
## Error Handling

The `IsArray` function itself does not raise errors, but it&#x27;s often used in error prevention:
</code></pre>
<p>vb
Function SafeArrayOperation(arr As Variant) As Variant
On Error GoTo ErrorHandler</p>
<p>If Not IsArray(arr) Then
Err.Raise 5, , "Invalid procedure call: array expected"
End If</p>
<p>' Proceed with array operations
Dim i As Long
For i = LBound(arr) To UBound(arr)
' Process array elements
Next i</p>
<p>Exit Function</p>
<p>ErrorHandler:
MsgBox "Error: " &amp; Err.Description, vbCritical
SafeArrayOperation = Null
End Function
```</p>
<h2 id="performance-considerations">Performance Considerations</h2>
<ul>
<li><strong>Fast Operation</strong>: <code>IsArray</code> is a very fast check with minimal overhead</li>
<li><strong>Type Checking</strong>: More efficient than attempting array operations and handling errors</li>
<li><strong>Avoid Redundant Checks</strong>: Cache <code>IsArray</code> result if checking multiple times</li>
<li><strong>Early Validation</strong>: Check <code>IsArray</code> early to avoid unnecessary processing</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Validate Parameters</strong>: Use <code>IsArray</code> to validate <code>Variant</code> parameters before array operations</li>
<li><strong>Flexible Functions</strong>: Create functions that gracefully handle both arrays and single values</li>
<li><strong>Clear Error Messages</strong>: Provide informative errors when array is expected but not received</li>
<li><strong>Combine Checks</strong>: Use with other Is functions (<code>IsNumeric</code>, <code>IsNull</code>, etc.) for complete validation</li>
<li><strong>Document Expectations</strong>: Clearly document whether functions expect arrays or single values</li>
<li><strong>Handle Edge Cases</strong>: Consider unallocated dynamic arrays (<code>IsArray</code> returns <code>True</code> but <code>UBound</code> fails)</li>
<li><strong>Use Early Returns</strong>: Check <code>IsArray</code> early and return/exit if validation fails</li>
<li><strong><code>ParamArray</code> Elements</strong>: Remember each <code>ParamArray</code> element might be an array</li>
</ol>
<h2 id="comparison-with-related-functions">Comparison with Related Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
<th>Returns</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IsArray</code></td>
<td>Check if array</td>
<td><code>Boolean</code></td>
<td>Validate array variables</td>
</tr>
<tr>
<td><code>IsEmpty</code></td>
<td>Check if uninitialized</td>
<td><code>Boolean</code></td>
<td>Check Variant initialization</td>
</tr>
<tr>
<td><code>IsNull</code></td>
<td>Check if Null</td>
<td><code>Boolean</code></td>
<td>Check for Null values</td>
</tr>
<tr>
<td><code>IsNumeric</code></td>
<td>Check if numeric</td>
<td><code>Boolean</code></td>
<td>Validate numeric data</td>
</tr>
<tr>
<td><code>IsObject</code></td>
<td>Check if object</td>
<td><code>Boolean</code></td>
<td>Validate object references</td>
</tr>
<tr>
<td><code>VarType</code></td>
<td>Get variant type</td>
<td><code>Integer</code></td>
<td>Detailed type information</td>
</tr>
<tr>
<td><code>TypeName</code></td>
<td>Get type name</td>
<td><code>String</code></td>
<td>Type name as string</td>
</tr>
</tbody>
</table>
<h2 id="platform-and-version-notes">Platform and Version Notes</h2>
<ul>
<li>Available in all VB6 versions</li>
<li>Part of VBA core functions</li>
<li>Returns <code>Boolean</code> type</li>
<li>Works with all array types (fixed, dynamic, single or multi-dimensional)</li>
<li>Returns <code>True</code> for unallocated dynamic arrays</li>
</ul>
<h2 id="limitations">Limitations</h2>
<ul>
<li>Does not indicate whether dynamic array is allocated (dimensioned vs <code>ReDim</code>-med)</li>
<li>Cannot determine number of dimensions</li>
<li>Cannot determine array bounds</li>
<li>Does not validate array contents</li>
<li>Does not distinguish between different array types</li>
</ul>
<h2 id="related-functions">Related Functions</h2>
<ul>
<li><code>UBound</code>: Upper bound of array dimension</li>
<li><code>LBound</code>: Lower bound of array dimension</li>
<li><code>Array</code>: Create <code>Variant</code> array</li>
<li><code>VarType</code>: Get detailed type information</li>
<li><code>TypeName</code>: Get type name as string</li>
<li><code>IsEmpty</code>: Check if <code>Variant</code> is uninitialized</li>
<li><code>IsNull</code>: Check if <code>Variant</code> is <code>Null</code></li>
</ul>
        </article>
        
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
            <p>
                <a href="index.html">‚Üê Back to Type Checking</a> |
                <a href="../index.html">View all functions</a>
            </p>
        </div>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024-2026 VB6Parse Contributors. Licensed under the MIT License.</p>
        </div>
    </footer>
</body>
</html>
