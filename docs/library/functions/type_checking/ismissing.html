<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VB6Parse Library Reference - ismissing - Type Checking">
    <title>ismissing - Type Checking - VB6Parse Library Reference</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <link rel="stylesheet" href="../../../assets/css/docs-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="../../../assets/js/theme-switcher.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/vbnet.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
    <header class="docs-header">
        <div class="container">
            <h1><a href="../../../index.html">VB6Parse</a> / <a href="../../../library/index.html">Library</a> / <a href="../../../library/functions/type_checking/index.html">Type Checking</a> / ismissing</h1>
            <p class="tagline">VB6 Library Reference</p>
        </div>
    </header>

    <nav class="docs-nav">
        <div class="container">
            <a href="../../../index.html">Home</a>
            <a href="../../../library/index.html">Library Reference</a>
            <a href="../../../documentation.html">Documentation</a>
            <a href="https://docs.rs/vb6parse" target="_blank">API Docs</a>
            <a href="https://github.com/scriptandcompile/vb6parse" target="_blank">GitHub</a>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon">üåô</span>
            </button>
        </div>
    </nav>

    <main class="container">
        
        <article class="library-item">
            <h1 id="ismissing-function">IsMissing Function</h1>
<p>Returns a <code>Boolean</code> value indicating whether an optional <code>Variant</code> parameter was passed to a procedure.</p>
<h2 id="syntax">Syntax</h2>
<pre><code class="language-vbnet">IsMissing(argname)</code></pre>
<h2 id="parameters">Parameters</h2>
<ul>
<li><code>argname</code> (Required): Name of an optional <code>Variant</code> parameter</li>
</ul>
<h2 id="return-value">Return Value</h2>
<p>Returns a Boolean:
- <code>True</code> if the optional <code>Variant</code> argument was not passed
- <code>False</code> if the optional <code>Variant</code> argument was passed
- Only works with optional <code>Variant</code> parameters
- Does not work with other data types (only <code>Variant</code>)
- Does not work with <code>ParamArray</code> parameters
- Returns <code>False</code> if <code>Null</code>, <code>Empty</code>, or any value was explicitly passed</p>
<h2 id="remarks">Remarks</h2>
<p>The <code>IsMissing</code> function is used to detect whether an optional parameter was omitted:
- Only works with Optional <code>Variant</code> parameters
- Cannot be used with typed optional parameters (Integer, String, etc.)
- Returns <code>True</code> only when argument was completely omitted
- Returns <code>False</code> if any value was passed (including <code>Empty</code>, <code>Null</code>, 0, "")
- Useful for implementing functions with truly optional behavior
- Different from checking <code>IsEmpty</code> - <code>IsMissing</code> detects omission
- <code>Empty</code> can be explicitly passed: <code>MyFunc Empty</code> - <code>IsMissing</code> returns <code>False</code>
- Common in COM/ActiveX programming for optional parameters
- Allows distinguishing "not provided" from "provided as Empty/Null/0"
- Must be used directly on parameter name, not on expressions
- Parameter must be declared as Optional <code>Variant</code>
- Cannot be used after assigning the parameter to another variable</p>
<h2 id="typical-uses">Typical Uses</h2>
<ol>
<li><strong>Optional Parameter Detection</strong>: Check if optional argument was provided</li>
<li><strong>Default Value Logic</strong>: Apply different defaults based on whether parameter was omitted</li>
<li><strong>API Compatibility</strong>: Maintain backward compatibility with varying parameter counts</li>
<li><strong>COM Interop</strong>: Work with COM objects expecting optional parameters</li>
<li><strong>Flexible Functions</strong>: Create functions with multiple optional behaviors</li>
<li><strong>Database Operations</strong>: Handle optional <code>WHERE</code> clause parameters</li>
<li><strong>Configuration Functions</strong>: Apply settings only when explicitly provided</li>
<li><strong>Validation Logic</strong>: Distinguish "no value" from "zero value"</li>
</ol>
<h2 id="basic-usage-examples">Basic Usage Examples</h2>
<pre><code class="language-vbnet">&#x27; Example 1: Simple optional parameter handling
Function Greet(name As String, Optional title As Variant) As String
    Dim greeting As String
    If IsMissing(title) Then
        greeting = &quot;Hello, &quot; &amp; name
    Else
        greeting = &quot;Hello, &quot; &amp; title &amp; &quot; &quot; &amp; name
    End If
    Greet = greeting
End Function
&#x27; Usage
Debug.Print Greet(&quot;Smith&quot;)              &#x27; &quot;Hello, Smith&quot;
Debug.Print Greet(&quot;Smith&quot;, &quot;Dr.&quot;)       &#x27; &quot;Hello, Dr. Smith&quot;
Debug.Print Greet(&quot;Smith&quot;, Empty)       &#x27; &quot;Hello,  Smith&quot; - Empty was passed!
&#x27; Example 2: Multiple optional parameters
Sub LogMessage(msg As String, Optional level As Variant, Optional timestamp As Variant)
    Dim output As String
    output = msg
    If Not IsMissing(level) Then
        output = &quot;[&quot; &amp; level &amp; &quot;] &quot; &amp; output
    End If
    If Not IsMissing(timestamp) Then
        output = Format$(timestamp, &quot;hh:nn:ss&quot;) &amp; &quot; &quot; &amp; output
    Else
        output = Format$(Now, &quot;hh:nn:ss&quot;) &amp; &quot; &quot; &amp; output
    End If
    Debug.Print output
End Sub
&#x27; Usage
LogMessage &quot;Application started&quot;                    &#x27; Uses current time, no level
LogMessage &quot;Error occurred&quot;, &quot;ERROR&quot;                &#x27; Uses current time, ERROR level
LogMessage &quot;Debug info&quot;, &quot;DEBUG&quot;, #1/1/2025 10:30#  &#x27; Uses specified time
&#x27; Example 3: Distinguish missing from zero/empty
Function Calculate(value As Double, Optional multiplier As Variant) As Double
    If IsMissing(multiplier) Then
        &#x27; No multiplier provided - return original value
        Calculate = value
    ElseIf multiplier = 0 Then
        &#x27; Multiplier is explicitly 0 - return 0
        Calculate = 0
    Else
        &#x27; Multiplier provided and non-zero
        Calculate = value * multiplier
    End If
End Function
Debug.Print Calculate(10)           &#x27; 10 - multiplier missing
Debug.Print Calculate(10, 2)        &#x27; 20 - multiplier is 2
Debug.Print Calculate(10, 0)        &#x27; 0 - multiplier is explicitly 0
&#x27; Example 4: Database query with optional filter
Function GetRecords(table As String, Optional whereClause As Variant) As Recordset
    Dim sql As String
    sql = &quot;SELECT * FROM &quot; &amp; table
    If Not IsMissing(whereClause) Then
        If whereClause &lt;&gt; &quot;&quot; Then
            sql = sql &amp; &quot; WHERE &quot; &amp; whereClause
        End If
    End If
    Set GetRecords = db.OpenRecordset(sql)
End Function
&#x27; Usage
Set rs = GetRecords(&quot;Customers&quot;)                    &#x27; All records
Set rs = GetRecords(&quot;Customers&quot;, &quot;State = &#x27;CA&#x27;&quot;)    &#x27; Filtered records
Set rs = GetRecords(&quot;Customers&quot;, &quot;&quot;)                &#x27; All records (empty string passed)</code></pre>
<h2 id="common-patterns">Common Patterns</h2>
<pre><code class="language-vbnet">&#x27; Pattern 1: Optional parameter with computed default
Function ProcessData(data As String, Optional maxLength As Variant) As String
    Dim limit As Long
    If IsMissing(maxLength) Then
        limit = Len(data)  &#x27; Use full length when not specified
    Else
        limit = maxLength
    End If
    ProcessData = Left$(data, limit)
End Function
&#x27; Pattern 2: Cascading optional parameters
Sub SaveFile(filename As String, Optional path As Variant, Optional createBackup As Variant)
    Dim fullPath As String
    Dim backup As Boolean
    If IsMissing(path) Then
        fullPath = App.Path &amp; &quot;\&quot; &amp; filename
    Else
        fullPath = path &amp; &quot;\&quot; &amp; filename
    End If
    If IsMissing(createBackup) Then
        backup = False  &#x27; Default to no backup
    Else
        backup = createBackup
    End If
    &#x27; Save file logic...
End Sub
&#x27; Pattern 3: Count provided optional parameters
Function CountProvided(Optional arg1 As Variant, Optional arg2 As Variant, _
                       Optional arg3 As Variant) As Integer
    Dim count As Integer
    count = 0
    If Not IsMissing(arg1) Then count = count + 1
    If Not IsMissing(arg2) Then count = count + 1
    If Not IsMissing(arg3) Then count = count + 1
    CountProvided = count
End Function
&#x27; Pattern 4: Optional override parameter
Function GetSetting(key As String, Optional overrideValue As Variant) As Variant
    If IsMissing(overrideValue) Then
        &#x27; Load from registry or config file
        GetSetting = LoadFromConfig(key)
    Else
        &#x27; Use provided override
        GetSetting = overrideValue
    End If
End Function
&#x27; Pattern 5: Optional parameter affects behavior
Sub PrintReport(data As Variant, Optional includeHeader As Variant)
    If Not IsMissing(includeHeader) Then
        If includeHeader Then
            PrintHeader
        End If
    Else
        &#x27; Default: always include header when not specified
        PrintHeader
    End If
    PrintData data
End Sub
&#x27; Pattern 6: Validation with optional strict mode
Function ValidateEmail(email As String, Optional strictMode As Variant) As Boolean
    Dim strict As Boolean
    If IsMissing(strictMode) Then
        strict = False  &#x27; Default to lenient validation
    Else
        strict = strictMode
    End If
    If strict Then
        ValidateEmail = ValidateEmailStrict(email)
    Else
        ValidateEmail = ValidateEmailBasic(email)
    End If
End Function
&#x27; Pattern 7: Optional range parameters
Function GetSubstring(text As String, Optional startPos As Variant, _
                      Optional length As Variant) As String
    Dim start As Long
    Dim len As Long
    If IsMissing(startPos) Then
        start = 1
    Else
        start = startPos
    End If
    If IsMissing(length) Then
        len = Len(text) - start + 1
    Else
        len = length
    End If
    GetSubstring = Mid$(text, start, len)
End Function
&#x27; Pattern 8: Build parameter list dynamically
Function BuildCommand(command As String, Optional arg1 As Variant, _
                      Optional arg2 As Variant) As String
    Dim cmd As String
    cmd = command
    If Not IsMissing(arg1) Then
        cmd = cmd &amp; &quot; &quot; &amp; arg1
    End If
    If Not IsMissing(arg2) Then
        cmd = cmd &amp; &quot; &quot; &amp; arg2
    End If
    BuildCommand = cmd
End Function
&#x27; Pattern 9: Optional error handler callback
Function ProcessRecords(records As Variant, Optional errorHandler As Variant) As Long
    Dim count As Long
    Dim i As Long
    count = 0
    For i = LBound(records) To UBound(records)
        On Error Resume Next
        ProcessRecord records(i)
        If Err.Number &lt;&gt; 0 Then
            If Not IsMissing(errorHandler) Then
                &#x27; Call custom error handler if provided
                Application.Run errorHandler, records(i), Err.Number
            End If
            Err.Clear
        Else
            count = count + 1
        End If
        On Error GoTo 0
    Next i
    ProcessRecords = count
End Function
&#x27; Pattern 10: Optional configuration object
Sub Initialize(Optional config As Variant)
    If IsMissing(config) Then
        &#x27; Use default configuration
        LoadDefaultConfig
    Else
        &#x27; Apply provided configuration
        ApplyConfig config
    End If
End Sub</code></pre>
<h2 id="advanced-usage-examples">Advanced Usage Examples</h2>
<pre><code class="language-vbnet">&#x27; Example 1: Flexible query builder
Public Class QueryBuilder
    Private m_sql As String
    Public Sub SelectFrom(table As String, Optional fields As Variant, _
                         Optional whereClause As Variant, _
                         Optional orderBy As Variant)
        If IsMissing(fields) Then
            m_sql = &quot;SELECT * FROM &quot; &amp; table
        Else
            m_sql = &quot;SELECT &quot; &amp; fields &amp; &quot; FROM &quot; &amp; table
        End If
        If Not IsMissing(whereClause) Then
            If whereClause &lt;&gt; &quot;&quot; Then
                m_sql = m_sql &amp; &quot; WHERE &quot; &amp; whereClause
            End If
        End If
        If Not IsMissing(orderBy) Then
            If orderBy &lt;&gt; &quot;&quot; Then
                m_sql = m_sql &amp; &quot; ORDER BY &quot; &amp; orderBy
            End If
        End If
    End Sub
    Public Function GetSQL() As String
        GetSQL = m_sql
    End Function
End Class
&#x27; Usage:
Dim qb As New QueryBuilder
qb.SelectFrom &quot;Customers&quot;                           &#x27; SELECT * FROM Customers
qb.SelectFrom &quot;Customers&quot;, &quot;Name, Email&quot;            &#x27; SELECT Name, Email FROM Customers
qb.SelectFrom &quot;Customers&quot;, , &quot;State = &#x27;CA&#x27;&quot;         &#x27; SELECT * FROM Customers WHERE State = &#x27;CA&#x27;
qb.SelectFrom &quot;Customers&quot;, &quot;Name&quot;, &quot;Active = 1&quot;, &quot;Name&quot;  &#x27; Full query
&#x27; Example 2: Logger with flexible output
Public Class Logger
    Private m_logFile As String
    Public Sub Initialize(Optional filename As Variant)
        If IsMissing(filename) Then
            m_logFile = App.Path &amp; &quot;\app.log&quot;
        Else
            m_logFile = filename
        End If
    End Sub
    Public Sub Log(message As String, Optional level As Variant, _
                   Optional timestamp As Variant, Optional writeToFile As Variant)
        Dim output As String
        Dim logLevel As String
        Dim useTimestamp As Date
        Dim toFile As Boolean
        &#x27; Determine log level
        If IsMissing(level) Then
            logLevel = &quot;INFO&quot;
        Else
            logLevel = level
        End If
        &#x27; Determine timestamp
        If IsMissing(timestamp) Then
            useTimestamp = Now
        Else
            useTimestamp = timestamp
        End If
        &#x27; Determine output destination
        If IsMissing(writeToFile) Then
            toFile = True  &#x27; Default to file
        Else
            toFile = writeToFile
        End If
        &#x27; Build output
        output = Format$(useTimestamp, &quot;yyyy-mm-dd hh:nn:ss&quot;) &amp; &quot; [&quot; &amp; _
                 logLevel &amp; &quot;] &quot; &amp; message
        &#x27; Write output
        Debug.Print output
        If toFile Then
            WriteToLogFile output
        End If
    End Sub
    Private Sub WriteToLogFile(text As String)
        Dim fileNum As Integer
        fileNum = FreeFile
        Open m_logFile For Append As fileNum
        Print #fileNum, text
        Close fileNum
    End Sub
End Class
&#x27; Example 3: HTTP request builder
Public Class HttpRequest
    Public Function Get(url As String, Optional headers As Variant, _
                       Optional timeout As Variant) As String
        Dim http As Object
        Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
        &#x27; Set timeout if provided
        If Not IsMissing(timeout) Then
            http.SetTimeouts timeout, timeout, timeout, timeout
        End If
        http.Open &quot;GET&quot;, url, False
        &#x27; Add custom headers if provided
        If Not IsMissing(headers) Then
            Dim headerList As Variant
            Dim i As Long
            If IsArray(headers) Then
                For i = LBound(headers) To UBound(headers)
                    http.setRequestHeader Split(headers(i), &quot;:&quot;)(0), _
                                         Trim$(Split(headers(i), &quot;:&quot;)(1))
                Next i
            End If
        End If
        http.send
        Get = http.responseText
    End Function
End Class
&#x27; Example 4: Validation framework
Public Class Validator
    Public Function Validate(value As Variant, Optional minValue As Variant, _
                            Optional maxValue As Variant, _
                            Optional pattern As Variant) As Boolean
        Dim isValid As Boolean
        isValid = True
        &#x27; Check minimum value
        If Not IsMissing(minValue) Then
            If value &lt; minValue Then
                isValid = False
                Exit Function
            End If
        End If
        &#x27; Check maximum value
        If Not IsMissing(maxValue) Then
            If value &gt; maxValue Then
                isValid = False
                Exit Function
            End If
        End If
        &#x27; Check pattern (if string)
        If Not IsMissing(pattern) Then
            If VarType(value) = vbString Then
                isValid = MatchesPattern(CStr(value), CStr(pattern))
            End If
        End If
        Validate = isValid
    End Function
    Private Function MatchesPattern(text As String, pattern As String) As Boolean
        &#x27; Simple pattern matching implementation
        MatchesPattern = (text Like pattern)
    End Function
End Class</code></pre>
<h2 id="error-handling">Error Handling</h2>
<p><code>IsMissing</code> itself does not raise errors, but improper usage can:</p>
<pre><code class="language-vbnet">&#x27; ERROR: Cannot use with non-Variant optional parameters
Function BadExample(Optional value As Integer) As Boolean
    BadExample = IsMissing(value)  &#x27; Compile error!
End Function
&#x27; CORRECT: Must use Optional Variant
Function GoodExample(Optional value As Variant) As Boolean
    GoodExample = IsMissing(value)  &#x27; Works correctly
End Function
&#x27; ERROR: Cannot use after assignment
Function BadExample2(Optional value As Variant) As Boolean
    Dim temp As Variant
    temp = value
    BadExample2 = IsMissing(temp)  &#x27; Always False! Use value directly.
End Function
&#x27; CORRECT: Use parameter directly
Function GoodExample2(Optional value As Variant) As Boolean
    GoodExample2 = IsMissing(value)  &#x27; Works correctly
End Function</code></pre>
<h2 id="performance-considerations">Performance Considerations</h2>
<ul>
<li><strong>Fast Operation</strong>: <code>IsMissing</code> is a very fast check with minimal overhead</li>
<li><strong>Compile-Time Check</strong>: VB6 can optimize <code>IsMissing</code> checks</li>
<li><strong>Variant Overhead</strong>: Optional <code>Variant</code> parameters have more overhead than typed parameters</li>
<li><strong>Use Sparingly</strong>: Only use when you truly need to distinguish missing from provided</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Use Only with Variant</strong>: <code>IsMissing</code> only works with Optional <code>Variant</code> parameters</li>
<li><strong>Direct Check</strong>: Always check <code>IsMissing</code> directly on the parameter name</li>
<li><strong>Document Behavior</strong>: Clearly document what happens when parameter is omitted</li>
<li><strong>Provide Defaults</strong>: Consider if default values on Optional parameters would work instead</li>
<li><strong>Avoid Complexity</strong>: Don't overuse optional parameters - can make APIs confusing</li>
<li><strong>Check Early</strong>: Test <code>IsMissing</code> before using the parameter value</li>
<li><strong>Combine Wisely</strong>: Can combine with <code>IsEmpty</code>, <code>IsNull</code> checks for complete validation</li>
<li><strong>API Design</strong>: Use for true optional behavior, not just to avoid typing</li>
</ol>
<h2 id="comparison-with-related-functions">Comparison with Related Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
<th>Returns</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IsMissing</code></td>
<td>Check if optional parameter omitted</td>
<td><code>Boolean</code></td>
<td>Detect missing Optional <code>Variant</code> arguments</td>
</tr>
<tr>
<td><code>IsEmpty</code></td>
<td>Check if uninitialized</td>
<td><code>Boolean</code></td>
<td>Detect <code>Empty</code> <code>Variant</code> values</td>
</tr>
<tr>
<td><code>IsNull</code></td>
<td>Check if Null</td>
<td><code>Boolean</code></td>
<td>Detect <code>Null</code> values</td>
</tr>
<tr>
<td><code>IsError</code></td>
<td>Check if error value</td>
<td><code>Boolean</code></td>
<td>Detect <code>CVErr</code> error values</td>
</tr>
<tr>
<td><code>VarType</code></td>
<td>Get variant type</td>
<td><code>Integer</code></td>
<td>Detailed type information</td>
</tr>
<tr>
<td><code>TypeName</code></td>
<td>Get type name</td>
<td><code>String</code></td>
<td>Type name as string</td>
</tr>
</tbody>
</table>
<h2 id="ismissing-vs-isempty"><code>IsMissing</code> vs <code>IsEmpty</code></h2>
<pre><code class="language-vbnet">Sub Test(Optional param As Variant)
    &#x27; Case 1: Parameter not provided
    &#x27; Call: Test
    Debug.Print IsMissing(param)  &#x27; True - was not provided
    Debug.Print IsEmpty(param)    &#x27; True - is Empty
    &#x27; Case 2: Explicit Empty passed
    &#x27; Call: Test Empty
    Debug.Print IsMissing(param)  &#x27; False - was provided (even though Empty)
    Debug.Print IsEmpty(param)    &#x27; True - is Empty
    &#x27; Case 3: Null passed
    &#x27; Call: Test Null
    Debug.Print IsMissing(param)  &#x27; False - was provided
    Debug.Print IsEmpty(param)    &#x27; False - is Null, not Empty
    &#x27; Case 4: Zero passed
    &#x27; Call: Test 0
    Debug.Print IsMissing(param)  &#x27; False - was provided
    Debug.Print IsEmpty(param)    &#x27; False - has value (0)
End Sub</code></pre>
<h2 id="platform-and-version-notes">Platform and Version Notes</h2>
<ul>
<li>Available in all VB6 versions</li>
<li>Part of VBA core functions</li>
<li>Returns <code>Boolean</code> type</li>
<li>Only works with Optional <code>Variant</code> parameters</li>
<li>Compile-time requirement: parameter must be Optional <code>Variant</code></li>
<li>Cannot be used with <code>ParamArray</code></li>
<li>Common in COM/ActiveX programming</li>
</ul>
<h2 id="limitations">Limitations</h2>
<ul>
<li>Only works with Optional <code>Variant</code> parameters (not <code>Integer</code>, <code>String</code>, etc.)</li>
<li>Cannot be used on expressions, only on parameter names</li>
<li>Cannot be used after assigning parameter to another variable</li>
<li>Does not work with <code>ParamArray</code> parameters</li>
<li>Cannot detect which parameter in <code>ParamArray</code> was omitted</li>
<li>Requires <code>Variant</code> type (introduces type safety concerns)</li>
<li>Can make function signatures more complex</li>
</ul>
<h2 id="related-functions">Related Functions</h2>
<ul>
<li><code>IsEmpty</code>: Check if <code>Variant</code> is uninitialized (<code>Empty</code>)</li>
<li><code>IsNull</code>: Check if <code>Variant</code> is <code>Null</code></li>
<li><code>VarType</code>: Get detailed <code>Variant</code> type information</li>
<li><code>TypeName</code>: Get type name as <code>String</code></li>
</ul>
        </article>
        
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
            <p>
                <a href="index.html">‚Üê Back to Type Checking</a> |
                <a href="../index.html">View all functions</a>
            </p>
        </div>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024-2026 VB6Parse Contributors. Licensed under the MIT License.</p>
        </div>
    </footer>
</body>
</html>
